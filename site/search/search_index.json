{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"\ud83d\udc4b Welcome to LiuTianBa7 's Blog","text":""},{"location":"#author-bio","title":"\ud83d\udc68\u200d\ud83d\udcbb \u5173\u4e8e\u6211 (Author Bio)","text":"\ud83c\udf93 \u5b66\u6821/\u4e13\u4e1a\uff1a\u4e1c\u5357\u5927\u5b66 \u00b7 \u8ba1\u7b97\u673a\u79d1\u5b66\u4e0e\u6280\u672f \u00b7 \u7814 0 \ud83c\udfaf \u5173\u6ce8\u9886\u57df\uff1a\u6df1\u5ea6\u5b66\u4e60\u3001\u540e\u7aef\u5f00\u53d1 \u2615 Java \u751f\u6001\uff1a              \ud83d\udc0d Python &amp; AI\uff1a              \ud83d\udcbe \u57fa\u7840 &amp; \u4e2d\u8fdb\u4ef6\uff1a              \ud83c\udf10 \u524d\u7aef\u6280\u672f\uff1a              \ud83d\ude80 \u76ee\u6807\uff1a\u5927\u5382! \u5927\u5382! \u8fd8\u662f\u5927\u5382!"},{"location":"#collections","title":"\ud83d\udcc2 \u672c\u7ad9\u6536\u5f55 (Collections)","text":"<ul> <li> <p> \u6280\u672f\u7b14\u8bb0</p> <p>\u6c47\u603b\u4e2a\u4eba\u5728 Code \u5b66\u4e60\u8def\u4e0a\u7684\u6240\u6709\u7b14\u8bb0\uff0c\u6db5\u76d6\u7b97\u6cd5\u3001\u6846\u67b6\u4e0e\u5b9e\u6218\u3002</p> </li> <li> <p> \u9762\u7ecf\u5fc3\u5f97</p> <p>\u6c89\u6dc0\u9762\u8bd5\u603b\u7ed3\u3001\u6838\u5fc3\u6e90\u7801\u7814\u8bfb\u53ca\u590d\u6742 Bug \u89e3\u51b3\u601d\u8def\u3002\u5728\u4e0d\u65ad\u590d\u76d8\u4e2d\u6784\u5efa\u5b8c\u5584\u7684\u5e95\u5c42\u77e5\u8bc6\u4f53\u7cfb\uff0c\u8bb0\u5f55\u6bcf\u4e00\u6b21\u6280\u672f\u7a81\u7834\u3002</p> </li> <li> <p> \u751f\u6d3b\u968f\u7b14</p> <p>\u8bb0\u5f55 2026 \u7684\u788e\u788e\u5ff5\uff0c\u5305\u62ec\u4e66\u5355\u3001\u5f71\u8bc4\u4e0e\u65c5\u884c\u611f\u609f\u3002</p> </li> <li> <p> \u9879\u76ee\u4f5c\u54c1</p> <p>\u5c55\u793a\u6211\u7684\u5f00\u6e90\u9879\u76ee\u4e0e\u4e2a\u4eba\u4f5c\u54c1\u96c6\u3002</p> </li> </ul>"},{"location":"#connect-with-me","title":"\ud83d\udcec \u8054\u7cfb\u6211 (Connect With Me)","text":"<p>\u5982\u679c\u4f60\u6709\u4efb\u4f55\u95ee\u9898\u6216\u60f3\u4ea4\u4e2a\u670b\u53cb\uff0c\u6b22\u8fce\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u8054\u7cfb\uff1a</p> <p> liutianba7@163.com | liutianba92@gmail.com Lqqqqqq123123</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/","title":"SpringBoot + git + Linux + Redis + Docker + RMQ","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#springboot","title":"\u4e00 Springboot","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1-spring-boot","title":"1. Spring Boot\u7684\u6982\u5ff5\u3001\u529f\u80fd","text":"<pre><code>\u7b80\u5355\u6765\u8bf4\uff0cSpring Boot \u80fd\u8ba9\u4f60**\u5feb\u901f\u521b\u5efa\u3001\u914d\u7f6e\u548c\u8fd0\u884c Spring \u5e94\u7528**\uff0c\u65e0\u9700\u624b\u52a8\u6dfb\u52a0\u5927\u91cf XML \u914d\u7f6e\u6216\u7e41\u7410\u7684\u4f9d\u8d56\u7ba1\u7406\u3002\u4ee5\u524d\u7528 Spring \u5199 Web \u9879\u76ee\uff0c\u8981\u914d `web.xml`\u3001Dispatcher Serverlet\u3001Spring \u5bb9\u5668\u2026\u2026\u4e00\u5927\u5806\u914d\u7f6e\u3002\n\n\u73b0\u5728\u7528 Spring Boot\uff0c\u4f60\u53ea\u9700\u8981\uff1a\n\n1. \u52a0\u4e2a `spring-boot-starter-web` \u4f9d\u8d56\uff0c\n2. \u5199\u4e2a `@SpringBootApplication` \u6ce8\u89e3\u7684\u4e3b\u7c7b\uff0c\n3. \u8fd0\u884c `main` \u65b9\u6cd5 \u2014\u2014 \u9879\u76ee\u5c31\u8dd1\u8d77\u6765\u4e86\uff01\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2","title":"2. \u573a\u666f\u542f\u52a8\u5668","text":"<pre><code>Starters are a set of convenient dependency descriptors that you can include in your application. You get a one-stop shop for all the Spring and related technologies that you need without having to hunt through sample code and copy-paste loads of dependency descriptors. For example, if you want to get started using Spring and JPA for database access, include the `spring-boot-starter-data-jpa` dependency in your project.\n\n\u542f\u52a8\u5668\u662f\u4e00\u7ec4\u65b9\u4fbf\u7684\u4f9d\u8d56\u9879\u63cf\u8ff0\u7b26\uff0c\u60a8\u53ef\u4ee5\u5c06\u5176\u5305\u542b\u5728\u5e94\u7528\u7a0b\u5e8f\u4e2d\u3002\u60a8\u53ef\u4ee5\u5728\u4e00\u4e2a\u5730\u65b9\u83b7\u53d6\u6240\u6709\u9700\u8981\u7684 Spring \u53ca\u76f8\u5173\u6280\u672f\uff0c\u800c\u65e0\u9700\u5728\u793a\u4f8b\u4ee3\u7801\u4e2d\u641c\u5bfb\u5e76\u590d\u5236\u7c98\u8d34\u5927\u91cf\u7684\u4f9d\u8d56\u9879\u63cf\u8ff0\u7b26\u3002\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u60f3\u5f00\u59cb\u4f7f\u7528 Spring \u548c JPA \u8fdb\u884c\u6570\u636e\u5e93\u8bbf\u95ee\uff0c\u8bf7\u5728\u9879\u76ee\u4e2d\u5305\u542b `spring-boot-starter-data-jpa` \u4f9d\u8d56\u9879\u3002\n\nThe starters contain a lot of the dependencies that you need to get a project up and running quickly and with a consistent, supported set of managed transitive dependencies.\n\n\u8fd9\u4e9b\u542f\u52a8\u5668\u5305\u542b\u5927\u91cf\u60a8\u9700\u8981\u7684\u4f9d\u8d56\u9879\uff0c\u80fd\u8ba9\u60a8\u5feb\u901f\u542f\u52a8\u9879\u76ee\uff0c\u5e76\u4e14\u62e5\u6709\u4e00\u5957\u4e00\u81f4\u4e14\u53d7\u652f\u6301\u7684\u53d7\u7ba1\u4f20\u9012\u4f9d\u8d56\u9879\u3002\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3","title":"3.  \u81ea\u52a8\u914d\u7f6e","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#31","title":"3.1 \u6982\u5ff5","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#32","title":"3.2 \u6838\u5fc3\u6d41\u7a0b","text":"<pre><code>1. \u521b\u5efa\u9879\u76ee\n2. \u9009\u62e9\u573a\u666f\u542f\u52a8\u5668\n3. \u573a\u666f\u542f\u52a8\u5668\u4e00\u5bfc\u5165\uff0c\u5c31\u4eceMETA-INF/spring.org.springframework.boot.autoconfigure .AutoConfiguration.imports\u4e0b\u9762\u5bfc\u5165\u4e00\u5806\u81ea\u52a8\u914d\u7f6e\u7c7b\u5230spring\u5bb9\u5668\u4e2d\u3002\n4. \u8fd9\u4e9b xxxAutoConfiguration \u57fa\u4e8e @Conditional \u6ce8\u89e3\u6709\u5bfc\u5165\u4e86\u4e00\u5806\u7684\u7ec4\u4ef6\n5. \u4e4b\u540e\u4e1a\u52a1\u5c31\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e9b\u7ec4\u4ef6\u4e86\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#33-datasourceautoconfiguration","title":"3.3 DataSourceAutoConfiguration \u7684\u5bfc\u5165\u6d41\u7a0b","text":"<pre><code>6. \u5728\u4f7f\u7528\u4e4b\u524d\uff0c\u81ea\u52a8\u914d\u7f6e\u7c7b\u628a\u7ec4\u4ef6\u914d\u7f6e\u5230\u5bb9\u5668\u4e2d\uff0c\u8981\u505a\u4e24\u4ef6\u4e8b\n\n    6.1\u628a\u5c5e\u6027\u7c7b\u548c\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u7ed1\u5b9a\n    6.2\uff1a\u628a\u7ec4\u4ef6\u8981\u7528\u5230\u7684\u6240\u6709\u5c5e\u6027\uff0c\u4e5f\u5c31\u662f\u8fd9\u4e2a\u5c5e\u6027\u7c7b\u653e\u5230\u5bb9\u5668\u4e2d\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#4","title":"4. \u5e38\u7528\u57fa\u672c\u529f\u80fd","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1-configurationproperties","title":"1. \u5c5e\u6027\u7ed1\u5b9a @ConfigurationProperties","text":"<pre><code>@Data\n@Component\n@ConfigurationProperties(prefix = \"dog\")\npublic class DogProperties {\n    private String name;\n    private String age;\n    private String sex;\n}\n\n// \u914d\u7f6e\u6587\u4ef6\ndog:\n  age: 18\n  name: \u65fa\u8d22\n  sex: \u96c4\u6027\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2-yaml","title":"2. yaml\u8bed\u6cd5","text":"<pre><code>1.  yaml\u8bed\u6cd5\u90fd\u662f key : value\n2.  \u4e00\u4e2a\u5bf9\u8c61\u5c31\u662f\u591a\u4e2a key : value, \u4e5f\u53ef\u4ee5\u7528: {name: \u5c0f\u54aa, age: 18}  \u8868\u793a\n3.  \u6570\u636e\u53ef\u4ee5\u7528[i1, i2, i3]\u8868\u793a,\u4e5f\u53ef\u4ee5\u7528 - i1, -i2 \u8868\u793a\n\n\u6ce8:\u5982\u679c\u540c\u65f6\u5b58\u5728.properties\u4e0e.yaml,\u4f18\u5148\u4f7f\u7528.properties\u4e0b\u7684\u914d\u7f6e\n</code></pre> <pre><code>person:  \n  name: \u674e\u56db  \n  age: 18  \n  birthday: 2019/01/01 00:00:00  \n  like: true  \n  child:  \n    name: \u5f20\u4e09  \n    age: 10  \n    birthday: 2018/01/01 00:00:00  \n  dogs:  \n    - name: \u65fa\u8d22  \n      age: 18  \n    - name: \u65fa\u8d222  \n      age: 18  \n  cats:  \n    cat1:  \n      {name: \u5c0f\u54aa, age: 18}  \n    cat2:  \n      {name: \u5c0f\u54aa2, age: 18}\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3-banner","title":"3. \u81ea\u5b9a\u4e49banner","text":"<pre><code>\u901a\u8fc7\u4fee\u6539 spring.banner.location=classpath:banner.txt \u53bb\u81ea\u5b9a\u4e49bannner\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#4-springapplication","title":"4. \u542f\u52a8 SpringApplication \u7684\u5176\u4ed6\u65b9\u6cd5","text":"<pre><code>\u7b2c\u4e00\u79cd\u5c31\u662f\u5148\u628a SpringApplication \u5bf9\u8c61\u5b9e\u4f8b\u5316\u51fa\u6765,\u7136\u540e\u8c03\u7528\u5b83\u7684run\u65b9\u6cd5,\u8fd9\u6837\u7684\u597d\u5904\u662f\u53ef\u4ee5\u505a\u4e00\u4e9b\u914d\u7f6e.\n</code></pre> <p><code>java public static void main(String[] args) {           // 1. \u521b\u5efaSpringApplication\u5bf9\u8c61          SpringApplication app = new SpringApplication(SpringbootDemoApplication.class);           // 2. \u914d\u7f6e          app.setBannerMode(Banner.Mode.OFF);           // 3. \u542f\u52a8SpringApplication\u5bf9\u8c61          app.run(args);      }</code></p> <pre><code>\u7b2c\u4e8c\u79cd\u65b9\u6cd5\u5c31\u662f\u901a\u8fc7 SpringApplicationBuilder \u6765\u94fe\u5f0f\u542f\u52a8 Spring \u5e94\u7528.\n</code></pre> <p><code>java builder.sources(SpringbootDemoApplication.class)           .bannerMode(Banner.Mode.OFF)           .run(args);</code></p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#5","title":"5. \u65e5\u5fd7","text":"<pre><code>\u65e5\u5fd7\u7cfb\u7edf\u63cf\u8ff0:\n</code></pre> <p>![[Pasted image 20251102093346.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#51","title":"5.1 \u65e5\u5fd7\u7684\u7ea7\u522b","text":"<pre><code>All --&gt; Trace --&gt; DEBUG --&gt; INFO --&gt; WARN --&gt; ERROR --&gt; OFF\n\u4ece\u4f4e\u5230\u9ad8,\u8d8a\u6253\u5370,\u8d8a\u7c97\u7cd9.\u65e5\u5fd7\u7684\u9ed8\u8ba4\u7ea7\u522b(info),\u53ea\u4f1a\u6253\u5370\u65e5\u5fd7\u7ea7\u522b\u53ca\u5176\u4ee5\u4e0a\u7684\u65e5\u5fd7.\n</code></pre> <p><code>logging.level.root=debug logging.level.xx\u5305\u7684\u5168\u7c7b\u540d=xx\u7ea7\u522b</code></p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#52","title":"5.2 \u65e5\u5fd7\u7684\u4f7f\u7528\u65b9\u5f0f","text":"<pre><code>\u9996\u5148\uff0c\u5148\u5bfc\u5165\u65e5\u5fd7\u7684\u573a\u666f\u542f\u52a8\u5668\n</code></pre> <p><code>java &lt;dependency&gt;       &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;       &lt;artifactId&gt;spring-boot-starter-logging&lt;/artifactId&gt;   &lt;/dependency&gt;</code></p> <pre><code>\u65b9\u6cd51:\u76f4\u63a5\u901a\u8fc7\u65e5\u5fd7\u5de5\u5382\u83b7\u5f97\u4e00\u4e2a\u5de5\u5382\u7c7b\n</code></pre> <p><code>java @SpringBootTest   public class LoggingTest {        // \u83b7\u5f97\u4e00\u4e2a\u65e5\u5fd7       Logger logger = LoggerFactory.getLogger(LoggingTest.class);        @Test       public void test01(){           logger.trace(\"trace...\");           logger.debug(\"debug...\");           logger.info(\"info...\");           logger.warn(\"warn...\");           logger.error(\"error...\");       }   }</code></p> <pre><code>\u65b9\u6cd52:lombok\u7684 @Slf4j \u6ce8\u89e3\u4f1a\u81ea\u52a8\u6ce8\u518c\u5e76\u6ce8\u5165\u4e00\u4e2a\u65e5\u5fd7\u7c7b,\u540d\u5b57\u4e3alog,\u6211\u4eec\u76f4\u63a5\u8c03log\u5c31\u53ef\u4ee5.\n</code></pre> <p><code>java @Slf4j   @SpringBootTest   public class LoggingTest {        @Test       public void test01(){           log.trace(\"trace...\");           log.debug(\"debug...\");           log.info(\"info...\");           log.warn(\"warn...\");           log.error(\"error...\");       }   }</code></p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#53","title":"5.3 \u65e5\u5fd7\u5206\u7ec4","text":"<pre><code>\u65e5\u5fd7\u5206\u7ec4\u80fd\u591f\u66f4\u52a0\u7ec6\u7c92\u5ea6\u7684\u63a7\u5236\u4e0d\u540c\u5305,\u4e0d\u540c\u7c7b\u7684\u65e5\u5fd7\u7ea7\u522b,\u4e5f\u5c31\u662f\u5bf9\u6bcf\u4e00\u7ec4\u7edf\u4e00\u6765\u63a7\u5236\u7ea7\u522b\n</code></pre> <p><code>java logging.group.group1=\u5168\u7c7b\u540d1,\u5168\u7c7b\u540d2,...</code></p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#54","title":"5.4 \u65e5\u5fd7\u8f93\u51fa\u5230\u6587\u4ef6","text":"<p>![[Pasted image 20251102100745.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#55","title":"5.5 \u65e5\u5fd7\u5f52\u6863\u4e0e\u6eda\u52a8\u5207\u5272","text":"<pre><code>Spring Boot \u9879\u76ee\u4e2d\u901a\u8fc7 `application.yml` \u6216 `application.properties` \u914d\u7f6e Logback \u7684\u65e5\u5fd7\u6eda\u52a8\u7b56\u7565\uff0c\u5b9e\u73b0\u65e5\u5fd7\u6587\u4ef6\u7684\u81ea\u52a8\u5207\u5272\u4e0e\u5f52\u6863\u3002\n</code></pre> \u914d\u7f6e\u9879 \u8bf4\u660e \u63a8\u8350\u503c/\u793a\u4f8b <code>logging.logback.rollingpolicy.clean-history-on-start</code> \u662f\u5426\u5728\u5e94\u7528\u542f\u52a8\u65f6\u6e05\u7406\u65e7\u7684\u65e5\u5fd7\u5f52\u6863\u6587\u4ef6 <code>false</code>\uff08\u5efa\u8bae\u8bbe\u4e3a <code>false</code>\uff0c\u907f\u514d\u8bef\u5220\u5386\u53f2\u65e5\u5fd7\uff09 <code>logging.logback.rollingpolicy.file-name-pattern</code> \u5f52\u6863\u65e5\u5fd7\u6587\u4ef6\u7684\u547d\u540d\u683c\u5f0f <code>app-%d{yyyy-MM-dd}.log</code>\uff08\u6309\u5929\u5207\u5272\uff09 <code>logging.logback.rollingpolicy.max-file-size</code> \u5355\u4e2a\u65e5\u5fd7\u6587\u4ef6\u7684\u6700\u5927\u5927\u5c0f\uff0c\u8d85\u8fc7\u5219\u89e6\u53d1\u6eda\u52a8 <code>2MB</code>\uff08\u53ef\u6839\u636e\u9879\u76ee\u65e5\u5fd7\u91cf\u8c03\u6574\uff09 <code>logging.logback.rollingpolicy.max-history</code> \u4fdd\u7559\u5f52\u6863\u65e5\u5fd7\u6587\u4ef6\u7684\u6700\u5927\u5929\u6570\uff08\u6216\u6570\u91cf\uff09 <code>7</code>\uff08\u4fdd\u7559\u6700\u8fd17\u5929\u7684\u65e5\u5fd7\uff09 <pre><code>\u914d\u7f6e\u6f14\u793a:\n</code></pre> <p>```yaml logging:   logback:     rollingpolicy:       # \u662f\u5426\u5728\u5e94\u7528\u542f\u52a8\u65f6\u5220\u9664\u65e7\u7684\u5f52\u6863\u65e5\u5fd7       clean-history-on-start: false        # \u5f52\u6863\u65e5\u5fd7\u6587\u4ef6\u540d\u683c\u5f0f\uff1a\u6309\u65e5\u671f\u5207\u5272       file-name-pattern: app-%d{yyyy-MM-dd}.log        # \u6bcf\u4e2a\u65e5\u5fd7\u6587\u4ef6\u6700\u5927 2MB\uff0c\u8d85\u8fc7\u5219\u521b\u5efa\u65b0\u6587\u4ef6       max-file-size: 2MB        # \u6700\u591a\u4fdd\u7559 7 \u5929\u7684\u5386\u53f2\u65e5\u5fd7\u6587\u4ef6       max-history: 7 ````  </p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#56","title":"5.6 \u5f15\u5165\u65e5\u5fd7\u6846\u67b6\u81ea\u5df1\u7684\u914d\u7f6e\u6587\u4ef6","text":"<p>``` </p> <p> <pre><code>&lt;contextName&gt;logback&lt;/contextName&gt;\n\n&lt;!-- \u65e5\u5fd7\u7684\u8f93\u51fa\u76ee\u5f55 --&gt;  \n&lt;property name=\"log.path\" value=\"D://work//tingshu_work//logs\" /&gt;\n\n&lt;!--\u63a7\u5236\u53f0\u65e5\u5fd7\u683c\u5f0f\uff1a\u5f69\u8272\u65e5\u5fd7--&gt;  \n&lt;!-- magenta:\u6d0b\u7ea2 --&gt;  \n&lt;!-- boldMagenta:\u7c97\u7ea2--&gt;  \n&lt;!-- cyan:\u9752\u8272 --&gt;  \n&lt;!-- white:\u767d\u8272 --&gt;  \n&lt;!-- magenta:\u6d0b\u7ea2 --&gt;  \n&lt;property name=\"CONSOLE_LOG_PATTERN\"  \n          value=\"%yellow(%date{yyyy-MM-dd HH:mm:ss}) %highlight([%-5level]) %green(%logger) %msg%n\"/&gt;\n\n&lt;!--\u6587\u4ef6\u65e5\u5fd7\u683c\u5f0f--&gt;  \n&lt;property name=\"FILE_LOG_PATTERN\"  \n          value=\"%date{yyyy-MM-dd HH:mm:ss} [%-5level] %thread %file:%line %logger %msg%n\" /&gt;\n\n&lt;!--\u7f16\u7801--&gt;  \n&lt;property name=\"ENCODING\" value=\"UTF-8\" /&gt;\n\n&lt;!-- \u63a7\u5236\u53f0\u65e5\u5fd7 --&gt;  \n&lt;appender name=\"CONSOLE\" class=\"ch.qos.logback.core.ConsoleAppender\"&gt;  \n    &lt;!-- \u4e34\u754c\u503c\u8fc7\u6ee4\u5668 --&gt;  \n    &lt;filter class=\"ch.qos.logback.classic.filter.ThresholdFilter\"&gt;  \n        &lt;level&gt;INFO&lt;/level&gt;  \n    &lt;/filter&gt;        &lt;encoder&gt;            &lt;pattern&gt;${CONSOLE_LOG_PATTERN}&lt;/pattern&gt;  \n        &lt;charset&gt;${ENCODING}&lt;/charset&gt;  \n    &lt;/encoder&gt;    &lt;/appender&gt;  \n&lt;!-- \u6587\u4ef6\u65e5\u5fd7 --&gt;  \n&lt;appender name=\"FILE\" class=\"ch.qos.logback.core.FileAppender\"&gt;  \n    &lt;file&gt;${log.path}//log.log&lt;/file&gt;  \n    &lt;append&gt;true&lt;/append&gt;  \n    &lt;encoder&gt;            &lt;pattern&gt;%date{yyyy-MM-dd HH:mm:ss} %msg%n&lt;/pattern&gt;  \n        &lt;charset&gt;${ENCODING}&lt;/charset&gt;  \n    &lt;/encoder&gt;    &lt;/appender&gt;  \n&lt;!-- logstash\u65e5\u5fd7 --&gt;\n</code></pre> <pre><code>&lt;!-- \u5f00\u53d1\u73af\u5883 --&gt;  \n&lt;springProfile name=\"dev\"&gt;  \n    &lt;!-- com.atguigu\u65e5\u5fd7\u8bb0\u5f55\u5668\uff1a\u4e1a\u52a1\u7a0b\u5e8fINFO\u7ea7\u522b  --&gt;  \n    &lt;logger name=\"com.atguigu\" level=\"INFO\" /&gt;  \n    &lt;!-- \u6839\u65e5\u5fd7\u8bb0\u5f55\u5668\uff1aINFO\u7ea7\u522b  --&gt;  \n    &lt;root level=\"INFO\"&gt;  \n        &lt;appender-ref ref=\"CONSOLE\" /&gt;\n</code></pre> <p> <pre><code>##### 5.7 \u603b\u7ed3\n\n    \u5728\u6211\u4eec\u4f7f\u7528\u65e5\u5fd7\u65f6,\u6b65\u9aa4\u53ef\u4ee5\u603b\u7ed3\u4e3a\u4e0b:\n        1. \u5982\u679c\u4e0d\u9700\u8981\u5207\u6362\u5e95\u5c42\u65e5\u5fd7\u6846\u67b6logback,\u5c31\u53ef\u4ee5\u76f4\u63a5\u53bb\u5199\u914d\u7f6e\u6587\u4ef6\u4e86,\u5305\u62ec\u65e5\u5fd7\u7ea7\u522b \n        2. \u8bb0\u5f55\u65e5\u5fd7:(\u5728\u5408\u9002\u7684\u65f6\u95f4,\u5408\u9002\u7684\u7ea7\u522b\u8bb0\u5f55\u65e5\u5fd7\u5c31\u53ef\u4ee5\u4e86)log.xxx\n\n\n## \u4e8c Spring Boot \u7684\u8fdb\u9636\u4f7f\u7528\n\n### 1. Profiles \u73af\u5883\u9694\u79bb\n\n      \u4e3a\u9879\u76ee\u8bbe\u7acb\u591a\u4e2a\u73af\u5883\uff08\u5982\u5f00\u53d1 `dev`\u3001\u6d4b\u8bd5 `test`\u3001\u751f\u4ea7 `prod`\uff09\uff0c\u5b9e\u73b0\u4e0d\u540c\u73af\u5883\u4e0b\u914d\u7f6e\u7684\u5feb\u901f\u5207\u6362\u3002\n\n    \u5b9e\u73b0\u6d41\u7a0b:\n      1. \u5b9a\u4e49\u4e0d\u540c\u73af\u5883\uff1a\n    \u521b\u5efa\u7279\u5b9a\u4e8e\u73af\u5883\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u547d\u540d\u683c\u5f0f\u4e3a application-{profile}.properties \u6216 application-{profile}.yml\u3002\n     \u793a\u4f8b\uff1a\n       application-dev.yml(\u5f00\u53d1\u73af\u5883)\n       application-test.yml(\u6d4b\u8bd5\u73af\u5883)\n       application-prod.yml(\u751f\u4ea7\u73af\u5883)\n\n      2. \u6307\u5b9a\u73af\u5883\u7279\u5b9a\u7684\u914d\u7f6e\uff1a\n     \u5728 application-{profile}.yml \u6587\u4ef6\u4e2d\uff0c\u914d\u7f6e\u8be5\u73af\u5883\u4e0b\u7279\u6709\u7684\u5c5e\u6027\uff08\u5982\u6570\u636e\u5e93\u8fde\u63a5\u3001\u65e5\u5fd7\u7ea7\u522b\u3001\u670d\u52a1\u5730\u5740\u7b49\uff09\u3002\n     \u53ef\u4ee5\u5728\u8fd9\u4e9b\u6587\u4ef6\u4e2d\u5b9a\u4e49\u6216\u8986\u76d6\u5728\u4e3b\u914d\u7f6e\u6587\u4ef6\u4e2d\u58f0\u660e\u7684Bean\u3002\n\n      3. \u6fc0\u6d3b\u6307\u5b9a\u73af\u5883\uff1a\n     \u5728\u4e3b\u914d\u7f6e\u6587\u4ef6 application.yml (\u6216 application.properties) \u4e2d\uff0c\u901a\u8fc7 spring.profiles.active \u5c5e\u6027\u6765\u6fc0\u6d3b\u67d0\u4e2a\u73af\u5883\u3002\n     \u793a\u4f8b (\u5728 application.yml \u4e2d)\uff1a\n```yaml\nspring:\n    profiles:\n        active: dev # \u6fc0\u6d3b\u5f00\u53d1\u73af\u5883\u914d\u7f6e\n</code></pre>      \u4e5f\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4\u884c\u53c2\u6570\u3001\u73af\u5883\u53d8\u91cf\u7b49\u65b9\u5f0f\u6fc0\u6d3b\uff0c\u4f8b\u5982\uff1a        \u547d\u4ee4\u884c\uff1ajava -jar myapp.jar --spring.profiles.active=prod        \u73af\u5883\u53d8\u91cf\uff1aSPRING_PROFILES_ACTIVE=prod</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2_1","title":"2. \u5355\u5143\u6d4b\u8bd5","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#21","title":"2.1 \u4e00\u4e9b\u5e38\u7528\u7684\u65b9\u6cd5","text":"<pre><code>\u2705 \u63d0\u793a\uff1a\u4f18\u5148\u4f7f\u7528 `@DisplayName` \u63d0\u5347\u6d4b\u8bd5\u53ef\u8bfb\u6027\uff1b\u5408\u7406\u4f7f\u7528 `@Tag` \u5b9e\u73b0\u6d4b\u8bd5\u5206\u7ec4\u3002\n</code></pre> \u6ce8\u89e3 \u8bf4\u660e <code>@Test</code> \u6807\u8bb0\u4e3a\u6d4b\u8bd5\u65b9\u6cd5 <code>@ParameterizedTest</code> \u652f\u6301\u53c2\u6570\u5316\u6d4b\u8bd5 <code>@RepeatedTest</code> \u65b9\u6cd5\u53ef\u91cd\u590d\u6267\u884c\u6307\u5b9a\u6b21\u6570 <code>@DisplayName</code> \u8bbe\u7f6e\u6d4b\u8bd5\u7c7b\u6216\u65b9\u6cd5\u7684\u5c55\u793a\u540d\u79f0 <code>@BeforeEach</code> \u6bcf\u4e2a\u6d4b\u8bd5\u524d\u6267\u884c\uff08\u5982\u521d\u59cb\u5316\uff09 <code>@AfterEach</code> \u6bcf\u4e2a\u6d4b\u8bd5\u540e\u6267\u884c\uff08\u5982\u6e05\u7406\u8d44\u6e90\uff09 <code>@BeforeAll</code> \u6240\u6709\u6d4b\u8bd5\u524d\u6267\u884c\u4e00\u6b21\uff08\u9700 static\uff09 <code>@AfterAll</code> \u6240\u6709\u6d4b\u8bd5\u540e\u6267\u884c\u4e00\u6b21\uff08\u9700 static\uff09 <code>@Tag</code> \u4e3a\u6d4b\u8bd5\u6253\u6807\u7b7e\uff0c\u7528\u4e8e\u5206\u7c7b\u7b5b\u9009 <code>@Disabled</code> \u8df3\u8fc7\u8be5\u6d4b\u8bd5\uff08\u7c7b\u4f3c @Ignore\uff09 <code>@Timeout</code> \u8bbe\u7f6e\u8d85\u65f6\u65f6\u95f4\uff0c\u8d85\u8fc7\u5219\u5931\u8d25 <code>@ExtendWith</code> \u5f15\u5165\u6269\u5c55\u7c7b\uff0c\u652f\u6301\u81ea\u5b9a\u4e49\u884c\u4e3a"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#22","title":"2.2 \u65ad\u8a00\u673a\u5236","text":"<pre><code>\u65ad\u8a00\u7528\u4e8e\u9a8c\u8bc1\u6d4b\u8bd5\u7ed3\u679c\u662f\u5426\u7b26\u5408\u9884\u671f\uff0c\u662f\u5355\u5143\u6d4b\u8bd5\u7684\u6838\u5fc3\u3002\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1-orgjunitjupiterapiassertions","title":"1. \u5e38\u7528\u65ad\u8a00\u65b9\u6cd5\uff08<code>org.junit.jupiter.api.Assertions</code>\uff09","text":"\u65b9\u6cd5 \u8bf4\u660e <code>assertEquals(expected, actual)</code> \u68c0\u67e5\u4e24\u503c\u662f\u5426\u76f8\u7b49 <code>assertNotEquals(unexpected, actual)</code> \u68c0\u67e5\u4e24\u503c\u662f\u5426\u4e0d\u76f8\u7b49 <code>assertTrue(condition)</code> \u68c0\u67e5\u6761\u4ef6\u662f\u5426\u4e3a\u771f <code>assertFalse(condition)</code> \u68c0\u67e5\u6761\u4ef6\u662f\u5426\u4e3a\u5047 <code>assertNull(object)</code> \u68c0\u67e5\u5bf9\u8c61\u662f\u5426\u4e3a null <code>assertNotNull(object)</code> \u68c0\u67e5\u5bf9\u8c61\u662f\u5426\u4e0d\u4e3a null <code>assertArrayEquals(expectedArray, actualArray)</code> \u68c0\u67e5\u6570\u7ec4\u662f\u5426\u76f8\u7b49 <code>assertThrows(Exception.class, () -&gt; { ... })</code> \u9a8c\u8bc1\u662f\u5426\u629b\u51fa\u6307\u5b9a\u5f02\u5e38 <code>assertTimeout(Duration.ofSeconds(1), () -&gt; { ... })</code> \u9a8c\u8bc1\u4ee3\u7801\u5757\u662f\u5426\u5728\u89c4\u5b9a\u65f6\u95f4\u5185\u6267\u884c <code>assertAll(\"group\", () -&gt; { ... })</code> \u5206\u7ec4\u65ad\u8a00\uff0c\u53ef\u6267\u884c\u591a\u4e2a\u65ad\u8a00\u5e76\u6536\u96c6\u6240\u6709\u5931\u8d25\u4fe1\u606f"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2_2","title":"2. \u9ad8\u7ea7\u7279\u6027","text":"<ul> <li> <p>\u6d88\u606f\u5ef6\u8fdf\u52a0\u8f7d\uff1a <code>assertEquals(expected, actual, () -&gt; \"\u81ea\u5b9a\u4e49\u9519\u8bef\u4fe1\u606f\")</code>   \u53ea\u6709\u65ad\u8a00\u5931\u8d25\u65f6\u624d\u4f1a\u751f\u6210\u6d88\u606f\uff0c\u63d0\u5347\u6027\u80fd\u3002</p> </li> <li> <p>\u5206\u7ec4\u65ad\u8a00\uff08Grouped Assertions\uff09\uff1a <pre><code>  assertAll(\"\u7528\u6237\u4fe1\u606f\u6821\u9a8c\",\n      () -&gt; assertEquals(\"Tom\", user.getName()),\n      () -&gt; assertEquals(25, user.getAge()),\n      () -&gt; assertNotNull(user.getId())\n</code></pre></p> </li> </ul>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3-actuator","title":"3. Actuator","text":"<pre><code>\u901a\u8fc7\u5bfc\u5165 `spring-boot-starter-actuator` \u573a\u666f\u542f\u52a8\u5668\uff0c\u53ef\u4ee5\u8f7b\u677e\u76d1\u63a7\u548c\u7ba1\u7406 Spring Boot \u5e94\u7528\u7684\u8fd0\u884c\u72b6\u6001\u3002\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#31_1","title":"3.1 \u529f\u80fd","text":"<ul> <li>\u63d0\u4f9b\u751f\u4ea7\u7ea7\u7684\u76d1\u63a7\u7aef\u70b9\uff08endpoints\uff09\uff0c\u7528\u4e8e\u89c2\u6d4b\u5e94\u7528\u5065\u5eb7\u3001\u6307\u6807\u3001\u73af\u5883\u7b49\u4fe1\u606f\u3002</li> <li>\u652f\u6301\u4e0e\u5916\u90e8\u7cfb\u7edf\u96c6\u6210\uff08\u5982 Prometheus\u3001Grafana\u3001Zipkin \u7b49\uff09\u3002</li> </ul>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#32_1","title":"3.2 \u4f7f\u7528\u6b65\u9aa4","text":"<ol> <li>\u6dfb\u52a0\u4f9d\u8d56\uff08Maven\uff09 <pre><code>   &lt;dependency&gt;\n       &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n       &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;\n   &lt;/dependency&gt;\n</code></pre></li> <li>\u8bbf\u95ee\u5185\u7f6e\u7aef\u70b9\uff1ahttp://localhost:8080/actuator/{endpoint}</li> <li> <p>\u542f\u7528\u4e0e\u66b4\u9732\u7aef\u70b9 <pre><code>management:\n  endpoints:\n    web:\n      exposure:\n        include: '*'  # \u66b4\u9732\u6240\u6709\u7aef\u70b9\uff08\u751f\u4ea7\u614e\u7528\uff09\n        # include: health,info  # \u63a8\u8350\uff1a\u4ec5\u66b4\u9732\u5fc5\u8981\u7aef\u70b9\n  endpoint:\n    health:\n      show-details: always  # \u663e\u793a\u5065\u5eb7\u8be6\u60c5\n</code></pre></p> </li> <li> <p>\u81ea\u5b9a\u4e49 <code>info</code> \u7aef\u70b9 <pre><code>info:\n  app:\n    name: MyApp\n    version: 1.0.0\n    author: Alice\n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#4-","title":"4. \u751f\u547d\u5468\u671f -- \u76d1\u542c\u5668\u611f\u77e5\u751f\u547d\u5468\u671f","text":"<p>![[Pasted image 20251102152652.png]]</p> <pre><code>@Slf4j  \npublic class MyListener implements SpringApplicationRunListener {  \n    @Override  \n    public void starting(ConfigurableBootstrapContext bootstrapContext) {  \n        log.info(\"starting\");  \n    }  \n\n    @Override  \n    public void environmentPrepared(ConfigurableBootstrapContext bootstrapContext, ConfigurableEnvironment environment) {  \n        log.info(\"environmentPrepared\");  \n    }  \n\n    @Override  \n    public void contextPrepared(ConfigurableApplicationContext context) {  \n        log.info(\"contextPrepared\");  \n    }  \n\n    @Override  \n    public void contextLoaded(ConfigurableApplicationContext context) {  \n        log.info(\"contextLoaded\");  \n    }  \n\n    @Override  \n    public void started(ConfigurableApplicationContext context, Duration timeTaken) {  \n        log.info(\"started\");  \n    }  \n\n    @Override  \n    public void ready(ConfigurableApplicationContext context, Duration timeTaken) {  \n        log.info(\"ready\");  \n    }  \n\n    @Override  \n    public void failed(ConfigurableApplicationContext context, Throwable exception) {  \n        log.info(\"failed\");  \n    }  \n}\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#41-","title":"4.1 \u751f\u547d\u5468\u671f-\u4e8b\u4ef6","text":"<pre><code>Spring Boot \u63d0\u4f9b\u4e86\u5b8c\u6574\u7684\u751f\u547d\u5468\u671f\u7ba1\u7406\u673a\u5236\uff0c\u901a\u8fc7\u76d1\u542c\u5668\uff08Listener\uff09\u53ef\u4ee5\u611f\u77e5\u5e94\u7528\u542f\u52a8\u548c\u5173\u95ed\u7684\u5173\u952e\u9636\u6bb5\u3002\n\u5982\u679c\u9879\u76ee\u542f\u52a8\u524d\u505a\u4e8b\uff1a BootstrapRegistryInitializer\u548cApplicationContextInitializer\n\u5982\u679c\u60f3\u8981\u5728\u9879\u76ee\u542f\u52a8\u5b8c\u6210\u540e\u505a\u4e8b\uff1aApplicationRunner\u548cCommandLineRunner\n\u5982\u679c\u8981\u5e72\u6d89\u751f\u547d\u5468\u671f\u505a\u4e8b\uff1aSpringApplicationRunListener\n\u5982\u679c\u60f3\u8981\u7528\u4e8b\u4ef6\u673a\u5236\uff1aApplicationListener\n</code></pre> <p>![[Pasted image 20251102160053.png]]</p> <pre><code>\u4ec0\u4e48\u662f\u57fa\u4e8e\u4e8b\u4ef6\u9a71\u52a8\u5f00\u53d1\uff1a\u4e8b\u4ef6\u9a71\u52a8\u5f00\u53d1\uff08Event-Driven Development\uff09 \u662f\u4e00\u79cd\u7f16\u7a0b\u8303\u5f0f\uff0c\u5176\u6838\u5fc3\u601d\u60f3\u662f\uff1a\u7cfb\u7edf\u7684\u884c\u4e3a\u7531\u4e8b\u4ef6\u7684\u4ea7\u751f\u548c\u54cd\u5e94\u6765\u9a71\u52a8\u3002\u5f53\u67d0\u4e2a\u7279\u5b9a\u4e8b\u4ef6\u53d1\u751f\u65f6\uff0c\u7cfb\u7edf\u4f1a\u81ea\u52a8\u89e6\u53d1\u9884\u5148\u6ce8\u518c\u7684\u76d1\u542c\u5668\u6216\u5904\u7406\u5668\u8fdb\u884c\u5904\u7406\u3002\n\n\u4e8b\u4ef6\u9a71\u52a8\u5f00\u53d1\u7684\u6d41\u7a0b\uff1a\n1. \u81ea\u5b9a\u4e49\u4e8b\u4ef6\uff1a\u7ee7\u627f ApplicationEvent\uff0c\u643a\u5e26\u54cd\u5e94\u5f97\u4e1a\u52a1\u6570\u636e\n2. \u6839\u636e\u7279\u5b9a\u4e1a\u52a1\u53d1\u5e03\u4e8b\u4ef6 publisher.publishEvent()\n3. \u7cfb\u7edf\u4e2d\u9884\u5148\u5b9a\u4e49\u7684\u4e8b\u4ef6\u76d1\u542c\u5668(@EventListener)\u5c31\u4f1a\u76d1\u542c\u4e8b\u4ef6\uff0c\u7136\u540e\u5bf9\u8fd9\u4e2a\u4e8b\u4ef6\u505a\u51fa\u54cd\u5e94 \n4. \u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u81ea\u5df1\u8bbe\u5b9a\u662f\u540c\u6b65\u8fd8\u662f\u5f02\u6b65\u5904\u7406\uff08@Async,\u540c\u65f6\u8bb0\u5f97\u5f00\u542f\u5f02\u6b65\u5904\u7406)\n</code></pre> <p>\u5b9e\u73b0\u65b9\u5f0f\uff1a\u6ce8\u89e3\u5f62\u5f0f</p> <pre><code>@Component\npublic class MyEventMonitor {\n    @EventListener\n    public void handleReady(ApplicationReadyEvent event) {\n        System.out.println(\"\u2705 \u5e94\u7528\u542f\u52a8\u5b8c\u6210\uff01\");\n    }\n\n    @EventListener\n    public void handleStart(ApplicationStartedEvent event) {\n        System.out.println(\"\ud83d\ude80 \u5e94\u7528\u5df2\u542f\u52a8\uff0c\u6b63\u5728\u6267\u884c Runner...\");\n    }\n}\n</code></pre> <p>\u5b9e\u73b0\u65b9\u5f0f\uff1a\u63a5\u53e3\u5f62\u5f0f <pre><code>@Component\npublic class MyEventListener implements ApplicationListener&lt;ApplicationReadyEvent&gt; {\n    @Override\n    public void onApplicationEvent(ApplicationReadyEvent event) {\n        System.out.println(\"\u5e94\u7528\u5df2\u5c31\u7eea\uff0c\u5f00\u59cb\u5904\u7406\u8bf7\u6c42...\");\n    }\n}\n</code></pre></p> <p>\u4ee3\u7801\u6f14\u793a\uff1a\u4f20\u7edf\u5f00\u53d1\u65b9\u5f0f--\u540c\u6b65\u963b\u585e\u5f00\u53d1</p> <pre><code>@Slf4j  \n@RestController  \npublic class UserController {  \n    // \u4f20\u7edf\u5f00\u53d1\u65b9\u5f0f  \n    // \u6ce8\u5165\u4e00\u5806service,\u7136\u540e\u53bb\u8c03\u65b9\u6cd5  \n    @Autowired  \n    UserPointsService userPointsService;  \n\n    @Autowired  \n    CouponService couponService;  \n    @GetMapping(\"/login\")  \n    public void afterLogin(String username){  \n        //1. \u767b\u5f55\u6210\u529f  \n        log.info(\"\u767b\u5f55\u6210\u529f\");  \n\n        //2. \u7ed9\u7528\u6237\u53d1\u9001\u4f18\u60e0\u5238  \n        couponService.sendCoupon(username);  \n\n        //3. \u7ed9\u7528\u6237\u53d1\u79ef\u5206  \n        userPointsService.addUserPoints(username);  \n    }  \n}\n</code></pre> <p>\u4ee3\u7801\u6f14\u793a\uff1a\u4e8b\u4ef6\u9a71\u52a8\u5f00\u53d1\u65b9\u5f0f <pre><code>// \u4e8b\u4ef6\u9a71\u52a8\u5f00\u53d1\u65b9\u5f0f\n----------------------------------userController--------------------------------\n@Autowired  \nApplicationEventPublisher applicationEventPublisher;  \n\n@GetMapping(\"/login\")  \npublic void afterLogin(String username){  \n    // 1. \u767b\u5f55\u6210\u529f  \n    log.info(\"\u767b\u5f55\u6210\u529f\");  \n\n    // 2. \u53d1\u9001\u767b\u5f55\u6210\u529f\u4e8b\u4ef6  \n    applicationEventPublisher.publishEvent(new UserLoginSuccessEvent(this, username));  \n}\n\n\n---------------------------------CouponService--------------------------------\n@Slf4j  \n@Service  \n@EnableAsync  \npublic class CouponService {  \n\n    @Async  \n    @EventListener(UserLoginSuccessEvent.class)  \n    public void listener(UserLoginSuccessEvent event){  \n        sendCoupon(event.getUsername());  \n\n    }  \n    public void sendCoupon(String userName){  \n        log.info(\"\u7ed9\u7528\u6237{}\u53d1\u9001\u4f18\u60e0\u5238\",userName);  \n    }  \n}\n\n -----------------------------------UserPointsService------------------------------\n@Slf4j  \n@Service  \n@EnableAsync  \npublic class UserPointsService {  \n\n    @Async  \n    @EventListener(UserLoginSuccessEvent.class)  \n    void listener(UserLoginSuccessEvent event){  \n        addUserPoints(event.getUsername());  \n    }  \n\n    // \u6dfb\u52a0\u79ef\u5206  \n    public void addUserPoints(String username){  \n      log.info(\"\u7528\u6237\uff1a{} \u6dfb\u52a0\u79ef\u5206\", username);  \n    }  \n}\n</code></pre></p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#_1","title":"\u4e09 \u603b\u7ed3\u4ee5\u53ca\u6269\u5c55","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#31_2","title":"3.1 \u603b\u7ed3","text":"<p>![[Pasted image 20251102174854.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#32_2","title":"3.2 \u81ea\u5b9a\u4e49\u573a\u666f\u542f\u52a8\u5668","text":"<pre><code>\u8be5\u529f\u80fd\u7684\u76ee\u7684\u662f\u628a\u6211\u4eec\u5f97\u4e00\u4e9b\u529f\u80fd\u62bd\u53d6\u51fa\u6765\uff0c\u5199\u6210\u4e00\u4e2axxx-spring-boot-starter(\u5b98\u65b9\u89c4\u5b9a\u5f97\u7b2c\u4e09\u65b9\u542f\u52a8\u5668\u540d\u79f0)\n1.\u6240\u6709\u81ea\u5b9a\u4e49\u5f97starter\u90fd\u9700\u8981\u4f9d\u8d56\u516c\u5171\u5f97spring-boot-starter\n2.\u7b2c\u4e00\u5c42\u62bd\u53d6\uff1a\u7f16\u5199\u4e00\u4e2a\u81ea\u52a8\u914d\u7f6e\u7c7b,\u522b\u4eba\u5bfc\u5165\u6211\u7684 starter \u65e0\u9700\u5173\u7cfb\u9700\u8981\u7ed9\u5bb9\u5668\u4e2d\u5bfc\u5165\u90a3\u4e9b\u7ec4\u4ef6\uff0c\u53ea\u9700\u8981\u5bfc\u5165\u81ea\u52a8\u914d\u7f6e\u7c7b\u3002\u8be5\u7c7b\u81ea\u52a8\u7684\u6ce8\u518c\u8be5\u573a\u666f\u6240\u7528\u5230\u7684\u6240\u6709\u7ec4\u4ef6\u3002\n3.\u7b2c\u4e8c\u5c42\u62bd\u53d6\uff1a\u522b\u4eba\u4e0d\u9700\u8981\u7528 @Import \u5bfc\u5165\u914d\u7f6e\u7c7b\uff0c\u53ea\u9700\u8981\u6807\u6ce8\u529f\u80fd\u5f00\u5173\u6ce8\u89e3 @Enablexxx \u5c31\u80fd\u4f7f\u7528\u3002\n4.\u7b2c\u4e09\u5c42\u62bd\u53d6\uff1a\u53ea\u9700\u8981\u5bfc\u5165 starter\uff0c\u7136\u540e\u6240\u6709\u529f\u80fd\u5c31\u4f1a\u5c31\u7eea\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#33","title":"3.3 \u91cd\u70b9\u6e90\u7801","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1-springboot","title":"1. SpringBoot \u81ea\u52a8\u914d\u7f6e","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2-springmvc-dispatcherservlet","title":"2. SpringMvc DispatcherServlet \u6d41\u7a0b","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3-spring-ioc","title":"3. Spring Ioc\uff08\u4e09\u7ea7\u7f13\u5b58\uff09","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#4-spring-transactionmanager-transactioninterceptor","title":"4. Spring \u4e8b\u52a1\u539f\u7406 \uff08TransactionManager + TransactionInterceptor)","text":"<p>\u200b   </p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#git","title":"\u56db Git","text":"<pre><code>\u65e5\u671f\uff1a2025\u5e7411\u67083\u65e5\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1-git","title":"1. Git \u7684\u6982\u5ff5\u548c\u4f5c\u7528","text":"<pre><code>Git \u662f\u4e00\u4e2a\u5206\u5e03\u5f0f\u7248\u672c\u63a7\u5236\u7cfb\u7edf\uff0c\u7528\u4e8e\u8ddf\u8e2a\u6587\u4ef6\u7684\u53d8\u66f4\u5386\u53f2\uff0c\u652f\u6301\u591a\u4eba\u534f\u4f5c\u5f00\u53d1\u3002\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2-git","title":"2. git \u5de5\u4f5c\u6d41\u7a0b","text":"<pre><code>\u5de5\u4f5c\u533a \u2192 \u6682\u5b58\u533a \u2192 \u672c\u5730\u4ed3\u5e93\n\u5de5\u4f5c\u533a\uff1a\u6b63\u5728\u7f16\u8f91\u7684\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u3002\n\u6682\u5b58\u533a\uff1a\u4f7f\u7528 git add \u547d\u4ee4\u5c06\u4fee\u6539\u52a0\u5165\u6682\u5b58\u533a\uff0c\u51c6\u5907\u63d0\u4ea4\u3002\n\u672c\u5730\u4ed3\u5e93\uff1a\u4f7f\u7528 git commit \u5c06\u6682\u5b58\u533a\u5185\u5bb9\u63d0\u4ea4\u5230\u672c\u5730\u7248\u672c\u5e93\u3002\n</code></pre> <p>![[Pasted image 20251103095619.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3-git","title":"3. git \u7684\u5e38\u7528\u547d\u4ee4","text":"<ol> <li> <p>\u914d\u7f6e git \u7684\u8d26\u6237\u4e0e\u90ae\u7bb1 <pre><code>git config -- user.name liutianba\ngit config -- user.email liutianba7@163.com\n</code></pre></p> </li> <li> <p>\u521d\u59cb\u5316\u4ed3\u5e93 <pre><code>git init\n</code></pre></p> </li> <li> <p>\u5c06\u5de5\u4f5c\u533a\u7684\u6587\u4ef6\u52a0\u5165\u5230\u6682\u5b58\u533a <pre><code>git add filename\ngit add . # \u5c06\u5de5\u4f5c\u533a\u4e0d\u518d\u6682\u5b58\u533a\u7684\u6587\u4ef6\u5168\u90e8\u52a0\u5165\u5230\u6682\u5b58\u533a\ngit status # \u67e5\u770b\u6587\u4ef6\u72b6\u6001\uff08\u5728\u4e0d\u5728\u7f13\u5b58\u533a\uff09\n</code></pre></p> </li> <li> <p>\u67e5\u770b\u672c\u5730\u4ed3\u5e93\u4fe1\u606f <pre><code>git log # \u67e5\u770b\u63d0\u4ea4\u8bb0\u5f55\ngit reflog # \u67e5\u770b\u63d0\u4ea4\u8bb0\u5f55\uff08\u7cbe\u7b80\u7248\uff0c\u53ef\u9009\u9879 -n x)\n</code></pre></p> </li> <li> <p>\u7248\u672c\u56de\u6eda <pre><code>git reset -- hard \u7248\u672c\u53f7\n\u7ec6\u8282\uff1agit \u56de\u6eda\u7684\u5934\u6307\u9488\u4e0d\u4f1a\u76f4\u63a5\u79fb\u56de\u53bb\uff0c\u8fd8\u662f\u5f80\u524d\u8d70\uff0c\u65b0\u7ed3\u70b9\u662f\u4e4b\u524d\u56de\u6eda\u7248\u672c\u7684\u4e00\u4e2a\u590d\u5236\n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#4-git","title":"4. git \u5206\u652f","text":"<pre><code>Git \u5206\u652f\u7ba1\u7406\u662f Git \u5f3a\u5927\u529f\u80fd\u4e4b\u4e00\uff0c\u80fd\u591f\u8ba9\u591a\u4e2a\u5f00\u53d1\u4eba\u5458\u5e76\u884c\u5de5\u4f5c\uff0c\u5f00\u53d1\u65b0\u529f\u80fd\u3001\u4fee\u590d bug \u6216\u8fdb\u884c\u5b9e\u9a8c\uff0c\u800c\u4e0d\u4f1a\u5f71\u54cd\u4e3b\u4ee3\u7801\u5e93\u3002\u51e0\u4e4e\u6bcf\u4e00\u79cd\u7248\u672c\u63a7\u5236\u7cfb\u7edf\u90fd\u4ee5\u67d0\u79cd\u5f62\u5f0f\u652f\u6301\u5206\u652f\uff0c\u4e00\u4e2a\u5206\u652f\u4ee3\u8868\u4e00\u6761\u72ec\u7acb\u7684\u5f00\u53d1\u7ebf\u3002\n\u4f7f\u7528\u5206\u652f\u610f\u5473\u7740\u4f60\u53ef\u4ee5\u4ece\u5f00\u53d1\u4e3b\u7ebf\u4e0a\u5206\u79bb\u5f00\u6765\uff0c\u7136\u540e\u5728\u4e0d\u5f71\u54cd\u4e3b\u7ebf\u7684\u540c\u65f6\u7ee7\u7eed\u5de5\u4f5c\u3002\n</code></pre> <p>![[Pasted image 20251103104230.png]]</p> <p>![[Pasted image 20251103104921.png]]</p> <ol> <li> <p>\u521b\u5efa\u5206\u652f <pre><code>git branch \u5206\u652f\u540d\ngit branch -v // \u67e5\u770b\u5206\u652f\n</code></pre></p> </li> <li> <p>\u5207\u6362\u5206\u652f <pre><code>git checkout \u5206\u652f\u540d\ngit checkout -b \u5206\u652f\u540d // \u5207\u6362\u5e76\u521b\u5efa\u5206\u652f\n</code></pre></p> </li> <li> <p>\u5408\u5e76\u5206\u652f</p> <pre><code>\u4e00\u65e6\u67d0\u5206\u652f\u6709\u4e86\u72ec\u7acb\u5185\u5bb9\uff0c\u4f60\u7ec8\u7a76\u4f1a\u5e0c\u671b\u5c06\u5b83\u5408\u5e76\u56de\u5230\u4f60\u7684\u4e3b\u5206\u652f\u3002 \u4f60\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5c06\u4efb\u4f55\u5206\u652f\u5408\u5e76\u5230\u5f53\u524d\u5206\u652f\u4e2d\u53bb\uff1a\n</code></pre> <p><code>git merge \u5206\u652f\u540d //\u628a\u6307\u5b9a\u7684\u5206\u652f\u5408\u5e76\u5230\u5f53\u524d\u5206\u652f</code></p> </li> <li> <p>\u5220\u9664\u5206\u652f <pre><code>git branch -d \u5206\u652f\u540d\n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#5-git","title":"5. git \u51b2\u7a81","text":"<pre><code> \u5f53\u5728\u5408\u5e76\u5206\u652f\u65f6\uff0c\u51fa\u73b0\u540c\u540d\u6587\u4ef6\u540c\u884c\u5185\u5bb9\u4e0d\u540c\u7684\u8bdd\uff0c\u5c31\u4f1a\u51fa\u73b0\u5408\u5e76\u51b2\u7a81\uff0c\u800c\u89e3\u51b3\u65b9\u5f0f\u5c31\u662f\u53bb\u624b\u52a8\u7684\u9009\u62e9\u8981\u54ea\u4e2a\u5206\u652f\u4e0a\u7684\u5185\u5bb9\uff0c\u7136\u540e\u518d\u53bb\u5c06\u5f53\u524d\u5de5\u4f5c\u533a\u63d0\u4ea4\u5230\u672c\u5730\u4ed3\u5e93\u5373\u53ef\u3002\n</code></pre> <pre><code>git merge xxx\ngit add .\ngit commit -m \"\u89e3\u51b3\u5408\u5e76\u51b2\u7a81\"\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#6-git","title":"6. git \u8fdc\u7a0b\u4ed3\u5e93","text":"<pre><code>\u5728\u8fdc\u7a0b\u4ed3\u5e93\u4e2d\uff0c\u63a8\u9001\u548c\u62c9\u53bb\u662f\u4ee5\u5206\u652f\u4e3a\u5355\u4f4d\u7684\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#61-ssh","title":"6.1 Ssh\u914d\u7f6e","text":"<pre><code>\u4f7f\u7528 SSH \u534f\u8bae\u8fde\u63a5 Git \u8fdc\u7a0b\u4ed3\u5e93\uff0c\u53ef\u5b9e\u73b0\u514d\u5bc6\u63a8\u9001/\u62c9\u53d6\u4ee3\u7801\uff0c\u5e76\u63d0\u5347\u5b89\u5168\u6027\u3002\u6d41\u7a0b\uff1a\u6bcf\u6b21\u53bb\u8bbf\u95ee\u8fdc\u7a0b\u4ed3\u5e93\u65f6\uff0cgit \u90fd\u4f1a\u4ece\u6307\u5b9a\u4f4d\u7f6e\u5e26\u7740\u5bc6\u94a5\u8fc7\u53bb\uff0c\u800c\u8fd9\u4e2a\u4f4d\u7f6e\u53ef\u4ee5\u81ea\u5df1\u5236\u5b9a\uff0c\u5728.ssh\u7684\u914d\u7f6e\u6587\u4ef6\u4e0b\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5b8c\u6210\uff1a\u4e0d\u540c\u8fdc\u7a0b\u4ed3\u5e93\u6307\u5b9a\u7684\u5bc6\u94a5\u662f\u4e0d\u540c\u7684\u3002\n</code></pre> <ol> <li> <p>\u751f\u6210 SSH \u5bc6\u94a5\u5bf9 <pre><code>ssh-keygen -t ed25519 -C \"your_email@example.com\n</code></pre></p> </li> <li> <p>\u542f\u52a8 SSH \u4ee3\u7406\u5e76\u6dfb\u52a0\u79c1\u94a5 <pre><code># \u542f\u52a8 ssh-agent\neval \"$(ssh-agent -s)\" \n# \u5c06\u79c1\u94a5\u6dfb\u52a0\u5230 \nssh-agent ssh-add ~/.ssh/id_ed25519\n</code></pre></p> </li> <li> <p>\u7136\u540e\u5c31\u53ef\u4ee5\u628a\u516c\u94a5\u653e\u5230\u8fdc\u7a0b\u4ed3\u5e93\u4e86</p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#62-git","title":"6.2 git \u8fdc\u7a0b\u76f8\u5173\u547d\u4ee4","text":"<ol> <li> <p>\u5173\u8054\u548c\u65ad\u5f00\u8fdc\u7a0b\u4ed3\u5e93 <pre><code>git remote add \u522b\u540d \u8fdc\u7a0b\u4ed3\u5e93\u7684 ssh | https \u5730\u5740\ngit remote -v # \u67e5\u770b\u8fdc\u7a0b\u4ed3\u5e93\u4fe1\u606f\ngit remote remove \u522b\u540d # \u5220\u9664\u8fdc\u7a0b\u4ed3\u5e93\n</code></pre></p> </li> <li> <p>\u63a8\u9001\u6570\u636e\u5230\u8fdc\u7a0b\u4ed3\u5e93 <pre><code>git push \u522b\u540d \u672c\u5730\u5206\u652f\u540d:\u8fdc\u7a0b\u5206\u652f\u540d # \u6ca1\u5199\u8fdc\u7a0b\u5206\u652f\u540d\u5219\u5728\u8fdc\u7a0b\u4ed3\u5e93\u5efa\u7acb\u4e00\u4e2a\u540c\u540d\u7684\u5206\u652f    \n</code></pre></p> </li> <li> <p>\u514b\u9686\u8fdc\u7a0b\u4ed3\u5e93\u5185\u5bb9 <pre><code>git clone \u8fdc\u7a0b\u4ed3\u5e93\u5730\u5740\uff081.\u521b\u5efa\u8fdc\u7a0b\u4ed3\u5e93\u540c\u540d\u7684\u4e00\u4e2a\u6587\u4ef6\u5939 2.\u521d\u59cb\u5316\u4ed3\u5e93 3.\u5173\u8054\u8fdc\u7a0b\u4ed3\u5e93\uff0c\u9ed8\u8ba4\u540d\u5b57\u4e3a origin\uff0c4.\u62c9\u53d6\u73b0\u6709\u8fdc\u7a0b\u4ed3\u5e93\u5185\u5bb9\uff09\n</code></pre></p> </li> <li> <p>\u62c9\u53bb\u8fdc\u7a0b\u4ed3\u5e93\u5185\u5bb9 <pre><code>git pull \u522b\u540d \u8fdc\u7a0b\u4ed3\u5e93\u4e2d\u7684\u5206\u652f\u540d\n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#63","title":"6.3 \u914d\u7f6e\u63a8\u9001\u5ffd\u7565\u6587\u4ef6","text":"<pre><code>java\u65e5\u5e38\u9879\u76ee\u6a21\u677f\uff1a\n</code></pre> <pre><code># Compiled class file\n*.class\n\n# Log file\n*.log\n\n# BlueJ files\n*.ctxt\n\n# Mobile Tools for Java (J2ME)\n.mtj.tmp/\n\n# Package Files #\n*.jar\n*.war\n*.nar\n*.ear\n*.zip\n*.tar.gz\n*.rar\n\n# virtual machine crash logs, see http://www.java.com/en/download/help/error_hotspot.xml\nhs_err_pid*\n\n# IDE and Build Files\n.classpath\n.project\n.settings\ntarget\n.idea\n*.iml\n</code></pre> <pre><code>\u5168\u5c40\u914d\u7f6e\uff1a\u9996\u5148\uff0c\u5728\u4efb\u610f\u4f4d\u7f6e\u5199\u4e00\u4e2axxx.ignore\uff0c\u7136\u540e\uff0c\u5728git\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u5e94\u7528\u8be5\u6587\u4ef6\u5373\u53ef\n</code></pre> <pre><code>[core]\n    excludesfile = **/xxx.ignore\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#linux","title":"\u4e94 Linux","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1-linux","title":"1. Linux \u7684\u6587\u4ef6\u76ee\u5f55","text":"<p>![[Pasted image 20251103174627.png]]</p> <pre><code>a.\u00a0 bin\u53ef\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u6587\u4ef6\u5939\n\nb.\u00a0 sbin \u8d85\u7ea7\u7528\u6237(root)\u53ef\u6267\u884c\u547d\u4ee4\u6587\u4ef6\u5939\n\nc.\u00a0 etc \u7cfb\u7edf\u914d\u7f6e\u6587\u4ef6\u5939\u4f4d\u7f6e,\u7f51\u7edc\u914d\u7f6e,\u7528\u6237\u914d\u7f6e\u7b49\u7b49\n\nd.\u00a0 home \u5b58\u653e\u7528\u6237\u7684\u4e3b\u76ee\u5f55,\u6bcf\u4e2a\u7528\u6237\u90fd\u6709\u4e00\u4e2a\u5bf9\u5e94\u7684\u6587\u4ef6\u5939\n\ne.\u00a0 root \u662f\u8d85\u7ea7\u7528\u6237(root)\u7684\u4e3b\u76ee\u5f55\n\nf.\u00a0 var \u5b58\u653e\u53ef\u53d8\u6587\u4ef6\u5939,\u4f8b\u5982:\u65e5\u5fd7\u6587\u4ef6,\u6570\u636e\u5e93\u6587\u4ef6\u7b49\n\ng.\u00a0 tmp \u5b58\u653e\u4e34\u65f6\u6587\u4ef6\u4f4d\u7f6e,\u53ef\u4ee5\u6e05\u7406\n\nh.\u00a0 dev \u5b58\u653e\u8bbe\u5907\u6587\u4ef6,\u7528\u6237\u7cfb\u7edf\u8bbf\u95ee\u8bbe\u5907\u6587\u4ef6,\u4f8b\u5982: \u952e\u76d8,\u6253\u5370\u673a\u7b49\u7b49\n\ni.\u00a0 boot \u542f\u52a8\u7cfb\u7edf\u6240\u9700\u8981\u7684\u6587\u4ef6\n\nj.\u00a0 opt \u7528\u4e8e\u5b58\u653e\u7b2c\u4e09\u65b9\u5f15\u7528,\u4f8b\u5982mysql\u548ctomcat\u670d\u52a1\u5668\u8f6f\u4ef6\u7b49\u7b49\n\nk.\u00a0 usr \u5b58\u653e\u7cfb\u7edf\u53ef\u5171\u4eab\u7684\u8d44\u6e90,\u6587\u6863,\u8f6f\u4ef6\u7b49\u7b49\n\nl.\u00a0 lib \u7cfb\u7edf\u542f\u52a8\u9700\u8981\u7684\u8fd0\u884c\u5e93\u6587\u4ef6\n\nm.\u00a0 mnt \u7528\u4e8e\u4e34\u65f6\u52a0\u8f7d/\u6302\u8f7d\u5916\u90e8\u8bbe\u5907\u548c\u7cfb\u7edf\u6587\u4ef6 \u4f8b\u5982: \u5149\u76d8,usb\u9a71\u52a8\u7b49\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2-vim","title":"2. Vim \u7f16\u8f91\u6587\u4ef6","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#21-vim","title":"2.1 vim \u7684\u4e09\u91cd\u6a21\u5f0f","text":"<pre><code>\u9996\u5148\uff0c\u7528 vim \u547d\u4ee4\u6253\u5f00\u4e00\u4e2a\u6587\u4ef6\uff0c\u5b83\u7684\u6a21\u5f0f\u9ed8\u8ba4\u662f\u4e00\u822c\u6a21\u5f0f\uff0c\u901a\u8fc7 i / a / o \u53ef\u4ee5\u8fdb\u5165\u5230\u7f16\u8f91\u6a21\u5f0f\uff0c\u5f53\u7f16\u8f91\u5b8c\u6bd5\u540e\uff0c\u6309 esc \u53ef\u4ee5\u8fd4\u56de\u4e00\u822c\u6a21\u5f0f\uff0c\u7136\u540e\uff0c\u518d\u901a\u8fc7 : / / \u4ece\u4e00\u822c\u6a21\u5f0f\u5230\u4e86\u547d\u4ee4\u6a21\u5f0f\uff0c\u6765\u8fdb\u884c\u9000\u51fa\uff08:q)\uff0c\u9000\u51fa\u5e76\u4fdd\u5b58\uff08:wq)\uff0c\u5f3a\u5236\u63a8\u51fa\uff08:q!)\u7b49\u64cd\u4f5c\u3002\n</code></pre> <p>![[Pasted image 20251103180120.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#22-vim","title":"2.2 vim\u76f8\u5173\u547d\u4ee4","text":"<ol> <li> <p>\u67e5\u770b\u5f53\u524d\u76ee\u5f55\u6587\u4ef6 <pre><code>ls\nls -a \n</code></pre></p> </li> <li> <p>\u5149\u6807\u79fb\u52a8 <pre><code>n + G // \u79fb\u52a8\u5230 n \u884c\nG // \u79fb\u52a8\u5230\u6700\u540e\u4e00\u884c\ngg // \u79fb\u52a8\u5230\u9875\u5934\n</code></pre></p> </li> <li> <p>\u5220\u9664\u4e00\u884c\u3001word\u3001\u5b57\u6bcd <pre><code>dd // \u5220\u9664\u4e00\u884c \ndnd //\u5220\u9664n\u884c\ndw // \u5220\u9664\u4e00\u4e2aword\nx / X // \u65b9\u5411\u4e0d\u540c\u7684\u5220\u9664\u5b57\u6bcd\n</code></pre></p> </li> <li> <p>\u590d\u5236\u4e0e\u7c98\u8d34 <pre><code>yy\nyny\nyw\np\n</code></pre></p> </li> <li> <p>\u8fdb\u5165\u7f16\u8f91\u6a21\u5f0f\u7684\u65b9\u5f0f</p> </li> </ol> <p>![[Pasted image 20251103183536.png]]</p> <pre><code>i \u5f53\u524d\u5149\u6807\u524d\na \u5f53\u524d\u5149\u6807\u540e\no \u5f53\u524d\u5149\u6807\u884c\u7684\u4e0b\u4e00\u884c\nI \u5f53\u524d\u884c\u6700\u524d\nA \u5f53\u524d\u884c\u6700\u540e\no \u5f53\u524d\u5149\u6807\u884c\u7684\u4e0a\u4e00\u884c\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#23","title":"2.3 \u547d\u4ee4\u6a21\u5f0f\u4e0b\u7684\u4e00\u4e9b\u6307\u4ee4","text":"<ol> <li> <p>\u8fdb\u5165\u547d\u4ee4\u6a21\u5f0f  <pre><code>:\n/\n</code></pre></p> </li> <li> <p>\u4e00\u4e9b\u9000\u51fa\u64cd\u4f5c <pre><code>q\nwq\nq!\n</code></pre></p> </li> <li> <p>\u67e5\u627e <pre><code>/word\n</code></pre></p> </li> <li> <p>\u663e\u793a\u884c\u53f7 <pre><code>set nu\nset nonu\n</code></pre></p> </li> <li> <p>\u5168\u5c40\u66ff\u6362\uff01 <pre><code>%s/old/new/g\n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3-linux","title":"3. Linux \u6838\u5fc3\u547d\u4ee4","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1","title":"1. \u5f00\u542f\u3001\u5173\u95ed\u670d\u52a1\u5668","text":"<pre><code>roboot -h now\nshutdown -h now\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2_3","title":"2. \u670d\u52a1\u7ba1\u7406\u547d\u4ee4","text":"<pre><code>// \u4e34\u65f6\u8bbe\u7f6e\nsystemctl start xxx\nsystemctl restart xxx\nsystemctl stop  xxx\nsystemclt status xxx\n\n// \u6c38\u4e45\u8bbe\u7f6e\nsystemctl enable xxx\nsystemctl disable xxx\nsystemctl is-enabled xxx\nsystemctl list-unit-files\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3_1","title":"3. \u6587\u4ef6\u76f8\u5173\u547d\u4ee4","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1-pwd-lp","title":"1. pwd -[LP]","text":"<pre><code>pwd\uff1a\u6253\u5370\u5f53\u524d\u6240\u5728\u7684\u5de5\u4f5c\u5b8c\u6574\u8def\u5f84 print working directory\n</code></pre> <pre><code>pwd // \u663e\u793a\u5f53\u524d\u903b\u8f91\u5730\u5740\npwd -L // \u903b\u8f91\u5730\u5740\npwd -P // \u7269\u7406\u5730\u5740\n</code></pre> <pre><code>ls\uff1als\u547d\u4ee4\u6765\u81ea\u82f1\u6587\u5355\u8bcdlist\u7684\u7f29\u5199\uff0c\u4e2d\u6587\u8bd1\u4e3a\u201c\u5217\u51fa\u201d\uff0c\u5176\u529f\u80fd\u662f\u663e\u793a\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u53ca\u5176\u5c5e\u6027\u4fe1\u606f\uff0c\u662f\u6700\u5e38\u4f7f\u7528\u7684Linux\u547d\u4ee4\u4e4b\u200d\u4e00\u3002 \u9ed8\u8ba4\u4e0d\u6dfb\u52a0\u4efb\u4f55\u53c2\u6570\u7684\u60c5\u51b5\u4e0b\uff0cls\u547d\u4ee4\u4f1a\u5217\u51fa\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u4fe1\u606f\uff0c\u5e38\u4e0ecd\u6216pwd\u547d\u4ee4\u642d\u914d\u4f7f\u7528\uff0c\u5341\u5206\u65b9\u4fbf\u3002\u5e26\u4e0a\u53c2\u6570\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u505a\u66f4\u591a\u7684\u4e8b\u60c5\u3002\u4f5c\u4e3a\u6700\u57fa\u7840\u3001\u6700\u9891\u7e41\u4f7f\u7528\u7684\u547d\u4ee4\uff0c\u6709\u5fc5\u8981\u4ed4\u7ec6\u4e86\u89e3\u5176\u5e38\u7528\u529f\u200d\u80fd\u3002\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2-ls-a-l-s-s-t-ll","title":"2. ls[-a -l -s -S -t ...] // ll","text":"<pre><code>ls [-a -l] [\u503c\uff1a\u6587\u4ef6\u5939\u540d]\n\u53c2\u6570\uff1a-a \u663e\u793a\u6240\u6709\u6587\u4ef6\uff0c\u5305\u542b\u9690\u85cf\u6587\u4ef6 -l \u8be6\u7ec6\u7f57\u5217\u4fe1\u606f -t \u6309\u521b\u5efa\u65f6\u95f4\u6392\u5e8f -S \u6309\u6587\u4ef6\u5927\u5c0f\u6392\u5e8f\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3-cd-pl","title":"3. cd -[PL]","text":"<pre><code>cd\u547d\u4ee4\u6765\u81ea\u82f1\u6587\u8bcd\u7ec4change directory\u7684\u7f29\u5199\uff0c\u5176\u529f\u80fd\u662f\u66f4\u6539\u5f53\u524d\u6240\u5904\u7684\u5de5\u4f5c\u76ee\u5f55\uff0c\u8def\u5f84\u53ef\u4ee5\u662f\u7edd\u5bf9\u8def\u5f84\uff0c\u4e5f\u53ef\u4ee5\u662f\u76f8\u5bf9\u8def\u5f84\uff0c\u82e5\u7701\u7565\u4e0d\u5199\u5219\u4f1a\u8df3\u8f6c\u81f3\u5f53\u524d\u4f7f\u7528\u8005\u7684\u5bb6\u76ee\u200d\u5f55\u3002\n</code></pre> <pre><code>cd \u53c2\u6570 \u76ee\u5f55\u540d  \n\u2014L : \u5207\u6362\u5230\u8f6f\u8fde\u63a5\u7684\u4f4d\u7f6e\n-P \uff1a\u5207\u6362\u5230\u771f\u6b63\u6240\u5728\u7684\u4f4d\u7f6e\n~  \uff1a\u5207\u6362\u5230\u5f53\u524d\u7528\u6237\u7684\u5bb6\u76ee\u5f55 \u7b49\u4e8e cd\n- \uff1a\u5207\u6362\u5230\u4e0a\u4e00\u6b21\u6240\u5728\u76ee\u5f55\n.. \uff1a\u5207\u6362\u5230\u4e0a\u4e00\u7ea7\u76ee\u5f55\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#4-mkdir-mpvz","title":"4. mkdir -[mpvz] \u76ee\u5f55\u540d","text":"<pre><code>mkdir\u547d\u4ee4\u6765\u81ea\u82f1\u6587\u8bcd\u7ec4make directories\u7684\u7f29\u5199\uff0c\u5176\u529f\u80fd\u662f\u521b\u5efa\u76ee\u5f55\u6587\u4ef6\u3002\u8be5\u547d\u4ee4\u7684\u4f7f\u7528\u7b80\u5355\uff0c\u4f46\u9700\u8981\u6ce8\u610f\uff0c\u82e5\u8981\u521b\u5efa\u7684\u76ee\u6807\u76ee\u5f55\u5df2\u7ecf\u5b58\u5728\uff0c\u5219\u4f1a\u63d0\u793a\u5df2\u5b58\u5728\u800c\u4e0d\u7ee7\u7eed\u521b\u5efa\uff0c\u4e0d\u8986\u76d6\u5df2\u6709\u6587\u4ef6\u3002\u82e5\u76ee\u5f55\u4e0d\u5b58\u5728\uff0c\u4f46\u5177\u6709\u5d4c\u5957\u7684\u4f9d\u8d56\u5173\u7cfb\u65f6\uff0c\u4f8b\u5982/Dir1/Dir2/Dir3/Dir4/Dir5\uff0c\u8981\u60f3\u4e00\u6b21\u6027\u521b\u5efa\u5219\u9700\u8981\u52a0\u5165-p\u53c2\u6570\uff0c\u8fdb\u884c\u9012\u5f52\u64cd\u200d\u4f5c\u3002\n</code></pre> <p><code>shell -m \u521b\u5efa\u76ee\u5f55\u7684\u540c\u65f6\u8bbe\u7f6e\u6743\u9650 \u00a0  -v \u663e\u793a\u6267\u884c\u8fc7\u7a0b\u8be6\u7ec6\u4fe1\u606f  -p \u9012\u5f52\u521b\u5efa\u591a\u7ea7\u76ee\u5f55  -z \u8bbe\u7f6e\u76ee\u5f55\u5b89\u5168\u4e0a\u4e0b\u6587</code></p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#5-rmdir","title":"5. rmdir","text":"<pre><code>\u4e86\u89e3\uff1a\u53ea\u80fd\u5220\u9664\u7a7a\u6587\u4ef6\u5939\uff0c\u6240\u4ee5\u4e86\u89e3\u5373\u53ef\uff0c\u53c2\u6570\u4e0emkdir\u5dee\u4e0d\u591a\uff0c  -v -p...\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#6-touch","title":"6. touch","text":"<pre><code>touch\u547d\u4ee4\u7684\u529f\u80fd\u662f\u521b\u5efa\u7a7a\u6587\u4ef6\u4e0e\u4fee\u6539\u65f6\u95f4\u6233\u3002\u5982\u679c\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u5219\u4f1a\u521b\u5efa\u4e00\u4e2a\u7a7a\u5185\u5bb9\u7684\u6587\u672c\u6587\u4ef6\uff1b\u5982\u679c\u6587\u4ef6\u5df2\u7ecf\u5b58\u5728\uff0c\u5219\u4f1a\u5bf9\u6587\u4ef6\u7684Atime\uff08\u8bbf\u95ee\u65f6\u95f4\uff09\u548cCtime\uff08\u4fee\u6539\u65f6\u95f4\uff09\u8fdb\u884c\u4fee\u6539\u64cd\u4f5c\uff0c\u7ba1\u7406\u5458\u53ef\u4ee5\u5b8c\u6210\u6b64\u9879\u5de5\u4f5c\uff0c\u800c\u666e\u901a\u7528\u6237\u53ea\u80fd\u7ba1\u7406\u4e3b\u673a\u7684\u6587\u200d\u4ef6\u3002\n</code></pre> <pre><code>touch \u53c2\u6570 \u6587\u4ef6\u540d  \nvim test.txt // vim\u4f1a\u81ea\u52a8\u521b\u5efa\u6587\u4ef6\uff0c\u7f16\u8f91\u5b8c:wq\u5c31\u53ef\u4ee5\u4fdd\u5b58\necho \"xxxxxx\" &gt;&gt; xxx // \u56de\u76f4\u63a5\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\u5e76\u5199\u5165\"xxxxxx\"\n// todo\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#7-cp","title":"7. cp","text":"<pre><code>cp\u547d\u4ee4\u6765\u81ea\u82f1\u6587\u5355\u8bcdcopy\u7684\u7f29\u5199\uff0c\u4e2d\u6587\u8bd1\u4e3a\u201c\u590d\u5236\u201d\uff0c\u5176\u529f\u80fd\u662f\u590d\u5236\u6587\u4ef6\u6216\u76ee\u5f55\u3002cp\u547d\u4ee4\u80fd\u591f\u5c06\u4e00\u4e2a\u6216\u591a\u4e2a\u6587\u4ef6\u6216\u76ee\u5f55\u590d\u5236\u5230\u6307\u5b9a\u4f4d\u7f6e\uff0c\u4ea6\u5e38\u7528\u4e8e\u6587\u4ef6\u7684\u5907\u4efd\u5de5\u4f5c\u3002-r\u53c2\u6570\u7528\u4e8e\u9012\u5f52\u64cd\u4f5c\uff0c\u590d\u5236\u76ee\u5f55\u65f6\u82e5\u5fd8\u8bb0\u6dfb\u52a0\u5219\u4f1a\u76f4\u63a5\u62a5\u9519\uff1b-f\u53c2\u6570\u5219\u7528\u4e8e\u5f53\u76ee\u6807\u6587\u4ef6\u5df2\u5b58\u5728\u65f6\u4f1a\u76f4\u63a5\u8986\u76d6\u800c\u4e0d\u518d\u8be2\u95ee\u3002\u8fd9\u4e24\u4e2a\u53c2\u6570\u5c24\u4e3a\u5e38\u7528\u3002\n</code></pre> <p><pre><code>cp \u53c2\u6570 \u6e90\u6587\u4ef6\u540d \u76ee\u6807\u6587\u4ef6\u540d\n</code></pre> ![[Pasted image 20251104105622.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#8-rm","title":"8. rm","text":"<pre><code>rm\u547d\u4ee4\u6765\u81ea\u82f1\u6587\u5355\u8bcdremove\u7684\u7f29\u5199\uff0c\u4e2d\u6587\u8bd1\u4e3a\u201c\u6d88\u9664\u201d\uff0c\u5176\u529f\u80fd\u662f\u5220\u9664\u6587\u4ef6\u6216\u76ee\u5f55\uff0c\u4e00\u6b21\u53ef\u4ee5\u5220\u9664\u591a\u4e2a\u6587\u4ef6\uff0c\u6216\u9012\u5f52\u5220\u9664\u76ee\u5f55\u53ca\u5176\u5185\u7684\u6240\u6709\u5b50\u6587\u4ef6\u3002 rm\u4e5f\u662f\u4e00\u4e2a\u5f88\u5371\u9669\u7684\u547d\u4ee4\uff0c\u4f7f\u7528\u7684\u65f6\u5019\u8981\u7279\u522b\u5f53\u5fc3\uff0c\u5c24\u5176\u5bf9\u4e8e\u65b0\u624b\u66f4\u8981\u683c\u5916\u6ce8\u610f\u3002\u4f8b\u5982\uff0c\u6267\u884crm -rf /*\u547d\u4ee4\u4f1a\u6e05\u7a7a\u7cfb\u7edf\u4e2d\u6240\u6709\u7684\u6587\u4ef6\uff0c\u751a\u81f3\u65e0\u6cd5\u6062\u590d\u56de\u6765\u3002\u6240\u4ee5\u6211\u4eec\u5728\u6267\u884c\u4e4b\u524d\u4e00\u5b9a\u8981\u518d\u6b21\u786e\u8ba4\u5728\u5728\u54ea\u4e2a\u76ee\u5f55\u4e2d\u3001\u5230\u5e95\u8981\u5220\u9664\u4ec0\u4e48\u6587\u4ef6\uff0c\u8003\u8651\u597d\u540e\u518d\u6572\u51fbEnter\u952e\uff0c\u8981\u65f6\u523b\u4fdd\u6301\u6e05\u9192\u7684\u5934\u200d\u8111\u3002\n</code></pre> <p>![[Pasted image 20251104105727.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#9-mv","title":"9. mv","text":"<pre><code>mv\u547d\u4ee4\u6765\u81ea\u82f1\u6587\u5355\u8bcdmove\u7684\u7f29\u5199\uff0c\u4e2d\u6587\u8bd1\u4e3a\u201c\u79fb\u52a8\u201d\uff0c\u5176\u529f\u80fd\u4e0e\u82f1\u6587\u542b\u4e49\u76f8\u540c\uff0c\u80fd\u591f\u5bf9\u6587\u4ef6\u8fdb\u884c\u526a\u5207\u548c\u91cd\u547d\u540d\u64cd\u4f5c\u3002\u8fd9\u662f\u4e00\u4e2a\u88ab\u9ad8\u9891\u4f7f\u7528\u7684\u6587\u4ef6\u7ba1\u7406\u547d\u4ee4\uff0c\u6211\u4eec\u9700\u8981\u7559\u610f\u5b83\u4e0e\u590d\u5236\u547d\u4ee4\u7684\u533a\u522b\u3002cp\u547d\u4ee4\u662f\u7528\u4e8e\u6587\u4ef6\u7684\u590d\u5236\u64cd\u4f5c\uff0c\u6587\u4ef6\u4e2a\u6570\u662f\u589e\u52a0\u7684\uff0c\u800cmv\u5219\u4e3a\u526a\u5207\u64cd\u4f5c\uff0c\u4e5f\u5c31\u662f\u5bf9\u6587\u4ef6\u8fdb\u884c\u79fb\u52a8\uff08\u642c\u5bb6\uff09\u64cd\u4f5c\uff0c\u6587\u4ef6\u4f4d\u7f6e\u53d1\u751f\u53d8\u5316\uff0c\u4f46\u603b\u4e2a\u6570\u5e76\u65e0\u589e\u200d\u52a0\u3002 \u5728\u540c\u4e00\u4e2a\u76ee\u5f55\u5185\u5bf9\u6587\u4ef6\u8fdb\u884c\u526a\u5207\u7684\u64cd\u4f5c\uff0c\u5b9e\u9645\u4e0a\u5e94\u7406\u89e3\u6210\u91cd\u547d\u540d\u64cd\u4f5c\uff0c\u4f8b\u5982\u4e0b\u9762\u7684\u7b2c\u4e00\u4e2a\u793a\u4f8b\u6240\u200d\u793a\u3002\n</code></pre> <p><pre><code>\u8bed\u6cd5\u683c\u5f0f\uff1amv \u53c2\u6570 \u6e90\u6587\u4ef6\u540d \u76ee\u6807\u6587\u4ef6\u540d  \n</code></pre> ![[Pasted image 20251104110617.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#10","title":"10. \u67e5\u770b\u6587\u4ef6\u5185\u5bb9","text":"<ol> <li>cat<pre><code>cat\u547d\u4ee4\u6765\u81ea\u82f1\u6587\u8bcd\u7ec4concatenate files and print\u7684\u7f29\u5199\uff0c\u5176\u529f\u80fd\u662f\u5728\u7ec8\u7aef\u8bbe\u5907\u4e0a\u663e\u793a\u6587\u4ef6\u5185\u5bb9\u3002\u5728Linux\u7cfb\u7edf\u4e2d\u6709\u5f88\u591a\u7528\u4e8e\u67e5\u770b\u6587\u4ef6\u5185\u5bb9\u7684\u547d\u4ee4\uff0c\u4f8b\u5982more\u3001tail\u3001head\u7b49\uff0c\u6bcf\u4e2a\u547d\u4ee4\u90fd\u6709\u5404\u81ea\u7684\u7279\u70b9\u3002cat\u547d\u4ee4\u9002\u5408\u67e5\u770b\u5185\u5bb9\u8f83\u5c11\u7684\u7eaf\u6587\u672c\u6587\u4ef6\u3002 \u5bf9\u4e8e\u5185\u5bb9\u8f83\u591a\u7684\u6587\u4ef6\uff0c\u4f7f\u7528cat\u547d\u4ee4\u67e5\u770b\u540e\u4f1a\u5728\u5c4f\u5e55\u4e0a\u5feb\u901f\u6eda\u5c4f\uff0c\u7528\u6237\u5f80\u5f80\u770b\u4e0d\u6e05\u6240\u663e\u793a\u7684\u5177\u4f53\u5185\u5bb9\uff0c\u53ea\u597d\u6309Ctrl+C\u7ec4\u5408\u952e\u4e2d\u65ad\u547d\u4ee4\u6267\u884c\uff0c\u6240\u4ee5\u5bf9\u4e8e\u5927\u6587\u4ef6\uff0c\u5e72\u8106\u7528more\u547d\u4ee4\u200d\u663e\u793a\u5427\u3002\n</code></pre> </li> </ol> <pre><code>cat \u53c2\u6570 \u6587\u4ef6\u540d \u67e5\u770b\u4e00\u5c4f\u5e55\u663e\u793a\u7684\u975e\u52a8\u6001\u6587\u672c\uff08\u5c0f\u6587\u672c\uff09\n-n \u663e\u793a\u884c\u53f7\n</code></pre> <ol> <li>more<pre><code>more\u547d\u4ee4\u7684\u529f\u80fd\u662f\u5206\u9875\u663e\u793a\u6587\u672c\u6587\u4ef6\u7684\u5185\u5bb9\u3002\u5982\u679c\u6587\u672c\u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\u8f83\u591a\u8f83\u957f\uff0c\u4f7f\u7528cat\u547d\u4ee4\u8bfb\u53d6\u540e\u5219\u5f88\u96be\u770b\u6e05\uff0c\u8fd9\u65f6\u4f7f\u7528more\u547d\u4ee4\u8fdb\u884c\u5206\u9875\u67e5\u770b\u5c31\u6bd4\u8f83\u5408\u9002\u4e86\uff0c\u8be5\u547d\u4ee4\u53ef\u4ee5\u628a\u6587\u672c\u5185\u5bb9\u4e00\u9875\u4e00\u9875\u5730\u663e\u793a\u5728\u7ec8\u7aef\u754c\u9762\u4e0a\uff0c\u7528\u6237\u6bcf\u6309\u4e00\u6b21Enter\u952e\u5373\u5411\u4e0b\u4e00\u884c\uff0c\u6bcf\u6309\u4e00\u6b21\u7a7a\u683c\u952e\u5373\u5411\u4e0b\u4e00\u9875\uff0c\u76f4\u81f3\u770b\u5b8c\u4e3a\u6b62\u3002\n</code></pre> </li> </ol> <p><pre><code>more \u53c2\u6570 \u6587\u4ef6\u540d\n\u4e00\u4e9b\u547d\u4ee4:\n= \u8f93\u51fa\u5f53\u524d\u884c\u6570\n:f \u8f93\u51fa\u6587\u4ef6\u540d\u4ee5\u53ca\u884c\u6570\n</code></pre> ![[Pasted image 20251104142054.png]]</p> <ol> <li>less<pre><code>less\u547d\u4ee4\u7684\u529f\u80fd\u662f\u5206\u9875\u663e\u793a\u6587\u4ef6\u5185\u5bb9\u3002Less\u547d\u4ee4\u5206\u9875\u663e\u793a\u7684\u529f\u80fd\u4e0emore\u547d\u4ee4\u5f88\u76f8\u50cf\uff0c\u4f46more\u547d\u4ee4\u53ea\u80fd\u4ece\u524d\u5411\u540e\u6d4f\u89c8\u6587\u4ef6\u5185\u5bb9\uff0c\u800cless\u547d\u4ee4\u4e0d\u4ec5\u80fd\u4ece\u524d\u5411\u540e\u6d4f\u89c8\uff08\u6309PageDown\u952e\uff09\uff0c\u8fd8\u53ef\u4ee5\u4ece\u540e\u5411\u524d\u6d4f\u89c8\uff08\u6309PageUp\u952e\uff09\uff0c\u66f4\u52a0\u7075\u200d\u6d3b\u3002\n</code></pre> </li> </ol> <p><pre><code>less \u53c2\u6570 \u6587\u4ef6\n\u7a7a\u683c\u7ffb\u9875 \u4e0a \u4e0b \u8fdb\u884c\u7ffb\u9875 q\u9000\u51fa /\u67e5\u627e\u5173\u952e\u5b57\n</code></pre> ![[Pasted image 20251104143220.png]]</p> <ol> <li>head         head\u547d\u4ee4\u7684\u529f\u80fd\u662f\u663e\u793a\u6587\u4ef6\u5f00\u5934\u7684\u5185\u5bb9\uff0c\u9ed8\u8ba4\u4e3a\u524d10\u884c\u3002  </li> </ol> <pre><code>head \u53c2\u6570 \u6587\u4ef6\u540d  \n-c \u8bbe\u7f6e\u663e\u793a\u5934\u90e8\u5185\u5bb9\u7684\u5b57\u7b26\u6570 \u00a0 \n-v \u663e\u793a\u6587\u4ef6\u540d\u7684\u5934\u4fe1\u606f \n-n \u8bbe\u7f6e\u663e\u793a\u884c\u6570 \n--help \u663e\u793a\u5e2e\u52a9\u4fe1\u606f \n-q \u4e0d\u663e\u793a\u6587\u4ef6\u540d\u7684\u5934\u4fe1\u606f \u00a0 \n</code></pre> <ol> <li>tail<pre><code>tail\u547d\u4ee4\u7684\u529f\u80fd\u662f\u67e5\u770b\u6587\u4ef6\u5c3e\u90e8\u5185\u5bb9\uff0c\u4f8b\u5982\u9ed8\u8ba4\u4f1a\u5728\u7ec8\u7aef\u754c\u9762\u4e0a\u663e\u793a\u6307\u5b9a\u6587\u4ef6\u7684\u672b\u5c3e10\u884c\uff0c\u5982\u679c\u6307\u5b9a\u4e86\u591a\u4e2a\u6587\u4ef6\uff0c\u5219\u4f1a\u5728\u663e\u793a\u7684\u6bcf\u4e2a\u6587\u4ef6\u5185\u5bb9\u524d\u9762\u52a0\u4e0a\u6587\u4ef6\u540d\u6765\u52a0\u4ee5\u533a\u5206\u3002\u9ad8\u9636\u73a9\u6cd5\u7684-f\u53c2\u6570\u7684\u4f5c\u7528\u662f\u6301\u7eed\u663e\u793a\u6587\u4ef6\u7684\u5c3e\u90e8\u6700\u65b0\u5185\u5bb9\uff0c\u7c7b\u4f3c\u4e8e\u673a\u573a\u5019\u673a\u5385\u7684\u5927\u5c4f\u5e55\uff0c\u603b\u4f1a\u628a\u6700\u65b0\u7684\u6d88\u606f\u663e\u793a\u51fa\u6765\n\u6ce8:\u53ea\u6709 echo \u8ffd\u52a0\u7684\u53c2\u4f1a\u88ab\u8bc6\u522b\n</code></pre> </li> </ol> <pre><code>tail \u53c2\u6570 \u6587\u4ef6\u540d\n-c \u8bbe\u7f6e\u663e\u793a\u6587\u4ef6\u5c3e\u90e8\u7684\u5b57\u7b26\u6570 \u00a0 \n--pid \u5f53\u6307\u5b9aPID\u8fdb\u7a0b\u7ed3\u675f\u65f6\uff0c\u81ea\u52a8\u9000\u51fa\u547d\u4ee4 \n-f \u6301\u7eed\u663e\u793a\u6587\u4ef6\u5c3e\u90e8\u6700\u65b0\u5185\u5bb9 \n--retry \u5f53\u6587\u4ef6\u65e0\u6743\u9650\u8bbf\u95ee\u65f6\uff0c\u4f9d\u7136\u5c1d\u8bd5\u6253\u5f00 \n-n \u8bbe\u7f6e\u663e\u793a\u6587\u4ef6\u5c3e\u90e8\u7684\u884c\u6570 \n</code></pre> <ol> <li>echo<pre><code>echo\u547d\u4ee4\u7684\u529f\u80fd\u662f\u5728\u7ec8\u7aef\u8bbe\u5907\u4e0a\u8f93\u51fa\u6307\u5b9a\u5b57\u7b26\u4e32\u6216\u53d8\u91cf\u63d0\u53d6\u540e\u7684\u503c\uff0c\u80fd\u591f\u7ed9\u7528\u6237\u4e00\u4e9b\u7b80\u5355\u7684\u63d0\u9192\u4fe1\u606f\uff0c\u4ea6\u53ef\u4ee5\u5c06\u8f93\u51fa\u7684\u6307\u5b9a\u5b57\u7b26\u4e32\u5185\u5bb9\u540c\u7ba1\u9053\u7b26\u4e00\u8d77\u4f20\u9012\u7ed9\u540e\u7eed\u547d\u4ee4\u4f5c\u4e3a\u6807\u51c6\u8f93\u5165\u4fe1\u606f\u8fdb\u884c\u4e8c\u6b21\u5904\u7406\uff0c\u8fd8\u53ef\u4ee5\u540c\u8f93\u51fa\u91cd\u5b9a\u5411\u7b26\u4e00\u8d77\u64cd\u4f5c\uff0c\u5c06\u4fe1\u606f\u76f4\u63a5\u5199\u5165\u6587\u4ef6\u3002\u5982\u9700\u63d0\u53d6\u53d8\u91cf\u503c\uff0c\u9700\u5728\u53d8\u91cf\u540d\u79f0\u524d\u52a0\u5165$\u7b26\u53f7\uff0c\u53d8\u91cf\u540d\u79f0\u4e00\u822c\u5747\u4e3a\u5927\u5199\u5f62\u200d\u5f0f\u3002\n</code></pre> </li> </ol> <pre><code>echo \u53c2\u6570 \u5b57\u7b26\u4e32\u6216$\u53d8\u91cf\u540d  \n\n\u914d\u5408\u91cd\u5b9a\u5411\u7b26\n&gt; \u8986\u5199\n&gt;&gt; \u8ffd\u52a0\n</code></pre> <ol> <li>ln<pre><code>ln\u547d\u4ee4\u6765\u81ea\u82f1\u6587\u5355\u8bcdlink\u7684\u7f29\u5199\uff0c\u4e2d\u6587\u8bd1\u4e3a\u201c\u94fe\u63a5\u201d\uff0c\u5176\u529f\u80fd\u662f\u4e3a\u67d0\u4e2a\u6587\u4ef6\u5728\u53e6\u5916\u4e00\u4e2a\u4f4d\u7f6e\u5efa\u7acb\u540c\u6b65\u7684\u94fe\u63a5\u3002Linux\u7cfb\u7edf\u4e2d\u7684\u94fe\u63a5\u6587\u4ef6\u6709\u4e24\u79cd\u5f62\u5f0f\uff0c\u4e00\u79cd\u662f\u786c\u94fe\u63a5\uff0c\u53e6\u4e00\u79cd\u662f\u8f6f\u94fe\u63a5\u3002\u8f6f\u94fe\u63a5\u76f8\u5f53\u4e8eWindows\u7cfb\u7edf\u4e2d\u7684\u5feb\u6377\u65b9\u5f0f\u6587\u4ef6\uff0c\u539f\u59cb\u6587\u4ef6\u88ab\u79fb\u52a8\u6216\u5220\u9664\u540e\uff0c\u8f6f\u94fe\u63a5\u6587\u4ef6\u4e5f\u5c06\u65e0\u6cd5\u4f7f\u7528\uff1b\u786c\u94fe\u63a5\u5219\u662f\u5c06\u6587\u4ef6\u7684inode\u5c5e\u6027\u5757\u8fdb\u884c\u4e86\u590d\u5236\uff0c\u56e0\u6b64\u628a\u539f\u59cb\u6587\u4ef6\u79fb\u52a8\u6216\u5220\u9664\u540e\uff0c\u786c\u94fe\u63a5\u6587\u4ef6\u4f9d\u7136\u53ef\u4ee5\u4f7f\u7528\u3002\n</code></pre> </li> </ol> <pre><code>\u521b\u5efa\u8f6f\u8fde\u63a5\uff08\u5feb\u6377\u65b9\u5f0f\uff09\nln -s \u539f\u6587\u4ef6\u6216\u8005\u6587\u4ef6\u5939 \u8f6f\u8fde\u63a5\u540d\n\u5bf9\u8f6f\u8fde\u63a5\u7684\u6240\u6709\u64cd\u4f5c\uff0c\u76f8\u5f53\u4e8e\u6e90\u6587\u4ef6\u7684\u52a8\u4f5c\uff0c\u8f6f\u8fde\u63a5\u540d\u8981\u548c\u6e90\u6587\u4ef6\u4e00\u81f4\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#4_1","title":"4. \u7528\u6237\u4ee5\u53ca\u6743\u9650\u547d\u4ee4","text":"<ol> <li> <p>\u6dfb\u52a0\u4e00\u4e2a\u7528\u6237 <pre><code>useradd \u7528\u6237\u540d\n-g \u6307\u5b9a\u7ec4(\u6539\u7ec4\u5fc5\u987b\u5b58\u5728)\n\nuserdel username\n-f \u5f3a\u5236\u5220\u9664\n-r \u8fde\u76f8\u5173\u6570\u636e\u4e5f\u5220\u9664\n</code></pre></p> </li> <li> <p>\u4e3a\u7528\u6237\u8bbe\u7f6e\u5bc6\u7801 <pre><code>passwd \u7528\u6237\u540d\n</code></pre></p> </li> <li> <p>\u4fee\u6539\u7528\u6237\u4e00\u4e9b\u5c5e\u6027 <pre><code>usermod \u53c2\u6570 \u7528\u6237\u540d\n-g \u4fee\u6539\u7528\u6237\u6240\u5728\u7ec4\n// \u4fee\u6539\u7528\u6237\u6240\u5c5e\u7ec4\nusermod -g \u7ec4\u540d \u7528\u6237\u540d\n</code></pre></p> </li> <li> <p>\u67e5\u770b\u7528\u6237\u662f\u5426\u5b58\u5728\u4ee5\u53ca\u76f8\u5173\u4fe1\u606f <pre><code>id username\ncat /etc/passwd\ncat /etc/group\ncat /etc/sudoers\n</code></pre></p> </li> <li> <p>\u7ec4\u76f8\u5173\u547d\u4ee4 <pre><code>// \u6dfb\u52a0\u4e00\u4e2a\u7ec4\ngroupadd \u7ec4\u540d\n// \u5220\u9664\u7ec4\ngroupdel \u7ec4\u540d\n//\u67e5\u770b\u7ec4\ncat /etc/group\n</code></pre></p> </li> <li> <p>\u8d4b\u4e88\u6743\u9650 <pre><code>1. \u53bb /etc/sudoers \u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6e\u6743\u9650 \u8d26\u53f7 ALL=(ALL) NOPASSWD:ALL\n2. \u4e4b\u540e\u5bf9\u5e94\u7528\u6237\u4f7f\u7528\u547d\u4ee4\u65f6\u524d\u9762 + sudo\n</code></pre></p> </li> <li> <p>\u7528\u6237\u7684\u5207\u6362 <pre><code>su username\nexit\nlogout \n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#5_1","title":"5. \u6587\u4ef6\u6743\u9650\u547d\u4ee4","text":"<pre><code>\u6587\u4ef6\u6743\u9650\u901a\u8fc710\u4f4d\u6765\u8868\u793a,\u7b2c\u4e00\u4f4d\u662f\u7c7b\u578b(-, l, d),\u540e9\u4f4d\u5206\u4e3a\u4e09\u7ec4,\u5206\u522b\u4ee3\u8868 \u6240\u6709\u8005, \u6240\u5728\u7ec4, \u5176\u4ed6\u4eba\u7684\u6743\u9650, \u5982\u56fe\u6240\u793a. \u540e\u9762\u5206\u522b\u662f\u6587\u4ef6\u6240\u6709\u8005\u548c\u6240\u5728\u7ec4.\n</code></pre> <p>![[Pasted image 20251104170916.png]]</p> <ol> <li>\u6743\u9650\u4fee\u6539\u547d\u4ee4<pre><code>chmod\u547d\u4ee4\u6765\u81ea\u82f1\u6587\u8bcd\u7ec4change mode\u7684\u7f29\u5199\uff0c\u5176\u529f\u80fd\u662f\u6539\u53d8\u6587\u4ef6\u6216\u76ee\u5f55\u6743\u9650\u7684\u547d\u4ee4\u3002\u9ed8\u8ba4\u53ea\u6709\u6587\u4ef6\u7684\u6240\u6709\u8005\u548c\u7ba1\u7406\u5458\u53ef\u4ee5\u8bbe\u7f6e\u6587\u4ef6\u6743\u9650\uff0c\u666e\u901a\u7528\u6237\u53ea\u80fd\u7ba1\u7406\u81ea\u5df1\u6587\u4ef6\u7684\u6743\u9650\u5c5e\u6027\u3002 \u8bbe\u7f6e\u6743\u9650\u65f6\u53ef\u4ee5\u4f7f\u7528\u6570\u5b57\u6cd5\uff0c\u4ea6\u53ef\u4f7f\u7528\u5b57\u6bcd\u8868\u8fbe\u5f0f\uff0c\u5bf9\u4e8e\u76ee\u5f55\u6587\u4ef6\uff0c\u5efa\u8bae\u52a0\u5165-R\u53c2\u6570\u8fdb\u884c\u9012\u5f52\u64cd\u4f5c\uff0c\u8fd9\u610f\u5473\u7740\u4e0d\u4ec5\u5bf9\u4e8e\u76ee\u5f55\u672c\u8eab\uff0c\u800c\u4e14\u4e5f\u5bf9\u76ee\u5f55\u5185\u7684\u5b50\u6587\u4ef6/\u76ee\u5f55\u8fdb\u884c\u65b0\u6743\u9650\u7684\u8bbe\u5b9a\u3002\n</code></pre> </li> </ol> <pre><code>chmod \u53c2\u6570\u503c [u+r, g+w, o+x] \u6587\u4ef6/\u76ee\u5f55\u540d\n\u8eab\u4efd\u8868\u793a: u g o a\n\u6570\u5b57\u6cd5 r 4 w 2 x 1\n-R \u9012\u5f52\u5904\u7406\n-v \u663e\u793a\u6267\u884c\u8fc7\u7a0b\n-f \u4fee\u6539\u5931\u8d25\u540e\u4e0d\u63d0\u793a\u4fe1\u606f\n</code></pre> <ol> <li>\u4fee\u6539\u6240\u6709\u8005/\u7ec4<pre><code>chown\u547d\u4ee4\u6765\u81ea\u82f1\u6587\u8bcd\u7ec4change owner\u7684\u7f29\u5199\uff0c\u5176\u529f\u80fd\u662f\u6539\u53d8\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u7528\u6237\u548c\u7528\u6237\u7ec4\u4fe1\u606f\u3002\u7ba1\u7406\u5458\u53ef\u4ee5\u6539\u53d8\u4e00\u5207\u6587\u4ef6\u7684\u6240\u5c5e\u4fe1\u606f\uff0c\u800c\u666e\u901a\u7528\u6237\u53ea\u80fd\u6539\u53d8\u81ea\u5df1\u6587\u4ef6\u7684\u6240\u5c5e\u4fe1\u606f.\n</code></pre> <p><code>chown \u53c2\u6570 \u6240\u5c5e\u4e3b:\u6240\u5c5e\u7ec4 \u6587\u4ef6\u540d</code></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#6","title":"6. \u67e5\u8be2\u6587\u4ef6","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#61-find","title":"6.1 find","text":"<pre><code>find\u547d\u4ee4\u7684\u529f\u80fd\u662f\u6839\u636e\u7ed9\u5b9a\u7684\u8def\u5f84\u548c\u6761\u4ef6\u67e5\u627e\u76f8\u5173\u6587\u4ef6\u6216\u76ee\u5f55\uff0c\u5176\u53c2\u6570\u7075\u6d3b\u65b9\u4fbf\uff0c\u4e14\u652f\u6301\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u7ed3\u5408\u7ba1\u9053\u7b26\u540e\u80fd\u591f\u5b9e\u73b0\u66f4\u52a0\u590d\u6742\u7684\u529f\u80fd\uff0c\u662fLinux\u7cfb\u7edf\u8fd0\u7ef4\u4eba\u5458\u5fc5\u987b\u638c\u63e1\u7684\u547d\u4ee4\u4e4b\u4e00\u3002 \nfind\u547d\u4ee4\u901a\u5e38\u8fdb\u884c\u7684\u662f\u4ece\u6839\u76ee\u5f55\uff08/\uff09\u5f00\u59cb\u7684\u5168\u76d8\u641c\u7d22\uff0c\u6709\u522b\u4e8ewhereis\u3001which\u3001locate\u7b49\u6709\u6761\u4ef6\u6216\u90e8\u5206\u6587\u4ef6\u7684\u641c\u7d22\u3002\u5bf9\u4e8e\u670d\u52a1\u5668\u8d1f\u8f7d\u8f83\u9ad8\u7684\u60c5\u51b5\uff0c\u5efa\u8bae\u4e0d\u8981\u5728\u9ad8\u5cf0\u65f6\u671f\u4f7f\u7528find\u547d\u4ee4\u7684\u6a21\u7cca\u641c\u7d22\uff0c\u8fd9\u4f1a\u76f8\u5bf9\u6d88\u8017\u8f83\u591a\u7684\u7cfb\u7edf\u8d44\u6e90\u3002\n</code></pre> <pre><code>find \u8def\u5f84 \u6761\u4ef6 \u6587\u4ef6\u540d  \n-name \u5339\u914d\u6587\u4ef6\u540d \u00a0 \n-nouser \u5339\u914d\u65e0\u6240\u5c5e\u4e3b\u7684\u6587\u4ef6 \n-perm \u5339\u914d\u6587\u4ef6\u6743\u9650 \n-nogroup \u5339\u914d\u65e0\u6240\u5c5e\u7ec4\u7684\u6587\u4ef6 \n-user \u5339\u914d\u6587\u4ef6\u6240\u5c5e\u4e3b \n-newer \u5339\u914d\u6bd4\u6307\u5b9a\u6587\u4ef6\u66f4\u65b0\u7684\u6587\u4ef6 \n-group \u5339\u914d\u6587\u4ef6\u6240\u5c5e\u7ec4 \n-type \u5339\u914d\u6587\u4ef6\u7c7b\u578b \n-mtime \u5339\u914d\u6700\u540e\u4fee\u6539\u6587\u4ef6\u5185\u5bb9\u65f6\u95f4 \n-size \u5339\u914d\u6587\u4ef6\u5927\u5c0f \n-atime \u5339\u914d\u6700\u540e\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\u65f6\u95f4 \n-prune \u4e0d\u641c\u7d22\u6307\u5b9a\u76ee\u5f55 \n-ctime \u5339\u914d\u6700\u540e\u4fee\u6539\u6587\u4ef6\u5c5e\u6027\u65f6\u95f4 \n-exec\u2026\u2026 {}\\; \u8fdb\u4e00\u6b65\u5904\u7406\u641c\u7d22\u7ed3\u679c  \n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#62-grep","title":"6.2 grep","text":"<pre><code>grep\u547d\u4ee4\u6765\u81ea\u82f1\u6587\u8bcd\u7ec4global search regular expression and print out the line\u7684\u7f29\u5199\uff0c\u610f\u601d\u662f\u7528\u4e8e\u5168\u9762\u641c\u7d22\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u5e76\u5c06\u7ed3\u679c\u8f93\u51fa\u3002\u4eba\u4eec\u901a\u5e38\u4f1a\u5c06grep\u547d\u4ee4\u4e0e\u6b63\u5219\u8868\u8fbe\u5f0f\u642d\u914d\u4f7f\u7528\uff0c\u53c2\u6570\u4f5c\u4e3a\u641c\u7d22\u8fc7\u7a0b\u4e2d\u7684\u8865\u5145\u6216\u5bf9\u8f93\u51fa\u7ed3\u679c\u7684\u7b5b\u9009\uff0c\u547d\u4ee4\u6a21\u5f0f\u5341\u5206\u7075\u200d\u6d3b\u3002\n</code></pre> <p><pre><code>grep \u53c2\u6570(\u53ef\u4ee5\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32) \u6587\u4ef6\u540d\n</code></pre> ![[Pasted image 20251104171842.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#7","title":"7. \u6587\u4ef6\u89e3\u538b\u7f29","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#71-gzip","title":"7.1 gzip","text":"<pre><code>\u53ea\u80fd\u538b\u7f29\u6587\u4ef6\uff0c\u538b\u7f29\u6587\u4ef6\u7684\u540e\u7f00\u540d \u539f\u540d.gz   \u538b\u7f29\u4ee5\u540e\u539f\u6587\u4ef6\u6d88\u5931\uff0c\u89e3\u538b\u4ee5\u540egz\u538b\u7f29\u5305\u4e5f\u6d88\u5931\n</code></pre> <pre><code>\u538b\u7f29\u6587\u4ef6\uff1a gzip \u6587\u4ef6\u540d\n\u89e3\u538b\u6587\u4ef6\uff1a gunzip \u6587\u4ef6\u540d.gz\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#72-zip","title":"7.2 zip","text":"<pre><code>\u538b\u7f29\u6587\u4ef6: zip \u538b\u7f29\u6587\u4ef6\u540d.zip \u6587\u4ef6\u540d\n\u538b\u7f29\u6587\u4ef6\u5939: zip -r \u538b\u7f29\u6587\u4ef6\u5939\u540d.zip \u6587\u4ef6\u5939\n\u89e3\u538b\u6587\u4ef6/\u6587\u4ef6\u8d3e unzip \u538b\u7f29\u6587\u4ef6\u540d.zip -d /\u89e3\u538b\u7684\u4f4d\u7f6e\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#73-tar","title":"7.3 tar","text":"<pre><code>tar\u547d\u4ee4\u7684\u529f\u80fd\u662f\u538b\u7f29\u548c\u89e3\u538b\u7f29\u6587\u4ef6\uff0c\u80fd\u591f\u5236\u4f5c\u51faLinux\u7cfb\u7edf\u4e2d\u5e38\u89c1\u7684tar\u3001tar.gz\u3001tar.bz2\u7b49\u683c\u5f0f\u7684\u538b\u7f29\u5305\u6587\u4ef6\u3002\u5bf9\u4e8eRHEL 7\u3001CentOS 7\u7248\u672c\u53ca\u4ee5\u540e\u7684\u7cfb\u7edf\uff0c\u89e3\u538b\u7f29\u65f6\u4e0d\u6dfb\u52a0\u683c\u5f0f\u53c2\u6570\uff08\u5982z\u6216j\uff09\uff0c\u7cfb\u7edf\u4e5f\u80fd\u81ea\u52a8\u8fdb\u884c\u5206\u6790\u5e76\u89e3\u538b\u3002\u628a\u8981\u4f20\u8f93\u7684\u6587\u4ef6\u5148\u538b\u7f29\u518d\u4f20\u8f93\uff0c\u80fd\u591f\u5f88\u597d\u5730\u63d0\u9ad8\u5de5\u4f5c\u6548\u7387\uff0c\u65b9\u4fbf\u5206\u4eab\u3002\n</code></pre> <pre><code>\u5f52\u7eb3\u6587\u4ef6\ntar -cvf xxx.tar \u8981\u5f52\u7eb3\u7684\u6587\u4ef6\u6216\u8005\u6587\u4ef6\u5939\n-f \u6307\u5b9a\u64cd\u4f5c\u7684\u6587\u4ef6\n-z \u89e3\u538b\u7f29\n-c \u5f52\u7eb3\n-x \u89e3\u7eb3\n\u6253\u5305\uff1a tar -cvf xxx.tar \u6587\u4ef6\u6216\u8005\u6587\u4ef6\u5939\n\u6253\u5305+\u538b\u7f29\uff1atar -czvf xxx.tar.gz \u6587\u4ef6\u6216\u8005\u6587\u4ef6\u5939\n\u89e3\u5305\uff1a tar -xvf xxx.tar -C /\u89e3\u5230\u6307\u5b9a\u7684\u6587\u4ef6\u5939\n\u89e3\u538b+\u89e3\u5305\uff1atar -zxvf xxx.tar.gz -C /\u89e3\u5230\u6307\u5b9a\u7684\u6587\u4ef6\u5939\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#4-linux-docker","title":"4. Linux \u4e0b\u4e00\u4e9b\u5e94\u7528\u7684\u5b89\u88c5\uff08\u975e docker)","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1-jdk-tomcat","title":"1. \u5b89\u88c5 JDK \u4e0e Tomcat","text":"<pre><code>\u6ce8\uff1a\u6240\u6709\u7aef\u53e3\u90fd\u6ce8\u610f\u4e00\u4e0b\u4e70\u6ca1\u5f00\u653e\uff08\u4e91\u670d\u52a1\u5668\uff09\uff0c\u7136\u540e\u9632\u706b\u5899\u8981\u8bb0\u5f97\u5173\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#11-jdk","title":"1.1 JDK","text":"<p>``` java 1\u3001\u5148\u53bb\u5b98\u7f51\u4e0b\u4e00\u4e2a jdk \u7684tar.gz \u7248\u672c  2\u3001\u4e0a\u4f20\u5230\u670d\u52a1\u5668\uff0c\u7136\u540e tar -zxvf \u5c31\u53ef\u4ee5\u89e3\u538b + \u89e3\u7eb3\uff08opt\uff09  3\u3001\u914d\u73af\u5883\u53d8\u91cf\uff1avim /etc/profile.d/my_env.sh\uff08\u5728profile.d\u4e0b\u9762\u65b0\u5efa\u4f60\u7684\u73af\u5883\u53d8\u91cf\u6587\u4ef6.sh\uff09</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#java_home","title":"JAVA_HOME","text":"<p>JAVA_HOME=/opt/jdk-17.0.12 PATH=$PATH:$JAVA_HOME/bin export PATH JAVA_HOME  4\u3001source /etc/profile.d/my_env.sh  java -version ```</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#12-tomcat","title":"1.2 Tomcat","text":"<p><code>\u76f4\u63a5\u53bb\u5b98\u7f51\u627e\u5230\u5bf9\u5e94\u7248\u672c\uff1atomcat 10.x \u7136\u540e\u4e0b\u8f7d\u89e3\u538b\u5373\u53ef</code></p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2-mysql","title":"2. \u5b89\u88c5mysql","text":"<pre><code>1. \u5148\u53bb\u5b98\u7f51\u4e0a\u4e0b\u8f7d\u548c\u4f60\u7684 linux \u5339\u914d\u7684\u7248\u672c\uff0c\u6700\u597d\u662fxxx.tar\uff0cRPM Bundle \u662f\u4e00\u4e2a\u6253\u5305\u597d\u7684\u00a0.tar.gz\u00a0\u6587\u4ef6\uff0c\u5305\u542b\u4e86\u6240\u6709\u5fc5\u8981\u7684 RPM \u5305\uff08\u670d\u52a1\u5668\u3001\u5ba2\u6237\u7aef\u3001\u5e93\u7b49\uff09\u3002\n\u901a\u8fc7\u547d\u4ee4\uff1acat /etc/redhat-release \u67e5\u770b\u7248\u672c\n2. \u7136\u540e\uff0c\u628a .tar \u89e3\u7eb3\u4e86\uff0c\u5c31\u5230\u7684\u82e5\u5e72\u4e2a.rpm\n3. \u4e4b\u540e\uff0c\u6309\u987a\u5e8f\u901a\u8fc7 rpm -ivh xxx.rpm \u6765\u5b89\u88c5\uff0c\u987a\u5e8f\u4e3a\uff1a\n   1\uff09mysql-community-common-8.0.30-1.el7.x86_64.rpm\n   2\uff09mysql-community-client-plugins-8.0.30-1.el7.x86_64.rpm\n   3\uff09mysql-community-libs-8.0.30-1.el7.x86_64.rpm\n   4\uff09mysql-community-icu-data-files-8.0.30-1.el7.x86_64.rpm\n   5\uff09mysql-community-icu-data-files-8.0.30-1.el7.x86_64.rpm\n   6\uff09mysql-community-server-8.0.30-1.el7.x86_64.rpm\n\n4. \u5b89\u88c5\u5b8c\u6bd5\u540e\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7 mysqladmin --version \u68c0\u67e5\u662f\u5426\u5b89\u88c5\u6210\u529f\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#21-mysql","title":"2.1 \u4e0e mysql \u670d\u52a1\u76f8\u5173\u7684\u547d\u4ee4","text":"<ol> <li> <p>\u542f\u52a8\u670d\u52a1 <pre><code>#\u521d\u59cb\u5316\u670d\u52a1\nmysqld --initialize --user=root\n\n# \u542f\u52a8\u670d\u52a1\nsystemclt start mysqld\n\n# \u9047\u5230\u7684\u9519\u8bef\uff08\u6743\u9650\u4e0d\u8db3\uff0c\u521b\u5efa\u4e0d\u4e86\u6587\u4ef6\uff09\n\u89e3\u51b3\uff1a\nchown -R mysql:mysql /var/lib/mysql\nchmod -R 777 /var/lib/mysql\n</code></pre></p> </li> <li> <p>\u627e\u521d\u59cb\u5316\u5bc6\u7801\u4ee5\u53ca\u91cd\u7f6e\u5bc6\u7801 <pre><code>cat /var/log/mysqld.log\ngrep \"temporary password\" \\var\\log\\mysqld.log\nALTER USER 'root'@'localhost' IDENTIFIED BY 'liuqiang';\n\n\n# \u627e\u56de\u5bc6\u7801\n</code></pre></p> </li> <li> <p>\u53bb\u914d\u7f6e\u90a3\u4e9b\u4e3b\u673a\u53ef\u4ee5\u8fde\u63a5\u5f53\u524dmysql <pre><code># \u4fee\u6539\u8868\nupdate user set host='%' where user='root';\n# \u4fee\u6539\u5b8cmysql\u5e95\u5c42\u8868\uff0c\u8bb0\u5f97\u66f4\u65b0 \nFLUSH PRIVILEGES;\n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3-nginx","title":"3. \u5b89\u88c5 nginx","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1_1","title":"1 \u5b89\u88c5\u8fc7\u7a0b","text":"<ol> <li> <p>\u914d\u7f6eNginx yum\u5b58\u50a8\u5e93 <pre><code>\u521b\u5efa/etc/yum.repos.d/nginx.repo\u6587\u4ef6\nsudo vim /etc/yum.repos.d/nginx.repo\n\n\u589e\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a\n\n[nginx-stable]\nname=nginx stable repo\nbaseurl=http://nginx.org/packages/centos/$releasever/$basearch/\ngpgcheck=1\nenabled=1\ngpgkey=https://nginx.org/keys/nginx_signing.key\nmodule_hotfixes=true\n\n[nginx-mainline]\nname=nginx mainline repo\nbaseurl=http://nginx.org/packages/mainline/centos/$releasever/$basearch/\ngpgcheck=1\nenabled=0\ngpgkey=https://nginx.org/keys/nginx_signing.key\nmodule_hotfixes=true\n</code></pre></p> </li> <li> <p>\u5728\u7ebf\u5b89\u88c5Nginx <pre><code>sudo yum install nginx\n</code></pre></p> </li> <li> <p>\u542f\u52a8Nginx <pre><code>\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u542f\u52a8Nginx\nsudo systemctl start nginx\n\n\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u67e5\u770bNginx\u8fd0\u884c\u72b6\u6001\nsudo systemctl status nginx\n\n\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f\nsudo systemctl enable nginx\n</code></pre></p> </li> <li> <p>\u8bbf\u95eeNginx\u670d\u52a1\u9ed8\u8ba4\u9996\u9875     \u8bbf\u95ee<code>http://192.168.10.101</code>\uff0c\u80fd\u8bbf\u95ee\u5230\u5982\u4e0b\u9875\u9762\uff0c\u5219\u8bc1\u660eNginx\u8fd0\u884c\u6b63\u5e38\u3002</p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2_4","title":"2 \u6838\u5fc3\u76ee\u5f55\u4ee5\u53ca\u6587\u4ef6","text":"<ol> <li> <p>\u914d\u7f6e\u6587\u4ef6\u76f8\u5173</p> <ul> <li><code>/etc/nginx/</code>\uff1a\u4e3b\u8981\u7684Nginx\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55\u3002</li> <li><code>/etc/nginx/nginx.conf</code>\uff1aNginx\u7684\u4e3b\u914d\u7f6e\u6587\u4ef6\uff0c\u5305\u542b\u5168\u5c40\u914d\u7f6e\u4fe1\u606f\u3002</li> <li><code>/etc/nginx/conf.d/</code>\uff1a\u8fd9\u4e2a\u76ee\u5f55\u901a\u5e38\u5305\u542b\u4e00\u4e9b\u9644\u52a0\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e3b\u914d\u7f6e\u6587\u4ef6<code>/etc/nginx/nginx.conf</code>\u4f1a\u5f15\u5165\u8be5\u76ee\u5f55\u7684\u6240\u6709\u6587\u4ef6\u3002</li> </ul> </li> <li> <p>\u65e5\u5fd7\u76f8\u5173</p> <ul> <li><code>/var/log/nginx/</code>\uff1aNginx\u7684\u65e5\u5fd7\u6587\u4ef6\u76ee\u5f55\uff0c\u5305\u62ec\u8bbf\u95ee\u65e5\u5fd7\u548c\u9519\u8bef\u65e5\u5fd7\u3002</li> <li><code>/var/log/nginx/access.log</code>\uff1a\u8bbf\u95ee\u65e5\u5fd7\uff0c\u8bb0\u5f55\u6240\u6709\u8fdb\u5165\u670d\u52a1\u5668\u7684\u8bf7\u6c42\u3002</li> <li><code>/var/log/nginx/error.log</code>\uff1a\u9519\u8bef\u65e5\u5fd7\uff0c\u8bb0\u5f55\u670d\u52a1\u5668\u5904\u7406\u8fc7\u7a0b\u4e2d\u7684\u9519\u8bef\u4fe1\u606f\u3002</li> </ul> </li> <li> <p>\u9759\u6001\u8d44\u6e90</p> <ul> <li>/usr/share/nginx/html -&gt;\u9759\u6001\u8d44\u6e90</li> </ul> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3_2","title":"3 \u865a\u62df\u4e3b\u673a\u7684\u914d\u7f6e","text":"<p>\u7531\u4e8eNginx\u4e2d\u53ef\u5b58\u5728\u591a\u4e2a\u865a\u62df\u4e3b\u673a\u7684\u914d\u7f6e\uff0c\u6545\u63a5\u6536\u5230\u4e00\u4e2a\u8bf7\u6c42\u540e\uff0cNginx\u9996\u5148\u8981\u786e\u5b9a\u8bf7\u6c42\u4ea4\u7ed9\u54ea\u4e2a\u865a\u62df\u4e3b\u673a\u8fdb\u884c\u5904\u7406\u3002\u8fd9\u5f88\u663e\u7136\u662f\u6839\u636e<code>server_name</code>\u548c<code>listen</code>\u8fdb\u884c\u5224\u65ad\u7684\u3002\u4f8b\u5982\u4e0a\u8ff0\u7684\u8bf7\u6c42\u8def\u5f84http://115.190.231.171/hello-nginx\uff0c\u5c31\u4f1a\u5339\u914d\u5230\u4ee5\u4e0b\u7684\u865a\u62df\u4e3b\u673a</p> <pre><code>server{\n    listen 8080;\n    server_name 115.190.231.171;\n    location /hello-nginx{\n        root /usr/share/nginx/html/;\n        index index.html;\n    }\n}\n\n#\u5176\u4ed6\u547d\u4ee4\nnginx -t \nnginx -s reload\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#4_2","title":"4 \u53cd\u5411\u4ee3\u7406","text":"<pre><code>server{\n    listen 8080;\n    server_name 115.190.231.171;\n    location / {\n         proxy_pass http://www.atguigu.com;\n    }\n\n}\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#5_2","title":"5 \u5b89\u5168\u6a21\u5f0f","text":"<pre><code>sudo setenforce 0 \u662f\u4e00\u4e2a\u7528\u4e8e\u7ba1\u7406 SELinux\uff08Security-Enhanced Linux\uff09\u7b56\u7565\u7684\u547d\u4ee4\u3002\n\n\u89e3\u91ca\uff1a\nsudo: \u8fd9\u4e2a\u547d\u4ee4\u7528\u4e8e\u4ee5\u8d85\u7ea7\u7528\u6237\u6743\u9650\uff08root \u6743\u9650\uff09\u6267\u884c\u540e\u7eed\u7684\u547d\u4ee4\u3002\u5b83\u8981\u6c42\u7528\u6237\u8f93\u5165\u5bc6\u7801\uff0c\u4ee5\u786e\u8ba4\u6709\u6743\u9650\u6267\u884c\u9ad8\u6743\u9650\u7684\u64cd\u4f5c\u3002\n\nsetenforce: \u8fd9\u662f\u4e00\u4e2a\u7528\u4e8e\u52a8\u6001\u8bbe\u7f6e SELinux \u6a21\u5f0f\u7684\u547d\u4ee4\u3002SELinux \u6709\u4e09\u79cd\u5de5\u4f5c\u6a21\u5f0f\uff1aEnforcing\uff08\u5f3a\u5236\uff09\u3001Permissive\uff08\u5bbd\u5bb9\uff09\u3001Disabled\uff08\u7981\u7528\uff09\u3002setenforce \u547d\u4ee4\u5141\u8bb8\u4f60\u5207\u6362 Enforcing \u548c Permissive \u6a21\u5f0f\u3002\n\nEnforcing \u6a21\u5f0f\uff1aSELinux \u4f1a\u5f3a\u5236\u6267\u884c\u6240\u6709\u7684\u5b89\u5168\u7b56\u7565\uff0c\u5bf9\u4e0d\u7b26\u5408\u7b56\u7565\u7684\u64cd\u4f5c\u8fdb\u884c\u963b\u6b62\uff0c\u5e76\u8bb0\u5f55\u4e8b\u4ef6\u3002\nPermissive \u6a21\u5f0f\uff1aSELinux \u4f1a\u5141\u8bb8\u6240\u6709\u64cd\u4f5c\uff0c\u4f46\u4f1a\u8bb0\u5f55\u8fdd\u53cd\u5b89\u5168\u7b56\u7565\u7684\u4e8b\u4ef6\uff0c\u4e0d\u4f1a\u963b\u6b62\u4efb\u4f55\u64cd\u4f5c\u3002\n0: \u8fd9\u4e2a\u6570\u5b57\u8868\u793a\u5c06 SELinux \u5207\u6362\u5230 Permissive \u6a21\u5f0f\u3002\u5728\u8fd9\u4e2a\u6a21\u5f0f\u4e0b\uff0cSELinux \u4e0d\u4f1a\u963b\u6b62\u4efb\u4f55\u64cd\u4f5c\uff0c\u53ea\u4f1a\u8bb0\u5f55\u6f5c\u5728\u7684\u8fdd\u89c4\u884c\u4e3a\u3002\n\n\u7efc\u4e0a\uff1a\nsudo setenforce 0 \u547d\u4ee4\u7684\u4f5c\u7528\u662f\u5c06 SELinux \u7684\u6a21\u5f0f\u8bbe\u7f6e\u4e3a Permissive\u3002\u8fd9\u610f\u5473\u7740 SELinux \u4f1a\u505c\u6b62\u5f3a\u5236\u6267\u884c\u5b89\u5168\u7b56\u7565\uff0c\u53ea\u4f1a\u8bb0\u5f55\u4efb\u4f55\u8fdd\u53cd\u7b56\u7565\u7684\u64cd\u4f5c\uff0c\u800c\u4e0d\u4f1a\u771f\u6b63\u963b\u6b62\u5b83\u4eec\u3002\u901a\u5e38\uff0c\u7ba1\u7406\u5458\u4f1a\u5728\u6392\u67e5 SELinux \u76f8\u5173\u95ee\u9898\u65f6\u4f7f\u7528\u8fd9\u4e2a\u547d\u4ee4\uff0c\u4ee5\u4fbf\u4e0d\u88ab\u7b56\u7565\u9650\u5236\u5f71\u54cd\u7cfb\u7edf\u7684\u6b63\u5e38\u64cd\u4f5c\u3002\n\n\u6ce8\u610f\uff1a\n\u8fd9\u4e2a\u547d\u4ee4\u4ec5\u4f1a\u5728\u5f53\u524d\u4f1a\u8bdd\u4e2d\u751f\u6548\u3002\u5982\u679c\u9700\u8981\u6c38\u4e45\u7981\u7528 SELinux \u6216\u66f4\u6539\u914d\u7f6e\uff0c\u9700\u8981\u4fee\u6539 SELinux \u914d\u7f6e\u6587\u4ef6\uff08\u901a\u5e38\u662f /etc/selinux/config\uff09\u3002\n\u5728\u67d0\u4e9b\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u5c06 SELinux \u8bbe\u7f6e\u4e3a Permissive \u53ef\u80fd\u4f1a\u5e26\u6765\u5b89\u5168\u9690\u60a3\uff0c\u56e0\u4e3a\u5b83\u4e0d\u518d\u5f3a\u5236\u6267\u884c\u5b89\u5168\u7b56\u7565\u3002\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#4-minio","title":"4. \u5b89\u88c5 minio","text":"<p>minio\u5b98\u65b9\u6587\u6863</p> <ol> <li>\u8fd8\u662f\u53bb\u5b98\u7f51\u4e0b\u8f7d minio \u7684 rpm \u5305</li> </ol> <pre><code>wget https://dl.min.io/server/minio/release/linux-amd64/archive/minio-20241029160148.0.0-1.x86_64.rpm -O minio.rpm\n</code></pre> <ol> <li> <p>\u7136\u540e\u76f4\u63a5\u5b89\u88c5 <pre><code>dnf|yum install minio.rpm\n\nrpm -ivh xxx.rpm\n</code></pre></p> </li> <li> <p>\u4e4b\u540e\u5c31\u53ef\u4ee5\u542f\u52a8 minio \u670d\u52a1\u5668\u4e86 <pre><code>mkdir ~/minio\nminio server ~/minio --console-address :9001\n\n// \u540e\u53f0\u542f\u52a8\nnohup minio server ./minioPath/data &gt; ./minioPath/minio.log 2&gt;&amp;1 &amp;\nRootUser: minioadmin\nRootPass: minioadmin\n</code></pre></p> </li> <li> <p>\u914d\u7f6e minio \u7684\u6570\u636e\u5b58\u653e\u4f4d\u7f6e\u4ee5\u53ca\u540e\u53f0\u542f\u52a8 <pre><code>// 1. \u7f16\u5199MinIO\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\nvim /etc/systemd/system/minio.service\n\n// 2. \u5185\u5bb9\u5982\u4e0b\uff0c\u5177\u4f53\u53ef\u53c2\u8003MinIO[\u5b98\u65b9\u6587\u6863](https://min.io/docs/minio/linux/operations/install-deploy-manage/deploy-minio-single-node-single-drive.html#create-the-systemd-service-file)\u3002\n\n\n[Unit]\nDescription=MinIO\nDocumentation=https://min.io/docs/minio/linux/index.html\nWants=network-online.target\nAfter=network-online.target\nAssertFileIsExecutable=/usr/local/bin/minio\n\n[Service]\nWorkingDirectory=/usr/local\nProtectProc=invisible\nEnvironmentFile=-/etc/default/minio\nExecStartPre=/bin/bash -c \"if [ -z \\\"${MINIO_VOLUMES}\\\" ]; then echo \\\"Variable MINIO_VOLUMES not set in /etc/default/minio\\\"; exit 1; fi\"\nExecStart=/usr/local/bin/minio server $MINIO_OPTS $MINIO_VOLUMES\nRestart=always\nLimitNOFILE=65536\nTasksMax=infinity\nTimeoutStopSec=infinity\nSendSIGKILL=no\n\n[Install]\nWantedBy=multi-user.target\n\n// 3. \u7f16\u5199 EnvironmentFile \u6587\u4ef6\nvim /etc/default/minio\n\nMINIO_ROOT_USER=minioadmin\nMINIO_ROOT_PASSWORD=minioadmin\nMINIO_VOLUMES=/root/minio/data\nMINIO_OPTS=\"--console-address :9001\"\n\n\nmkdir /data\nchmod -R 777 /root/minio/data\n</code></pre></p> </li> <li> <p><code>EnvironmentFile</code>\uff0c\u8be5\u6587\u4ef6\u4e2d\u53ef\u914d\u7f6eMinIO\u670d\u52a1\u6240\u9700\u7684\u5404\u9879\u53c2\u6570</p> </li> <li> <p><code>ExecStart</code>\uff0c\u8be5\u53c2\u6570\u7528\u4e8e\u914d\u7f6eMinIO\u670d\u52a1\u7684\u542f\u52a8\u547d\u4ee4\uff0c\u5176\u4e2d<code>$MINIO_OPTS</code>\u3001<code>$MINIO_VOLUMES</code>\uff0c\u5747\u5f15\u7528\u4e8e<code>EnvironmentFile</code>\u4e2d\u7684\u53d8\u91cf\u3002</p> <ul> <li><code>MINIO_OPTS</code>\u7528\u4e8e\u914d\u7f6eMinIO\u670d\u52a1\u7684\u542f\u52a8\u9009\u9879\uff0c\u53ef\u7701\u7565\u4e0d\u914d\u7f6e\u3002</li> <li><code>MINIO_VOLUMES</code>\u7528\u4e8e\u914d\u7f6eMinIO\u670d\u52a1\u7684\u6570\u636e\u5b58\u50a8\u8def\u5f84\u3002</li> </ul> </li> <li> <p><code>Restart</code>\uff0c\u8868\u793a\u81ea\u52a8\u91cd\u542f</p> </li> <li> <p>\u81ea\u5b9a\u4e49\u6876\u89c4\u5219 <pre><code>{\n  \"Statement\" : [ {\n    \"Action\" : \"s3:GetObject\",\n    \"Effect\" : \"Allow\",\n    \"Principal\" : \"*\",\n    \"Resource\" : \"arn:aws:s3:::test/*\"\n  } ],\n  \"Version\" : \"2012-10-17\"\n}\n</code></pre></p> </li> <li> <p>minio\u901a\u7528\u6a21\u677f <pre><code>@Test  \nvoid testMinioClient() throws Exception {  \n    // \u68c0\u67e5\u5e76\u521b\u5efa\u6876  \n    boolean exists = minioClient.bucketExists(  \n            BucketExistsArgs.builder().bucket(BUCKET_NAME).build()  \n    );  \n\n    if (!exists) {  \n        minioClient.makeBucket(  \n                MakeBucketArgs.builder().bucket(BUCKET_NAME).build()  \n        );  \n\n        String policy = \"\"\"  \n            {              \"Statement\": [{                \"Action\": \"s3:GetObject\",                \"Effect\": \"Allow\",                \"Principal\": \"*\",                \"Resource\": \"arn:aws:s3:::%s/*\"              }],              \"Version\": \"2012-10-17\"            }            \"\"\".formatted(BUCKET_NAME);  \n\n        minioClient.setBucketPolicy(  \n                SetBucketPolicyArgs.builder()  \n                        .bucket(BUCKET_NAME)  \n                        .config(policy)  \n                        .build()  \n        );  \n    }  \n\n    // \u4e0a\u4f20\u6587\u4ef6\uff08\u4ece\u6d4b\u8bd5\u8d44\u6e90\u76ee\u5f55\uff09  \n    URL resource = getClass().getClassLoader().getResource(\"test-file.txt\");  \n    if (resource == null) {  \n        throw new IllegalStateException(\"Test file 'test-file.txt' not found in resources!\");  \n    }  \n    Path filePath = Paths.get(resource.toURI());  \n    long fileSize = Files.size(filePath);  \n\n    try (InputStream inputStream = Files.newInputStream(filePath)) {  \n        minioClient.putObject(  \n                PutObjectArgs.builder()  \n                        .bucket(BUCKET_NAME)  \n                        .object(\"remote-file.txt\")  \n                        // \u8f93\u5165\u6d41\u3001\u6587\u4ef6\u5927\u5c0f\u3001\u5206\u7247\u5927\u5c0f\uff0c\u9ed8\u8ba4\u5206\u7247\u5927\u5c0f\uff085MB) \n                        .stream(inputStream, fileSize, -1)  \n                        .contentType(\"text/plain\")  \n                        .build()  \n        );  \n    }  \n}\n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#x1","title":"x1. \u8f6f\u4ef6\u5305\u7ba1\u7406","text":"<pre><code>1. \u67e5\u8be2\nrpm -qa | grep \u5173\u952e\u5b57 \u67e5\u770b\u5b89\u88c5\u4e86\u67d0\u4e2a\u8f6f\u4ef6 [\u67e5\u8be2\u5b89\u88c5\u4e86\u54ea\u4e9b\u8f6f\u4ef6 grep \u7b5b\u9009]\nrpm -ql \u8f6f\u4ef6\u540d \u67e5\u770b\u8f6f\u4ef6\u5b89\u88c5\u7684\u6587\u4ef6\u5939 [\u8f6f\u4ef6\u5b89\u88c5\u7684\u4f4d\u7f6e]\n\n2. \u5378\u8f7d\nrpm -e \u8f6f\u4ef6\u540d \u5378\u8f7d\u8f6f\u4ef6,\u5982\u679c\u8981\u5378\u8f7d\u7684\u8f6f\u4ef6\u5176\u4ed6\u8f6f\u4ef6\u4f9d\u8d56,\u5378\u8f7d\u5931\u8d25 [\u5982\u679c\u6709\u522b\u7684\u8f6f\u4ef6\u4f9d\u8d56\u6211,\u6211\u5c31\u5378\u8f7d\u5931\u8d25]\nrpm -e --nodeps \u8f6f\u4ef6\u540d \u5f3a\u5236\u5378\u8f7d [\u4e0d\u5173\u522b\u7684\u8f6f\u4ef6\u662f\u5426\u4f9d\u8d56\u6211,\u6211\u90fd\u5f3a\u5236\u5378\u8f7d]\n\n3. \u5b89\u88c5\uff08yum\uff09\nrpm -ivh --nodeps \u8f6f\u4ef6\u5305.rpm [--nodeps \u5f3a\u5236\u5b89\u88c5,\u5c31\u7b97\u73af\u5883\u4e0d\u8db3\u5b89\u88c5\u6210\u529f,\u8fd0\u884c\u4e0d\u8d77\u6765! ]\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#x2","title":"x2. \u5207\u6362\u7b2c\u4e09\u65b9\u6e90","text":"<pre><code>centos7\u505c\u6b62\u5b98\u65b9\u7ef4\u62a4,\u5207\u6362\u6570\u636e\u6e90\u4e3a\u963f\u91cc\u6e90\u65b9\u53ef\u4f7f\u7528\nwget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo\nyum -y install \u8f6f\u4ef6\u540d\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#5_3","title":"5. \u5176\u4ed6\u547d\u4ee4\u603b\u7ed3","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1_2","title":"1. \u67e5\u770b\u7aef\u53e3\u53f7\u662f\u5426\u88ab\u5360\u7528","text":"<pre><code>ss -tuln | grep \"port\"\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2_5","title":"2. \u67e5\u770b\u7aef\u53e3\u5177\u4f53\u5e94\u7528\u4fe1\u606f","text":"<pre><code>lsof -i:port;\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#redis","title":"\u516d Redis","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#60-no-sql-redis","title":"6.0 No Sql \u4ee5\u53ca Redis \u7684\u4e00\u4e9b\u7279\u6027","text":"<pre><code>NoSQL\uff08Not Only SQL\uff09 \u662f\u4e00\u7c7b\u975e\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7684\u7edf\u79f0\uff0c\u65e8\u5728\u89e3\u51b3\u4f20\u7edf\u5173\u7cfb\u578b\u6570\u636e\u5e93\u5728\u9ad8\u5e76\u53d1\u3001\u5927\u6570\u636e\u91cf\u3001\u7075\u6d3b\u6570\u636e\u6a21\u578b\u7b49\u573a\u666f\u4e0b\u7684\u74f6\u9888\u3002\nRedis \u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u5185\u5b58\u578b\u952e\u503c\u6570\u636e\u5e93\uff0c\u5c5e\u4e8e NoSQL \u4e2d\u7684\u952e\u503c\u5b58\u50a8\u7c7b\u578b\u3002\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#61-redis","title":"6.1 \u5b89\u88c5 redis","text":"<ol> <li> <p>\u53bb redis \u5b98\u7f51\u4e0b\u8f7d redis\uff0c\u9ed8\u8ba4\u5c31\u662f .tar.gz\uff0c\u7136\u540e\u89e3\u538b</p> </li> <li> <p>redis \u9700\u8981 c \u73af\u5883 <pre><code>yum -y install gcc\ngcc --version\n</code></pre></p> </li> <li> <p>\u8fdb\u5165 redis \u76ee\u5f55\uff0c\u7136\u540e\u7f16\u8bd1 redis <pre><code>make \u7f16\u8bd1\nmake install \u5b89\u88c5\n\n# \u5b89\u88c5\u5931\u8d25\nmake disclean \n</code></pre></p> </li> <li> <p>\u9ed8\u8ba4\u5b89\u88c5\u5230\u4e86 usr \u91cc\u9762\uff0c\u4e0d\u9700\u8981\u81ea\u5df1\u914d\u73af\u5883\u53d8\u91cf\u4e86\uff08\u547d\u4ee4\u6240\u5728\u4f4d\u7f6e\uff1a/usr/local/bin\uff09</p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#62-redis","title":"6.2 Redis \u914d\u7f6e\u3001\u542f\u52a8","text":"<pre><code>1\u3001\u5c06\u524d\u53f0\u542f\u52a8\u6539\u4e3a\u540e\u53f0\u542f\u52a8\n309 \u884c\u9644\u8fd1\uff1adaemonize no\n\n2\u3001\u5c06 bind ip \u6ce8\u89e3\u6389\uff0c\u8fd9\u6837\u5176\u4ed6 host \u624d\u80fd\u8fde\u63a5\n87 \u884c\u9644\u8fd1\uff1abind 127.0.0.1 -::1\n3\u3001\u53d6\u6d88\u5bc6\u7801\u4fdd\u62a4\n111 \u884c\u9644\u8fd1\uff1aprotected-mode yes --&gt; no\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#63-redis","title":"6.3 Redis \u5e38\u89c1\u6570\u636e\u7c7b\u578b\u548c\u64cd\u4f5c\u547d\u4ee4","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1_3","title":"1. \u5e38\u89c1\u6570\u636e\u7c7b\u578b","text":"<pre><code>redis\u7684\u5b58\u50a8\u65f6 key-value\u5f62\u5f0f\u7684,\u8fd9\u91cc\u7684\u4e94\u5927\u7c7b\u578b\u6307\u7684\u662f value\u7684\u4e94\u79cd\u6570\u636e\u7c7b\u578b!\n1\uff09String\n2) List\n3) Set\n4) Hash\n5) Zset\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2-key","title":"2. key \u76f8\u5173\u6307\u4ee4","text":"<p>![[Pasted image 20251105162931.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3-string","title":"3. String \u76f8\u5173\u6307\u4ee4","text":"<pre><code>String\u662fRedis\u6700\u57fa\u672c\u7684\u7c7b\u578b\uff0c\u4f60\u53ef\u4ee5\u7406\u89e3\u6210\u4e0eMemcached\u4e00\u6a21\u4e00\u6837\u7684\u7c7b\u578b\uff0c\u4e00\u4e2akey\u5bf9\u5e94\u4e00\u4e2avalue\u3002\n\nString\u7c7b\u578b\u662f\u4e8c\u8fdb\u5236\u5b89\u5168\u7684\u3002\u610f\u5473\u7740Redis\u7684string\u53ef\u4ee5\u5305\u542b\u4efb\u4f55\u6570\u636e\u3002\u6bd4\u5982jpg\u56fe\u7247\u6216\u8005\u5e8f\u5217\u5316\u7684\u5bf9\u8c61\u3002\n\nString\u7c7b\u578b\u662fRedis\u6700\u57fa\u672c\u7684\u6570\u636e\u7c7b\u578b\uff0c\u4e00\u4e2aRedis\u4e2d\u5b57\u7b26\u4e32value\u6700\u591a\u53ef\u4ee5\u662f512M\n</code></pre> <p>![[Pasted image 20251105163018.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#4-list","title":"4. List \u76f8\u5173\u6307\u4ee4","text":"<pre><code>redis \u73b0\u5728\u7684 list \u5e95\u5c42\u7ed3\u6784\u5c31\u662f Quicklist\nQuicklist \u5c31\u662f Redis \u7528\u6765\u5b9e\u73b0 List \u7684\u5e95\u5c42\u6570\u636e\u7ed3\u6784 \u2014\u2014 \u8bf4\u767d\u4e86\uff0c\u5b83\u662f\u4e00\u4e2a\u300c\u7528\u53cc\u5411\u94fe\u8868\u4e32\u8d77\u6765\u7684\u591a\u4e2a\u5c0f\u538b\u7f29\u5217\u8868\u300d\u3002\n</code></pre> <p>![[Pasted image 20251105163041.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#5-set","title":"5. Set \u76f8\u5173\u6307\u4ee4","text":"<pre><code>Redis\u00a0\u7684\u00a0Set \u7c7b\u578b\u662f\u4e00\u4e2a\u4e0d\u5141\u8bb8\u91cd\u590d\u5143\u7d20\u7684\u96c6\u5408\uff0c\u5143\u7d20\u5b58\u50a8\u7684\u987a\u5e8f\u4e0d\u6309\u7167\u63d2\u5165\u7684\u987a\u5e8f\uff0c\u56e0\u6b64\u5c5e\u4e8e\u65e0\u5e8f\u96c6\u5408\u3002\u4e00\u4e2a Set \u6700\u591a\u53ef\u4ee5\u5b58\u50a8 2^32 - 1 \u4e2a\u5143\u7d20\uff0c\u8fd9\u4e0e\u6570\u5b66\u4e2d\u7684\u96c6\u5408\u6982\u5ff5\u7c7b\u4f3c\u3002Set \u7c7b\u578b\u4e0d\u4ec5\u652f\u6301\u589e\u3001\u5220\u3001\u6539\u3001\u67e5\u7b49\u64cd\u4f5c\uff0c\u8fd8\u652f\u6301\u591a\u4e2aSet\u4e4b\u95f4\u7684\u4ea4\u96c6\u3001\u5e76\u96c6\u548c\u5dee\u96c6\u8fd0\u7b97\u3002\n</code></pre> <p>\u5185\u90e8\u5b9e\u73b0\uff1a</p> <pre><code>\u5982\u679c\u96c6\u5408\u4e2d\u7684\u6240\u6709\u5143\u7d20\u90fd\u662f\u6574\u6570\uff0c\u5e76\u4e14\u5143\u7d20\u4e2a\u6570\u5c0f\u4e8e 512\uff08\u9ed8\u8ba4\u503c\uff0c\u53ef\u901a\u8fc7\u5c5e\u6027 set-maxintset-entries \u914d\u7f6e\uff09\uff0cRedis \u4f1a\u4f7f\u7528intset\u4f5c\u4e3a Set \u7c7b\u578b\u7684\u5e95\u5c42\u6570\u636e\u7ed3\u6784\u3002\nIntSet \u5185\u90e8\u5176\u5b9e\u662f\u4e00\u4e2a\u6570\u7ec4\uff08int8_t coentents[] \u6570\u7ec4\uff09\uff0c\u800c\u4e14\u5b58\u50a8\u6570\u636e\u7684\u65f6\u5019\u662f\u6709\u5e8f\u7684\uff0c\u56e0\u4e3a\u5728\u67e5\u627e\u6570\u636e\u7684\u65f6\u5019\u662f\u901a\u8fc7\u4e8c\u5206\u67e5\u627e\u6765\u5b9e\u73b0\u7684\u3002\n\u5f53\u6211\u4eec\u4f7f\u7528 sadd nunbers 1 3 5,\u8be5\u96c6\u5408\u5bf9\u8c61\u5728\u5185\u5b58\u7684\u7ed3\u6784\u5982\u4e0b\uff1a\n</code></pre> <p>![[Pasted image 20251105170459.png]]</p> <pre><code>\u5982\u679c\u96c6\u5408\u4e2d\u7684\u5143\u7d20\u4e0d\u7b26\u5408\u4e0a\u8ff0\u6761\u4ef6\uff0cRedis \u4f1a\u4f7f\u7528\u54c8\u5e0c\u8868\u4f5c\u4e3a Set \u7c7b\u578b\u7684\u5e95\u5c42\u6570\u636e\u7ed3\u6784\u3002\nRedis \u4e2d\u7684 key-value \u662f\u901a\u8fc7 dictEntry \u5bf9\u8c61\u6765\u5b9e\u73b0\u7684\uff0c\u800c\u54c8\u5e0c\u8868\u5c31\u662f\u5c06 dictEntry \u8fdb\u884c\u4e86\u518d\u4e00\u6b21\u7684\u5305\u88c5\u5f97\u5230\u7684\uff0c\u8fd9\u5c31\u662f\u54c8\u5e0c\u8868\u5bf9\u8c61 dictht\uff1a\n</code></pre> <p><code>js typedef struct dictht {  dictEntry **table;//\u54c8\u5e0c\u8868\u6570\u7ec4  unsigned long size;//\u54c8\u5e0c\u8868\u5927\u5c0f  unsigned long sizemask;//\u63a9\u7801\u5927\u5c0f\uff0c\u7528\u4e8e\u8ba1\u7b97\u7d22\u5f15\u503c\uff0c\u603b\u662f\u7b49\u4e8esize-1  unsigned long used;//\u54c8\u5e0c\u8868\u4e2d\u7684\u5df2\u6709\u8282\u70b9\u6570  } dictht;</code> ![[Pasted image 20251105170734.png]]</p> <p>![[Pasted image 20251105163131.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#6-zset","title":"6. Zset \u76f8\u5173\u6307\u4ee4","text":"<pre><code>ZSet \u5e95\u5c42\u662f \u8df3\u8868\uff08skiplist\uff09 + \u54c8\u5e0c\u8868\uff08hash table\uff09\uff1a\n</code></pre> <p>![[Pasted image 20251105171705.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#7-hash","title":"7. Hash \u76f8\u5173\u6307\u4ee4","text":"<pre><code>\u5728redis\u5b58\u653e\u5173\u8054\u6570\u636e\uff0c\u6709\u4e09\u79cd\u89e3\u51b3\u65b9\u5f0f\uff0c\u5982\u56fe\uff1a\n</code></pre> <p>![[Pasted image 20251105173701.png]]</p> <p>![[Pasted image 20251105174257.png]]</p> <pre><code>\u5176\u4ed6\u5e38\u7528\u547d\u4ee4\nhgetall key\nhlen key\nhkeys key\nkvals key\nhincrby key field increment\nhsetnx key field vaule\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#8-redis-hash","title":"8 Redis hash \u7684\u5e95\u5c42","text":"<pre><code>\u9996\u5148\uff0chash \u5c31\u662f\u7528\u6765\u5b58\u653e key - value \u952e\u503c\u5bf9\u7684\uff0c\u5b83\u7684\u5e95\u5c42\u53ef\u4ee5\u770b\u4f5c\u662f\u6570\u7ec4\uff0c\u53ea\u4e0d\u8fc7\u5bf9\u5e94\u7684 value \u6240\u5b58\u653e\u7684\u4f4d\u7f6e\u90fd\u662f\u901a\u8fc7 Hash(key) \u6765\u8ba1\u7b97\u51fa\u6765\u7684\uff0c\u5177\u4f53\u5b9e\u73b0\u5c31\u662f\u4e24\u79cd\uff1a\u62c9\u94fe\u6cd5 | \u8e72\u5751\u6cd5\n</code></pre> <p>![[Pasted image 20251105180733.png]]</p> <pre><code>\u90a3\u4e48 Redis \u91c7\u7528\u7684\u662f\u54ea\u4e00\u79cd\u505a\u6cd5\u5462\uff1f\u7b54\u6848\u662f\u300c\u5206\u79bb\u94fe\u63a5\u6cd5\u300d\uff0c\u5728\u4e0d\u6269\u5bb9\u54c8\u5e0c\u8868\u7684\u524d\u63d0\u4e0b\uff0c\u5c06\u5177\u6709\u76f8\u540c\u54c8\u5e0c\u503c\u7684\u6570\u636e\u4e32\u8d77\u6765\uff0c\u5f62\u6210\u94fe\u8868\uff0c\u4ee5\u4fbf\u8fd9\u4e9b\u6570\u636e\u5728\u8868\u4e2d\u4ecd\u7136\u53ef\u4ee5\u88ab\u67e5\u8be2\u5230\u3002\u597d\u4e86\uff0c\u90a3\u4e48\u63a5\u4e0b\u6765\u5c31\u770b\u770b Redis \u54c8\u5e0c\u8868\u7684\u7ed3\u6784\u8bbe\u8ba1\u3002\n</code></pre> <p>![[Pasted image 20251105180917.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#64-jedis","title":"6.4. Jedis","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1_4","title":"1. \u4f7f\u7528\u65b9\u6cd5","text":"<ol> <li> <p>\u5bfc\u5165\u4f9d\u8d56 <pre><code>&lt;dependency&gt;  \n    &lt;groupId&gt;redis.clients&lt;/groupId&gt;  \n    &lt;artifactId&gt;jedis&lt;/artifactId&gt;  \n    &lt;version&gt;2.9.0&lt;/version&gt;  \n&lt;/dependency&gt;  \n&lt;!-- https://mvnrepository.com/artifact/org.junit.jupiter/junit-jupiter-api --&gt;  \n&lt;dependency&gt;  \n    &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;  \n    &lt;artifactId&gt;junit-jupiter-api&lt;/artifactId&gt;  \n    &lt;version&gt;5.8.1&lt;/version&gt;  \n    &lt;scope&gt;test&lt;/scope&gt;  \n&lt;/dependency&gt;\n</code></pre></p> </li> <li> <p>\u7136\u540e\u5c31\u53ef\u4ee5\u83b7\u53d6\u8fde\u63a5\uff0c\u6267\u884c\u65b9\u6cd5\u4e86 <pre><code>Jedis jedis = new Jedis(\"192.168.6.101\",6379);\njedis.xxx (\u8fd9\u91cc\u7684\u65b9\u6cd5\u540d\u5c31\u662f redis \u7684\u547d\u4ee4\u540d)\n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#65-spring-data-redis","title":"6.5 Spring data redis","text":"<pre><code>\u4f7f\u7528\u6b65\u9aa4\uff1a\n1\uff09\u5bfc\u5165\u76f8\u5173\u573a\u666f\u542f\u52a8\u5668\u4ee5\u53ca\u4f9d\u8d56\uff08spring-boot-starter-data-redis\uff0c spring-boot-starter-web\uff1a\u8981\u7684\u662fjson\u4ee5\u53ca\u8fde\u63a5\u6c60\u4f9d\u8d56 commons-pool2\uff09\n</code></pre> <p><code>xml &lt;parent&gt;     &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;     &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;     &lt;version&gt;3.0.5&lt;/version&gt; &lt;/parent&gt;  &lt;dependencies&gt;      &lt;dependency&gt;         &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;         &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;     &lt;/dependency&gt;      &lt;dependency&gt;         &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;         &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;     &lt;/dependency&gt;      &lt;dependency&gt;         &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;         &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;     &lt;/dependency&gt;      &lt;dependency&gt;         &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;         &lt;artifactId&gt;lombok&lt;/artifactId&gt;     &lt;/dependency&gt;  &lt;/dependencies&gt;</code>     2\uff09\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6e\u4fe1\u606f\uff0c\u6700\u91cd\u8981\u7684\uff1aspring.data.redis.host | port ``` yaml spring:   data:     redis:       host: 47.94.86.115       port: 6379  </p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#jedis","title":"jedis:","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#pool","title":"pool:","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#enabled-true","title":"enabled: true","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#max-active-8","title":"max-active: 8","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#max-idle-5","title":"max-idle: 5","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#max-wait-100","title":"max-wait: 100","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#client-type-jedis","title":"client-type: jedis","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#redis_1","title":"# redis\u8fde\u63a5\u6c60\u914d\u7f6e","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#lettuce","title":"\u542b\u4e49\uff1a\u8fd9\u4e2a\u5c5e\u6027\u6307\u5b9a\u662f\u5426\u542f\u7528 Lettuce \u8fde\u63a5\u6c60\u3002","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#springdataredislettucepoolenabledtrue","title":"spring.data.redis.lettuce.pool.enabled=true","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#_2","title":"# \u542b\u4e49\uff1a\u8fd9\u4e2a\u5c5e\u6027\u5b9a\u4e49\u4e86\u8fde\u63a5\u6c60\u4e2d\u5141\u8bb8\u7684\u6700\u5927\u6d3b\u52a8\u8fde\u63a5\u6570\u3002","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#springdataredislettucepoolmax-active8","title":"spring.data.redis.lettuce.pool.max-active=8","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#_3","title":"# \u542b\u4e49\uff1a\u8fd9\u4e2a\u5c5e\u6027\u5b9a\u4e49\u4e86\u8fde\u63a5\u6c60\u4e2d\u5141\u8bb8\u7684\u6700\u5927\u7a7a\u95f2\u8fde\u63a5\u6570\u3002","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#springdataredislettucepoolmax-idle5","title":"spring.data.redis.lettuce.pool.max-idle=5","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#_4","title":"# \u542b\u4e49\uff1a\u8fd9\u4e2a\u5c5e\u6027\u5b9a\u4e49\u4e86\u5728\u83b7\u53d6\u8fde\u63a5\u65f6\u6700\u957f\u7684\u7b49\u5f85\u65f6\u95f4\uff08\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\uff09\u3002","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#springdataredislettucepoolmax-wait100","title":"spring.data.redis.lettuce.pool.max-wait=100","text":"<p><code>3) \u81ea\u5b9a\u4e49\u5e8f\u5217\u5316\u5668\uff08\u624b\u52a8\u6ce8\u518c\u4e00\u4e2aredistemplate)</code>java @Configuration public class RedisTemplateConfig {      @Bean     public RedisTemplate redisTemplate(RedisConnectionFactory connectionFactory){         // \u521b\u5efaRedisTemplate\u5bf9\u8c61         RedisTemplate template = new RedisTemplate&lt;&gt;();         // \u8bbe\u7f6e\u8fde\u63a5\u5de5\u5382         template.setConnectionFactory(connectionFactory);         // \u521b\u5efaJSON\u5e8f\u5217\u5316\u5de5\u5177         GenericJackson2JsonRedisSerializer jsonRedisSerializer =                 new GenericJackson2JsonRedisSerializer();         // \u8bbe\u7f6eKey\u7684\u5e8f\u5217\u5316         template.setKeySerializer(RedisSerializer.string());         template.setHashKeySerializer(RedisSerializer.string());         // \u8bbe\u7f6eValue\u7684\u5e8f\u5217\u5316         template.setValueSerializer(jsonRedisSerializer);         template.setHashValueSerializer(jsonRedisSerializer);         // \u8fd4\u56de\u4fee\u6539\u7684\u6a21\u677f\u5bf9\u8c61         return template;     } } ```"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#66","title":"6.6 \u4e8b\u52a1\u548c\u9501","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1_5","title":"1. \u6982\u5ff5","text":"<pre><code>\u5728redis\u4e2d\uff0c\u4e8b\u52a1\u5c31\u662f\u4e00\u7cfb\u5217\u547d\u4ee4\u7ec4\u4e2a\u961f\uff08QUEUE\uff09\uff0c\u4f46\u662f\u4e0d\u50cf mysql\uff0credis \u7684\u4e8b\u52a1\u662f\u6ca1\u6709 ACID \u7684\u3002\n\u800c\u9501\u662f\u56e0\u4e3a\u5728\u4e8b\u52a1\u8fd8\u6ca1\u6267\u884c\u4e4b\u524d\uff0c\u4e5f\u5c31\u662f\u7ec4\u961f\u671f\u95f4\uff0c\u5f53\u524d\u4e8b\u52a1\u8981\u8bbf\u95ee\u7684\u6570\u636e\u53ef\u80fd\u88ab\u5176\u4ed6\u547d\u4ee4\u6240\u4fee\u6539\uff0c\u4ece\u800c\u5bfc\u81f4\u810f\u8bfb\u3002\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2_6","title":"2. \u4ee3\u7801\u5b9e\u73b0","text":"<pre><code>// \u4e8b\u52a1\nmulti  \u5f00\u542f\u4e8b\u52a1\nexec \u6267\u884c\u4e8b\u52a1\ndiscard \u53d6\u6d88\u4e8b\u52a1\n\n\n// \u9501\nwatch key1 key2 ... \n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3_3","title":"3. \u60b2\u89c2\u9501\u548c\u4e50\u89c2\u9501","text":"<pre><code>\u60b2\u89c2\u9501\u7684\u610f\u601d\u5c31\u662f\u60b2\u89c2\u7684\u8ba4\u4e3a\u4e8b\u52a1\u8981\u8bbf\u95ee\u7684\u6570\u636e\u4f1a\u88ab\u5176\u4ed6\u547d\u4ee4\u6216\u8005\u4e8b\u52a1\u6240\u4fee\u6539\uff0c\u6240\u4ee5\u6211\u76f4\u63a5\u7ed9\u6570\u636e\u4e0a\u9501\uff0c\u8ba9\u522b\u4eba\u5728\u6211\u6240\u6267\u884c\u8fc7\u7a0b\u4e2d\u4e0d\u80fd\u4f7f\u7528\u8fd9\u4e2a\u6570\u636e\uff0c\u56e0\u6b64\uff0c\u60b2\u89c2\u9501\u6027\u80fd\u4f1a\u5dee\u70b9\u3002\n\u800c\u4e50\u89c2\u9501\u5c31\u662f\u8ba4\u4e3a\u672c\u6b21\u8981\u8bbf\u95ee\u7684\u6570\u636e\u4e0d\u4f1a\u88ab\u5176\u4ed6\u547d\u4ee4\u6216\u8005\u4e8b\u52a1\u6240\u4fee\u6539\uff0c\u5c31\u7b97\u5176\u4ed6\u4e8b\u52a1\u6216\u547d\u4ee4\u8981\u4fee\u6539\uff0c\u4e5f\u8ba9\u4ed6\u4eec\u53bb\u4fee\u6539\uff0c\u6211\u5728\u91cd\u65b0\u5f00\u4e00\u6b21\u4e8b\u52a1\u5c31\u884c\u4e86\u3002\njava\u7528\u7684\u662f\u60b2\u89c2\u9501\u673a\u5236\uff0c\u800credis\u662f\u4e50\u89c2\u9501\u673a\u5236\u3002\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#67-lua","title":"6.7 Lua \u811a\u672c","text":"<pre><code>Lua \u662f\u4e00\u95e8\u8f7b\u91cf\u7ea7\u3001\u53ef\u5d4c\u5165\u7684\u811a\u672c\u8bed\u8a00\uff0c\u8bbe\u8ba1\u76ee\u6807\u662f\u9ad8\u6548\u3001\u7b80\u6d01\u3001\u53ef\u6269\u5c55\uff0c\u5e38\u7528\u4e8e\u6e38\u620f\u5f00\u53d1\u3001\u5d4c\u5165\u5f0f\u7cfb\u7edf\u548c\u9ad8\u6027\u80fd\u670d\u52a1\u4e2d\uff08\u5982 Redis\uff09\u3002\n\u5728 redis \u4e2d\uff0clua\u53ef\u4ee5\u4e00\u6b21\u6267\u884c\u591a\u6761redis\u547d\u4ee4\uff0c\u4ece\u800c\u51cf\u5c11\u4e0eredis\u7684\u8fde\u63a5\u6b21\u6570\uff0c\u63d0\u5347\u6027\u80fd\u3002\u540c\u65f6\uff0c\u8fd9\u4e9b redis \u547d\u4ee4\u662f\u539f\u5b50\u7684\uff0c\u590d\u5408\u7684\u3002\u4e5f\u5c31\u662f\u8981\u4e48\u5168\u90e8\u6267\u884c\uff0c\u8981\u4e48\u5168\u90e8\u4e0d\u6267\u884c\u3002\n</code></pre> <p>\u4f7f\u7528\u65b9\u6cd5\uff1a</p> <pre><code>1. \u7f16\u5199 lua \u811a\u672c\uff0c\u5c06 lua \u811a\u672c\u5b58\u5230 resources \u4e0b\n2. \u6211\u4eec\u9700\u8981\u5c06 lua \u811a\u672c\u8f6c\u4e3a resource \u5bf9\u8c61\uff0c\u7136\u540e\u518d\u8f6c\u4e3a RedisScript \u5bf9\u8c61\u5e76\u6ce8\u518c\u5230 ioc \u5bb9\u5668\u4e2d\u3002\n3. \u7136\u540e\uff0c\u901a\u8fc7 script.execute() \u65b9\u6cd5\u5c31\u53ef\u4ee5\u8c03\u7528\u8fd9\u4e2a lua \u811a\u672c\u3002\n</code></pre> <p><code>java @Bean public RedisScript&lt;Boolean&gt; booleanRedisScript(){     //\u52a0\u8f7d\u811a\u672c\u6587\u4ef6     Resource resource = new ClassPathResource(\"lua/change.lua\");      //\u53c2\u65701\uff1a \u52a0\u8f7d\u811a\u672c\u7684\u8d44\u6e90\u5bf9\u8c61 \u53c2\u65702\uff1a \u8fd4\u56de\u503c\u7c7b\u578b     RedisScript&lt;Boolean&gt; booleanRedisScript = RedisScript.of(resource, Boolean.class);      return booleanRedisScript; }</code></p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#68-redis","title":"6.8 Redis \u7684\u6301\u4e45\u5316\u7b56\u7565","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1-rdb","title":"1. RDB","text":"<pre><code>\u5728\u6307\u5b9a\u65f6\u95f4\u95f4\u9694\u5185\uff0c\u5c06\u5185\u5b58\u4e2d\u7684\u6570\u636e\u96c6\u5feb\u7167\u5199\u5165\u78c1\u76d8\uff0c\u751f\u6210\u4e00\u4e2a dump.rdb \u6587\u4ef6\n</code></pre> <pre><code>// \u6301\u4e45\u5316\u6587\u4ef6\u540d\u5b57\u914d\u7f6e\ndbfilename dump.rdb \uff08481\u884c\uff09\n\n// dump.rdb \u5b58\u653e\u7684\u4f4d\u7f6e\ndir ./ \uff08\u9ed8\u8ba4\u914d\u7f6e\uff09\n</code></pre> <p>\u89e6\u53d1\u6301\u4e45\u5316\u7684\u65b9\u6cd5\uff1a <pre><code>save \u5728\u4e3b\u8fdb\u7a0b\u53bb\u8fdb\u884c\u6301\u4e45\u5316\nbgsave\nshutdown\nflushall\n\n\n// \u5b98\u65b9\u63d0\u4f9b\u7684\u914d\u7f6e\nsave 900 1 # \u5728900\u79d2\uff0815\u5206\u949f\uff09\u5185\uff0c\u5982\u679c\u81f3\u5c11\u67091\u4e2a\u952e\u53d1\u751f\u6539\u53d8\uff0c\u5219\u6267\u884cRDB\u6301\u4e45\u5316\nsave 300 10 # \u5728300\u79d2\uff085\u5206\u949f\uff09\u5185\uff0c\u5982\u679c\u81f3\u5c11\u670910\u4e2a\u952e\u53d1\u751f\u6539\u53d8\uff0c\u5219\u6267\u884cRDB\u6301\u4e45\u5316\nsave 60 10000 # \u572860\u79d2\u5185\uff0c\u5982\u679c\u81f3\u5c11\u670910,000\u4e2a\u952e\u53d1\u751f\u6539\u53d8\uff0c\u5219\u6267\u884cRDB\u6301\u4e45\u5316\n\u6ce8\u610f: \u5468\u671f\u4e00\u5b9a\u6267\u884c\u5b8c\u6bd5\u624d\u4f1a\u89e6\u53d1\u6301\u4e45\u5316!\u4e0d\u4f1a\u4e2d\u9014\u89e6\u53d1! \u6240\u4ee5rdb\u81ea\u52a8\u5907\u4efd\u53ef\u80fd\u4f1a\u4e22\u5931\u6570\u636e\n</code></pre></p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2-aof","title":"2. AOF","text":"<pre><code>\u8bb0\u5f55\u670d\u52a1\u5668\u63a5\u6536\u5230\u7684\u6bcf\u4e00\u4e2a\u5199\u547d\u4ee4\uff0c\u4ee5\u534f\u8bae\u683c\u5f0f\u8ffd\u52a0\u5230 appendonly.aof \u6587\u4ef6\u672b\u5c3e\u3002\u91cd\u542f\u65f6\u901a\u8fc7\u91cd\u653e\u547d\u4ee4\u6062\u590d\u6570\u636e\n</code></pre> <pre><code>// \u6301\u4e45\u5316\u7684\u6587\u4ef6\u540d\u914d\u7f6e \nappendfilename \"appendonly.aof\"\n\n// \"appendonly.aof \u5b58\u653e\u7684\u4f4d\u7f6e\ndir ./\n\n// \u5199\u7684\u9891\u7387\nappendfsync always\nappendfsync everysec \u9ed8\u8ba4\u7528\u8fd9\u4e2a\nappendfsync no\n\n// \u662f\u5426\u5f00\u542f\nappendonly no --&gt; yes\n</code></pre> <p>\u91cd\u5199\u538b\u7f29\u673a\u5236\uff1a  1.  aof \u624d\u6709\u91cd\u5199\u673a\u5236  2.  aof \u5b58\u50a8\u5199\u547d\u4ee4\u7684\u6587\u672c\u6587\u4ef6  3.  \u91cd\u5199\u4f1a\u51cf\u5c11 aof \u6587\u4ef6\u7684\u5927\u5c0f\uff0c aof \u91cd\u5199\u4fdd\u8bc1\u5b58\u7684\u662f\u80fd\u591f\u6062\u590d\u6570\u636e\u7684\u6700\u5c0f\u6307\u4ee4\u96c6  4. aof \u53ef\u4ee5\u81ea\u52a8\u89e6\u53d1\u91cd\u5199\uff0c\u4e5f\u53ef\u4ee5\u624b\u52a8\u89e6\u53d1\uff1abgrewriteaof <pre><code>auto-aof-rewrite-percentage : 150% #\u589e\u91cf\u767e\u5206\u6bd4\nauto-aof-rewrite-min-size : 100MB #\u8bbe\u7f6e\u7b2c\u4e00\u6b21\u538b\u7f29\u7684\u57fa\u51c6\u503c\n\u7b2c\u4e00\u6b21: 100+(100*150%) = 250MB -&gt; 80MB\n\u7b2c\u4e8c\u6b21: 80+80*150% = 200MB -&gt; .....\n</code></pre></p> <p>\u9009\u62e9\u5efa\u8bae\uff1a     a.\u00a0 \u5b98\u7f51\u63a8\u8350\u4e24\u4e2a\u90fd\u5f00\u542f\uff0c\u5f00\u542f\u7684AOF\u4f18\u5148\u751f\u6548     b.\u00a0 \u975e\u654f\u611f\u6570\u636e\uff0c\u5efa\u8baeRDB     c.\u00a0 \u5355\u7eaf\u7684\u7f13\u5b58\uff0c\u5efa\u8bae\u90fd\u4e0d\u5f00\u542f     d.\u00a0 \u654f\u611f\u6570\u636e\uff0c\u5efa\u8bae\u90fd\u5f00\u542f</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#69-redis","title":"6.9 Redis \u4e3b\u4ece","text":"<pre><code>\u4e3b\u4ece\u662f\u6765\u5b9e\u73b0\u8bfb\u5199\u5206\u79bb\u7684\uff0c\u4e3b\u8d1f\u8d23\u5199\u5165\u6570\u636e\u5e76\u8d1f\u8d23\u5c06\u6570\u636e\u5199\u5165\u4ece\uff0c\u4ece\u8d1f\u8d23\u8bfb\u53d6\u6570\u636e\uff0c\u5e76\u4e14\u63a5\u53d7\u4e3b\u53d1\u6765\u7684\u540c\u6b65\u6570\u636e\u3002\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1_6","title":"1. \u4e3b\u4ece\u5b9e\u73b0\u65b9\u6cd5","text":"<ol> <li>\u51c6\u5907\u591a\u4efd\u914d\u7f6e\u6587\u4ef6 <pre><code>include /root/myredis/redis.conf\npidfile /var/run/redis_6379.pid\nport 6379\ndbfilename dump6379.rdb\n</code></pre></li> <li> <p>\u542f\u52a8\u8fd9\u4e09\u53f0 redis \u670d\u52a1 <pre><code>redis-server xxx.conf\n</code></pre></p> </li> <li> <p>\u6784\u5efa\u4e3b\u4ece\u6a21\u5f0f <pre><code>slave of ip port --&gt; replicaof ip port\ninfo replication\uff08\u67e5\u770b\u89d2\u8272\uff09\n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2_7","title":"2. \u4e3b\u4ece\u5b9e\u73b0\u539f\u7406","text":"<pre><code>a.\u00a0 \u5168\u91cf\u590d\u5236: \u5c0f\u5f1f\u8fde\u63a5\u5230\u4e3b\u673a\uff0c\u4e3b\u673a\u7b2c\u4e00\u6b21\u4f1a\u5c06\u6240\u6709\u6570\u636e\u90fd\u4f20\u9012\u7ed9\u5c0f\u5f1f\uff01\uff08\u5168\u91cf\uff09\nb.\u00a0 \u589e\u91cf\u590d\u5236\uff1a\u540e\u7eed\u7684\u4e3b\u673a\u6570\u636e\u66f4\u65b0\uff0c\u90fd\u5c5e\u4e8e\u589e\u91cf\u590d\u5236\uff0c\u5f97\u5230\u7684\u65b0\u6570\u636e\u4f1a\u7acb\u5373\u540c\u6b65\u7ed9\u5c0f\u5f1f\uff08\u589e\u5f3a\uff09\nc.\u00a0 \u4e3b\u4ece\u6a21\u5f0f\u901a\u8fc7\u5168\u91cf+\u589e\u91cf\u63d0\u9ad8\u4e86\u6027\u80fd\u7684\u540c\u65f6\uff0c\u4e5f\u80fd\u4fdd\u8bc1\u4efb\u610f\u65f6\u523b\u52a0\u5165\u7684\u5c0f\u5f1f\u90fd\u6709\u4e3b\u673a\u7684\u5168\u90e8\u6570\u636e\nd.\u00a0 \u6211\u4eec\u5fc5\u987b\u77e5\u9053\uff0c\u4e3b\u4ece\u6a21\u5f0f\u6570\u636e\u662f\u6709\u5ef6\u8fdf\u6027\u7684\uff01\uff08\u4e3b\u673a-\u300b\u5199\u5165\u6570\u636e-\u300b\u4ece\u673a\u6ca1\u6709\u8bfb\u5230\uff09\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3_4","title":"3. \u54e8\u5175\u673a\u5236","text":"<pre><code>\u54e8\u5175\u7684\u5b58\u5728\u5c31\u662f\u5f53\u4e3b\u673a\u51fa\u73b0\u6545\u969c\u65f6\uff0c\u81ea\u52a8\u7684\u9009\u62e9\u4e00\u4e2a\u4ece\u673a\u5f53\u4f5c\u4e3b\u673a\uff0c\u7136\u540e\u8ba9\u5176\u4ed6\u4ece\u673a\u90fd\u6267\u884c replicaof ip host\uff0c\u4ece\u800c\u5b9e\u73b0\u6362\u4e3b\uff0c\u5f53\u66fe\u7ecf\u7684\u4e3b\u673a\u56de\u6765\u540e\uff0c\u4e5f\u4f1a\u53d8\u6210\u5f53\u524d\u4e3b\u673a\u7684\u4ece\u673a\u3002\n\na.\u00a0 \u7f16\u5199\u54e8\u5175\u914d\u7f6e\n</code></pre> <p><code>sentinel monitor mymaster 127.0.0.1 6379 1</code></p> <pre><code>b.\u00a0 \u542f\u52a8\u54e8\u5175\u6a21\u5f0f\n</code></pre> <p><code>redis-sentinel sentinel.conf</code></p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#610-redis","title":"6.10 redis \u96c6\u7fa4","text":"<pre><code>Redis \u96c6\u7fa4\uff08Redis Cluster\uff09\u662f Redis \u5b98\u65b9\u63d0\u4f9b\u7684\u5206\u5e03\u5f0f\u89e3\u51b3\u65b9\u6848\uff0c\u7528\u4e8e\u5b9e\u73b0\u6570\u636e\u5206\u7247\uff08sharding\uff09\u3001\u9ad8\u53ef\u7528\u548c\u6c34\u5e73\u6269\u5c55\u3002\n</code></pre> <p>\u6838\u5fc3\u7279\u6027\uff1a</p> <pre><code>\u81ea\u52a8\u5206\u7247\uff1a\u5c06\u6570\u636e\u5206\u6563\u5230\u591a\u4e2a\u8282\u70b9\uff08\u6700\u591a 16384 \u4e2a\u54c8\u5e0c\u69fd\uff09\n\u9ad8\u53ef\u7528\uff1a\u6bcf\u4e2a\u4e3b\u8282\u70b9\u53ef\u914d\u7f6e\u4ece\u8282\u70b9\uff0c\u4e3b\u8282\u70b9\u6545\u969c\u65f6\u81ea\u52a8\u6545\u969c\u8f6c\u79fb\n\u53bb\u4e2d\u5fc3\u5316\uff1a\u65e0\u4e2d\u5fc3\u4ee3\u7406\uff0c\u5ba2\u6237\u7aef\u76f4\u8fde\u4efb\u610f\u8282\u70b9\uff0c\u96c6\u7fa4\u5185\u90e8\u81ea\u52a8\u91cd\u5b9a\u5411\n\u5199\u80fd\u529b\u6269\u5c55\uff1a\u591a\u4e3b\u67b6\u6784\uff0c\u7a81\u7834\u5355\u673a\u5199\u6027\u80fd\u74f6\u9888\n</code></pre> <p>\u6838\u5fc3\u539f\u7406\uff1a</p> <ul> <li>Redis \u96c6\u7fa4\u5c06\u6574\u4e2a\u952e\u7a7a\u95f4\u5212\u5206\u4e3a 16384 \u4e2a\u54c8\u5e0c\u69fd\uff08hash slots\uff09</li> <li>\u6bcf\u4e2a key \u901a\u8fc7 <code>CRC16(key) % 16384</code> \u8ba1\u7b97\u51fa\u6240\u5c5e\u69fd\u4f4d</li> <li>\u6bcf\u4e2a\u4e3b\u8282\u70b9\u8d1f\u8d23\u4e00\u90e8\u5206\u69fd\u4f4d\uff08\u4f8b\u5982 3 \u4e3b\u8282\u70b9\uff1a0-5460, 5461-10922, 10923-16383\uff09</li> </ul>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#_5","title":"\u96c6\u7fa4\u76f8\u5173\u547d\u4ee4","text":"<ol> <li> <p>\u6bcf\u4e2a\u8282\u70b9\u7684\u914d\u7f6e\u6587\u4ef6 <pre><code>include /root/myredis/redis.conf\nport 6379\npidfile \"/var/run/redis_6379.pid\"\ndbfilename \"dump6379.rdb\"\ncluster-enabled yes\ncluster-config-file nodes-6379.conf\ncluster-node-timeout 15000\n</code></pre></p> </li> <li> <p>\u5c06\u591a\u4e2a redis \u7ec4\u6210\u96c6\u7fa4 <pre><code># \u6bcf\u4e2a\u670d\u52a1\u90fd\u8981\u6e05\u7a7a\nredis-cli --cluster create --cluster-replicas 1 172.17.14.36:6379 172.17.14.36:6380 172.17.14.36:6381 172.17.14.36:6382 172.17.14.36:6383 172.17.14.36:6384\n</code></pre></p> </li> <li> <p>\u8fde\u63a5\u96c6\u7fa4 <pre><code># \u767b\u5f55\u5fc5\u987b\u662f-c\u94fe\u63a5\u7684\u96c6\u7fa4\u4e0d\u662f\u6bcf\u4e2a\u8282\u70b9\nredis-cli -c -p 6383\n\n# \u67e5\u770b\u96c6\u7fa4\u4e2d\u8282\u70b9\ncluster nodes \u67e5\u770b\u8282\u70b9\u5173\u7cfb\n\n# redis\u96c6\u7fa4\u7684\u6570\u636e\u5b58\u50a8\uff08\u96c6\u7fa4\uff0c\u771f\u6b63\u7684\u80fd\u89e3\u51b3\u6570\u636e\u7684\u5e76\u53d1\u5199\u95ee\u9898\uff01\uff09\n\u5b58\u50a8\u8fc7\u7a0b\uff1a key =&gt; CRC16(key) =\u300b \u6574\u6570 =\u300b %16384 =&gt; index =&gt; \u5b58\u50a8\u5230\u5bf9\u5e94\u7684slot\n\u8282\u70b9 A \u8d1f\u8d23\u5904\u7406 0 \u53f7\u81f3 5460 \u53f7\u63d2\u69fd\u3002\n\u8282\u70b9 B \u8d1f\u8d23\u5904\u7406 5461 \u53f7\u81f3 10922 \u53f7\u63d2\u69fd\u3002\n\u8282\u70b9 C \u8d1f\u8d23\u5904\u7406 10923 \u53f7\u81f3 16383 \u53f7\u63d2\u69fd\u3002\n\nset name xx -&gt; slot -&gt; redirect -&gt; master\u8282\u70b9 -\u300b \u5b58\u50a8\u6570\u636e\n\n#\u4e00\u6b21\u8bbe\u7f6e\u591a\u5bf9\u952e\u503c\u5bf9\nmset key{1} key{1} ....{1}slot\u503c\u8fdb\u884c\u5b58\u50a8\n</code></pre></p> </li> <li> <p>\u8ba1\u7b97 key \u7684slot <pre><code>- cluster keyslot key \u8ba1\u7b97key\u5e94\u8be5\u4fdd\u5b58\u5728\u90a3\u4e2a\u63d2\u69fd\n- cluster countkeysinslot slot\u7684\u503c \u8ba1\u7b97\u67d0\u4e2a\u63d2\u69fd\u4e2d\u4fdd\u5b58\u7684key\u7684\u6570\u91cf\n- CLUSTER GETKEYSINSLOT \\&lt;slot&gt;\\&lt;count&gt; \u8fd4\u56de count \u4e2a slot \u69fd\u4e2d\u7684\u952e\u3002\n</code></pre></p> </li> <li> <p>\u96c6\u7fa4\u6545\u969c\u6062\u590d <pre><code>1. \u5355\u4e2a\u5206\u533a\u7684master\u6302\u4e86\n\u96c6\u7fa4\u5185\u90e8\u81ea\u5e26\u54e8\u5175\n\u4e3b\u8282\u70b9\u6302\u4e86\u4ee5\u540e\uff0c\u81ea\u52a8\u9009\u4e3e\u4e1b\u8282\u70b9\u5f53\u9009\u4e3b\u8282\u70b9\n\n2. \u5355\u4e2a\u5206\u533a\u90fd\u6302\u4e86\n- redis.conf\u4e2dcluster-require-full-coverage \u4e3ayes \u90a3\u4e48\uff0c\u6574\u4e2a\u96c6\u7fa4\u90fd\u6302\u6389\n- redis.conf\u4e2dcluster-require-full-coverage \u4e3ano \u90a3\u4e48\uff0c\u53ea\u6709\u8be5\u63d2\u69fd\u6570\u636e\u5168\u90fd\u4e0d\u80fd\u4f7f\u7528\u3002\n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#docker-2375","title":"\u4e03 Docker 2375","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#71-docker","title":"7.1 \u4ec0\u4e48\u662fdocker","text":"<pre><code>Docker\u00a0\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u5bb9\u5668\u5316\u5e73\u53f0\uff0c\u7528\u4e8e\u5c06\u5e94\u7528\u53ca\u5176\u4f9d\u8d56\u6253\u5305\u5230\u8f7b\u91cf\u3001\u53ef\u79fb\u690d\u7684\u5bb9\u5668\u4e2d\u3002\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#72-docker","title":"7.2 docker \u67b6\u6784","text":"<p>![[Pasted image 20251118081318.png]] - \u955c\u50cf\uff08Image\uff09\uff1a\u53ea\u8bfb\u6a21\u677f\uff0c\u7528\u4e8e\u521b\u5efa\u5bb9\u5668\u3002 - \u5bb9\u5668\uff08Container\uff09\uff1a\u955c\u50cf\u7684\u8fd0\u884c\u5b9e\u4f8b\u3002 - Docker Hub\uff1a\u5b98\u65b9\u955c\u50cf\u4ed3\u5e93\uff0c\u53ef\u62c9\u53d6/\u63a8\u9001\u955c\u50cf\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#73-docker","title":"7.3 \u5b89\u88c5docker","text":"<ol> <li> <p>\u5148\u53bb\u5b89\u88c5c,c++\u73af\u5883 <pre><code>yum install gcc\nyum install gcc-c++\n</code></pre></p> </li> <li> <p>\u518d\u53bb\u5b89\u88c5\u4e00\u4e9bdocker\u7684\u4f9d\u8d56 <pre><code>yum install -y yum-utils \\\n  device-mapper-persistent-data \\\n  lvm2\n</code></pre></p> </li> <li> <p>\u6dfb\u52a0\u955c\u50cf\u6e90 <pre><code># 12\u67081\u65e5\uff0c\u53d1\u73b0\u8fd9\u4e2a\u6e90\u6709\u95ee\u9898\nsudo yum-config-manager \\\n    --add-repo \\\n    https://download.docker.com/linux/centos/docker-ce.repo\n\n# \u6e05\u534e\u6e90\nsed\u00a0-i\u00a0's+https://download.docker.com+https://mirrors.tuna.tsinghua.edu.cn/docker-ce+'\u00a0/etc/yum.repos.d/docker-ce.repo\n</code></pre></p> </li> <li> <p>\u5b89\u88c5docker <pre><code># \u4e00\u4e2a\u4e00\u4e2a\u5b89\u88c5\uff0c\u4e0d\u7136\u6709\u95ee\u9898\nsudo yum install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin\n# \u4e00\u952e\u5b89\u88c5\ncurl -fsSL https://github.com/tech-shrimp/docker_installer/releases/download/latest/linux.sh| bash -s docker --mirror Aliyun\n</code></pre></p> </li> <li> <p>\u5220\u9664 docker <pre><code>yum remove docker \\  \n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 docker-client \\  \n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 docker-client-latest \\  \n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 docker-common \\  \n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 docker-latest \\  \n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 docker-latest-logrotate \\  \n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 docker-logrotate \\  \n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 docker-engine\n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#74-docker","title":"7.4 docker\u7684\u914d\u7f6e","text":"<ol> <li> <p>\u914d\u7f6e\u4ed3\u5e93 <pre><code>sudo mkdir -p /etc/docker \nsudo tee /etc/docker/daemon.json &lt;&lt;-'EOF' { \"registry-mirrors\": [\"https://kf7vf3vo.mirror.aliyuncs.com\"] } EOF \nsudo systemctl daemon-reload \nsudo systemctl restart docker\n</code></pre></p> </li> <li> <p>\u5b8c\u6574\u914d\u7f6e\u5982\u4e0b\uff08\u73b0\u5728\u963f\u91cc\u7684\u4ed3\u5e93\u4e0d\u5bf9\u5916\u5f00\u653e\u4e86\uff0c\u53ea\u80fd\u963f\u91cc\u4e91\u7684\u4e91\u670d\u52a1\u5668\u624d\u80fd\u7528\uff09 <pre><code>\u5751\uff1a\u6700\u540e\u4e0d\u8981\u6709\u9017\u53f7\uff01\uff01\n {\n  \"registry-mirrors\": [\n        \"https://docker.m.daocloud.io\",\n        \"https://docker.1panel.live\",\n        \"https://docker.xuanyuan.me\",\n        \"https://docker.mirrors.ustc.edu.cn\",\n        \"https://registry.dockermirror.com\",\n        \"https://hub-mirror.c.163.com\"\n        ]\n}\n\n// \u817e\u8baf\u4e91\u670d\u52a1\u5668\u7684\u914d\u7f6e\n {\n  \"registry-mirrors\": [\n        \"https://docker.m.daocloud.io\",\n        \"https://docker.1panel.live\",\n        \"https://docker.xuanyuan.me\",\n        \"https://docker.mirrors.ustc.edu.cn\",\n        \"https://registry.dockermirror.com\",\n        \"https://hub-mirror.c.163.com\",\n        \"https://mirror.ccs.tencentyun.com\"\n        ]\n}\n</code></pre></p> </li> <li> <p>\u914d\u7f6e\u5141\u8bb8\u8fdc\u7a0b\u8fde\u63a5\uff08\u4e3a\u4e86\u540e\u7eed\u628aspringboot\u9879\u76ee\u6253\u5305\u6210\u955c\u50cf\uff0c\u4e0a\u4f20\u5230docker\uff09</p> </li> <li></li> <li><code>-H tcp://0.0.0.0:2375</code>\uff1a\u5f00\u542f TCP \u7aef\u53e3\u76d1\u542c\uff0c\u5141\u8bb8\u6240\u6709 IP \u8bbf\u95ee\uff08\u751f\u4ea7\u73af\u5883\u5efa\u8bae\u9650\u5236 IP\uff09\u3002</li> <li><code>-H fd://</code>\uff1a\u4fdd\u7559\u9ed8\u8ba4 Unix socket \u65b9\u5f0f\uff08\u672c\u5730\u901a\u4fe1\u4ecd\u53ef\u7528\uff09\u3002</li> <li><code>2375</code>\u00a0\u662f Docker \u9ed8\u8ba4\u7684\u8fdc\u7a0b API \u7aef\u53e3\u3002 <pre><code>// 1. \u7f16\u8f91\u914d\u7f6e\u6587\u4ef6\nvim /lib/systemd/system/docker.service\n\n// 2. \u4fee\u6539\u914d\u7f6e\nExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock\nExecStart=/usr/bin/dockerd -H tcp://0.0.0.0:2375 -H fd:// --containerd=/run/containerd/containerd.sock\n\n// 3. \u91cd\u542f\u670d\u52a1\nsystemctl daemon-reload        # \u91cd\u8f7d systemd \u914d\u7f6e\nsystemctl restart docker       # \u91cd\u542f Docker \u670d\u52a1\n</code></pre></li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#74-docker_1","title":"7.4 docker\u5e38\u7528\u547d\u4ee4","text":"<pre><code>\u955c\u50cf\u662f\u7531\u5f88\u591a\u5c42\u7ec4\u6210\u7684\uff0c\u8fd9\u6837\u7684\u597d\u5904\u662f\u5c42\u662f\u516c\u7528\u7684\uff0c\u8fd9\u6837\u4e0b\u8f7d\u5176\u4ed6\u955c\u50cf\u65f6\u53ef\u4ee5\u590d\u7528\u4e4b\u524d\u4e0b\u8f7d\u8fc7\u7684\u5c42\u3002\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1_7","title":"1. \u955c\u50cf\u76f8\u5173","text":"<pre><code>//  \u67e5\u770b\u4e2d\u592e\u4ed3\u5e93\ndocker search \u955c\u50cf\u5173\u952e\u5b57:\u7248\u672c  \n\n// \u67e5\u770b\u672c\u5730\u955c\u50cf\ndocker images -a \n\n// \u62c9\u53d6\u955c\u50cf\ndocker pull \u955c\u50cf\u540d\u79f0:\u7248\u672c\u53f7 \n\n//\u5220\u9664\u955c\u50cf\ndocker rmi --force | -f id/\u955c\u50cf\u540d\u79f0:\u7248\u672c\u53f7 \n\n// \u5220\u9664\u6240\u6709\nddocker rmi -f $(docker images -aq)\n\n// \u4ece\u672c\u5730\u52a0\u8f7d\u955c\u50cf\uff08\u4e5f\u5c31\u662f\u628atar --&gt; \u955c\u50cf\uff09\ndocker load -i xxx.tar  \n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2_8","title":"2. \u5bb9\u5668\u76f8\u5173","text":"<pre><code>// \u67e5\u770b\u5bb9\u5668\ndocker ps -aq\n-a : \u6240\u6709  \u4e0d\u52a0-a\u5c31\u662f\u53ea\u770b\u6b63\u5728\u8fd0\u884c\u65f6\u7684\n-q : \u67e5id\n\n// \u521b\u5efa\u5bb9\u5668\n-i\uff1a\u8868\u793a\u8fd0\u884c\u5bb9\u5668\n-t\uff1a\u8868\u793a\u5bb9\u5668\u542f\u52a8\u540e\u4f1a\u8fdb\u5165\u5176\u547d\u4ee4\u884c\u3002\u52a0\u5165\u8fd9\u4e24\u4e2a\u53c2\u6570\u540e\uff0c\u5bb9\u5668\u521b\u5efa\u5c31\u80fd\u767b\u5f55\u8fdb\u53bb\u3002\u5373\u5206\u914d\u4e00\u4e2a\u4f2a\u7ec8\u7aef\u3002\n--name :\u4e3a\u521b\u5efa\u7684\u5bb9\u5668\u547d\u540d\u3002\n-v\uff1a\u8868\u793a\u76ee\u5f55\u6620\u5c04\u5173\u7cfb\uff08\u524d\u8005\u662f\u5bbf\u4e3b\u673a\u76ee\u5f55\uff0c\u540e\u8005\u662f\u6620\u5c04\u5230\u5bbf\u4e3b\u673a\u4e0a\u7684\u76ee\u5f55\uff09\uff0c\u53ef\u4ee5\u4f7f\u7528\u591a\u4e2a\uff0dv\u505a\u591a\u4e2a\u76ee\u5f55\u6216\u6587\u4ef6\u6620\u5c04\u3002\u6ce8\u610f\uff1a\u6700\u597d\u505a\u76ee\u5f55\u6620\u5c04\uff0c\u5728\u5bbf\u4e3b\u673a\u4e0a\u505a\u4fee\u6539\uff0c\u7136\u540e\u5171\u4eab\u5230\u5bb9\u5668\u4e0a\u3002\n-d\uff1a\u5728run\u540e\u9762\u52a0\u4e0a-d\u53c2\u6570,\u5219\u4f1a\u521b\u5efa\u4e00\u4e2a\u5b88\u62a4\u5f0f\u5bb9\u5668\u5728\u540e\u53f0\u8fd0\u884c\uff08\u8fd9\u6837\u521b\u5efa\u5bb9\u5668\u540e\u4e0d\u4f1a\u81ea\u52a8\u767b\u5f55\u5bb9\u5668\uff0c\u5982\u679c\u53ea\u52a0-i -t\u4e24\u4e2a\u53c2\u6570\uff0c\u521b\u5efa\u540e\u5c31\u4f1a\u81ea\u52a8\u8fdb\u53bb\u5bb9\u5668\uff09\u3002\n-p\uff1a\u8868\u793a\u7aef\u53e3\u6620\u5c04\uff0c\u524d\u8005\u662f\u5bbf\u4e3b\u673a\u7aef\u53e3\uff0c\u540e\u8005\u662f\u5bb9\u5668\u5185\u7684\u6620\u5c04\u7aef\u53e3\u3002\u53ef\u4ee5\u4f7f\u7528\u591a\u4e2a-p\u505a\u591a\u4e2a\u7aef\u53e3\u6620\u5c04\n\n\n\u4ea4\u4e92\u578b\u5bb9\u5668\uff1a\u5177\u6709\u548c\u7528\u6237\u4ea4\u4e92\u7684\u8f93\u5165\u548c\u8f93\u51fa\u7ec8\u7aef\uff0c\u5bb9\u5668\u521b\u5efa\u540e\u81ea\u52a8\u8fdb\u5165\u5bb9\u5668\uff0c\u9996\u6b21\u9000\u51faexit\u5bb9\u5668\u540e\uff0c\u5bb9\u5668\u81ea\u52a8\u5173\u95ed\u3002\n\u5bb9\u5668\u542f\u52a8\u4e86\uff0c\u4f46\u5bb9\u5668\u91cc\u9762\u7684\u7a0b\u5e8f\u6ca1\u81ea\u5df1\u542f\u52a8\n// \u521b\u5efa\u5bb9\u5668\u5e76\u8fdb\u5165\u5b83\u3001\u540c\u65f6\u7528\u7ec8\u7aef\u4e8e\u5b83\u4ea4\u4e92\ndocker run --name \u5bb9\u5668\u540d \u955c\u50cf\u540d:\u7248\u672c\u53f7\neg: docker run -it -p 8888:8080 --name tomcat tomcat /bin/bash\n\n// \u8fdb\u5165\u4ea4\u4e92\u5f0f\u5bb9\u5668\ndocker exec -it \u5bb9\u5668\u540d /bin/bash\n\n// \u521b\u5efa\u5b88\u62a4\u578b\u5bb9\u5668\n\u5b88\u62a4\u578b\u5bb9\u5668\uff1a\u6ca1\u6709\u548c\u7528\u6237\u4ea4\u4e92\u7ec8\u7aef\uff0c\u9700\u8981\u4f7f\u7528docker exec\u8fdb\u5165\u5bb9\u5668\uff0c\u9000\u51fa\u540e\uff0c\u5bb9\u5668\u4e0d\u4f1a\u5173\u95ed\u3002\ndocker run -id --name -p xxxx:xxxx \u955c\u50cf\u540d\uff1a\u7248\u672c\u53f7\n\n\n// \u8fd0\u884c\u5bb9\u5668\ndocker start xxx\n\n// \u505c\u6b62\u5bb9\u5668\ndocker stop xxx\n\n// \u91cd\u542f\u5bb9\u5668\ndocker restart xxx\n\n// \u5220\u9664\u5bb9\u5668     \ndocker rm xxx\n\n// \u5220\u9664\u6240\u6709\u5bb9\u5668\ndocker rm $(docker ps -aq)\n\n// \u8fdb\u5165\u5bb9\u5668\ndocker exec -it xxx /bin/bash \n\n// \u4fee\u6539\u5bb9\u5668\u7684\u4e00\u4e9b\u5c5e\u6027\ndocker update \u5bb9\u5668\u540d \u53c2\u6570 \u53c2\u6570\u503c\neg: docker update xxx --restart alaways\n// \u9000\u51fa\u5bb9\u5668         \nexit\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3_5","title":"3. \u5176\u4ed6\u547d\u4ee4","text":"<ol> <li> <p>\u65e5\u5fd7\u76f8\u5173 <pre><code>// \u67e5\u770b\u5bb9\u5668\u5185\u8fdb\u7a0b\u7684\u65e5\u5fd7\ndocker logs -f \u5bb9\u5668\u540d / id\n\n// \u67e5\u770b\u5bb9\u5668\u8be6\u60c5\u4fe1\u606f\ndocker inspect \u5bb9\u5668\u540d / id\n</code></pre></p> </li> <li> <p>\u5bbf\u4e3b\u673a\u4e0edocker\u5bb9\u5668\u7684\u6587\u4ef6\u4f20\u9012 <pre><code>// \u5bbf\u4e3b\u673a\u7684\u6587\u4ef6\u4e0e\u5bb9\u5668\u8fdb\u884c\u4ea4\u4e92\ndocker cp \u5bbf\u4e3b\u673a\u7684\u6587\u4ef6\u8def\u5f84 \u5bb9\u5668\u540d:\u8981\u62f7\u8d1d\u5230\u8be5\u5bb9\u5668\u7684\u8def\u5f84\n\ndocker \u5bb9\u5668\u540d:\u8981\u62f7\u8d1d\u5230\u8be5\u5bb9\u5668\u7684\u8def\u5f84 cp \u5bbf\u4e3b\u673a\u7684\u6587\u4ef6\u8def\u5f84\n</code></pre></p> </li> <li> <p>\u5907\u4efd\u4e0e\u8fc1\u79fb ![[Pasted image 20251118111513.png]]</p> </li> </ol> <pre><code>// 1. \u5148\u901a\u8fc7\u5bb9\u5668\u53bb\u521b\u5efa\u4e00\u4e2a\u955c\u50cf\ndocker commit \u5bb9\u5668\u540d/id \u955c\u50cf\u540d\neg:docker commit redis01 myredis_image\n// 2. \u628a\u955c\u50cf\u5f52\u7eb3\u6210tar\u5305\ndocker save -o tar\u5305\u7684\u6587\u4ef6\u540d \u955c\u50cf\u540d\u79f0/id\neg:docker save -o ./images/redis_image.tar myredis_image\n\n// 3. \u628atar\u5305\u91cd\u5199\u52a0\u8f7d\u4e3a\u955c\u50cf\ndocker load -i \u955c\u50cftar\u6587\u4ef6\u540d\u79f0\neg: docker load -i /opt/images/\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#75-docker","title":"7.5 docker \u6570\u636e\u5377","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1_8","title":"1. \u6982\u5ff5","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2_9","title":"2. \u6570\u636e\u5377\u76f8\u5173\u547d\u4ee4","text":"<ol> <li> <p>\u67e5\u770b\u6570\u636e\u5377 <pre><code>docker volume ls\ndocker volume inspect \u6570\u636e\u5377\u540d\u79f0\n</code></pre></p> </li> <li> <p>\u521b\u5efa\u6570\u636e\u5377 <pre><code>docker volume create \u6570\u636e\u5377\u540d\u79f0\n</code></pre></p> </li> <li> <p>\u5220\u9664\u6570\u636e\u5377 <pre><code>docker volume rm \u6570\u636e\u5377\u540d\u79f0\n</code></pre></p> </li> <li> <p>\u6570\u636e\u5377\u7684\u6302\u8f7d\uff08\u4e5f\u5c31\u662f\u548c\u54ea\u4e2a\u5bb9\u5668\u7ed1\u5b9a\uff09</p> </li> </ol> <pre><code> docker run -id -p xxx: xxx --name xxx -v \u6570\u636e\u5377\u540d\u5b57:/data redis:7.0.15\n \u89e3\u91ca\uff1a\u6570\u636e\u5377\u540d\u5b57:/data\n /data \u662f\u5bb9\u5668\u5185\u90e8\u7684\u6570\u636e\n\n \u6ce8\uff1a\u5377\u540d\u524d\u9762\u4e0d\u80fd\u6709 / \uff0c\u5982\u679c\u6709/\uff0c\u5c31\u662f\u76ee\u5f55\u6302\u8f7d\uff0c\u8fd9\u6837\u7684\u6302\u8f7d\u65b9\u5f0f\u90fd\u4e0d\u9700\u8981\u521b\u5efa\u5377\u4e86\n\n Docker\u6302\u8f7d\u4e3b\u673a\u76ee\u5f55Docker\u8bbf\u95ee\u51fa\u73b0cannot open directory .: Permission denied\n\u89e3\u51b3\u529e\u6cd5\uff1a\u5728\u6302\u8f7d\u76ee\u5f55\u540e\u591a\u52a0\u4e00\u4e2a--privileged=true\u53c2\u6570\u5373\u53ef\n</code></pre> <p>\u6ce8\u610f\u4e8b\u9879\uff1a</p> <pre><code>1\u3001\u5982\u679c\u6570\u636e\u5377\u6ca1\u6709\u63d0\u524d\u521b\u5efa\u597d\uff0c\u90a3\u4e48\u5728\u521b\u5efa\u5bb9\u5668\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u521b\u5efa\u5bf9\u5e94\u7684\u6570\u636e\u5377\n\n2\u3001\u6570\u636e\u5377\u6302\u8f7d\u7684\u65f6\u5019\u6570\u636e\u5377\u540d\u79f0\u524d\u9762\u6ca1\u6709/*\n\n3\u3001\u5bb9\u5668\u76ee\u5f55\u4e0d\u5b58\u5728\u4f1a\u81ea\u52a8\u521b\u5efa\n\n4\u3001\u6570\u636e\u5377\u76ee\u5f55\u5982\u679c\u4e0d\u4e3a\u7a7a\uff0c\u6b64\u65f6\u4f1a\u4f7f\u7528\u6570\u636e\u5377\u76ee\u5f55\u5185\u5bb9\u8986\u76d6\u5bb9\u5668\u76ee\u5f55\u5185\u5bb9\n\n5\u3001\u6570\u636e\u5377\u76ee\u5f55\u5982\u679c\u4e3a\u7a7a\uff0c\u5bb9\u5668\u76ee\u5f55\u4e0d\u4e3a\u7a7a\uff0c\u6b64\u65f6\u5c31\u4f1a\u4f7f\u7528\u5bb9\u5668\u76ee\u5f55\u5185\u5bb9\u8986\u76d6\u6570\u636e\u5377\u76ee\u5f55\n</code></pre> <ol> <li>\u76ee\u5f55\u6302\u8f7d <pre><code>docker run -d --name=redis02 -p 6380:6379 -v /redis-data:/data redis:7.0.10\n</code></pre></li> </ol> <p>\u6ce8\u610f\u4e8b\u9879\uff1a</p> <pre><code>1\u3001\u5982\u679c\u5bbf\u4e3b\u673a\u76ee\u5f55\u6ca1\u6709\u63d0\u524d\u521b\u5efa\u597d\uff0c\u90a3\u4e48\u5728\u521b\u5efa\u5bb9\u5668\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u521b\u5efa\u5bf9\u5e94\u7684\u5bbf\u4e3b\u673a\u76ee\u5f55\n\n2\u3001\u5bbf\u4e3b\u673a\u76ee\u5f55\u6302\u8f7d\u7684\u65f6\u5019\u5bbf\u4e3b\u673a\u76ee\u5f55\u540d\u79f0\u524d\u9762\u6709/\n\n3\u3001\u5bb9\u5668\u76ee\u5f55\u4e0d\u5b58\u5728\u4f1a\u81ea\u52a8\u521b\u5efa\n\n4\u3001\u5bbf\u4e3b\u673a\u76ee\u5f55\u5982\u679c\u4e0d\u4e3a\u7a7a\uff0c\u6b64\u65f6\u4f1a\u4f7f\u7528\u5bbf\u4e3b\u673a\u76ee\u5f55\u5185\u5bb9\u8986\u76d6\u5bb9\u5668\u76ee\u5f55\u5185\u5bb9\n\n5\u3001\u5bbf\u4e3b\u673a\u76ee\u5f55\u5982\u679c\u4e3a\u7a7a\uff0c\u5bb9\u5668\u76ee\u5f55\u4e0d\u4e3a\u7a7a\uff0c\u6b64\u65f6\u5c31\u4f1a\u5c06\u5bb9\u5668\u76ee\u5f55\u5185\u5bb9\u6e05\u7a7a\u6389 \u6ce8\u610f!!!!!\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#76","title":"7.6 \u9879\u76ee\u90e8\u7f72","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1-dockerfile","title":"1. dockerfile","text":"<pre><code>Dockerfile \u662f\u4e00\u4e2a\u6587\u672c\u6587\u4ef6\uff0c\u5305\u542b\u4e00\u7cfb\u5217\u6307\u4ee4\uff08instructions\uff09\uff0c\u7528\u4e8e\u81ea\u52a8\u6784\u5efa Docker \u955c\u50cf\u3002Docker \u5f15\u64ce\u4f1a\u6309\u987a\u5e8f\u6267\u884c\u8fd9\u4e9b\u6307\u4ee4\uff0c\u6700\u7ec8\u751f\u6210\u4e00\u4e2a\u53ef\u8fd0\u884c\u7684\u955c\u50cf\u3002\n</code></pre> <p>\uff081\uff09FROM \u2014\u2014 \u6307\u5b9a\u57fa\u7840\u955c\u50cf</p> <ul> <li>\u4f5c\u7528\uff1a\u5b9a\u4e49\u6784\u5efa\u65b0\u955c\u50cf\u6240\u57fa\u4e8e\u7684\u7236\u955c\u50cf\uff08\u57fa\u7840\u955c\u50cf\uff09\u3002</li> <li>\u6240\u6709 Dockerfile\u00a0\u5fc5\u987b\u4ee5\u00a0FROM\u00a0\u5f00\u5934\uff08\u6ce8\u91ca\u548c\u7a7a\u884c\u9664\u5916\uff09\u3002</li> <li>centos:7\u00a0\u8868\u793a\u4f7f\u7528\u5b98\u65b9\u4ed3\u5e93\u4e2d\u7684 CentOS 7 \u955c\u50cf\u4f5c\u4e3a\u8d77\u70b9\u3002</li> <li>\u5982\u679c\u4f60\u4e0d\u9700\u8981\u64cd\u4f5c\u7cfb\u7edf\u5c42\uff0c\u4e5f\u53ef\u4ee5\u7528\u00a0scratch`\uff08\u7a7a\u955c\u50cf\uff09\uff0c\u4f46\u4e00\u822c\u7528\u4e8e\u6781\u7b80\u573a\u666f\u3002</li> </ul> <pre><code>FROM centos:7\n</code></pre> <p>\uff082\uff09<code>MAINTAINER</code>\uff08\u5df2\u5f03\u7528\uff0c\u5efa\u8bae\u7528\u00a0<code>LABEL</code>\uff09</p> <pre><code>LABEL maintainer=\"atguigu@example.com\"\n</code></pre> <p>\uff083\uff09<code>RUN</code>\u00a0\u2014\u2014 \u5728\u955c\u50cf\u4e2d\u6267\u884c\u547d\u4ee4</p> <ul> <li>\u4f5c\u7528\uff1a\u5728\u6784\u5efa\u8fc7\u7a0b\u4e2d\u521b\u5efa\u65b0\u7684\u955c\u50cf\u5c42\uff0c\u5e76\u6267\u884c shell \u547d\u4ee4\u3002</li> <li>\u6bcf\u4e2a\u00a0<code>RUN</code>\u00a0\u4f1a\u751f\u6210\u4e00\u5c42\uff08layer\uff09\uff0c\u5efa\u8bae\u5408\u5e76\u591a\u4e2a\u547d\u4ee4\u4ee5\u51cf\u5c11\u5c42\u6570\uff08\u7528\u00a0<code>&amp;&amp;</code>\u00a0\u8fde\u63a5\uff09\uff1a <pre><code>RUN mkdir -p /usr/local/java &amp;&amp; yum update -y\n</code></pre></li> </ul> <p>\uff084\uff09ADD \u2014\u2014  \u590d\u5236\u6587\u4ef6/\u89e3\u538b/\u4e0b\u8f7d</p> <ul> <li>\u5c06\u672c\u5730\u6587\u4ef6\uff08\u5982\u00a0<code>.tar.gz</code>\uff09\u590d\u5236\u5230\u955c\u50cf\u4e2d\u3002</li> <li>\u81ea\u52a8\u89e3\u538b <code>.tar</code>,\u00a0<code>.tar.gz</code>,\u00a0<code>.zip</code>\u00a0\u7b49\u538b\u7f29\u5305\uff08\u4ec5\u9650\u672c\u5730\u8def\u5f84\uff09\u3002</li> <li>\u4e5f\u652f\u6301\u4ece URL \u4e0b\u8f7d\u6587\u4ef6\uff08\u4f46\u4e0d\u63a8\u8350\uff0c\u5efa\u8bae\u7528\u00a0<code>curl</code>\u00a0+\u00a0<code>RUN</code>\u00a0\u66f4\u53ef\u63a7\uff09\u3002</li> </ul> <pre><code>ADD jdk-17_linux-x64_bin.tar.gz /usr/local/java/\n</code></pre> <p>\uff085\uff09 ENV\u00a0\u2014\u2014 \u8bbe\u7f6e\u73af\u5883\u53d8\u91cf</p> <p>\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\uff0c\u540e\u7eed\u7684\u00a0<code>RUN</code>\u3001\u5bb9\u5668\u542f\u52a8\u65f6\u90fd\u53ef\u7528\u3002 <pre><code>ENV JAVA_HOME=/usr/local/java/jdk-17.0.7\nENV PATH=$PATH:$JAVA_HOME/bin\n\n// \u53ef\u4ee5\u5199\u6210\u4e00\u884c\nENV JAVA_HOME=/usr/local/java/jdk-17.0.7 \\\n    PATH=$PATH:$JAVA_HOME/bin\n</code></pre></p> <p>\uff086\uff09 \u5176\u4ed6\u6307\u4ee4\uff1a</p> \u6307\u4ee4 \u8bf4\u660e <code>WORKDIR</code> \u8bbe\u7f6e\u5de5\u4f5c\u76ee\u5f55\uff08\u7c7b\u4f3c\u00a0<code>cd</code>\uff09\uff0c\u540e\u7eed\u00a0<code>RUN</code>/<code>CMD</code>\u00a0\u5728\u6b64\u76ee\u5f55\u6267\u884c <code>COPY</code> \u4ec5\u590d\u5236\u6587\u4ef6\uff08\u4e0d\u89e3\u538b\uff09\uff0c\u6bd4\u00a0<code>ADD</code>\u00a0\u66f4\u660e\u786e <code>EXPOSE</code> \u58f0\u660e\u5bb9\u5668\u8fd0\u884c\u65f6\u76d1\u542c\u7684\u7aef\u53e3\uff08\u5982\u00a0<code>8080</code>\uff09\uff0c\u4ec5\u4e3a\u6587\u6863\u7528\u9014\uff0c\u9700\u914d\u5408\u00a0<code>-p</code>\u00a0\u6620\u5c04 <code>CMD</code> \u5bb9\u5668\u542f\u52a8\u65f6\u9ed8\u8ba4\u6267\u884c\u7684\u547d\u4ee4\uff08\u53ef\u88ab\u00a0<code>docker run</code>\u00a0\u540e\u53c2\u6570\u8986\u76d6\uff09 <code>ENTRYPOINT</code> \u5bb9\u5668\u4e3b\u547d\u4ee4\uff0c\u4e0e\u00a0<code>CMD</code>\u00a0\u914d\u5408\u4f7f\u7528\uff0c\u4e0d\u6613\u88ab\u8986\u76d6"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2_10","title":"2. \u6784\u5efa\u8fc7\u7a0b","text":"<ol> <li> <p>\u7f16\u5199dockerfile <pre><code># \u4f7f\u7528 CentOS 7 \u4f5c\u4e3a\u57fa\u7840\u955c\u50cf \nFROM centos:7 \n\n# \u6807\u6ce8\u7ef4\u62a4\u8005\uff08\u63a8\u8350\u7528 LABEL\uff09 \nLABEL maintainer=\"atguigu\" \n\n# \u521b\u5efa Java \u5b89\u88c5\u76ee\u5f55 \nRUN mkdir -p /usr/local/java \n\n# \u5c06\u672c\u5730 JDK \u538b\u7f29\u5305\u6dfb\u52a0\u5e76\u81ea\u52a8\u89e3\u538b\u5230\u6307\u5b9a\u76ee\u5f55 ADD jdk-17_linux-x64_bin.tar.gz /usr/local/java/ \n\n# \u8bbe\u7f6e\u73af\u5883\u53d8\u91cf \nENV JAVA_HOME=/usr/local/java/jdk-17.0.7 \nENV PATH=$PATH:$JAVA_HOME/bin # \n\n\uff08\u53ef\u9009\uff09\u9a8c\u8bc1 Java \u5b89\u88c5 \nRUN java -version\n</code></pre></p> </li> <li> <p>\u6784\u5efa\u955c\u50cf <pre><code>docker build -t centos7-jdk17 .\n</code></pre></p> </li> <li> <p><code>-t</code>\uff1a\u6307\u5b9a\u955c\u50cf\u540d\u79f0\u548c\u6807\u7b7e</p> </li> <li><code>.</code>\uff1a\u8868\u793a\u5f53\u524d\u76ee\u5f55\u4e3a\u6784\u5efa\u4e0a\u4e0b\u6587\uff08Dockerfile \u548c JDK \u5305\u5fc5\u987b\u5728\u6b64\uff09</li> </ol> <p>#### 7.7 \u4e00\u4e9b\u5e38\u7528\u5bb9\u5668\u7684\u4e0b\u8f7d\u4e0e\u542f\u52a8</p> <p>1\uff09mysql</p> <pre><code>// \u521b\u5efa\u4e00\u4e2a\u5bb9\u5668\ndocker run -di --name=mysql -p 3306:3306 -v mysql_data:/var/lib/mysql -v mysql_conf:/etc/mysql -e MYSQL_ROOT_PASSWORD=liuqiang mysql:8.0.30\n\n\n// \u4e4b\u540e\uff0c\u8fdb\u5165\u8be5\u5bb9\u5668\uff0c\u8bb0\u5f97\u8bbe\u7f6e\u7f16\u7801\u683c\u5f0f\uff0c\u5426\u5219\u4e2d\u6587\u53ef\u80fd\u4e71\u7801\ndocker exec -it -e LANG=C.UTF-8 mysql bash\n</code></pre> <p>2\uff09rabbitmq <pre><code># -d \u53c2\u6570\uff1a\u540e\u53f0\u8fd0\u884c Docker \u5bb9\u5668\n# --name \u53c2\u6570\uff1a\u8bbe\u7f6e\u5bb9\u5668\u540d\u79f0\n# -p \u53c2\u6570\uff1a\u6620\u5c04\u7aef\u53e3\u53f7\uff0c\u683c\u5f0f\u662f\u201c\u5bbf\u4e3b\u673a\u7aef\u53e3\u53f7:\u5bb9\u5668\u5185\u7aef\u53e3\u53f7\u201d\u30025672\u4f9b\u5ba2\u6237\u7aef\u7a0b\u5e8f\u8bbf\u95ee\uff0c15672\u4f9b\u540e\u53f0\u7ba1\u7406\u754c\u9762\u8bbf\u95ee\n# -v \u53c2\u6570\uff1a\u5377\u6620\u5c04\u76ee\u5f55\n# -e \u53c2\u6570\uff1a\u8bbe\u7f6e\u5bb9\u5668\u5185\u7684\u73af\u5883\u53d8\u91cf\uff0c\u8fd9\u91cc\u6211\u4eec\u8bbe\u7f6e\u4e86\u767b\u5f55RabbitMQ\u7ba1\u7406\u540e\u53f0\u7684\u9ed8\u8ba4\u7528\u6237\u548c\u5bc6\u7801\ndocker run -d \\\n--name rabbitmq \\\n-p 5672:5672 \\\n-p 15672:15672 \\\n-v rabbitmq-plugin:/plugins \\\n-e RABBITMQ_DEFAULT_USER=root \\\n-e RABBITMQ_DEFAULT_PASS=liuqiang \\\nrabbitmq:3.12.0-management\n\n\n// \u7136\u540e\uff0c\u628a\u63d2\u4ef6\u4e0a\u4f20\u5230\u6570\u636e\u5377\u540e\uff0c\u542f\u52a8\u63d2\u4ef6\u5373\u53ef\nrabbitmq-plugins enable rabbitmq_delayed_message_exchange\n</code></pre></p> <p>3\uff09nacos <pre><code># \u62c9\u53d6\u955c\u50cf\ndocker pull nacos/nacos-server:v2.1.1\n\n# \u521b\u5efa\u5bb9\u5668\ndocker run --name nacos -e MODE=standalone -p 8848:8848 -p 9848:9848 -d nacos/nacos-server:v2.1.1\n\n# nacos2.x\u7684\u7248\u672c\u65b0\u589e\u4e86\u4e00\u4e2a\u5ba2\u6237\u7aef\u4e0e\u670d\u52a1\u7aef\u7684gRpc\u7684\u901a\u8baf\u7aef\u53e3\u53f79848\n</code></pre></p> <p>4\uff09redis <pre><code>1. \u521b\u5efaredis\u6570\u636e\u5b58\u653e\u4ee5\u53ca\u914d\u7f6e\u6587\u4ef6\n\nmkdir\u00a0-p /mydata/redis/conf /mydata/redis/data\ntouch\u00a0/mydata/redis/conf/redis.conf\n\n2. \u8fd0\u884credis\ndocker run -d \\\n--name redis \\\n-p 6379:6379 \\\n-v /root/mydata/redis/data:/data \\\n-v /root/mydata/redis/conf/redis.conf:/etc/redis/redis.conf \\\nredis:7.0.15 redis-server /etc/redis/redis.conf\n\n3. \u8fdb\u5165redis-cli\u6d4b\u8bd5\ndocker\u00a0exec\u00a0-it redis redis-cli\n</code></pre></p> <p>5\uff09minio <pre><code>docker pull minio/minio\n\n\ndocker run \\\n-p 9000:9000 \\\n-p 9001:9001 \\\n--name=spzx_minio \\\n-d --restart=always \\\n-e \"MINIO_ROOT_USER=minioadmin\" \\\n-e \"MINIO_ROOT_PASSWORD=minioadmin\" \\\n-v spzx_minio-data:/data \\\n-v spzx_minio-config:/root/.minio \\\nminio/minio server /data --console-address \":9001\"\n</code></pre></p> <p>6\uff09nginx <pre><code>docker pull nginx\n\ndocker run -d --name=spzx_nginx -p 80:80 -v nginx_conf:/etc/nginx -v nginx_html:/usr/share/nginx/html -v nginx_logs:/var/log/nginx nginx\n</code></pre></p> <p>7\uff09sentinel \u9ed8\u8ba48080 <pre><code>docker pull bladex/sentinel-dashboard:latest\n\ndocker run --name=sentinel-dashboard --restart=always -p 8858:8858 -d bladex/sentinel-dashboard:latest\n</code></pre></p> <p>8\uff09elasticsearch</p> <p>[[#11 ElasticSearch#2.1 ElasticSearch \u7684\u5b89\u88c5]]</p> <p>9\uff09portainer <pre><code>\u6b65\u9aa4 1\uff1a\u62c9\u53d6 Portainer \u82f1\u6587\u7248\ndocker pull portainer/portainer-ce:latest\n\n\u6b65\u9aa4 2\uff1a\u542f\u52a8 Portainer\ndocker run -d --name portainer -p 19000:9000 -v /var/run/docker.sock:/var/run/docker.sock -v /app/portainer_data:/data --restart always --privileged=true portainer/portainer-ce:latest\n\n\u6b65\u9aa4 3\uff1a\u8bbf\u95ee Portainer Web \u754c\u9762\nhttp://115.190.231.171:19000/\n</code></pre></p> <p>10\uff09zipkin <pre><code>docker pull openzipkin/zipkin\n\ndocker run --name zipkin --restart=always -d -p 9411:9411 openzipkin/zipkin\n</code></pre></p> <p>11\uff09canal <pre><code>\n</code></pre></p> <p>12\uff09mdb [[#12 MongoDB]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#78-docker-compose","title":"7.8 docker compose","text":"<p>\u6279\u91cf\u7ba1\u7406\u5bb9\u5668  \u662fdocker\u5185\u7f6e\u7684\u63d2\u4ef6</p> <pre><code># \u542f\u52a8\u5bb9\u5668(\u5982\u679c\u4e0d\u5b58\u5728\u5bb9\u5668\u5c31\u521b\u5efa\u3001\u5b58\u5728\u5219\u4fee\u6539)\ndocker compose -f docker-compose.yml up -d\n\n# \u5220\u9664\u6240\u6709\u5bb9\u5668\ndocker compose -f docker-compose.yml down\n\n# \u505c\u6b62\u6240\u6709\u5bb9\u5668\ndocker compose -f docker-compose.yml stop\n\n# \u542f\u52a8\u6240\u6709\u5bb9\u5668\ndocker compose -f docker-compose.yml start\n\n# \u91cd\u542f\u6240\u6709\u5bb9\u5668\ndocker compose -f docker-compose.yml restart\n</code></pre> <p>compose \u7ba1\u7406\u591a\u4e2a\u5bb9\u5668\u7684 yml \u914d\u7f6e <pre><code>\u5bb9\u5668\u7f16\u6392\uff1adocker-compose.yml\n---------------------------------------------\nservices:\n  redis:\n    image: redis:7.0.10\n    container_name: redis001\n    ports:\n      - \"6399:6379\"\n    volumes: \n      - redis-data:/data\n  mysql:\n    container_name: mysql001\n    image: mysql:8.0.30\n    ports:\n      - \"3399:3306\"\n    volumes:\n      - mysql_data:/var/lib/mysql\n      - mysql_conf:/etc/mysql\n    privileged: true\n    environment:\n      - \"MYSQL_ROOT_PASSWORD=1234\"\n  ebuy:\n    container_name: ebuy001\n    image: ebuy-docker:v2.0\n    ports:\n      - \"8099:8081\"\nvolumes:\n  redis-data: {}\n  mysql_data: {}\n  mysql_conf: {}\n---------------------------------------------\n</code></pre></p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#rabbitmq-5672","title":"\u516b RabbitMQ  (5672)","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#81-rabbitmq","title":"8.1 RabbitMQ \u4ecb\u7ecd","text":"<p>![[Pasted image 20251118154521.png]]</p> <p>RabbitMQ\u662f\u7531erlang\u8bed\u8a00\u5f00\u53d1\uff0c\u57fa\u4e8eAMQP\uff08Advanced Message Queue \u9ad8\u7ea7\u6d88\u606f\u961f\u5217\u534f\u8bae\uff09\u534f\u8bae\u5b9e\u73b0\u7684\u6d88\u606f\u961f\u5217\uff0c\u5b83\u662f\u4e00\u79cd\u5e94\u7528\u7a0b\u5e8f\u4e4b\u95f4\u7684\u901a\u4fe1\u65b9\u6cd5\uff0c\u6d88\u606f\u961f\u5217\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u5f00\u53d1\u4e2d\u5e94\u7528\u975e\u5e38\u5e7f\u6cdb\u3002</p> <p>AMQP\uff0c\u5373 Advanced Message Queuing Protocol\uff08\u9ad8\u7ea7\u6d88\u606f\u961f\u5217\u534f\u8bae\uff09\uff0c\u662f\u4e00\u4e2a\u7f51\u7edc\u534f\u8bae\uff0c\u662f\u5e94\u7528\u5c42\u534f\u8bae\u7684\u4e00\u4e2a\u5f00\u653e\u6807\u51c6\uff0c\u4e3a\u9762\u5411\u6d88\u606f\u7684\u4e2d\u95f4\u4ef6\u8bbe\u8ba1\u3002\u57fa\u4e8e\u6b64\u534f\u8bae\u7684\u5ba2\u6237\u7aef\u4e0e\u6d88\u606f\u4e2d\u95f4\u4ef6\u53ef\u4f20\u9012\u6d88\u606f\uff0c\u5e76\u4e0d\u53d7\u5ba2\u6237\u7aef/\u4e2d\u95f4\u4ef6\u4e0d\u540c\u4ea7\u54c1\uff0c\u4e0d\u540c\u7684\u5f00\u53d1\u8bed\u8a00\u7b49\u6761\u4ef6\u7684\u9650\u5236\u30022006\u5e74\uff0cAMQP \u89c4\u8303\u53d1\u5e03\u3002\u7c7b\u6bd4HTTP\u3002</p> <p>2007\u5e74\uff0cRabbit \u6280\u672f\u516c\u53f8\u57fa\u4e8e AMQP \u6807\u51c6\u5f00\u53d1\u7684 RabbitMQ 1.0 \u53d1\u5e03\u3002RabbitMQ \u91c7\u7528 Erlang \u8bed\u8a00\u5f00\u53d1\u3002Erlang \u8bed\u8a00\u7531 Ericson \u8bbe\u8ba1\uff0c\u4e13\u95e8\u4e3a\u5f00\u53d1\u9ad8\u5e76\u53d1\u548c\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u4e00\u79cd\u8bed\u8a00\uff0c\u5728\u7535\u4fe1\u9886\u57df\u4f7f\u7528\u5e7f\u6cdb\u3002</p> <p>RabbitMQ\u5b98\u65b9\u5730\u5740\uff1ahttp://www.rabbitmq.com/</p> <p>RabbitMQ\u63d0\u4f9b\u4e86\u591a\u79cd\u5de5\u4f5c\u6a21\u5f0f\uff1a\u7b80\u5355\u6a21\u5f0f\uff0cwork\u6a21\u5f0f \uff0cPublish/Subscribe\u53d1\u5e03\u4e0e\u8ba2\u9605\u6a21\u5f0f\uff0cRouting\u8def\u7531\u6a21\u5f0f\uff0cTopics\u4e3b\u9898\u6a21\u5f0f\u7b49</p> <p>![[Pasted image 20251118154557.png]]</p> <p>\u5b98\u7f51\u5bf9\u5e94\u6a21\u5f0f\u4ecb\u7ecd\uff1ahttps://www.rabbitmq.com/getstarted.html</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#82","title":"8.2 \u6d88\u606f\u961f\u5217\u7684\u529f\u80fd","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1_9","title":"1.\u89e3\u8026\u670d\u52a1","text":"<ul> <li>\u4ee5\u4e0b\u5355\u529f\u80fd\u4e3a\u4f8b\uff0c\u5982\u4e0b\u56fe\uff0c\u5b58\u5728\u529f\u80fd\u8026\u5408\u5ea6\u9ad8\u7684\u95ee\u9898\u3002</li> <li>\u7528\u6237\u4e0b\u5355\uff0c\u9700\u8981\u4fdd\u5b58\u8ba2\u5355\uff0c\u66f4\u65b0\u8d2d\u7269\u8f66\uff0c\u66f4\u65b0\u5e93\u5b58\uff0c\u8fd8\u8981\u66f4\u65b0\u79ef\u5206\uff0c\u5982\u679c\u5728\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\uff0c\u6709\u4efb\u4f55\u4e00\u4e2a\u73af\u8282\u5931\u8d25\u4e86\uff0c\u6700\u7ec8\u4f1a\u5bfc\u81f4\u64cd\u4f5c\u5931\u8d25\uff0c\u8fd4\u56de\u9519\u8bef\u4fe1\u606f ![[Pasted image 20251118151250.png]]</li> <li>\u800c\u91c7\u7528\u6d88\u606f\u961f\u5217\u65b9\u5f0f\uff0c\u53ef\u4ee5\u5f88\u597d\u7684\u89e3\u51b3\u8026\u5408\u5ea6\u8fc7\u9ad8\u95ee\u9898 ![[Pasted image 20251118151309.png]]</li> </ul>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2_11","title":"2. \u5f02\u6b65\u5904\u7406","text":"<p>\u573a\u666f\u8bf4\u660e\uff1a\u7528\u6237\u6ce8\u518c\u540e\uff0c\u9700\u8981\u53d1\u6ce8\u518c\u90ae\u4ef6\u548c\u6ce8\u518c\u77ed\u4fe1\uff0c\u4f20\u7edf\u7684\u505a\u6cd5\u6709\u4e24\u79cd - \u4e32\u884c\u7684\u65b9\u5f0f - \u5e76\u884c\u7684\u65b9\u5f0f</p> <p>(1) \u4e32\u884c\u65b9\u5f0f\uff1a 150ms</p> <p>\u5c06\u6ce8\u518c\u4fe1\u606f\u5199\u5165\u6570\u636e\u5e93\u540e\uff0c\u53d1\u9001\u6ce8\u518c\u90ae\u4ef6\uff0c\u518d\u53d1\u9001\u6ce8\u518c\u77ed\u4fe1\uff0c\u4ee5\u4e0a\u4e09\u4e2a\u4efb\u52a1\u5168\u90e8\u5b8c\u6210\u540e\u624d\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002 \u8fd9\u6709\u4e00\u4e2a\u95ee\u9898\u662f\uff0c\u90ae\u4ef6\uff0c\u77ed\u4fe1\u5e76\u4e0d\u662f\u5fc5\u987b\u7684\uff0c\u5b83\u53ea\u662f\u4e00\u4e2a\u901a\u77e5\uff0c\u800c\u8fd9\u79cd\u505a\u6cd5\u8ba9\u5ba2\u6237\u7aef\u7b49\u5f85\u6ca1\u6709\u5fc5\u8981\u7b49\u5f85\u7684\u4e1c\u897f\u3002</p> <p>(2) \u5e76\u884c\u65b9\u5f0f\uff1a 100ms</p> <p>\u5c06\u6ce8\u518c\u4fe1\u606f\u5199\u5165\u6570\u636e\u5e93\u540e\uff0c\u53d1\u9001\u90ae\u4ef6\u7684\u540c\u65f6\uff0c\u53d1\u9001\u77ed\u4fe1\uff0c\u4ee5\u4e0a\u4e09\u4e2a\u4efb\u52a1\u5b8c\u6210\u540e\uff0c\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\uff0c\u5e76\u884c\u7684\u65b9\u5f0f\u80fd\u63d0\u9ad8\u5904\u7406\u7684\u65f6\u95f4\u3002</p> <p>(3) \u6d88\u606f\u961f\u5217\uff1a55ms \u5f15\u5165\u6d88\u606f\u961f\u5217\u540e\uff0c\u628a\u53d1\u9001\u90ae\u4ef6\uff0c\u77ed\u4fe1\u4e0d\u662f\u5fc5\u987b\u7684\u4e1a\u52a1\u903b\u8f91\u5f02\u6b65\u5904\u7406</p> <p>![[Pasted image 20251118152112.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3_6","title":"3. \u6d41\u91cf\u524a\u5cf0","text":"<p>\u573a\u666f\uff1a \u79d2\u6740\u6d3b\u52a8\uff0c\u4e00\u822c\u4f1a\u56e0\u4e3a\u6d41\u91cf\u8fc7\u5927\uff0c\u5bfc\u81f4\u5e94\u7528\u6302\u6389\uff0c\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u4e00\u822c\u5728\u5e94\u7528\u524d\u7aef\u52a0\u5165 \u6d88\u606f\u961f\u5217\u3002</p> <p>\u4e2d\u95f4\u4ef6\u6a21\u5f0f\uff1a \u6d88\u606f\u88abMQ\u4fdd\u5b58\u8d77\u6765\u4e86 \uff0c\u7136\u540e\u7cfb\u7edf\u5c31\u53ef\u4ee5\u6309\u7167\u81ea\u5df1\u7684\u6d88\u8d39\u80fd\u529b\u6765\u6d88\u8d39\uff0c\u6bd4\u5982\u6bcf\u79d21000\u4e2a\u6570\u636e\uff0c\u8fd9\u6837\u6162\u6162\u5199\u5165\u6570\u636e\u5e93\uff0c\u8fd9\u6837\u5c31\u4e0d\u4f1a\u5361\u6b7b\u6570\u636e\u5e93\u4e86\u3002</p> <p>\u6d41\u91cf\u524a\u5cf0\u4e5f\u53eb\u505a\u524a\u5cf0\u586b\u8c37 ![[Pasted image 20251118153111.png]] \u4f7f\u7528\u4e86MQ\u4e4b\u540e\uff0c\u9650\u5236\u6d88\u8d39\u6d88\u606f\u7684\u901f\u5ea6\u4e3a1000\uff0c\u4f46\u662f\u8fd9\u6837\u4e00\u6765\uff0c\u9ad8\u5cf0\u671f\u4ea7\u751f\u7684\u6570\u636e\u52bf\u5fc5\u4f1a\u88ab\u79ef\u538b\u5728MQ\u4e2d\uff0c\u9ad8\u5cf0\u5c31\u88ab\u201c\u524a\u201d\u6389\u4e86\u3002\u4f46\u662f\u56e0\u4e3a\u6d88\u606f\u79ef\u538b\uff0c\u5728\u9ad8\u5cf0\u671f\u8fc7\u540e\u7684\u4e00\u6bb5\u65f6\u95f4\u5185\uff0c\u6d88\u8d39\u6d88\u606f\u7684\u901f\u5ea6\u8fd8\u662f\u4f1a\u7ef4\u6301\u5728 3\u6d88\u8d39\u5b8c\u79ef\u538b\u7684\u6d88\u606f\uff0c\u8fd9\u5c31\u53eb\u505a\u201c\u586b\u8c37\u201d</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#83-amqp-jms","title":"8.3 AMQP \u4ee5\u53ca JMS","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1-amqp","title":"1. AMQP","text":"<p>AMQP\u662f\u4e00\u79cd**\u9ad8\u7ea7\u6d88\u606f\u961f\u5217\u534f\u8bae\uff08Advanced Message Queuing Protocol\uff09\uff0c\u66f4\u51c6\u786e\u7684\u8bf4\u662f\u4e00\u79cdbinary wire-level protocol\uff08\u94fe\u63a5\u534f\u8bae\uff09\u3002\u8fd9\u662f\u5176\u548cJMS\u7684\u672c\u8d28\u5dee\u522b\uff0cAMQP\u4e0d\u4eceAPI\u5c42\u8fdb\u884c\u9650\u5b9a\uff0c\u800c\u662f\u76f4\u63a5\u5b9a\u4e49\u7f51\u7edc\u4ea4\u6362\u7684\u6570\u636e\u683c\u5f0f\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2-jms","title":"2. JMS","text":"<p>JMS\u5373Java\u6d88\u606f\u670d\u52a1\uff08JavaMessage Service\uff09\u5e94\u7528\u7a0b\u5e8f\u63a5\u53e3\uff0c\u662f\u4e00\u4e2aJava\u5e73\u53f0\u4e2d\u5173\u4e8e\u9762\u5411\u6d88\u606f\u4e2d\u95f4\u4ef6\uff08MOM\uff09\u7684API\uff0c\u7528\u4e8e\u5728\u4e24\u4e2a\u5e94\u7528\u7a0b\u5e8f\u4e4b\u95f4\uff0c\u6216\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u53d1\u9001\u6d88\u606f\uff0c\u8fdb\u884c\u5f02\u6b65\u901a\u4fe1\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3-amqp-jms","title":"3. AMQP \u4e0e JMS \u533a\u522b","text":"<p>\u00b7 JMS\u662f\u5b9a\u4e49\u4e86\u7edf\u4e00\u7684\u63a5\u53e3\uff0c\u6765\u5bf9\u6d88\u606f\u64cd\u4f5c\u8fdb\u884c\u7edf\u4e00\uff1bAMQP\u662f\u901a\u8fc7\u89c4\u5b9a\u534f\u8bae\u6765\u7edf\u4e00\u6570\u636e\u4ea4\u4e92\u7684\u683c\u5f0f</p> <p>\u00b7 JMS\u9650\u5b9a\u4e86\u5fc5\u987b\u4f7f\u7528Java\u8bed\u8a00\uff1bAMQP\u53ea\u662f\u534f\u8bae\uff0c\u4e0d\u89c4\u5b9a\u5b9e\u73b0\u65b9\u5f0f\uff0c\u56e0\u6b64\u662f\u8de8\u8bed\u8a00\u7684\u3002</p> <p>\u00b7 JMS\u89c4\u5b9a\u4e86\u4e24\u79cd\u6d88\u606f\u6a21\u5f0f\uff1b\u800cAMQP\u7684\u6d88\u606f\u6a21\u5f0f\u66f4\u52a0\u4e30\u5bcc</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#84-docker","title":"8.4 docker \u955c\u50cf\u4e0b\u8f7d","text":"<pre><code>    docker pull rabbitmq:3.12-management\n</code></pre> <p>\u521b\u5efa\u542f\u52a8\u5bb9\u5668 5672 \uff1a\u6807\u51c6\u7aef\u53e3\u53f7 15672\uff08\u540e\u53f0\u7ba1\u7406\u7684\u7aef\u53e3\u53f7\uff09 <pre><code># -d \u53c2\u6570\uff1a\u540e\u53f0\u8fd0\u884c Docker \u5bb9\u5668\n# --name \u53c2\u6570\uff1a\u8bbe\u7f6e\u5bb9\u5668\u540d\u79f0\n# -p \u53c2\u6570\uff1a\u6620\u5c04\u7aef\u53e3\u53f7\uff0c\u683c\u5f0f\u662f\u201c\u5bbf\u4e3b\u673a\u7aef\u53e3\u53f7:\u5bb9\u5668\u5185\u7aef\u53e3\u53f7\u201d\u30025672\u4f9b\u5ba2\u6237\u7aef\u7a0b\u5e8f\u8bbf\u95ee\uff0c15672\u4f9b\u540e\u53f0\u7ba1\u7406\u754c\u9762\u8bbf\u95ee\n# -v \u53c2\u6570\uff1a\u5377\u6620\u5c04\u76ee\u5f55\n# -e \u53c2\u6570\uff1a\u8bbe\u7f6e\u5bb9\u5668\u5185\u7684\u73af\u5883\u53d8\u91cf\uff0c\u8fd9\u91cc\u6211\u4eec\u8bbe\u7f6e\u4e86\u767b\u5f55RabbitMQ\u7ba1\u7406\u540e\u53f0\u7684\u9ed8\u8ba4\u7528\u6237\u548c\u5bc6\u7801\ndocker run -d \\\n--name rabbitmq \\\n-p 5672:5672 \\\n-p 15672:15672 \\\n-v rabbitmq-plugin:/plugins \\\n-e RABBITMQ_DEFAULT_USER=root \\\n-e RABBITMQ_DEFAULT_PASS=liuqiang \\\nrabbitmq:3.12-management\n</code></pre></p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#85-springboot-rabbitmq","title":"8.5 springboot \u96c6\u6210 rabbitMQ","text":"<ol> <li> <p>\u76f4\u63a5\u5bfc\u5165\u542f\u52a8\u5668\u5373\u53ef <pre><code>&lt;dependencies&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-amqp&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n&lt;/dependencies&gt;\n</code></pre></p> </li> <li> <p>\u53bb\u5199yaml\u914d\u7f6e\u6587\u4ef6 <pre><code>spring: \n  rabbitmq: \n    host: 192.168.47.100\n    port: 5672 \n    username: guest \n    password: 123456 \n    virtual-host: /\n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#86","title":"8.6 \u4e0d\u540c\u5de5\u4f5c\u6a21\u5f0f\u6848\u4f8b","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1_10","title":"1. \u7b80\u5355\u6a21\u5f0f","text":"<ol> <li> <p>\u751f\u4ea7\u8005     \u6838\u5fc3\u65b9\u6cd5\uff1arabbitTemplate.convertAndSend <pre><code>@Autowired  \nprivate RabbitTemplate rabbitTemplate;  \n\n@Test  \npublic void testSend(){  \n    rabbitTemplate.convertAndSend(\"\",\"queue_simple\",\"hello world\");  \n}\n</code></pre></p> </li> <li> <p>\u6d88\u8d39\u8005 <pre><code>@RabbitListener(queues = {\"queue_simple\"})  \npublic void testSimpleConsumer(String msg){  \n    System.out.println(\"\u6d88\u8d39\u8005\u6536\u5230\u6d88\u606f\uff1a\" + msg);  \n}\n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2_12","title":"2. \u5de5\u4eba\u6a21\u5f0f","text":"<pre><code>\u5c31\u662f\u4e00\u4e2a\u751f\u4ea7\u8005\uff0c\u591a\u4e2a\u6d88\u8d39\u8005\uff0c\u540c\u4e00\u65f6\u523b\u53ea\u53d1\u7ed9\u4e00\u4e2a\u6d88\u8d39\u8005,\u56e0\u6b64\uff0c\u4e0d\u540c\u751f\u4ea7\u8005\u5c5e\u4e8e\u7ade\u4e89\u5173\u7cfb\u3002\n</code></pre> <ol> <li> <p>\u6d88\u8d39\u8005 <pre><code>@Test  \npublic void testWorkerSend(){  \n    rabbitTemplate.convertAndSend(\"\",\"queue_worker1\",\"hello world1\");  \n    rabbitTemplate.convertAndSend(\"\",\"queue_worker2\",\"hello world2\");  \n}\n</code></pre></p> </li> <li> <p>\u751f\u4ea7\u8005 <pre><code>@RabbitListener(queues = {\"queue_worker1\"})  \npublic void testWorkerConsumer1(String msg){  \n    System.out.println(\"\u6d88\u8d39\u80051\u6536\u5230\u6d88\u606f\uff1a\" + msg);  \n}  \n\n@RabbitListener(queues = {\"queue_worker2\"})  \npublic void testWorkerConsumer2(String msg){  \n    System.out.println(\"\u6d88\u8d39\u80052\u6536\u5230\u6d88\u606f\uff1a\" + msg);  \n}\n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3-","title":"3. \u53d1\u5e03-\u8ba2\u9605\u6a21\u5f0f(\u5e7f\u64ad\u6a21\u5f0f)","text":"<pre><code>\u4e00\u4e2a\u751f\u4ea7\u8005\uff0c\u591a\u4e2a\u6d88\u8d39\u8005\uff0c\u5e76\u4e14\u6709\u591a\u4e2a\u961f\u5217\uff0c\u8def\u7531\u4f1a\u628a\u6d88\u606f\u53d1\u9001\u7ed9\u6240\u6709\u961f\u5217\u3002\u4e5f\u5c31\u662f\u4e00\u4e2a\u751f\u4ea7\u8005\u751f\u4ea7\u7684\u6570\u636e\u4f9b\u6240\u6709\u6d88\u8d39\u8005\u4f7f\u7528\n\u6ce8\uff1a\u8bb0\u5f97\u4f20\u6784\u5efa\u4e00\u4e2a\u5e7f\u64ad\u8def\u7531\u4ee5\u53ca\u4e24\u4e2a\u961f\u5217\uff0c\u7136\u540e\u628a\u8be5\u8def\u7531\u548c\u8fd9\u4e24\u4e2a\u961f\u5217\u7ed1\u5b9a\u8d77\u6765\uff0c\u8def\u7531\u952e\u8bbe\u7f6e\u4e3a \"\" \u5373\u53ef\u3002\n</code></pre> <ol> <li> <p>\u751f\u4ea7\u8005  <code>java @Test   public void testPublishAndSubscribeSend(){       rabbitTemplate.convertAndSend(\"exchange_ps\",\"\",\"hello world\");   }</code></p> </li> <li> <p>\u6d88\u8d39\u8005 <pre><code>@RabbitListener(queues = {\"queue_ps1\"})  \npublic void testPsConsumer1(String msg){  \n    System.out.println(\"\u6d88\u8d39\u80051\u6536\u5230\u6d88\u606f\uff1a\" + msg);  \n}  \n\n@RabbitListener(queues = {\"queue_ps2\"})  \npublic void testPsConsumer2(String msg){  \n    System.out.println(\"\u6d88\u8d39\u80052\u6536\u5230\u6d88\u606f\uff1a\" + msg);  \n}\n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#4-_1","title":"4. \u53d1\u5e03-\u8ba2\u9605\u6a21\u5f0f\uff08\u8f6c\u53d1\u6a21\u5f0f\uff09","text":"<pre><code>\u8be5\u6a21\u5f0f\u5141\u8bb8\u6d88\u8d39\u8005\u8ba2\u9605\u4e00\u7ec4\u6d88\u606f\uff0c\u6bd4\u5982\u6d88\u8d39\u80051\u8ba2\u9605\u7684\u6d88\u606f\u7684\u8def\u7531\u952e\u4e3a a,b,c\uff0c\u800c\u6d88\u8d39\u80052\u8ba2\u9605\u7684\u8def\u7531\u952e\u4e3aa\uff0c\u90a3\u4e48\u5f53\u8f6c\u53d1\u7c7b\u578b\u7684\u8def\u7531\u63a5\u6536\u5230\u8def\u7531\u952e\u4e3aa\u7684\u6d88\u606f\u65f6\uff0c\u8fd9\u4e24\u4e2a\u6d88\u8d39\u8005\u90fd\u4f1a\u6536\u5230\u8be5\u6d88\u606f\uff0c\u4f46\u5982\u679c\u662fb\uff0c\u5219\u53ea\u6709\u6d88\u8d39\u80051\u4f1a\u6536\u5230\u8be5\u6d88\u606f\uff0c\u800c2\u4e0d\u4f1a\u6536\u5230\u8be5\u6d88\u606f\n\n\u4ee3\u7801\u7565\uff0c\u4e5f\u5c31\u662f\u5728\u8def\u7531\u4e0e\u6d88\u606f\u961f\u5217\u7ed1\u5b9a\u65f6\u6307\u5b9a\u8be5\u7ed1\u5b9a\u7684\u8def\u7531\u952e\u5373\u53ef\u3002\n</code></pre> <p>![[Pasted image 20251118174035.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#5_4","title":"5. \u4e3b\u9898\u6a21\u5f0f","text":"<pre><code>\u4e3b\u9898\u6a21\u5f0f\u5b9e\u9645\u8fd8\u662f\u53d1\u5e03-\u8ba2\u9605\u6a21\u5f0f\uff0c\u53ea\u4e0d\u8fc7\u6b64\u65f6\u7684\u8def\u7531\u952e\u5339\u914d\u53ef\u4ee5\u5199\u7edf\u914d\u7b26\u4e86\u3002\n</code></pre> <p>![[Pasted image 20251118174018.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#87-rabbitlistener","title":"8.7 @RabbitListener","text":"<pre><code>@RabbitListener(bindings =  \n        @QueueBinding(  \n                value = @Queue(name = \"queue01\", durable = \"true\", autoDelete = \"false\", exclusive = \"false\"),  \n                exchange = @Exchange(name = \"exchange01\", type = \"direct\", durable = \"true\", autoDelete = \"false\", internal = \"false\"),  \n                key = {\"key01\"}))\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#88","title":"8.8 \u6d88\u606f\u7684\u53ef\u9760\u6027\u6295\u9012","text":"<p>1\uff09\u751f\u4ea7\u8005\u53d1\u9001\u6d88\u606f\u7684\u53ef\u9760 \u5f00\u542f\u786e\u8ba4+\u56de\u9000 --&gt; \u5b9e\u73b0\u63a5\u53e3 2\uff09\u6d88\u606f\u4e2d\u95f4\u4ef6\u5b58\u50a8\u6d88\u606f\u7684\u53ef\u9760 --&gt; \u9ed8\u8ba4\u5c31\u662f\u53ef\u6301\u4e45\u5316\u7684 3\uff09\u6d88\u8d39\u8005\u5904\u7406\u6d88\u606f\u7684\u53ef\u9760  \u5f00\u59cb\u624b\u52a8\u786e\u8ba4\u6a21\u5f0f(\u4e5f\u5c31\u662f\u4e1a\u52a1\u6210\u529f\uff0c\u6211\u624d\u7ed9\u6d88\u606f\u961f\u5217\u8fd4\u56de ack\uff0c\u4e4b\u540e\u6d88\u606f\u961f\u5217\u624d\u4f1a\u5220\u9664\u8be5\u6d88\u606f)</p> <ol> <li>\u786e\u8ba4\uff0b\u56de\u9000\u673a\u5236     producer\u2014&gt;rabbitmq broker\u2014&gt;exchange\u2014&gt;queue\u2014&gt;consumer<pre><code>\u5f53\u4ea4\u6362\u673a\u6536\u5230\u4e86\u6d88\u606f\u65f6\uff0c\u5c31\u4f1a\u5411\u751f\u4ea7\u8005\u53d1\u9001\u4e00\u4e2a\u786e\u8ba4\u62a5\u6587\uff0c\u751f\u4ea7\u8005\u53ef\u4ee5\u901a\u8fc7\u76d1\u542c\u65b9\u6cd5\u6765\u6536\u5230\u8fd9\u4e2a\u786e\u8ba4\u62a5\u6587\n</code></pre> </li> </ol> <p>\u5b9e\u73b0\u65b9\u5f0f <pre><code>1. \u5148\u53bb\u914d\u7f6e\u6587\u4ef6\u4e2d\u5f00\u59cb\u786e\u8ba4\u3001\u56de\u9000\u529f\u80fd\npublisher-confirm-type: CORRELATED # \u4ea4\u6362\u673a\u7684\u786e\u8ba4  \npublisher-returns: true # \u961f\u5217\u7684\u786e\u8ba4\n\n2. \u53bb\u589e\u5f3a RabbitTemplate\uff0c\u4e5f\u5c31\u662f\u5b9e\u73b0 ConfirmCallback and ReturnsCallback\uff0c\u7136\u540e\u8bbe\u7f6e\u7ed9 RabbitTemplate\n\n3. \u7136\u540e\uff0c\u5c31\u6210\u529f\u7684\u5f00\u542f\u4e86\u786e\u8ba4 + \u56de\u9000\u673a\u5236\n</code></pre></p> <pre><code>/**\n * A callback for publisher confirmations.\n */\n@FunctionalInterface\npublic interface ConfirmCallback {\n\n    /**\n     * Confirmation callback.\n     * @param correlationData correlation data for the callback.\n     * @param ack true for ack, false for nack\n     * @param cause An optional cause, for nack, when available, otherwise null.\n     */\n    void confirm(@Nullable CorrelationData correlationData, boolean ack, @Nullable String cause);\n\n}\n\n\n/**\n* A callback for returned messages.\n* @since 2.3\n*/\n@FunctionalInterface\npublic interface ReturnsCallback {\n\n    /**\n     * Returned message callback.\n     * @param returned the returned message and metadata.\n     */\n    void returnedMessage(ReturnedMessage returned);\n}\n</code></pre> <pre><code>@Component\n@Slf4j\npublic class MQProducerAckConfig implements RabbitTemplate.ConfirmCallback, RabbitTemplate.ReturnsCallback{\n\n    @Autowired\n    private RabbitTemplate rabbitTemplate;\n\n    @PostConstruct\n    public void init() {\n        rabbitTemplate.setConfirmCallback(this);\n        rabbitTemplate.setReturnsCallback(this);\n    }\n\n    @Override\n    public void confirm(CorrelationData correlationData, boolean ack, String cause) {\n        if (ack) {\n            log.info(\"\u6d88\u606f\u53d1\u9001\u5230\u4ea4\u6362\u673a\u6210\u529f\uff01\u6570\u636e\uff1a\" + correlationData);\n        } else {\n            log.info(\"\u6d88\u606f\u53d1\u9001\u5230\u4ea4\u6362\u673a\u5931\u8d25\uff01\u6570\u636e\uff1a\" + correlationData + \" \u539f\u56e0\uff1a\" + cause);\n        }\n    }\n\n    @Override\n    public void returnedMessage(ReturnedMessage returned) {\n        log.info(\"\u6d88\u606f\u4e3b\u4f53: \" + new String(returned.getMessage().getBody()));\n        log.info(\"\u5e94\u7b54\u7801: \" + returned.getReplyCode());\n        log.info(\"\u63cf\u8ff0\uff1a\" + returned.getReplyText());\n        log.info(\"\u6d88\u606f\u4f7f\u7528\u7684\u4ea4\u6362\u5668 exchange : \" + returned.getExchange());\n        log.info(\"\u6d88\u606f\u4f7f\u7528\u7684\u8def\u7531\u952e routing : \" + returned.getRoutingKey());\n    }\n}\n</code></pre> <ol> <li>\u6d88\u606f\u961f\u5217\u4ee5\u53ca\u8def\u7531\u6301\u4e45\u5316<pre><code>\u6211\u4eec\u5176\u5b9e\u4e0d\u5fc5\u4e13\u95e8\u521b\u5efa\u6301\u4e45\u5316\u7684\u4ea4\u6362\u673a\u548c\u961f\u5217\uff0c\u56e0\u4e3a\u5b83\u4eec\u9ed8\u8ba4\u5c31\u662f\u6301\u4e45\u5316\u7684\u3002\u63a5\u4e0b\u6765\u6211\u4eec\u53ea\u9700\u8981\u786e\u8ba4\u4e00\u4e0b\uff1a\u5b58\u653e\u5230\u961f\u5217\u4e2d\uff0c\u5c1a\u672a\u88ab\u6d88\u8d39\u7aef\u53d6\u8d70\u7684\u6d88\u606f\uff0c\u662f\u5426\u4f1a\u968f\u7740RabbitMQ\u670d\u52a1\u5668\u91cd\u542f\u800c\u4e22\u5931\uff1f\n</code></pre> </li> </ol> <p>\u5728\u540e\u53f0\u7ba1\u7406\u754c\u9762\u521b\u5efa\u4ea4\u6362\u673a\u548c\u961f\u5217\u65f6\uff0c\u9ed8\u8ba4\u5c31\u662f\u6301\u4e45\u5316\u7684\u6a21\u5f0f\u3002\u6b64\u65f6\u6d88\u606f\u4e5f\u662f\u6301\u4e45\u5316\u7684\uff0c\u4e0d\u9700\u8981\u989d\u5916\u8bbe\u7f6e\u3002</p> <ol> <li>\u6d88\u8d39\u7aef\u6d88\u606f\u786e\u8ba4</li> </ol> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6d88\u8d39\u7aef\u53d6\u56de\u6d88\u606f\u540e\uff0c\u9ed8\u8ba4\u4f1a\u81ea\u52a8\u8fd4\u56deACK\u786e\u8ba4\u6d88\u606f\uff0c\u6240\u4ee5\u5728\u524d\u9762\u7684\u6d4b\u8bd5\u4e2d\u6d88\u606f\u88ab\u6d88\u8d39\u7aef\u6d88\u8d39\u4e4b\u540e\uff0cRabbitMQ\u5f97\u5230ACK\u786e\u8ba4\u4fe1\u606f\u5c31\u4f1a\u5220\u9664\u6d88\u606f</p> <p>\u4f46\u5b9e\u9645\u5f00\u53d1\u4e2d\uff0c\u6d88\u8d39\u7aef\u6839\u636e\u6d88\u606f\u961f\u5217\u6295\u9012\u7684\u6d88\u606f\u6267\u884c\u5bf9\u5e94\u7684\u4e1a\u52a1\uff0c\u672a\u5fc5\u90fd\u80fd\u6267\u884c\u6210\u529f\uff0c\u5982\u679c\u5e0c\u671b\u80fd\u591f\u591a\u6b21\u91cd\u8bd5\uff0c\u90a3\u4e48\u9ed8\u8ba4\u8bbe\u5b9a\u5c31\u4e0d\u6ee1\u8db3\u8981\u6c42\u4e86</p> <p>\u6240\u4ee5\u8fd8\u662f\u8981\u4fee\u6539\u6210\u624b\u52a8\u786e\u8ba4</p> <pre><code>spring:\n  rabbitmq:\n    ...\n    virtual-host: /\n    listener:\n      simple:\n        acknowledge-mode: manual # \u628a\u6d88\u606f\u786e\u8ba4\u6a21\u5f0f\u6539\u4e3a\u624b\u52a8\u786e\u8ba4\n</code></pre> <pre><code>basicAck()\u65b9\u6cd5:\u7ed9Broker\u8fd4\u56deACK\u786e\u8ba4\u4fe1\u606f\uff0c\u8868\u793a\u6d88\u606f\u5df2\u7ecf\u5728\u6d88\u8d39\u7aef\u6210\u529f\u6d88\u8d39\uff0c\u8fd9\u6837Broker\u5c31\u53ef\u4ee5\u628a\u6d88\u606f\u5220\u9664\u4e86\n\nbasicNack()\u65b9\u6cd5:\u7ed9Broker\u8fd4\u56deNACK\u4fe1\u606f\uff0c\u8868\u793a\u6d88\u606f\u5728\u6d88\u8d39\u7aef\u6d88\u8d39\u5931\u8d25\uff0c\u6b64\u65f6Broker\u7684\u540e\u7eed\u64cd\u4f5c\u53d6\u51b3\u4e8e\u53c2\u6570requeue\u7684\u503c\n\n\n\nbasicReject()\u65b9\u6cd5\n</code></pre> \u53c2\u6570\u540d\u79f0 \u542b\u4e49 long deliveryTag Broker\u7ed9\u6bcf\u4e00\u6761\u8fdb\u5165\u961f\u5217\u7684\u6d88\u606f\u90fd\u8bbe\u5b9a\u4e00\u4e2a\u552f\u4e00\u6807\u8bc6 boolean multiple \u53d6\u503c\u4e3atrue\uff1a\u4e3a\u5c0f\u4e8e\u3001\u7b49\u4e8edeliveryTag\u7684\u6d88\u606f\u6279\u91cf\u8fd4\u56deACK\u4fe1\u606f \u53d6\u503c\u4e3afalse\uff1a\u4ec5\u4e3a\u6307\u5b9a\u7684deliveryTag\u8fd4\u56deACK\u4fe1\u606f boolean requeue \u53d6\u503c\u4e3atrue\uff1aBroker\u5c06\u6d88\u606f\u91cd\u65b0\u653e\u56de\u961f\u5217\uff0c\u63a5\u4e0b\u6765\u4f1a\u91cd\u65b0\u6295\u9012\u7ed9\u6d88\u8d39\u7aef \u53d6\u503c\u4e3afalse\uff1aBroker\u5c06\u6d88\u606f\u6807\u8bb0\u4e3a\u5df2\u6d88\u8d39\uff0c\u4e0d\u4f1a\u653e\u56de\u961f\u5217 <pre><code>@Component\n@Slf4j\npublic class MyMessageListener {\n\n    public static final String EXCHANGE_DIRECT = \"exchange.direct.order\";\n    public static final String ROUTING_KEY = \"order\";\n    public static final String QUEUE_NAME  = \"queue.order\";\n\n    // \u4fee\u9970\u76d1\u542c\u65b9\u6cd5\n    @RabbitListener(\n            // \u8bbe\u7f6e\u7ed1\u5b9a\u5173\u7cfb\n            bindings = @QueueBinding(\n\n                // \u914d\u7f6e\u961f\u5217\u4fe1\u606f\uff1adurable \u4e3a true \u8868\u793a\u961f\u5217\u6301\u4e45\u5316\uff1bautoDelete \u4e3a false \u8868\u793a\u5173\u95ed\u81ea\u52a8\u5220\u9664\n                value = @Queue(value = QUEUE_NAME, durable = \"true\", autoDelete = \"false\"),\n\n                // \u914d\u7f6e\u4ea4\u6362\u673a\u4fe1\u606f\uff1adurable \u4e3a true \u8868\u793a\u961f\u5217\u6301\u4e45\u5316\uff1bautoDelete \u4e3a false \u8868\u793a\u5173\u95ed\u81ea\u52a8\u5220\u9664\n                exchange = @Exchange(value = EXCHANGE_DIRECT, durable = \"true\", autoDelete = \"false\"),\n\n                // \u914d\u7f6e\u8def\u7531\u952e\u4fe1\u606f\n                key = {ROUTING_KEY}\n    ))\n    public void processMessage(String dataString, Message message, Channel channel) throws IOException {\n\n        // 1\u3001\u83b7\u53d6\u5f53\u524d\u6d88\u606f\u7684 deliveryTag \u503c\u5907\u7528\n        long deliveryTag = message.getMessageProperties().getDeliveryTag();\n\n        try {\n            // 2\u3001\u6b63\u5e38\u4e1a\u52a1\u64cd\u4f5c\n            log.info(\"\u6d88\u8d39\u7aef\u63a5\u6536\u5230\u6d88\u606f\u5185\u5bb9\uff1a\" + dataString);\n\n            // System.out.println(10 / 0);\n\n            // 3\u3001\u7ed9 RabbitMQ \u670d\u52a1\u5668\u8fd4\u56de ACK \u786e\u8ba4\u4fe1\u606f\n            channel.basicAck(deliveryTag, false);\n        } catch (Exception e) {\n\n            // 4\u3001\u83b7\u53d6\u4fe1\u606f\uff0c\u770b\u5f53\u524d\u6d88\u606f\u662f\u5426\u66fe\u7ecf\u88ab\u6295\u9012\u8fc7\n            Boolean redelivered = message.getMessageProperties().getRedelivered();\n\n            if (!redelivered) {\n                // 5\u3001\u5982\u679c\u6ca1\u6709\u88ab\u6295\u9012\u8fc7\uff0c\u90a3\u5c31\u91cd\u65b0\u653e\u56de\u961f\u5217\uff0c\u91cd\u65b0\u6295\u9012\uff0c\u518d\u8bd5\u4e00\u6b21\n                channel.basicNack(deliveryTag, false, true);\n            } else {\n                // 6\u3001\u5982\u679c\u5df2\u7ecf\u88ab\u6295\u9012\u8fc7\uff0c\u4e14\u8fd9\u4e00\u6b21\u4ecd\u7136\u8fdb\u5165\u4e86 catch \u5757\uff0c\u90a3\u4e48\u8fd4\u56de\u62d2\u7edd\u4e14\u4e0d\u518d\u653e\u56de\u961f\u5217\n                channel.basicReject(deliveryTag, false);\n            }\n\n        }\n    }\n\n}\n</code></pre> <ul> <li> <p>\u8981\u70b91\uff1a\u628a\u6d88\u606f\u786e\u8ba4\u6a21\u5f0f\u6539\u4e3a\u624b\u52a8\u786e\u8ba4</p> </li> <li> <p>\u8981\u70b92\uff1a\u8c03\u7528Channel\u5bf9\u8c61\u7684\u65b9\u6cd5\u8fd4\u56de\u4fe1\u606f</p> <ul> <li> <p>ACK\uff1aAcknowledgement\uff0c\u8868\u793a\u6d88\u606f\u5904\u7406\u6210\u529f</p> </li> <li> <p>NACK\uff1aNegative Acknowledgement\uff0c\u8868\u793a\u6d88\u606f\u5904\u7406\u5931\u8d25</p> </li> <li> <p>Reject\uff1a\u62d2\u7edd\uff0c\u540c\u6837\u8868\u793a\u6d88\u606f\u5904\u7406\u5931\u8d25</p> </li> </ul> </li> <li> <p>\u8981\u70b93\uff1a\u540e\u7eed\u64cd\u4f5c</p> <ul> <li> <p>requeue\u4e3atrue\uff1a\u91cd\u65b0\u653e\u56de\u961f\u5217\uff0c\u91cd\u65b0\u6295\u9012\uff0c\u518d\u6b21\u5c1d\u8bd5</p> </li> <li> <p>requeue\u4e3afalse\uff1a\u4e0d\u653e\u56de\u961f\u5217\uff0c\u4e0d\u91cd\u65b0\u6295\u9012</p> </li> </ul> </li> <li> <p>\u8981\u70b94\uff1adeliveryTag \u6d88\u606f\u7684\u552f\u4e00\u6807\u8bc6\uff0c\u67e5\u627e\u5177\u4f53\u67d0\u4e00\u6761\u6d88\u606f\u7684\u4f9d\u636e</p> </li> </ul>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#89","title":"8.9 \u6d88\u606f\u5e42\u7b49\u6027","text":"<pre><code>\u53ea\u8981\u6d89\u53ca\u5230\u751f\u4ea7\u8005\u91cd\u53d1\u6d88\u606f\uff0c\u5c31\u4f1a\u5bfc\u81f4\u6d88\u606f\u961f\u5217\u6709\u76f8\u540c\u7684\u6d88\u606f\uff0c\u800c\u8fd9\u65f6\u5019\u8981\u6ee1\u8db3\u6d88\u606f\u5e42\u7b49\u6027\uff1a\u6d88\u8d39\u591a\u6761\u76f8\u540c\u7684\u6d88\u606f\u4e0e\u6d88\u8d39\u4e00\u6761\u7ed3\u679c\u662f\u76f8\u540c\u7684\u3002\n</code></pre> <p>\u5b9e\u73b0\u65b9\u5f0f\uff1a\u4e50\u89c2\u9501\u673a\u5236</p> <pre><code>\u4e5f\u5c31\u662f\u7ed9\u6570\u636e\u52a0\u4e00\u4e2a\u7248\u672c\u53f7\uff0c\u540c\u65f6\u6d88\u606f\u4e5f\u52a0\u4e00\u4e2a\u7248\u672c\u53f7\uff0c\u53ea\u8981\u6d88\u606f\u6210\u529f\u7684\u66f4\u65b0\u4e86\u6570\u636e\u5e93\u7684\u6570\u636e\uff0c\u5c31\u7ed9\u6570\u636e\u7684\u7248\u672c\u53f7\uff0b1\uff0c\u4e4b\u540e\u7684\u66f4\u65b0\u5c31\u4f1a\u56e0\u4e3a\u7248\u672c\u53f7\u4e0d\u540c\u800c\u65e0\u6cd5\u8fdb\u884c\uff0c\u8fd9\u5c31\u5b9e\u73b0\u4e86\u76f8\u540c\u7684\u6d88\u606f\u53ea\u6709\u4e00\u6761\u80fd\u66f4\u65b0\u6570\u636e\u5e93\u3002\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#810","title":"8.10 \u6d88\u8d39\u7aef\u9650\u6d41\uff08\u5b58\u5728\u9ed8\u8ba4\u9650\u6d41\uff09","text":"<p>![[Pasted image 20251120105406.png]]</p> <ul> <li>\u751f\u4ea7\u8005\u53d1\u900110000\u4e2a\u6d88\u606f</li> <li>\u6d88\u8d39\u7aef\u5e76\u53d1\u80fd\u529b\u4e0a\u9650\uff1a\u540c\u65f6\u5904\u74061000\u4e2a\u8bf7\u6c42</li> <li>\u8bbe\u5b9a\uff1a\u6bcf\u6b21\u6700\u591a\u4ece\u961f\u5217\u53d6\u56de1000\u4e2a\u8bf7\u6c42</li> </ul> <pre><code>spring:\n  rabbitmq:\n    ...\n    virtual-host: /\n    listener:\n      simple:\n        acknowledge-mode: manual\n        prefetch: 1000  # \u8bbe\u7f6e\u6bcf\u6b21\u6700\u591a\u4ece\u6d88\u606f\u961f\u5217\u670d\u52a1\u5668\u53d6\u56de\u591a\u5c11\u6d88\u606f\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#811","title":"8.11 \u6d88\u606f\u8d85\u65f6","text":"<pre><code>\u6211\u4eec\u53ef\u4ee5\u8bbe\u7f6e\u6d88\u606f\u7684\u8d85\u65f6\u65f6\u95f4\uff0c\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e\u961f\u5217\u7684\u603b\u4f53\u65f6\u95f4\u6216\u8005\u7ed9\u6d88\u606f\u5355\u72ec\u8bbe\u7f6e\u8d85\u65f6\u65f6\u95f4\uff0c\u4ece\u8fdb\u5165\u961f\u5217\u5f00\u59cb\u8ba1\u65f6\uff0c\u5982\u679c\u5728\u8d85\u65f6\u65f6\u95f4\u4e4b\u524d\u6ca1\u88ab\u6d88\u8d39\u8005\u53d6\u8d70\uff0c\u5c31\u4f1a\u6d88\u5931\u3002\n</code></pre> <pre><code>public void sendMessage(String message) {  \n    rabbitTemplate.convertAndSend(\"exchange01\", \"key00\", message, (msg) -&gt; {  \n        msg.getMessageProperties().setExpiration(\"5000\");  \n        return msg;  \n    });  \n}\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#812","title":"8.12 \u6b7b\u4fe1\u961f\u5217","text":"<p>![[Pasted image 20251120113236.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1_11","title":"1. \u6d88\u606f\u6210\u4e3a\u6b7b\u4fe1\u7684\u4e09\u79cd\u60c5\u51b5","text":"<ul> <li> <p>\u62d2\u7edd\uff1a\u6d88\u8d39\u8005\u62d2\u63a5\u6d88\u606f\uff0cbasicNack()/basicReject()\uff0c\u5e76\u4e14\u4e0d\u628a\u6d88\u606f\u91cd\u65b0\u653e\u5165\u539f\u76ee\u6807\u961f\u5217\uff0crequeue=false</p> </li> <li> <p>\u6ea2\u51fa\uff1a\u961f\u5217\u4e2d\u6d88\u606f\u6570\u91cf\u5230\u8fbe\u9650\u5236\u3002\u6bd4\u5982\u961f\u5217\u6700\u5927\u53ea\u80fd\u5b58\u50a810\u6761\u6d88\u606f\uff0c\u4e14\u73b0\u5728\u5df2\u7ecf\u5b58\u50a8\u4e8610\u6761\uff0c\u6b64\u65f6\u5982\u679c\u518d\u53d1\u9001\u4e00\u6761\u6d88\u606f\u8fdb\u6765\uff0c\u6839\u636e\u5148\u8fdb\u5148\u51fa\u539f\u5219\uff0c\u961f\u5217\u4e2d\u6700\u65e9\u7684\u6d88\u606f\u4f1a\u53d8\u6210\u6b7b\u4fe1</p> </li> <li> <p>\u8d85\u65f6\uff1a\u6d88\u606f\u5230\u8fbe\u8d85\u65f6\u65f6\u95f4\u672a\u88ab\u6d88\u8d39</p> </li> </ul>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2_13","title":"2. \u6b7b\u4fe1\u5904\u7406\u7684\u65b9\u5f0f","text":"<ol> <li>\u4e22\u5f03</li> <li>\u8bb0\u5f55\u5230\u6570\u636e\u5e93</li> <li>\u901a\u8fc7\u6b7b\u4fe1\u961f\u5217\u53bb\u5904\u7406</li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3_7","title":"3. \u5b9e\u73b0\u65b9\u5f0f","text":"<pre><code>\u521b\u5efa\u4e00\u4e2a\u6b7b\u4fe1\u8def\u7531\u4ee5\u53ca\u6b7b\u4fe1\u961f\u5217\uff0c\u7136\u540e\u7ed9\u6b63\u5e38\u8def\u7531\u7ed1\u5b9a\u6b7b\u4fe1\u8def\u7531\u4ee5\u53ca\u8def\u7531\u952e\uff0c\u4ece\u800c\u8ba9\u670d\u52a1\u5668\u81ea\u52a8\u7684\u5c06\u6b7b\u4fe1\u53d1\u9001\u7ed9\u6b7b\u4fe1\u961f\u5217\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#813","title":"8.13 \u5ef6\u8fdf\u961f\u5217","text":"<ul> <li> <p>\u5ef6\u8fdf\u961f\u5217\u5b58\u50a8\u7684\u5bf9\u8c61\u80af\u5b9a\u662f\u5bf9\u5e94\u7684\u5ef6\u65f6\u6d88\u606f\uff0c\u6240\u8c13\u201d\u5ef6\u65f6\u6d88\u606f\u201d\u662f\u6307\u5f53\u6d88\u606f\u88ab\u53d1\u9001\u4ee5\u540e\uff0c\u5e76\u4e0d\u60f3\u8ba9\u6d88\u8d39\u8005\u7acb\u5373\u62ff\u5230\u6d88\u606f\uff0c\u800c\u662f\u7b49\u5f85\u6307\u5b9a\u65f6\u95f4\u540e\uff0c\u6d88\u8d39\u8005\u624d\u62ff\u5230\u8fd9\u4e2a\u6d88\u606f\u8fdb\u884c\u6d88\u8d39\u3002</p> </li> <li> <p>\u573a\u666f\uff1a\u5728\u8ba2\u5355\u7cfb\u7edf\u4e2d\uff0c\u4e00\u4e2a\u7528\u6237\u4e0b\u5355\u4e4b\u540e\u901a\u5e38 \u670930\u5206\u949f\u7684\u65f6\u95f4\u8fdb\u884c\u652f\u4ed8\uff0c\u5982\u679c30\u5206\u949f\u4e4b\u5185\u6ca1\u6709\u652f\u4ed8\u6210\u529f\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8ba2\u5355\u5c06\u8fdb\u884c\u53d6\u6d88\u5904\u7406\u3002\u8fd9\u65f6\u5c31\u53ef\u4ee5\u4f7f\u7528\u5ef6\u65f6\u961f\u5217\u5c06\u8ba2\u5355\u4fe1\u606f\u53d1\u9001\u5230\u5ef6\u65f6\u961f\u5217\u3002</p> </li> </ul>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1_12","title":"1. \u5b9e\u73b0\u65b9\u5f0f","text":"<p>1\uff09\u8d85\u65f6+\u6b7b\u4fe1</p> <p>![[Pasted image 20251120114100.png]]</p> <p>2\uff09\u63d2\u4ef6</p> <ul> <li>\u5b98\u7f51\u5730\u5740\uff1ahttps://github.com/rabbitmq/rabbitmq-delayed-message-exchange</li> <li>\u5ef6\u8fdf\u6781\u9650\uff1a\u6700\u591a\u4e24\u5929</li> <li>\u5bfc\u81f4\u56de\u9000\u56de\u8c03\u51fd\u6570\u88ab\u6267\u884c\u3002\u56e0\u4e3a\uff0c\u4ea4\u6362\u673a\u4f1a\u5ef6\u8fdf\u8f6c\u53d1\u7ed9\u961f\u5217\u3002</li> </ul>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2_14","title":"2. \u5b89\u88c5\u65b9\u5f0f","text":"<ol> <li> <p>\u5148\u53bb\u5b98\u7f51\u4e0b\u8f7d\u5ef6\u8fdf\u961f\u5217\u63d2\u4ef6 <pre><code>wget https://github.com/rabbitmq/rabbitmq-delayed-message-exchange/releases/download/v3.12.0/rabbitmq_delayed_message_exchange-3.12.0.ez\nmv rabbitmq_delayed_message_exchange-3.12.0.ez /var/lib/docker/volumes/rabbitmq-plugin/_data\n</code></pre></p> </li> <li> <p>\u7136\u540e\u542f\u7528\u63d2\u4ef6 <pre><code># \u767b\u5f55\u8fdb\u5165\u5bb9\u5668\u5185\u90e8\ndocker exec -it rabbitmq /bin/bash\n\n# rabbitmq-plugins\u547d\u4ee4\u6240\u5728\u76ee\u5f55\u5df2\u7ecf\u914d\u7f6e\u5230$PATH\u73af\u5883\u53d8\u91cf\u4e2d\u4e86\uff0c\u53ef\u4ee5\u76f4\u63a5\u8c03\u7528\nrabbitmq-plugins enable rabbitmq_delayed_message_exchange\n\n# \u9000\u51faDocker\u5bb9\u5668\nexit\n\n# \u91cd\u542fDocker\u5bb9\u5668\ndocker restart rabbitmq\n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3_8","title":"3. \u4f7f\u7528\u65b9\u5f0f","text":"<pre><code>\u8bbe\u7f6e\u4e00\u4e2a\u5934\u5c31\u53ef\u4ee5\u4e86\u3002\u5f53\u7136\uff0c\u5ef6\u8fdf\u4ea4\u6362\u673a\u5fc5\u987b\u901a\u8fc7\u53c2\u6570\u6307\u5b9a\u8def\u7531\u5668\u5de5\u4f5c\u65b9\u5f0f\uff0c\u540c\u65f6\uff0c\u8be5\u4ea4\u6362\u673a\u4e5f\u53ef\u4ee5\u901a\u8fc7\u6ce8\u89e3\u7684\u65b9\u5f0f\u521b\u5efa\u3002\n</code></pre> <p><code>java @Test public void testSendDelayMessage() {     rabbitTemplate.convertAndSend(             EXCHANGE_DELAY,             ROUTING_KEY_DELAY,             \"\u6d4b\u8bd5\u57fa\u4e8e\u63d2\u4ef6\u7684\u5ef6\u8fdf\u6d88\u606f [\" + new SimpleDateFormat(\"hh:mm:ss\").format(new Date()) + \"]\",             messageProcessor -&gt; {                  // \u8bbe\u7f6e\u5ef6\u8fdf\u65f6\u95f4\uff1a\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d                 messageProcessor.getMessageProperties().setHeader(\"x-delay\", \"10000\");                  return messageProcessor;             }); }</code></p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#springcloud-2022","title":"\u4e5d SpringCloud 2022\u5e74\u7248\u672c","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1_13","title":"1. \u4ec0\u4e48\u662f\u5fae\u670d\u52a1","text":"<p>![[Pasted image 20251120160005.png]]</p> <pre><code>In short\uff08\u7b80\u8a00\u4e4b\uff09, the microservice architectural style \u3010\u67b6\u6784\u98ce\u683c\u3011[1] is an approach to developing a single application as a suite of small services\u3010\u72ec\u7acb\u5e94\u7528\u53d8\u6210\u4e00\u5957\u5c0f\u670d\u52a1\u3011, each running in its own process and communicating with lightweight(\u8f7b\u91cf\u7ea7\u6c9f\u901a) mechanisms(\u6bcf\u4e00\u4e2a\u90fd\u8fd0\u884c\u5728\u81ea\u5df1\u7684\u8fdb\u7a0b\u5185\uff08\u5bb9\u5668\uff09), often an HTTP resource API(\u7528HTTP\uff0c\u5c06\u529f\u80fd\u5199\u6210\u80fd\u63a5\u53d7\u8bf7\u6c42). These services are built around business capabilities \uff08\u72ec\u7acb\u4e1a\u52a1\u80fd\u529b\uff09and independently deployable by fully automated deployment machinery\uff08\u5e94\u8be5\u81ea\u52a8\u5316\u72ec\u7acb\u90e8\u7f72\uff09. There is a bare minimum of centralized management of these services\uff08\u5e94\u8be5\u6709\u4e00\u4e2a\u80fd\u7ba1\u7406\u8fd9\u4e9b\u670d\u52a1\u7684\u4e2d\u5fc3\uff09, which may be written in different programming languages (\u72ec\u7acb\u5f00\u53d1\u8bed\u8a00)and use different data storage technologies\uff08\u72ec\u7acb\u7684\u6570\u636e\u5b58\u50a8\uff09.\n</code></pre> <p>\u6838\u5fc3\u7279\u6027\uff1a 1. \u5206\u89e3\u4e0e\u72ec\u7acb\u6027\uff1a \u5c06\u5e94\u7528\u5206\u89e3\u6210\u591a\u4e2a\u8f83\u5c0f\u7684\u72ec\u7acb\u90e8\u5206\uff0c\u6bcf\u4e2a\u90e8\u5206\u6709\u5404\u81ea\u7684\u804c\u8d23\u9886\u57df\uff0c\u53ef\u4ee5\u72ec\u7acb\u5f00\u53d1\u3001\u90e8\u7f72\u548c\u7ef4\u62a4\u3002 2. \u901a\u4fe1\uff1a \u5404\u4e2a\u670d\u52a1\u901a\u8fc7\u8f7b\u91cf\u7ea7 API\uff08\u5982 REST\u3001\u6d88\u606f\u961f\u5217\uff09\u8fdb\u884c\u901a\u4fe1\uff0c\u800c\u4e0d\u662f\u5171\u4eab\u5185\u5b58\u6216\u6570\u636e\u5e93\u3002 3. \u6280\u672f\u591a\u6837\u6027\uff1a \u5141\u8bb8\u56e2\u961f\u4e3a\u6bcf\u4e2a\u670d\u52a1\u9009\u62e9\u6700\u5408\u9002\u7684\u6280\u672f\u6808\u3001\u7f16\u7a0b\u8bed\u8a00\u548c\u6570\u636e\u5e93\u3002 4. \u6570\u636e\u81ea\u4e3b\u6027\uff1a \u6bcf\u4e2a\u5fae\u670d\u52a1\u901a\u5e38\u62e5\u6709\u81ea\u5df1\u7684\u6570\u636e\u5e93\u548c\u6570\u636e\u7ba1\u7406\u6a21\u578b\u3002 5. \u4e91\u539f\u751f\uff1a \u5b83\u662f\u4e00\u79cd\u4e91\u539f\u751f\u8f6f\u4ef6\u6784\u5efa\u65b9\u5f0f\uff0c\u901a\u5e38\u4e0e\u5bb9\u5668\u5316\u6280\u672f\uff08\u5982 Docker\u3001Kubernetes\uff09\u548c DevOps/\u6301\u7eed\u4ea4\u4ed8\u6d41\u7a0b\u7ed3\u5408\u4f7f\u7528\u3002</p> <p>\u76f8\u6bd4\u5355\u4f53\u67b6\u6784\u7684\u4f18\u52bf\uff1a - \u53ef\u6269\u5c55\u6027\u66f4\u9ad8\uff1a \u5404\u4e2a\u5fae\u670d\u52a1\u53ef\u6839\u636e\u81ea\u8eab\u9700\u6c42\u72ec\u7acb\u5f39\u6027\u6269\u5c55\u3002 - \u654f\u6377\u6027\u66f4\u5f3a\uff1a \u52a0\u5feb\u5f00\u53d1\u548c\u90e8\u7f72\u901f\u5ea6\uff0c\u7f29\u77ed\u65b0\u529f\u80fd\u4e0a\u5e02\u65f6\u95f4\u3002 - \u5f39\u6027\u589e\u5f3a\uff1a \u67d0\u4e2a\u670d\u52a1\u6545\u969c\u65f6\uff0c\u4e0d\u4f1a\u5f71\u54cd\u6574\u4e2a\u5e94\u7528\u7684\u53ef\u7528</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2_15","title":"2. \u6982\u5ff5\u6c47\u603b","text":"<ol> <li>\u5fae\u670d\u52a1\uff1a\u4e00\u79cd\u67b6\u6784\u98ce\u683c\uff0c\u5c06\u5355\u4e00\u5e94\u7528\u5206\u89e3\u4e3a\u4e00\u7ec4\u677e\u8026\u5408\u3001\u53ef\u72ec\u7acb\u90e8\u7f72\u7684\u5c0f\u578b\u670d\u52a1\uff0c\u6bcf\u4e2a\u670d\u52a1\u56f4\u7ed5\u7279\u5b9a\u4e1a\u52a1\u529f\u80fd\u6784\u5efa\uff0c\u62e5\u6709\u81ea\u5df1\u7684\u6570\u636e\u548c\u6280\u672f\u6808\u3002</li> <li>\u5206\u5e03\u5f0f\uff1a\u5728\u4e0d\u540c\u7684\u670d\u52a1\u5668\u4e0a\u90e8\u7f72\u4e0d\u540c\u7684\u5e94\u7528\u7a0b\u5e8f</li> <li>\u96c6\u7fa4\uff1a\u5728\u4e0d\u540c\u7684\u670d\u52a1\u5668\u4e0a\u90e8\u7f72\u76f8\u540c\u7684\u670d\u52a1</li> <li>\u8d1f\u8f7d\u5747\u8861\uff1a\u5c06\u8bf7\u6c42\u5c3d\u91cf\u5747\u8861\u7684\u5206\u53d1\u5230\u4e0d\u540c\u7684\u96c6\u7fa4\u8282\u70b9</li> <li>\u7f51\u5173\uff1a\u62e6\u622a\u6240\u6709\u670d\u52a1\u8c03\u7528\u8bf7\u6c42\uff0c\u53ef\u4ee5\u5bf9\u670d\u52a1\u8fdb\u884c\u7edf\u4e00\u7684\u529f\u80fd\u62d3\u5c55\uff08\u7c7b\u4f3c Interceptor_</li> <li>\u964d\u7ea7\uff1a\u8c03\u7528\u670d\u52a1\u5931\u8d25\u4e86\uff0c\u8fd4\u56de\u4e00\u4e2a\u515c\u5e95\u7684\u7ed3\u679c</li> <li>\u7194\u65ad\uff1a\u591a\u6b21\u964d\u7ea7\u540e\uff0c\u5f00\u59cb\u7194\u65ad\u5668\uff0c\u4e4b\u540e\u7684\u670d\u52a1\u8c03\u7528\u4e0d\u518d\u6267\u884c\uff0c\u800c\u662f\u76f4\u63a5\u8fd4\u56de\u964d\u7ea7\u7ed3\u679c\u3002</li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3-springcloud","title":"3. SpringCloud \u7684\u4ecb\u7ecd","text":"<p>\u9488\u5bf9\u5fae\u670d\u52a1\u7cfb\u7edf\u67b6\u6784\u6240\u5b58\u5728\u7684\u95ee\u9898\uff0c\u80af\u5b9a\u662f\u9700\u8981\u6709\u5177\u4f53\u7684\u6280\u672f\u6765\u89e3\u51b3\uff0c\u800c\u6240\u4f7f\u7528\u5230\u7684\u6280\u672f\u5c31\u662fSpring Clouad Alibaba\u3002\u90a3\u4e48\u60f3\u8981\u4e86\u89e3Spring Clouad Alibaba\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u5148\u4e86\u89e3\u4e00\u4e0bSpring Cloud</p> <p>\u4e0b\u9762\u662f\u4e00\u4e9b\u5e38\u7528\u7684\u7ec4\u4ef6\uff1a</p> <ol> <li> <p>\u6ce8\u518c\u4e2d\u5fc3\uff08Nacos/Eureka\uff09\uff1a \u5b9e\u73b0\u670d\u52a1\u53d1\u73b0\u4e0e\u6ce8\u518c\u3002\u6240\u6709\u5fae\u670d\u52a1\u542f\u52a8\u65f6\u5411\u4e2d\u5fc3\u6ce8\u518c\uff0c\u6d88\u8d39\u8005\u901a\u8fc7\u4e2d\u5fc3\u83b7\u53d6\u670d\u52a1\u5730\u5740\u3002</p> </li> <li> <p>\u914d\u7f6e\u4e2d\u5fc3\uff08Nacos\uff09\uff1a \u96c6\u4e2d\u7ba1\u7406\u6240\u6709\u5fae\u670d\u52a1\u7684\u914d\u7f6e\u4fe1\u606f\uff0c\u652f\u6301\u914d\u7f6e\u7684\u52a8\u6001\u63a8\u9001\u548c\u66f4\u65b0\u3002</p> </li> <li> <p>\u8d1f\u8f7d\u5747\u8861\uff08LoadBalancer/Ribbon\uff09\uff1a \u5728\u96c6\u7fa4\u670d\u52a1\u5668\u5171\u540c\u627f\u62c5\u8bf7\u6c42\u538b\u529b\u65f6\uff0c\u51b3\u5b9a\u5c06\u8bf7\u6c42\u5206\u53d1\u7ed9\u54ea\u4e2a\u5b9e\u4f8b\uff08\u5982\uff1a\u8f6e\u8be2\u673a\u5236\u3001\u968f\u673a\uff09\u3002</p> </li> <li> <p>\u7f51\u5173\uff08Gateway/Zuul\uff09\uff1a \u7cfb\u7edf\u7684\u7edf\u4e00\u5165\u53e3\uff0c\u5904\u7406\u6240\u6709\u5fae\u670d\u52a1\u5171\u6027\u95ee\u9898\uff08\u5982\u8def\u7531\u3001\u9274\u6743\u3001\u9650\u6d41\u3001\u76d1\u63a7\u7b49\uff09\u3002</p> </li> <li> <p>\u8fdc\u7a0b\u8c03\u7528\uff08OpenFeign/Feign\uff09\uff1a \u7b80\u5316\u670d\u52a1\u4e4b\u95f4\u7684 HTTP \u8c03\u7528\uff0c\u901a\u8fc7\u58f0\u660e\u5f0f\u63a5\u53e3\u5b9e\u73b0\u8fdc\u7a0b\u670d\u52a1\u8bbf\u95ee\u3002q</p> </li> <li> <p>\u670d\u52a1\u964d\u7ea7/\u7194\u65ad\uff08Sentinel/Hystrix\uff09\uff1a</p> <ul> <li>\u964d\u7ea7\uff1a \u727a\u7272\u975e\u6838\u5fc3\u529f\u80fd\uff0c\u786e\u4fdd\u6838\u5fc3\u529f\u80fd\u5728\u7cfb\u7edf\u538b\u529b\u5927\u65f6\u4f9d\u7136\u53ef\u7528\u3002</li> <li>\u7194\u65ad\uff1a \u4fdd\u62a4\u670d\u52a1\uff0c\u5f53\u4f9d\u8d56\u670d\u52a1\u6545\u969c\u65f6\uff0c\u5feb\u901f\u5931\u8d25\uff0c\u907f\u514d\u670d\u52a1\u96ea\u5d29\u3002</li> </ul> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#4_3","title":"4.  \u8fdc\u7a0b\u8c03\u7528","text":"<pre><code>\u8fdc\u7a0b\u8c03\u7528\u76f4\u63a5\u901a\u8fc7 Springboot \u63d0\u4f9b\u7684 RestTemplate\u5c31\u53ef\u4ee5\u5b9e\u73b0\uff0c\u4f46\u8fd9\u662f\u5e95\u5c42\u7684\uff0c\u540e\u9762\u7528\u5176\u4ed6\u7ec4\u4ef6\u3002\n\u6ce8\uff1a\u8be5\u7ec4\u4ef6\u6ca1\u6709\u81ea\u52a8\u6ce8\u518c\uff0c\u9700\u8981\u624b\u52a8\u6ce8\u518c\n</code></pre> <pre><code>// 1. \u6ce8\u518c\u7ec4\u4ef6\u5230ioc\u5bb9\u5668\n@Configuration  \npublic class RestTemplateConfiguration {  \n\n    @Bean  \n    public RestTemplate restTemplate(){  \n        return new RestTemplate();  \n    }  \n}\n\n// 2. \u901a\u8fc7 RestTemplate \u8c03\u7528\u8fdc\u7a0b\u670d\u52a1\nrestTemplate.getForEntity(\"http://localhost:10010/api/user/2\", User.class);\n</code></pre> <p>\u4e0a\u8ff0\u7684\u8c03\u7528\u65b9\u5f0f\u5b58\u5728\u95ee\u9898\uff1a</p> <pre><code>1\u3001\u7ef4\u62a4\u6027\u5dee\uff1a\u670d\u52a1\u63d0\u4f9b\u65b9\u7684ip\u5730\u5740\u53d1\u751f\u4e86\u6539\u53d8\uff0c\u90a3\u4e48\u6b64\u65f6\u670d\u52a1\u7684\u6d88\u8d39\u65b9\u5c31\u9700\u8981\u66f4\u6539\u4ee3\u7801\n2\u3001\u7f3a\u5c11\u8d1f\u8f7d\u5747\u8861\u673a\u5236\uff1a\u8d1f\u8f7d\u5747\u8861\u5c31\u662f\u8d1f\u8f7d\u3010\u8bf7\u6c42\u3011\u901a\u8fc7\u591a\u53f0\u670d\u52a1\u5668\u8fdb\u884c\u5904\u7406\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#5-nacos","title":"5. Nacos","text":"<pre><code>\u8981\u60f3\u89e3\u51b3\u4e0a\u8ff0\u8fdc\u7a0b\u8c03\u7528\u6240\u5b58\u5728\u7684\u95ee\u9898\uff0c\u5c31\u9700\u8981\u4f7f\u7528\u5230Spring Cloud Alibaba\u4e2d\u7684Nacos\u6ce8\u518c\u4e2d\u5fc3\u3002\n\u901a\u8fc7\u6ce8\u518c\u4e2d\u5fc3\u53ef\u4ee5\u5bf9\u670d\u52a1\u63d0\u4f9b\u65b9\u548c\u670d\u52a1\u6d88\u8d39\u65b9\u8fdb\u884c\u89e3\u8026\u3002\u5177\u4f53\u7684\u5de5\u4f5c\u6a21\u5f0f\u5982\u4e0b\u56fe\u6240\u793a\uff1a\n</code></pre> <p>![[Pasted image 20251120172658.png]]</p> <p>\u5de5\u4f5c\u6d41\u7a0b\u8bf4\u660e\uff1a</p> <pre><code>1\u3001\u670d\u52a1\u63d0\u4f9b\u65b9\u5728\u542f\u52a8\u7684\u65f6\u5019\uff0c\u4f1a\u5411\u6ce8\u518c\u4e2d\u5fc3\u6ce8\u518c\u81ea\u5df1\u670d\u52a1\u7684\u8be6\u60c5\u4fe1\u606f(ip\u3001\u7aef\u53e3\u53f7\u7b49)\u3002\u5728\u6ce8\u518c\u4e2d\u5fc3\u4e2d\u4f1a\u7ef4\u62a4\u4e00\u5f20\u670d\u52a1\u6e05\u5355\uff0c\u4fdd\u5b58\u8fd9\u4e9b\u6ce8\u518c\u4fe1\u606f\uff0c\u6ce8\u518c\u4e2d\u5fc3\u9700\u8981\u4ee5\u5fc3\u8df3\u7684\u65b9\u5f0f\u53bb\u76d1\u6d4b\u6e05\u5355\u4e2d\u7684\u670d\u52a1\u662f\u5426\u53ef\u7528\uff0c\u5982\u679c\u4e0d\u53ef\u7528\uff0c\u9700\u8981\u5728\u670d\u52a1\u6e05\u5355\u4e2d\u5254\u9664\u4e0d\u53ef\u7528\u7684\u670d\u52a1\u3002\n\n2\u3001\u670d\u52a1\u6d88\u8d39\u65b9\u5411\u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3\u54a8\u8be2\u670d\u52a1\uff0c\u5e76\u83b7\u53d6\u6240\u6709\u670d\u52a1\u7684\u5b9e\u4f8b\u6e05\u5355\uff0c\u7136\u540e\u6309\u7167\u6307\u5b9a\u7684\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u4ece\u670d\u52a1\u6e05\u5355\u4e2d\u9009\u62e9\u4e00\u4e2a\u670d\u52a1\u5b9e\u4f8b\u8fdb\u884c\u8bbf\u95ee\u3002\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1-nacos","title":"1. Nacos\u7684\u4ecb\u7ecd","text":"<pre><code>Nacos\u662f Dynamic Naming and Configuration Service\u7684\u9996\u5b57\u6bcd\u7b80\u79f0\uff0c\u4e00\u4e2a\u66f4\u6613\u4e8e\u6784\u5efa\u4e91\u539f\u751f\u5e94\u7528\u7684\u52a8\u6001\u670d\u52a1\u53d1\u73b0\u3001\u914d\u7f6e\u7ba1\u7406\u548c\u670d\u52a1\u7ba1\u7406\u5e73\u53f0\u3002\nNacos \u81f4\u529b\u4e8e\u5e2e\u52a9\u60a8\u53d1\u73b0\u3001\u914d\u7f6e\u548c\u7ba1\u7406\u5fae\u670d\u52a1\u3002Nacos \u63d0\u4f9b\u4e86\u4e00\u7ec4\u7b80\u5355\u6613\u7528\u7684\u7279\u6027\u96c6\uff0c\u5e2e\u52a9\u60a8\u5feb\u901f\u5b9e\u73b0\u52a8\u6001\u670d\u52a1\u53d1\u73b0\u3001\u670d\u52a1\u914d\u7f6e\u3001\u670d\u52a1\u5143\u6570\u636e\u53ca\u6d41\u91cf\u7ba1\u7406\u3002\n</code></pre> <p>![[Pasted image 20251120183525.png]]</p> <pre><code>Nacos Server\uff1a\u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3\uff0c\u5b83\u662f\u670d\u52a1\uff0c\u5176\u5b9e\u4f8b\u53ca\u5143\u6570\u636e\u7684\u6570\u636e\u5e93\u3002\u670d\u52a1\u5b9e\u4f8b\u5728\u542f\u52a8\u65f6\u6ce8\u518c\u5230\u670d\u52a1\u6ce8\u518c\u8868\uff0c\u5e76\u5728\u5173\u95ed\u65f6\u6ce8\u9500\u3002\u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3\u53ef\u80fd\u4f1a\u8c03\u7528\u670d\u52a1\u5b9e\u4f8b\u7684\u5065\u5eb7\u68c0\u67e5 API \u6765\u9a8c\u8bc1\u5b83\u662f\u5426\u80fd\u591f\u5904\u7406\u8bf7\u6c42\u3002Nacos Server\u9700\u8981\u72ec\u7acb\u7684\u90e8\u7f72\u3002\n\nNacos Client: Nacos Client\u8d1f\u8d23\u548cNacos Server\u8fdb\u884c\u901a\u8baf\u5b8c\u6210\u670d\u52a1\u7684\u6ce8\u518c\u548c\u670d\u52a1\u7684\u53d1\u73b0\u3002\n\nNacos Console\uff1a\u662fNacos\u7684\u63a7\u5236\u6a21\u5757\uff0cNacos\u63d0\u4f9b\u4e86\u53ef\u89c6\u5316\u7684\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf\uff0c\u53ef\u4ee5\u5f88\u5bb9\u6613\u7684\u5b9e\u73b0\u670d\u52a1\u7ba1\u7406\u64cd\u4f5c\u3002\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2-nacos-docker","title":"2. Nacos \u7684\u5b89\u88c5\u4e0e\u542f\u52a8\uff08docker\uff09","text":"<pre><code># \u62c9\u53d6\u955c\u50cf\ndocker pull nacos/nacos-server:v2.1.1\n\n# \u521b\u5efa\u5bb9\u5668\ndocker run --name nacos -e MODE=standalone -p 8848:8848 -p 9848:9848 -d nacos/nacos-server:v2.1.1\n\n# nacos2.x\u7684\u7248\u672c\u65b0\u589e\u4e86\u4e00\u4e2a\u5ba2\u6237\u7aef\u4e0e\u670d\u52a1\u7aef\u7684gRpc\u7684\u901a\u8baf\u7aef\u53e3\u53f79848\n</code></pre> <p>\u6253\u5f00\u6d4f\u89c8\u5668\u8bbf\u95eenacos\u7684\u6240\u63d0\u4f9b\u7684\u540e\u7aef\u7ba1\u7406\u754c\u9762\uff1aNacos \u7528\u6237\u540d\u548c\u5bc6\u7801\uff1anacos/nacos</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3-nacos","title":"3. \u5fae\u670d\u52a1\u96c6\u6210 nacos","text":"<ol> <li> <p>\u5bfc\u5165\u4f9d\u8d56 <pre><code>&lt;!-- nacos\u4f5c\u4e3a\u6ce8\u518c\u4e2d\u5fc3\u7684\u4f9d\u8d56 --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre></p> </li> <li> <p>\u8fdb\u884c\u914d\u7f6e <pre><code>spring:\n  # \u914d\u7f6enacos\u6ce8\u518c\u4e2d\u5fc3\u7684\u5730\u5740\n  cloud:\n    nacos:\n      discovery:\n        server-addr: localhost:8848\n  application:\n    name: spzx-cloud-user   # \u6bcf\u4e00\u4e2a\u670d\u52a1\u6ce8\u518c\u5230nacos\u6ce8\u518c\u4e2d\u5fc3\u90fd\u9700\u8981\u63d0\u4f9b\u4e00\u4e2a\u670d\u52a1\u540d\u79f0,order\u5fae\u670d\u52a1\u6ce8\u518c\u7684\u65f6\u5019\u9700\u8981\u66f4\u6539\u5fae\u670d\u52a1\u540d\u79f0\n</code></pre></p> </li> <li> <p>\u4e4b\u540e\u8c03\u7528\u7528\u670d\u52a1\u540d\u5b57\u4ee3\u66ffip\u5730\u5740\u5373\u53ef</p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#4-discoveryclient","title":"4. DiscoveryClient","text":"<pre><code>\u53ef\u4ee5\u901a\u8fc7discoveryClient\u6765\u83b7\u53d6\u670d\u52a1\u7684\u670d\u52a1\u5217\u8868\u3002\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#5_5","title":"5. \u9ad8\u7ea7\u7279\u6027","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#51_1","title":"5.1 \u5c31\u8fd1\u673a\u623f\u8bbf\u95ee","text":"<p>![[Pasted image 20251121094939.png]]</p> <p>\u5b9e\u73b0\u65b9\u6cd5\uff1a 1. \u5148\u7ed9\u96c6\u7fa4\u8bbe\u7f6e\u4e00\u4e2a\u540d\u5b57,\u7136\u540e\uff0cnacos\u5c31\u53ef\u4ee5\u6839\u636e\u96c6\u7fa4\u540d\u5b57\u628a\u8282\u70b9\u5212\u5206\u4e3a\u4e0d\u540c\u96c6\u7fa4\u3002</p> <pre><code>spring:\n    cloud:\n        nacos:\n            discovery:\n                cluster-name = xxx\n</code></pre> <ol> <li>\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u8bbe\u7f6e\uff08\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u914d\u7f6e\u5728\u8c03\u7528\u8005\u914d\uff09 <pre><code># loadbalancer\u8981\u542f\u7528nacos\u7ec4\u4ef6\u63d0\u4f9b\u7684\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\uff1a\u5c31\u8fd1\u673a\u623f\u968f\u673a\u8bbf\u95ee\nspring:\n    cloud:\n        loadbalancer:\n            nacos:\n                enabled:true\n</code></pre></li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#52_1","title":"5.2 \u6743\u91cd\u914d\u7f6e","text":"<pre><code>\u53ef\u4ee5\u914d\u7f6e\u6743\u91cd\u6765\u8bbe\u7f6e\u670d\u52a1\u5b9e\u4f8b\u627f\u62c5\u670d\u52a1\u7684\u53ef\u80fd\u6027\u3002\n</code></pre> <p>\u5728\u670d\u52a1\u63d0\u4f9b\u8005\u7aef\u914d\u7f6e\uff1a <pre><code>spring:\n    cloud:\n        nacos:\n            discovery:weight:0 -  100\n</code></pre></p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#53_1","title":"5.3  \u73af\u5883\u9694\u79bb","text":"<p>\u5728\u5b9e\u9645\u7684\u5f00\u53d1\u8fc7\u7a0b\u4e2d\uff0c\u53ef\u80fd\u4f1a\u5b58\u5728\u5f88\u591a\u4e2a\u8f6f\u4ef6\u73af\u5883\uff1a\u5f00\u53d1\u73af\u5883\u3001\u6d4b\u8bd5\u73af\u5883\u3001\u751f\u4ea7\u73af\u5883\u3002nacos \u4e5f\u662f\u652f\u6301\u591a\u73af\u5883\u9694\u79bb\u914d\u7f6e\u7684\uff0c\u5728 nacos \u662f\u901a\u8fc7 namespace \u6765\u5b9e\u73b0\u591a\u73af\u5883\u7684\u9694\u79bb\u3002</p> <p>\u5b8c\u6574\u7684\u670d\u52a1\u6ce8\u518c\u6570\u636e\u5b58\u50a8\u7ed3\u6784\u5982\u4e0b\u6240\u793a\uff1a ![[Pasted image 20251121100513.png]]</p> <p>\u4e0b\u9762\u662f\u5982\u4f55\u8ba9\u670d\u52a1\u6ce8\u518c\u5230\u6307\u5b9a\u7684\u547d\u540d\u7a7a\u95f4\uff1a <pre><code>spring:\n    cloud:\n        nacos:\n            discovery:\n                server-addr: nacos\u5730\u5740\n                namespace: \u5bf9\u5e94\u547d\u540d\u7a7a\u95f4\u7684id\n</code></pre></p> <p>\u5373\u4f7f\u5728\u540c\u4e00\u4e2a\u547d\u540d\u7a7a\u95f4\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4e0d\u540c\u7684\u7ec4\u540d\u5212\u5206\u3002\u8fd9\u4e2a\u65f6\u5019\u5373\u4f7f\u670d\u52a1\u540d\u5b57\u76f8\u540c\uff0c\u4e5f\u4e0d\u5c5e\u4e8e\u4e00\u4e2a\u96c6\u7fa4</p> <pre><code>spring:\n    cloud:\n        nacos:\n            discovery:\n                server-addr: nacos\u5730\u5740\n                namespace: \u5bf9\u5e94\u547d\u540d\u7a7a\u95f4\u7684id\n                group: \u7ec4\u540d\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#54_1","title":"5.4 \u4e34\u65f6\u5b9e\u4f8b\u4e0e\u6c38\u4e45\u5b9e\u4f8b","text":"<pre><code>todo\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#6-loadbalancer","title":"6. LoadBalancer","text":"<p>Spring Cloud LoadBalancer\u662fSpring Cloud\u4e2d\u8d1f\u8d23\u5ba2\u6237\u7aef\u8d1f\u8f7d\u5747\u8861\u7684\u6a21\u5757\uff0c\u5176\u4e3b\u8981\u539f\u7406\u662f\u901a\u8fc7\u9009\u62e9\u5408\u9002\u7684\u670d\u52a1\u5b9e\u4f8b\u6765\u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1_14","title":"1. \u4f7f\u7528\u65b9\u5f0f","text":"<ol> <li>\u5728order\u5fae\u670d\u52a1\u4e2d\u6dfb\u52a0\u4f9d\u8d56</li> </ol> <pre><code>    &lt;!-- spring cloud \u6240\u63d0\u4f9b\u7684\u8d1f\u8f7d\u5747\u8861\u5668 --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-cloud-loadbalancer&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <ol> <li>\u5728\u58f0\u660eRestTemplate\u7684\u65b9\u6cd5\u4e0a\u6dfb\u52a0@LoadBalanced\u6ce8\u89e3</li> </ol> <pre><code>@Bean\n@LoadBalanced       // \u8ba9RestTemplate\u5177\u6709\u8d1f\u8f7d\u5747\u8861\u7684\u80fd\u529b\npublic RestTemplate restTemplate() {\n    return new RestTemplate() ;\n}\n</code></pre> <ol> <li>\u66f4\u6539\u8fdc\u7a0b\u8c03\u7528\u4ee3\u7801 <pre><code>// \u670d\u52a1\u63d0\u4f9b\u65b9\u7684\u670d\u52a1ip\u5730\u5740\u548c\u7aef\u53e3\u53f7\u53ef\u4ee5\u4f7f\u7528\u670d\u52a1\u63d0\u4f9b\u65b9\u7684\u670d\u52a1\u540d\u79f0\u8fdb\u884c\u66ff\u6362\nrestTemplate.getForObject(\"http://spzx-cloud-user/api/user/findUserByUserId/\" + order.getUserId(), User.class);\n</code></pre></li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2-loadbalancer","title":"2. LoadBalancer \u7684\u539f\u7406","text":"<p>Spring Cloud LoadBalancer\u7684\u5e95\u5c42\u91c7\u7528\u4e86\u4e00\u4e2a\u62e6\u622a\u5668 LoadBalancerInterceptor\uff0c\u62e6\u622a\u4e86RestTemplate\u53d1\u51fa\u7684\u8bf7\u6c42\uff0c\u5bf9\u5730\u5740\u505a\u4e86\u4fee\u6539\u3002\u7528\u4e00\u5e45\u56fe\u6765\u603b\u7ed3\u4e00\u4e0b\uff1a</p> <p>![[Pasted image 20251121102631.png]]</p> <p>\u6267\u884c\u6d41\u7a0b\u8bf4\u660e\uff1a</p> <p>1\u3001\u901a\u8fc7LoadBalancerInterceptor\u8bf7\u6c42\u62e6\u622a\u5668\u62e6\u622a\u6211\u4eec\u7684RestTemplate\u8bf7\u6c42\uff1ahttp://spzx-cloud-user/api/user/findUserByUserId/1</p> <p>2\u3001\u83b7\u53d6\u8bf7\u6c42\u7684url\uff0c\u7136\u540e\u4ece\u8bf7\u6c42\u7684url\u4e2d\u83b7\u53d6\u670d\u52a1\u63d0\u4f9b\u65b9\u7684\u4e3b\u673a\u540d\u79f0</p> <p>3\u3001\u7136\u540e\u8c03\u7528LoadBalancerClient\u4e2d\u7684execute\u65b9\u6cd5\uff0c\u5c06\u670d\u52a1\u63d0\u4f9b\u65b9\u7684\u540d\u79f0\u4f20\u9012\u8fc7\u53bb</p> <p>4\u3001\u5728LoadBalancerClient\u7684choose\u65b9\u6cd5\u4e2d\u901a\u8fc7ReactiveLoadBalancer.Factory\u4eceNacos\u6ce8\u518c\u4e2d\u5fc3\u4e2d\u83b7\u53d6\u670d\u52a1\u5217\u8868\u4ee5\u53ca\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u5b9e\u4f8b\u5bf9\u8c61</p> <p>5\u3001\u901a\u8fc7ReactiveLoadBalancer\u4ece\u670d\u52a1\u5217\u8868\u4e2d\u9009\u62e9\u4e00\u4e2a\u670d\u52a1\u5b9e\u4f8b\u5730\u5740\uff0c\u7136\u540e\u53d1\u8d77\u8fdc\u7a0b\u8c03\u7528</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3_9","title":"3.  \u66f4\u6539\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5","text":"<p>LoadBalancer\u9ed8\u8ba4\u7684\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u662fRoundRobinLoadBalancer\uff0c\u5982\u679c\u60f3\u66f4\u6539\u9ed8\u8ba4\u7684\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\uff0c\u90a3\u4e48\u6b64\u65f6\u9700\u8981\u5411Spring\u5bb9\u5668\u4e2d\u6ce8\u518c\u4e00\u4e2aBean\uff0c\u5e76\u4e14\u914d\u7f6e\u8d1f\u8f7d\u5747\u8861\u7684\u4f7f\u7528\u8005\u3002</p> <ol> <li> <p>\u5728 Spring \u5bb9\u5668\u4e2d\u6ce8\u518c\u4e00\u4e2a Bean <pre><code>@Configuration\npublic class CustomLoadBalancerConfiguration {\n\n    /**\n     * @param environment: \u7528\u4e8e\u83b7\u53d6\u73af\u5883\u5c5e\u6027\u914d\u7f6e\uff0c\u5176\u4e2dLoadBalancerClientFactory.PROPERTY_NAME\u8868\u793a\u8be5\u8d1f\u8f7d\u5747\u8861\u5668\u8981\u5e94\u7528\u7684\u670d\u52a1\u540d\u79f0\u3002\n     * @param loadBalancerClientFactory: \u662fSpring Cloud\u4e2d\u7528\u4e8e\u521b\u5efa\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u5de5\u5382\u7c7b\uff0c\u901a\u8fc7getLazyProvider\u65b9\u6cd5\u83b7\u53d6ServiceInstanceListSupplier\u5bf9\u8c61\uff0c\u4ee5\u63d0\u4f9b\u53ef\u7528\u7684\u670d\u52a1\u5217\u8868\u3002\n     * ServiceInstanceListSupplier\uff1a\u7528\u4e8e\u63d0\u4f9bServiceInstance\u5217\u8868\u7684\u63a5\u53e3\uff0c\u53ef\u4ee5\u4eceDiscoveryClient\u6216\u8005\u5176\u4ed6\u6ce8\u518c\u4e2d\u5fc3\u4e2d\u83b7\u53d6\u53ef\u7528\u7684\u670d\u52a1\u5b9e\u4f8b\u5217\u8868\u3002\n     * @return\n     */\n    @Bean\n    ReactorLoadBalancer&lt;ServiceInstance&gt; randomLoadBalancer(Environment environment, LoadBalancerClientFactory loadBalancerClientFactory) {\n        String name = environment.getProperty(LoadBalancerClientFactory.PROPERTY_NAME);\n        return new RandomLoadBalancer(loadBalancerClientFactory.getLazyProvider(name, ServiceInstanceListSupplier.class), name);\n    }\n}\n</code></pre></p> </li> <li> <p>\u914d\u7f6e\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u7684\u4f7f\u7528\u8005 <pre><code>@Configuration\n@LoadBalancerClients(value = {\n        @LoadBalancerClient(name = \"spzx-cloud-user\" , configuration = CustomLoadBalancerConfiguration.class)      // \u5c06\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u5e94\u7528\u5230\u6307\u5b9a\u7684\u670d\u52a1\u63d0\u4f9b\u65b9\u4e2d\n})\npublic class RestTemplateConfiguration {\n\n    @Bean\n    @LoadBalanced       // \u8ba9RestTemplate\u5177\u6709\u8d1f\u8f7d\u5747\u8861\u7684\u80fd\u529b\n    public RestTemplate restTemplate() {\n        return new RestTemplate() ;\n    }\n\n}\n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#7-openfeign","title":"7. OpenFeign","text":"<p>feign\u662f\u4e00\u4e2a\u58f0\u660e\u5f0f\u7684http\u5ba2\u6237\u7aef\uff0c\u5b98\u65b9\u5730\u5740\uff1ahttps://github.com/OpenFeign/feign\u5176\u4f5c\u7528\u5c31\u662f\u5e2e\u52a9\u6211\u4eec\u4f18\u96c5\u7684\u5b9e\u73b0http\u8bf7\u6c42\u7684\u53d1\u9001\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1_15","title":"1. \u4f7f\u7528\u65b9\u6cd5","text":"<ol> <li>\u5bfc\u5165\u4f9d\u8d56 <pre><code>&lt;!-- \u52a0\u5165OpenFeign\u7684\u4f9d\u8d56 --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre></li> <li> <p>\u5f00\u542f\u529f\u80fd</p> <p>\u5728\u542f\u52a8\u7c7b\u4e0a\u6dfb\u52a0@EnableFeignClients**\u5f00\u542fOpenFeign\u7684\u529f\u80fd\u652f\u6301</p> </li> <li> <p>\u7f16\u5199 OpenFeign \u7684\u5ba2\u6237\u7aef <pre><code>@FeignClient(value = \"spzx-cloud-user\")     // \u58f0\u660e\u5f53\u524d\u63a5\u53e3\u662f\u4e00\u4e2a\u8bbf\u95eeuser-service\u7684feign\u7684\u5ba2\u6237\u7aef\npublic interface UserFeignClient {\n\n    @GetMapping(\"/api/user/findUserByUserId/{userId}\")\n    public abstract User queryById(@PathVariable(\"userId\") Long userId) ;   // \u6839\u636euserId\u67e5\u8be2\u7528\u6237\u4fe1\u606f\u7684\u63a5\u53e3\u65b9\u6cd5\n\n}\n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2-openfeign","title":"2. OpenFeign \u7684\u81ea\u5b9a\u4e49\u914d\u7f6e","text":"<p>OpenFeign\u53ef\u4ee5\u652f\u6301\u5f88\u591a\u7684\u81ea\u5b9a\u4e49\u914d\u7f6e\uff0c\u5982\u4e0b\u8868\u6240\u793a\uff1a   </p> \u7c7b\u578b \u4f5c\u7528 \u8bf4\u660e feign.Logger.Level \u4fee\u6539\u65e5\u5fd7\u7ea7\u522b \u5305\u542b\u56db\u79cd\u4e0d\u540c\u7684\u7ea7\u522b\uff1aNONE\u3001BASIC\u3001HEADERS\u3001FULL feign.codec.Decoder \u54cd\u5e94\u7ed3\u679c\u7684\u89e3\u6790\u5668 http\u8fdc\u7a0b\u8c03\u7528\u7684\u7ed3\u679c\u505a\u89e3\u6790\uff0c\u4f8b\u5982\u89e3\u6790json\u5b57\u7b26\u4e32\u4e3ajava\u5bf9\u8c61 feign.codec.Encoder \u8bf7\u6c42\u53c2\u6570\u7f16\u7801 \u5c06\u8bf7\u6c42\u53c2\u6570\u7f16\u7801\uff0c\u4fbf\u4e8e\u901a\u8fc7http\u8bf7\u6c42\u53d1\u9001 feign.Contract \u652f\u6301\u7684\u6ce8\u89e3\u683c\u5f0f \u9ed8\u8ba4\u662fSpringMVC\u7684\u6ce8\u89e3 feign.Retryer \u5931\u8d25\u91cd\u8bd5\u673a\u5236 \u8bf7\u6c42\u5931\u8d25\u7684\u91cd\u8bd5\u673a\u5236\uff0c\u9ed8\u8ba4\u662f\u6ca1\u6709\uff0c\u4e0d\u8fc7\u4f1a\u4f7f\u7528Ribbon\u7684\u91cd\u8bd5 <p>\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u9ed8\u8ba4\u503c\u5c31\u80fd\u6ee1\u8db3\u6211\u4eec\u4f7f\u7528\uff0c\u5982\u679c\u8981\u81ea\u5b9a\u4e49\u65f6\uff0c\u53ea\u9700\u8981\u521b\u5efa\u81ea\u5b9a\u4e49\u7684@Bean\u8986\u76d6\u9ed8\u8ba4Bean\u5373\u53ef\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#21_1","title":"2.1 \u65e5\u5fd7\u914d\u7f6e","text":"<pre><code># \u5c06feign\u5305\u4e0b\u4ea7\u751f\u7684\u65e5\u5fd7\u7684\u7ea7\u522b\u8bbe\u7f6e\u4e3adebug\nlogging:\n  level:\n    com.atguigu.spzx.cloud.order.feign: debug\n\n# openfeign\u65e5\u5fd7\u7ea7\u522b\u914d\u7f6e\nspring:\n  cloud:\n    openfeign:\n      client:\n        config: \n          default:  # \u8fd9\u91cc\u7528default\u5c31\u662f\u5168\u5c40\u914d\u7f6e\uff0c\u5982\u679c\u662f\u5199\u670d\u52a1\u540d\u79f0\uff0c\u5219\u662f\u9488\u5bf9\u67d0\u4e2a\u5fae\u670d\u52a1\u7684\u914d\u7f6e\n            loggerLevel: full\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u57fa\u4e8eJava\u4ee3\u7801\u6765\u4fee\u6539\u65e5\u5fd7\u7ea7\u522b\uff0c\u5148\u58f0\u660e\u4e00\u4e2a\u7c7b\uff0c\u7136\u540e\u58f0\u660e\u4e00\u4e2aLogger.Level\u7684\u5bf9\u8c61\uff1a</p> <pre><code>\u00a0public class DefaultFeignConfiguration  {  \n\u00a0 \u00a0 \u00a0@Bean  \n\u00a0 \u00a0 \u00a0public Logger.Level feignLogLevel(){  \n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0return Logger.Level.BASIC; // \u65e5\u5fd7\u7ea7\u522b\u4e3aBASIC  \n\u00a0 \u00a0  }  \n\u00a0}\n</code></pre> <p>\u5982\u679c\u8981\u5168\u5c40\u751f\u6548\uff0c\u5c06\u5176\u653e\u5230\u542f\u52a8\u7c7b\u7684@EnableFeignClients\u8fd9\u4e2a\u6ce8\u89e3\u4e2d\uff1a <pre><code>\u00a0@EnableFeignClients(defaultConfiguration = DefaultFeignConfiguration .class) \n</code></pre> \u5982\u679c\u662f\u5c40\u90e8\u751f\u6548\uff0c\u5219\u628a\u5b83\u653e\u5230\u5bf9\u5e94\u7684@FeignClient\u8fd9\u4e2a\u6ce8\u89e3\u4e2d\uff1a <pre><code>\u00a0@FeignClient(value = \"spzx-cloud-user\", configuration = DefaultFeignConfiguration .class)\n</code></pre></p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#22_1","title":"2.2 \u8d85\u65f6\u914d\u7f6e","text":"<p>\u9ed8\u8ba4\u8fde\u63a5\u8d85\u65f6\uff1a10s\uff0c\u54cd\u5e94\u8d85\u65f6\uff1a60s</p> <p>\u8d85\u65f6\u673a\u5236\u6982\u8ff0\uff1aFeign \u7684\u8d85\u65f6\u673a\u5236\u662f\u6307\u5728\u4f7f\u7528 Feign \u8fdb\u884c\u670d\u52a1\u95f4\u7684 HTTP \u8c03\u7528\u65f6\uff0c\u8bbe\u7f6e\u8bf7\u6c42\u7684\u8d85\u65f6\u65f6\u95f4\u3002\u5f53\u8bf7\u6c42\u8d85\u8fc7\u8bbe\u5b9a\u7684\u8d85\u65f6\u65f6\u95f4\u540e\uff0cFeign \u5c06\u4f1a\u4e2d\u65ad\u8be5\u8bf7\u6c42\u5e76\u629b\u51fa\u76f8\u5e94\u7684\u5f02\u5e38\u3002</p> <p>\u8d85\u65f6\u673a\u5236\u7684\u610f\u4e49\uff1a</p> <p>1\u3001\u9632\u6b62\u957f\u65f6\u95f4\u7b49\u5f85\uff1a\u901a\u8fc7\u8bbe\u7f6e\u9002\u5f53\u7684\u8d85\u65f6\u65f6\u95f4\uff0c\u53ef\u4ee5\u907f\u514d\u5ba2\u6237\u7aef\u5728\u8bf7\u6c42\u670d\u52a1\u65f6\u957f\u65f6\u95f4\u7b49\u5f85\u54cd\u5e94\u800c\u5bfc\u81f4\u7684\u6027\u80fd\u95ee\u9898\u3002\u5982\u679c\u6ca1\u6709\u8d85\u65f6\u673a\u5236\uff0c\u5ba2\u6237\u7aef\u53ef\u80fd\u4f1a\u4e00\u76f4\u7b49\u5f85\uff0c\u4ece\u800c\u5f71\u54cd\u6574\u4e2a\u7cfb\u7edf\u7684\u541e\u5410\u91cf\u548c\u54cd\u5e94\u65f6\u95f4\u3002</p> <p>2\u3001\u907f\u514d\u8d44\u6e90\u6d6a\u8d39\uff1a\u8d85\u65f6\u673a\u5236\u53ef\u4ee5\u5e2e\u52a9\u53ca\u65f6\u91ca\u653e\u5360\u7528\u7684\u8d44\u6e90\uff0c\u4f8b\u5982\u8fde\u63a5\u3001\u7ebf\u7a0b\u7b49\u3002\u5982\u679c\u8bf7\u6c42\u4e00\u76f4\u5904\u4e8e\u7b49\u5f85\u72b6\u6001\u800c\u4e0d\u8d85\u65f6\uff0c\u5c06\u5bfc\u81f4\u8d44\u6e90\u7684\u6d6a\u8d39\u548c\u7cfb\u7edf\u7684\u8d1f\u8f7d\u589e\u52a0\u3002</p> <p>3\u3001\u4f18\u5316\u7528\u6237\u4f53\u9a8c\uff1a\u8d85\u65f6\u673a\u5236\u53ef\u4ee5\u9632\u6b62\u7528\u6237\u957f\u65f6\u95f4\u7b49\u5f85\u65e0\u54cd\u5e94\u7684\u60c5\u51b5\u53d1\u751f\uff0c\u63d0\u4f9b\u66f4\u597d\u7684\u7528\u6237\u4f53\u9a8c\u3002\u5f53\u8bf7\u6c42\u8d85\u65f6\u65f6\uff0c\u53ef\u4ee5\u53ca\u65f6\u7ed9\u51fa\u9519\u8bef\u63d0\u793a\u6216\u8fdb\u884c\u76f8\u5e94\u7684\u5904\u7406\uff0c\u4ee5\u63d0\u9192\u7528\u6237\u6216\u91c7\u53d6\u5176\u4ed6\u63aa\u65bd\u3002</p> <p>\u914d\u7f6e\u5982\u4e0b\uff1a <pre><code>spring:\n  cloud:\n    openfeign:\n      client:\n        config:\n          default:\n            loggerLevel: full   \n            read-timeout: 2000          # \u8bfb\u53d6\u6570\u636e\u7684\u8d85\u65f6\u65f6\u95f4\u8bbe\u7f6e\u4e3a2s\n            connect-timeout: 2000       # \u5efa\u7acb\u8fde\u63a5\u7684\u8d85\u65f6\u65f6\u95f4\u8bbe\u7f6e\u4e3a2s\n</code></pre></p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#23_1","title":"2.3 \u91cd\u8bd5\u914d\u7f6e","text":"<p>feign\u4e00\u65e6\u8bf7\u6c42\u8d85\u65f6\u4e86\uff0c\u90a3\u4e48\u6b64\u65f6\u5c31\u4f1a\u76f4\u63a5\u629b\u51faSocketTimeoutException: Read timed out\u7684\u5f02\u5e38\u3002\u8bf7\u6c42\u8d85\u65f6\u7684\u539f\u56e0\u6709\u5f88\u591a\u79cd\uff0c\u5982\u7f51\u7edc\u6296\u52a8\u3001\u670d\u52a1\u4e0d\u53ef\u7528\u7b49\u3002\u5982\u679c\u7531\u4e8e\u7f51\u7edc\u6682\u65f6\u4e0d\u53ef\u7528\u5bfc\u81f4\u89e6\u53d1\u4e86\u8d85\u65f6\u673a\u5236\uff0c\u90a3\u4e48\u6b64\u65f6\u76f4\u63a5\u8fd4\u56de\u5f02\u5e38\u4fe1\u606f\u5c31\u5e76\u4e0d\u662f\u7279\u522b\u7684\u5408\u7406\uff0c\u5c24\u5176\u9488\u5bf9\u67e5\u8be2\u8bf7\u6c42\uff0c\u80af\u5b9a\u5e0c\u671b\u5f97\u5230\u4e00\u4e2a\u7ed3\u679c\u3002\u5408\u7406\u7684\u505a\u6cd5\uff1a\u89e6\u53d1\u8d85\u65f6\u4ee5\u540e\uff0c\u8ba9feign\u8fdb\u884c\u91cd\u8bd5\u3002</p> <ol> <li> <p>\u81ea\u5b9a\u4e49\u91cd\u8bd5\u5668 \u5b9e\u73b0 Retryer \u63a5\u53e3 <pre><code>public class FeignClientRetryer implements Retryer {\n\n    // \u5b9a\u4e49\u4e24\u4e2a\u6210\u5458\u53d8\u91cf\u6765\u51b3\u5b9a\u91cd\u8bd5\u6b21\u6570\n    private int start = 1 ;\n    private int end = 3 ;\n\n    @Override\n    public void continueOrPropagate(RetryableException e) {     // \u662f\u5426\u9700\u8981\u8fdb\u884c\u91cd\u8bd5\u53d6\u51b3\u4e8e\u8be5\u65b9\u6cd5\u662f\u5426\u629b\u51fa\u5f02\u5e38\uff0c\u5982\u679c\u629b\u51fa\u5f02\u5e38\u91cd\u8bd5\u7ed3\u675f\n        if(start &gt;= end) {\n            throw new RuntimeException(e) ;\n        }\n        start++ ;\n    }\n\n    @Override\n    public Retryer clone() {    // \u6846\u67b6\u5e95\u5c42\u8c03\u7528\u8be5\u65b9\u6cd5\u5f97\u5230\u4e00\u4e2a\u91cd\u8bd5\u5668\n        return new FeignClientRetryer();\n    }\n}\n</code></pre></p> </li> <li> <p>\u914d\u7f6e\u91cd\u8bd5\u5668 <pre><code>spring:  \n  cloud:  \n    openfeign:  \n      client:   \n        config:  \n          default: # \u914d\u7f6e\u54ea\u4e2a\u670d\u52a1\uff0c\u5982\u679c\u5199default\u5c31\u662f\u5168\u5c40\u914d\u7f6e  \n            logger-level:  full  \n            connect-timeout: 3000  \n            read-timeout: 3000  \n            retryer: \"person.ltb.openfeign.MyRetryer\"\n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#8-nacos","title":"8. Nacos \u914d\u7f6e\u4e2d\u5fc3","text":"<p>\u73b0\u5728\uff0c\u4e0d\u540c\u7684\u5fae\u670d\u52a1\u90fd\u5f97\u5355\u72ec\u53bb\u5199 yaml \u914d\u7f6e\u6587\u4ef6\uff0c\u8fd9\u6837\u5728\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u65f6\u975e\u5e38\u4e0d\u65b9\u4fbf\uff0c\u5c24\u5176\u662f\u8fd0\u884c\u5728\u5bb9\u5668\u73af\u5883\u4e2d\uff0c\u8fd9\u65f6\u5019\uff0cnacos \u63d0\u4f9b\u4e86\u914d\u7f6e\u4e2d\u5fc3\uff0c\u5c31\u50cf\u5bf9\u4e0d\u540c\u670d\u52a1\u7684\u96c6\u4e2d\u7ba1\u7406\u4e00\u6837\u3002</p> <p>\u914d\u7f6e\u547d\u540d\u89c4\u5219\uff1a\u670d\u52a1\u540d\u79f0-profile.yaml</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1_16","title":"1. \u4f7f\u7528\u65b9\u6cd5","text":"<ol> <li> <p>\u5bfc\u5165\u914d\u7f6e\u4e2d\u5fc3\u7684\u4f9d\u8d56 <pre><code>&lt;!-- nacos\u4f5c\u4e3a\u914d\u7f6e\u4e2d\u5fc3\u65f6\u6240\u5bf9\u5e94\u7684\u4f9d\u8d56 --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-config&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre></p> </li> <li> <p>\u5728yaml\u4e2d\u914d\u7f6e\u5f53\u524d\u914d\u7f6e\u4e2d\u5fc3 <pre><code>spring:\n  cloud:\n    nacos:\n      config:\n        server-addr: xxx:8848\n  config:\n    import:\n      - nacos:xxx.yml\n</code></pre></p> </li> <li> <p>\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7 @Value \u6216\u8005 @ConfigurationProperties \u6765\u62ff\u5230\u914d\u7f6e\u503c\u4e86\u3002</p> </li> </ol> <p>\u6ce8\uff1a\u60f3\u8981\u5f00\u59cb\u70ed\u66f4\u65b0\uff0c\u8fd8\u5f97\u4f7f\u7528 @ RefreshScope \u6ce8\u89e3</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#9-gateway","title":"9. Gateway","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1-gateway","title":"1. Gateway\u7b80\u4ecb","text":"<ul> <li> <p>Gateway\u662f\u5728spring\u751f\u6001\u7cfb\u7edf\u4e4b\u4e0a\u6784\u5efa\u7684API\u7f51\u5173\u670d\u52a1\uff0c\u57fa\u4e8eSpring5\uff0cSpringBoot2\u548cProject Reactor\u7b49\u6280\u672f\u3002Gateway\u65e8\u5728\u63d0\u4f9b\u4e00\u79cd\u7b80\u5355\u800c\u6709\u6548\u7684\u65b9\u5f0f\u6765\u5bf9API\u8fdb\u884c\u8def\u7531\uff0c\u4ee5\u53ca\u63d0\u4f9b\u4e00\u4e9b\u5f3a\u5927\u7684\u8fc7\u6ee4\u5668\u529f\u80fd\uff0c\u4f8b\u5982\uff1a\u7194\u65ad\u3001\u9650\u6d41\u3001\u91cd\u8bd5\u7b49</p> </li> <li> <p>SpringCloud Gateway\u662fSpringCloud\u7684\u4e00\u4e2a\u5168\u65b0\u9879\u76ee\uff0c\u57fa\u4e8eSpring5.X+SpringBoot2.X\u548cProject Reactor\u7b49\u6280\u672f\u5f00\u53d1\u7684\u7f51\u5173\uff0c\u5b83\u65e8\u5728\u4e3a\u5fae\u670d\u52a1\u67b6\u6784\u63d0\u4f9b\u4e00\u79cd\u7b80\u5355\u6709\u6548\u7684\u7edf\u4e00\u7684API\u8def\u7531\u7ba1\u7406\u65b9\u5f0f\u3002</p> </li> <li> <p>\u4e3a\u4e86\u63d0\u5347\u7f51\u5173\u7684\u6027\u80fd\uff0cSpringCloud Gatway\u662f\u57fa\u4e8eWebFlux\u6846\u67b6\u5b9e\u73b0\u7684\uff0c\u800cWebFlux\u6846\u67b6\u5e95\u5c42\u5219\u4f7f\u7528\u4e86\u9ad8\u6027\u80fd\u7684Reactor\u6a21\u5f0f\u901a\u8baf\u6846\u67b6Netty\u3002</p> </li> <li> <p>SpringCloud Gateway\u7684\u76ee\u6807\u63d0\u4f9b\u7edf\u4e00\u7684\u8def\u7531\u65b9\u5f0f\u4e14\u57fa\u4e8eFilter\u94fe\u7684\u65b9\u5f0f\u63d0\u4f9b\u4e86\u7f51\u5173\u57fa\u672c\u7684\u529f\u80fd\uff0c\u4f8b\u5982\uff1a\u5b89\u5168\u3001\u76d1\u63a7/\u6307\u6807\u3001\u548c\u9650\u6d41\u3002</p> </li> </ul> <p>![[Pasted image 20251121171843.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2_16","title":"2. \u6838\u5fc3\u6982\u5ff5","text":"<ol> <li>Route\uff1a\u8def\u7531\u662f\u6784\u5efa\u7f51\u5173\u7684\u57fa\u672c\u6a21\u5757\uff0c\u5b83\u7531ID\uff0c\u76ee\u6807URI\uff0c\u4e00\u7cfb\u5217\u7684\u65ad\u8a00\u548c\u8fc7\u6ee4\u5668\u7ec4\u6210\uff0c\u5982\u679c\u65ad\u8a00\u4e3atrue\u5219\u5339\u914d\u8be5\u8def\u7531</li> <li>Predicate\uff1a\u53c2\u8003\u7684\u662fjava8\u7684java.util.function.Predicate\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u5339\u914dHTTP\u8bf7\u6c42\u4e2d\u7684\u6240\u6709\u5185\u5bb9\uff08\u4f8b\u5982\u8bf7\u6c42\u5934\u6216\u8bf7\u6c42\u53c2\u6570\uff09\uff0c\u5982\u679c\u8bf7\u6c42\u4e0e\u65ad\u8a00\u76f8\u5339\u914d\u5219\u8fdb\u884c\u8def\u7531</li> <li>Fliter\uff1a\u6307\u7684\u662fSpring\u6846\u67b6\u4e2dGatewayFilter\u7684\u5b9e\u4f8b\uff0c\u4f7f\u7528\u8fc7\u6ee4\u5668\uff0c\u53ef\u4ee5\u5728\u8bf7\u6c42\u88ab\u8def\u7531\u524d\u6216\u8005\u4e4b\u540e\u5bf9\u8bf7\u6c42\u8fdb\u884c\u4fee\u6539\u3002</li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3-gateway","title":"3. Gateway \u4f7f\u7528\u65b9\u6cd5","text":"<pre><code>\u7f51\u5173\u662f\u4e00\u4e2a\u4e13\u95e8\u7684\u670d\u52a1\n</code></pre> <ol> <li>\u5bfc\u5165\u4f9d\u8d56 <code>&lt;!--\u7f51\u5173--&gt; &lt;dependency&gt;     &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;     &lt;artifactId&gt;spring-cloud-starter-gateway&lt;/artifactId&gt; &lt;/dependency&gt;  &lt;!--nacos\u670d\u52a1\u53d1\u73b0\u4f9d\u8d56--&gt; &lt;dependency&gt;     &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;     &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt; &lt;/dependency&gt;  &lt;!-- \u8d1f\u8f7d\u5747\u8861\u7ec4\u4ef6 --&gt; &lt;dependency&gt;     &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;     &lt;artifactId&gt;spring-cloud-loadbalancer&lt;/artifactId&gt; &lt;/dependency&gt;</code></li> <li>\u53bb\u914d\u7f6e\u8def\u7531 <code>server:   port: 8222 spring:   application:     name: spzx-cloud-gateway   cloud:     gateway:       discovery:         locator:           enabled: true       routes:         - id: spzx-cloud-user  # \u8def\u7531id\uff0c\u53ef\u4ee5\u81ea\u5b9a\u4e49\uff0c\u53ea\u8981\u552f\u4e00\u5373\u53ef           uri: lb://spzx-cloud-user  # \u8def\u7531\u7684\u76ee\u6807\u5730\u5740 lb\u5c31\u662f\u8d1f\u8f7d\u5747\u8861\uff0c\u540e\u9762\u8ddf\u670d\u52a1\u540d\u79f0           predicates:             - Path=/*/user/** # \u8def\u5f84\u5339\u914d         - id: spzx-cloud-order           uri: lb://spzx-cloud-order           predicates:             - Path=/*/order/** # \u8def\u5f84\u5339\u914d     nacos:       discovery:         server-addr: 127.0.0.1:8848</code></li> </ol> <p>\u91cd\u70b9\u914d\u7f6e\uff1a\u8def\u7531\u7684\u914d\u7f6e\u4ee5\u53ca\u5f00\u59cb\u7f51\u5173\u7684\u6ce8\u518c\u670d\u52a1 <pre><code>cloud:\n    gateway:\n      discovery:\n        locator:\n          enabled: true\n      routes:\n        - id: spzx-cloud-user  # \u8def\u7531id\uff0c\u53ef\u4ee5\u81ea\u5b9a\u4e49\uff0c\u53ea\u8981\u552f\u4e00\u5373\u53ef\n          uri: lb://spzx-cloud-user  # \u8def\u7531\u7684\u76ee\u6807\u5730\u5740 lb\u5c31\u662f\u8d1f\u8f7d\u5747\u8861\uff0c\u540e\u9762\u8ddf\u670d\u52a1\u540d\u79f0\n          predicates:\n            - Path=/*/user/** # \u8def\u5f84\u5339\u914d\n        - id: spzx-cloud-order\n          uri: lb://spzx-cloud-order\n          predicates:\n            - Path=/*/order/** # \u8def\u5f84\u5339\u914d\n</code></pre></p> <ol> <li>\u542f\u52a8\u670d\u52a1\u5373\u53ef</li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#4-predicate","title":"4. Predicate \u7684\u4f7f\u7528","text":"<pre><code>springcloud \u63d0\u4f9b\u4e86 10+ \u65ad\u8a00\u7c7b\u578b\uff0c\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u7684\u4e1a\u52a1\u8981\u6c42\u6765\u6dfb\u52a0\n</code></pre> <p>eg: <code>java spring:     cloud:         gateway:             routers:                 - id:                    url:                    predicates:                     - Path=xxx                     - Header=xxx</code></p> <p>Predicate \u5b98\u65b9\u6587\u6863</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#5-fliter","title":"5. Fliter \u7684\u4f7f\u7528","text":"<pre><code>\u5728gateway\u4e2d\u8981\u5b9e\u73b0\u5176\u4ed6\u7684\u529f\u80fd\uff1a\u6743\u9650\u63a7\u5236\u3001\u6d41\u91cf\u76d1\u63a7\u3001\u7edf\u4e00\u65e5\u5fd7\u5904\u7406\u7b49\u3002\u5c31\u9700\u8981\u4f7f\u7528\u5230gateway\u4e2d\u6240\u63d0\u4f9b\u7684\u8fc7\u6ee4\u5668\u4e86\u3002\u8fc7\u6ee4\u5668\uff0c\u53ef\u4ee5\u5bf9\u8fdb\u5165\u7f51\u5173\u7684\u8bf7\u6c42\u548c\u5fae\u670d\u52a1\u8fd4\u56de\u7684\u54cd\u5e94\u505a\u5904\u7406\uff1a\n</code></pre> <p>spring gateway \u63d0\u4f9b\u4e8631\u79cd\u4e0d\u540c\u7684\u8fc7\u6ee4\u5668\uff0c\u8fd9\u4e9b\u8fc7\u6ee4\u5668\u65e2\u53ef\u4ee5\u505a\u8def\u7531\u8fc7\u6ee4\u5668\uff0c\u4e5f\u53ef\u4ee5\u53bb\u505a\u9ed8\u8ba4\u8fc7\u6ee4\u5668 GatewayFilter \u5b98\u65b9\u6587\u6863</p> <p>1) \u8def\u7531\u8fc7\u6ee4\u5668\u7684\u4f7f\u7528 <pre><code>spring:\n    cloud:\n        gateway:\n            routers:\n                - id: \n                  url: \n                  fliters:\n                   - AddRequestHeader=Truth, atguigu\n</code></pre></p> <p>2) \u9ed8\u8ba4\u8fc7\u6ee4\u5668\u7684\u4f7f\u7528 <pre><code>spring:\n    cloud:\n        gateway:\n            routers:\n                - id: \n                  url: \n            default-filters:\n                - AddRequestHeader=Truth, atguigu is good\n</code></pre></p> <p>3) \u5168\u5c40\u8fc7\u6ee4\u5668\u7684\u4f7f\u7528 <pre><code>public class AuthFilter implements GlobalFilter, Ordered {  \n    @Override  \n    public Mono&lt;Void&gt; filter(ServerWebExchange exchange, GatewayFilterChain chain) {  \n        // 1. \u5982\u679c\u8bf7\u6c42\u6ca1\u5e26\u8bf7\u6c42\u5934username\uff0c\u6211\u4eec\u5c31\u62e6\u622a\uff0c\u53cd\u6b63\u653e\u884c  \n        String username = exchange.getRequest().getQueryParams().getFirst(\"username\");  \n        if(username ==  null || username.length() &gt; 0){  \n            // \u62e6\u622a  \n            return exchange.getResponse().setComplete();  \n        }  \n\n        // \u4e4b\u524d\u7684\u53eb\u505apre  \n        Mono&lt;Void&gt; filter = chain.filter(exchange);  \n        // \u540e\u9762\u7684\u53eb\u505apost  \n        return filter;  \n    }  \n\n    @Override  \n    public int getOrder() {  \n        return 0;  \n    }  \n}\n</code></pre></p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#x","title":"x. \u8fc7\u6ee4\u5668\u6267\u884c\u987a\u5e8f","text":"<p>![[Pasted image 20251121171606.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#10-sentinel","title":"10. Sentinel","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1_17","title":"1. \u96ea\u5d29\u6548\u5e94","text":"<p>\u6982\u8ff0\uff1a\u5728\u5fae\u670d\u52a1\u7cfb\u7edf\u67b6\u6784\u4e2d\uff0c\u670d\u52a1\u95f4\u8c03\u7528\u5173\u7cfb\u9519\u7efc\u590d\u6742\uff0c\u4e00\u4e2a\u5fae\u670d\u52a1\u5f80\u5f80\u4f9d\u8d56\u4e8e\u591a\u4e2a\u5176\u5b83\u5fae\u670d\u52a1\u3002\u4e00\u4e2a\u670d\u52a1\u7684\u4e0d\u53ef\u7528\u5bfc\u81f4\u6574\u4e2a\u7cfb\u7edf\u7684\u4e0d\u53ef\u7528\u7684\u73b0\u8c61\u5c31\u88ab\u79f0\u4e4b\u4e3a\u96ea\u5d29\u6548\u5e94\u3002</p> <p>![[Pasted image 20251122150659.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2_17","title":"2. \u89e3\u51b3\u65b9\u6848","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#21_2","title":"2.1 \u8d85\u65f6\u5904\u7406","text":"<p>\u8d85\u65f6\u5904\u7406\uff1a\u8bbe\u5b9a\u8d85\u65f6\u65f6\u95f4\uff0c\u8bf7\u6c42\u8d85\u8fc7\u4e00\u5b9a\u65f6\u95f4\u6ca1\u6709\u54cd\u5e94\u5c31\u8fd4\u56de\u9519\u8bef\u4fe1\u606f\uff0c\u4e0d\u4f1a\u65e0\u4f11\u6b62\u7b49\u5f85 ![[Pasted image 20251122150936.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#22_2","title":"2.2 \u9694\u79bb\u5904\u7406","text":"<p>\u9694\u79bb\u5904\u7406\uff1a\u5c06\u9519\u8bef\u9694\u79bb\u5728\u53ef\u63a7\u7684\u8303\u56f4\u4e4b\u5185\uff0c\u4e0d\u8981\u8ba9\u5176\u5f71\u54cd\u5230\u5176\u4ed6\u7684\u7a0b\u5e8f\u7684\u8fd0\u884c\u3002 \u8fd9\u79cd\u8bbe\u8ba1\u601d\u60f3\uff0c\u6765\u6e90\u4e8e\u8239\u8231\u7684\u8bbe\u8ba1\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a ![[Pasted image 20251122151011.png]] \u8239\u8231\u90fd\u4f1a\u88ab\u9694\u677f\u5206\u79bb\u4e3a\u591a\u4e2a\u72ec\u7acb\u7a7a\u95f4\uff0c\u5f53\u8239\u4f53\u7834\u635f\u65f6\uff0c\u53ea\u4f1a\u5bfc\u81f4\u90e8\u5206\u7a7a\u95f4\u8fdb\u5165\uff0c\u5c06\u6545\u969c\u63a7\u5236\u5728\u4e00\u5b9a\u8303\u56f4\u5185\uff0c\u907f\u514d\u6574\u4e2a\u8239\u4f53\u90fd\u88ab\u6df9\u6ca1\u3002\u4e8e\u6b64\u7c7b\u4f3c\uff0c\u6211\u4eec\u4e1a\u52a1\u7cfb\u7edf\u4e5f\u53ef\u4ee5\u4f7f\u7528\u8fd9\u79cd\u601d\u60f3\u6765\u9632\u6b62\u51fa\u73b0\u96ea\u5d29\u6548\u5e94\uff0c\u5e38\u89c1\u7684\u9694\u79bb\u65b9\u5f0f\uff1a\u7ebf\u7a0b\u9694\u79bb ![[Pasted image 20251122151024.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#23_2","title":"2.3 \u7194\u65ad\u5904\u7406","text":"<p>\u7531\u65ad\u8def\u5668\u7edf\u8ba1\u4e1a\u52a1\u6267\u884c\u7684\u5f02\u5e38\u6bd4\u4f8b\uff0c\u5982\u679c\u8d85\u51fa\u9608\u503c\u5219\u4f1a\u7194\u65ad\u8be5\u4e1a\u52a1\uff0c\u62e6\u622a\u8bbf\u95ee\u8be5\u4e1a\u52a1\u7684\u4e00\u5207\u8bf7\u6c42\u3002 ![[Pasted image 20251122151049.png]] \u8bf7\u6c42\u4e86\u4e09\u6b21\uff0c\u4e24\u6b21\u51fa\u73b0\u5f02\u5e38\uff0c\u4e00\u6b21\u6210\u529f\u3002\u5f53\u53d1\u73b0\u8bbf\u95ee\u670d\u52a1D\u7684\u8bf7\u6c42\u5f02\u5e38\u6bd4\u4f8b\u8fc7\u9ad8\u65f6\uff0c\u8ba4\u4e3a\u670d\u52a1D\u6709\u5bfc\u81f4\u96ea\u5d29\u7684\u98ce\u9669\uff0c\u4f1a\u62e6\u622a\u8bbf\u95ee\u670d\u52a1D\u7684\u4e00\u5207\u8bf7\u6c42\uff0c\u5f62\u6210\u7194\u65ad\uff1a ![[Pasted image 20251122151108.png]] \u89e6\u53d1\u7194\u65ad\u4e86\u4ee5\u540e\uff0c\u5f53\u5728\u8bbf\u95ee\u670d\u52a1A\u7684\u65f6\u5019\uff0c\u5c31\u4e0d\u4f1a\u5728\u901a\u8fc7\u670d\u52a1A\u53bb\u8bbf\u95ee\u670d\u52a1D\u4e86\uff0c\u7acb\u9a6c\u7ed9\u7528\u6237\u8fdb\u884c\u8fd4\u56de\uff0c\u8fd4\u56de\u7684\u662f\u4e00\u79cd\u9ed8\u8ba4\u503c\uff0c\u8fd9\u79cd\u8fd4\u56de\u5c31\u662f\u4e00\u79cd\u515c\u5e95\u65b9\u6848\u3002\u8fd9\u79cd\u515c\u5e95\u65b9\u6848\u4e5f\u5c06\u5176\u79f0\u4e4b\u4e3a\u964d\u7ea7\u903b\u8f91\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#24","title":"2.4 \u6d41\u91cf\u63a7\u5236","text":"<p>\u6d41\u91cf\u63a7\u5236\uff1a\u9650\u5236\u4e1a\u52a1\u8bbf\u95ee\u7684QPS(\u6bcf\u79d2\u7684\u8bf7\u6c42\u6570)\uff0c\u907f\u514d\u670d\u52a1\u56e0\u6d41\u91cf\u7684\u7a81\u589e\u800c\u6545\u969c\u3002 ![[Pasted image 20251122151151.png]] \u9650\u6d41\u662f\u4e00\u79cd\u9884\u9632\u63aa\u65bd\uff0c\u907f\u514d\u56e0\u77ac\u95f4\u9ad8\u5e76\u53d1\u6d41\u91cf\u800c\u5bfc\u81f4\u670d\u52a1\u6545\u969c\uff0c\u8fdb\u800c\u907f\u514d\u96ea\u5d29\u3002\u5176\u4ed6\u7684\u5904\u7406\u65b9\u5f0f\u662f\u4e00\u79cd\u8865\u6551\u63aa\u65bd\uff0c\u5728\u90e8\u5206\u670d\u52a1\u6545\u969c\u65f6\uff0c\u5c06\u6545\u969c\u63a7\u5236\u5728\u4e00\u5b9a\u8303\u56f4\uff0c\u907f\u514d\u96ea\u5d29\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3-sentinel","title":"3. Sentinel \u7684\u5b89\u88c5\u4e0e\u6574\u5408","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#31_3","title":"3.1 \u5b89\u88c5","text":"<p>sentenel \u540e\u7aef\u662f\u4e00\u4e2aspringboot\u9879\u76ee\uff0c\u4e0b\u8f7d\u4e0b\u6765\u76f4\u63a5\u7528java-jar\u8fd0\u884c\u5373\u53ef</p> <pre><code>java -jar sentinel-dashboard-2.0.0-alpha-preview.jar\n</code></pre> \u914d\u7f6e\u9879 \u9ed8\u8ba4\u503c \u8bf4\u660e server.port 8080 \u670d\u52a1\u7aef\u53e3 sentinel.dashboard.auth.username sentinel \u9ed8\u8ba4\u7528\u6237\u540d sentinel.dashboard.auth.password sentinel \u9ed8\u8ba4\u5bc6\u7801 <p>eg: <pre><code>java -Dserver.port=8090 -jar sentinel-dashboard-2.0.0-alpha-preview.jar\n</code></pre></p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#32-sentinel","title":"3.2 \u6574\u5408 sentinel","text":"<p>\u4e00\u822c\u8981\u96c6\u6210\u5728\u670d\u52a1\u7684\u8c03\u7528\u8005\u4e0a</p> <ol> <li> <p>\u5bfc\u5165\u4f9d\u8d56 <pre><code>&lt;!--sentinel--&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; \n    &lt;artifactId&gt;spring-cloud-starter-alibaba-sentinel&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre></p> </li> <li> <p>\u5199\u5165\u914d\u7f6e <pre><code>spring:\n  cloud:\n    sentinel:\n      transport:\n        dashboard: localhost:8080  # \u914d\u7f6esentinel\u63a7\u5236\u53f0\u5730\u5740\n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#4_4","title":"4. \u6d41\u91cf\u63a7\u5236","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#41","title":"4.1 \u76f8\u5173\u6982\u5ff5","text":"<p>\u7c07\u70b9\u94fe\u8def\uff1a\u5f53\u8bf7\u6c42\u8fdb\u5165\u5fae\u670d\u52a1\u65f6\uff0c\u9996\u5148\u4f1a\u8bbf\u95eeDispatcherServlet\uff0c\u7136\u540e\u8fdb\u5165Controller\u3001Service\u3001Mapper\uff0c\u8fd9\u6837\u7684\u4e00\u4e2a\u8c03\u7528\u94fe\u5c31\u53eb\u505a\u7c07\u70b9\u94fe\u8def\u3002</p> <p>\u8d44\u6e90\uff1a\u7c07\u70b9\u94fe\u8def\u4e2d\u88ab\u76d1\u63a7\u7684\u6bcf\u4e00\u4e2a\u63a5\u53e3\u5c31\u662f\u4e00\u4e2a\u8d44\u6e90\uff0c\u6d41\u63a7\u3001\u7194\u65ad\u7b49\u90fd\u662f\u9488\u5bf9\u7c07\u70b9\u94fe\u8def\u4e2d\u7684\u8d44\u6e90\u6765\u8bbe\u7f6e\u7684\u3002</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0bsentinel\u4f1a\u76d1\u63a7spring mvc\u7684\u6bcf\u4e00\u4e2a\u7aef\u70b9\uff08Endpoint\uff0c\u4e5f\u5c31\u662fcontroller\u4e2d\u7684\u65b9\u6cd5\uff09\uff0c\u56e0\u6b64spring mvc\u7684\u6bcf\u4e00\u4e2a\u7aef\u70b9\u5c31\u662f\u8c03\u7528\u94fe\u8def\u4e2d\u7684\u4e00\u4e2a\u8d44\u6e90\u3002</p> <p>\u4f8b\u5982\uff0c\u6211\u4eec\u521a\u624d\u8bbf\u95ee\u7684spzx-cloud-user\u4e2d\u7684UserController\u4e2d\u7684\u7aef\u70b9\uff1a/api/user/findUserByUserId/{userId}</p> <p>######  4.2 \u6d41\u63a7\u6a21\u5f0f</p> <p>\u5728\u6dfb\u52a0\u9650\u6d41\u89c4\u5219\u65f6\uff0c\u70b9\u51fb\u9ad8\u7ea7\u9009\u9879\uff0c\u53ef\u4ee5\u9009\u62e9\u4e09\u79cd\u6d41\u63a7\u6a21\u5f0f\uff1a</p> <pre><code>1\u3001\u76f4\u63a5\uff1a\u7edf\u8ba1\u5f53\u524d\u8d44\u6e90\u7684\u8bf7\u6c42\uff0c\u89e6\u53d1\u9608\u503c\u65f6\u5bf9\u5f53\u524d\u8d44\u6e90\u76f4\u63a5\u9650\u6d41\uff0c\u4e5f\u662f\u9ed8\u8ba4\u7684\u6a21\u5f0f\n2\u3001\u5173\u8054\uff1a\u7edf\u8ba1\u4e0e\u5f53\u524d\u8d44\u6e90\u76f8\u5173\u7684\u53e6\u4e00\u4e2a\u8d44\u6e90\uff0c\u89e6\u53d1\u9608\u503c\u65f6\uff0c\u5bf9\u5f53\u524d\u8d44\u6e90\u9650\u6d41\n3\u3001\u94fe\u8def\uff1a\u7edf\u8ba1\u4ece\u6307\u5b9a\u94fe\u8def\u8bbf\u95ee\u5230\u672c\u8d44\u6e90\u7684\u8bf7\u6c42\uff0c\u89e6\u53d1\u9608\u503c\u65f6\uff0c\u5bf9\u6307\u5b9a\u94fe\u8def\u9650\u6d41\n</code></pre> <p>\u5982\u4e0b\u6240\u793a\uff1a</p> <p>![[Pasted image 20251122155157.png]]</p> <ol> <li>\u5173\u8054\u6a21\u5f0f</li> </ol> <p>\u8bed\u6cd5\u8bf4\u660e\uff1a\u5bf9/api/user/updateUserById\u8d44\u6e90\u7684\u8bf7\u6c42\u8fdb\u884c\u7edf\u8ba1\uff0c\u5f53\u8bbf\u95ee\u6d41\u91cf\u8d85\u8fc7\u9608\u503c\u65f6\uff0c\u5c31\u5bf9/api/user/findUserByUserId/{userId}\u8fdb\u884c\u9650\u6d41\uff0c\u907f\u514d\u5f71\u54cd/api/user/updateUserById\u8d44\u6e90\u3002</p> <p>\u4f7f\u7528\u573a\u666f\uff1a\u6bd4\u5982\u7528\u6237\u652f\u4ed8\u65f6\u9700\u8981\u4fee\u6539\u8ba2\u5355\u72b6\u6001\uff0c\u540c\u65f6\u7528\u6237\u8981\u67e5\u8be2\u8ba2\u5355\u3002\u67e5\u8be2\u548c\u4fee\u6539\u64cd\u4f5c\u4f1a\u4e89\u62a2\u6570\u636e\u5e93\u9501\uff0c\u4ea7\u751f\u7ade\u4e89\u3002\u4e1a\u52a1\u9700\u6c42\u662f\u4f18\u5148\u652f\u4ed8\u548c\u66f4\u65b0\u8ba2\u5355\u7684\u4e1a\u52a1\uff0c\u56e0\u6b64\u5f53\u4fee\u6539\u8ba2\u5355\u4e1a\u52a1\u89e6\u53d1\u9608\u503c\u65f6\uff0c\u9700\u8981\u5bf9\u67e5\u8be2\u8ba2\u5355\u4e1a\u52a1\u9650\u6d41\u3002</p> <p>![[Pasted image 20251122155255.png]]</p> <ol> <li>\u94fe\u8def\u6a21\u5f0f</li> </ol> <p>\u53ea\u9488\u5bf9\u4ece\u6307\u5b9a\u94fe\u8def\u8bbf\u95ee\u5230\u672c\u8d44\u6e90\u7684\u8bf7\u6c42\u505a\u7edf\u8ba1\uff0c\u5224\u65ad\u662f\u5426\u8d85\u8fc7\u9608\u503c\uff0c\u5982\u679c\u8d85\u8fc7\u9608\u503c\u5bf9\u4ece\u8be5\u94fe\u8def\u8bf7\u6c42\u8fdb\u884c\u9650\u6d41\u3002</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0csentinel\u53ea\u76d1\u63a7controller\u65b9\u6cd5\uff0c\u56e0\u6b64\uff0c\u901a\u8fc7 @SentinelResource **\u6807\u8bb0 UserService \u4e2d\u7684 queryUsers \u65b9\u6cd5\u4e3a\u4e00\u4e2asentinel\u76d1\u63a7\u7684\u8d44\u6e90</p> <p>\u94fe\u8def\u6a21\u5f0f\u4e2d\uff0c\u662f\u5bf9\u4e0d\u540c\u6765\u6e90\u7684\u4e24\u4e2a\u94fe\u8def\u505a\u76d1\u63a7\u3002\u4f46\u662fsentinel\u9ed8\u8ba4\u4f1a\u7ed9\u8fdb\u5165spring mvc\u7684\u6240\u6709\u8bf7\u6c42\u8bbe\u7f6e\u540c\u4e00\u4e2aroot\u8d44\u6e90\uff0c\u4f1a\u5bfc\u81f4\u94fe\u8def\u6a21\u5f0f\u5931\u6548\u3002\u56e0\u6b64\u9700\u8981\u5173\u95ed\u8fd9\u79cd\u8d44\u6e90\u6574\u5408\u3002 <pre><code>spring:\n  cloud:\n    sentinel:\n      web-context-unify: false # \u5173\u95edcontext\u6574\u5408\n</code></pre></p> <p>\u914d\u7f6e\u65b9\u5f0f\uff1a</p> <pre><code>1\u3001/api/user/save --&gt; users\n2\u3001/api/user/query --&gt; users\n</code></pre> <p>\u5982\u679c\u53ea\u5e0c\u671b\u7edf\u8ba1\u4ece/api/user/query\u8fdb\u5165\u5230users\u7684\u8bf7\u6c42\uff0c\u5e76\u8fdb\u884c\u9650\u6d41\u64cd\u4f5c\uff0c\u5219\u53ef\u4ee5\u8fd9\u6837\u914d\u7f6e\uff1a ![[Pasted image 20251122155445.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#43","title":"4.3 \u6d41\u63a7\u6548\u679c","text":"<p>\u6d41\u63a7\u6548\u679c\u662f\u6307\u8bf7\u6c42\u8fbe\u5230\u6d41\u63a7\u9608\u503c\u65f6\u5e94\u8be5\u91c7\u53d6\u7684\u63aa\u65bd\uff0c\u5305\u62ec\u4e09\u79cd\uff1a</p> <p>1\u3001\u5feb\u901f\u5931\u8d25\uff1a\u8fbe\u5230\u9608\u503c\u540e\uff0c\u65b0\u7684\u8bf7\u6c42\u4f1a\u88ab\u7acb\u5373\u62d2\u7edd\u5e76\u629b\u51faFlowException\u5f02\u5e38\uff0c\u662f\u9ed8\u8ba4\u7684\u5904\u7406\u65b9\u5f0f</p> <p>2\u3001warm up\uff1a\u9884\u70ed\u6a21\u5f0f\uff0c\u5bf9\u8d85\u51fa\u9608\u503c\u7684\u8bf7\u6c42\u540c\u6837\u662f\u62d2\u7edd\u5e76\u629b\u51fa\u5f02\u5e38\uff0c\u4f46\u8fd9\u79cd\u6a21\u5f0f\u9608\u503c\u4f1a\u52a8\u6001\u53d8\u5316\uff0c\u4ece\u4e00\u4e2a\u8f83\u5c0f\u503c(qps\u76841/3\uff09\u9010\u6e10\u589e\u52a0\u5230\u6700\u5927\u9608\u503c</p> <p>\u5de5\u4f5c\u7279\u70b9\uff1a\u8bf7\u6c42\u9608\u503c\u521d\u59cb\u503c\u662f maxThreshold / coldFactor, \u6301\u7eed\u6307\u5b9a\u65f6\u957f(\u9884\u70ed\u65f6\u95f4)\u540e\uff0c\u9010\u6e10\u63d0\u9ad8\u5230maxThreshold\u503c\uff0c\u800ccoldFactor\u7684\u9ed8\u8ba4\u503c\u662f3\u3002</p> <p>3\u3001\u6392\u961f\u7b49\u5f85\uff1a\u8ba9\u6240\u6709\u7684\u8bf7\u6c42\u6309\u7167\u5148\u540e\u6b21\u5e8f\u8fdb\u5165\u5230\u4e00\u4e2a\u961f\u5217\u4e2d\u8fdb\u884c\u6392\u961f\uff0c\u5f53\u67d0\u4e00\u4e2a\u8bf7\u6c42\u6700\u5927\u7684\u9884\u671f\u7b49\u5f85\u65f6\u95f4\u8d85\u8fc7\u4e86\u6240\u8bbe\u5b9a\u7684\u8d85\u65f6\u65f6\u95f4\u65f6\u540c\u6837\u662f\u62d2\u7edd\u5e76\u629b\u51fa\u5f02\u5e38</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#44","title":"4.4 \u70ed\u70b9\u8d44\u6e90\u9650\u6d41","text":"<p>\u4e4b\u524d\u7684\u9650\u6d41\u662f\u7edf\u8ba1\u8bbf\u95ee\u67d0\u4e2a\u8d44\u6e90\u7684\u6240\u6709\u8bf7\u6c42\uff0c\u5224\u65ad\u662f\u5426\u8d85\u8fc7QPS\u9608\u503c\u3002\u800c\u70ed\u70b9\u53c2\u6570\u9650\u6d41\u662f\u5206\u522b\u7edf\u8ba1\u53c2\u6570\u503c\u76f8\u540c\u7684\u8bf7\u6c42\uff0c\u5224\u65ad\u662f\u5426\u8d85\u8fc7QPS\u9608\u503c\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#langchain4j","title":"\u5341 LangChain4j","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#x-pinecone","title":"x. Pinecone \u7684\u96c6\u6210","text":"<ol> <li> <p>\u5bfc\u5165\u4f9d\u8d56 </p> </li> <li> <p>\u53bb\u521b\u5efa\u4e00\u4e2a\u5411\u91cf\u6570\u636e\u5e93</p> </li> <li>\u5b58\u50a8\u5411\u91cf</li> <li>\u68c0\u7d22\u5411\u91cf</li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#11-elasticsearch","title":"11 ElasticSearch","text":"<p>\u5b98\u7f51 Reference | Elastic Docs</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1_18","title":"1. \u6982\u8ff0","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#11","title":"1.1 \u7b80\u4ecb","text":"<p>ElasticSearch\u662f\u4e00\u4e2a\u57fa\u4e8eLucene\uff08Apache\u5f00\u6e90\u5168\u6587\u68c0\u7d22\u5de5\u5177\u5305\uff09\u7684\u641c\u7d22\u670d\u52a1\u5668\u3002\u5b83\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5206\u5e03\u5f0f\u591a\u7528\u6237\u80fd\u529b\u7684\u5168\u6587\u641c\u7d22\u5f15\u64ce\uff0c\u57fa\u4e8eRESTful web\u63a5\u53e3\u3002ElasticSearch\u662f\u7528Java\u5f00\u53d1\u7684\uff0c\u5e76\u4f5c\u4e3aApache\u8bb8\u53ef\u6761\u6b3e\u4e0b\u7684\u5f00\u653e\u6e90\u7801\u53d1\u5e03\uff0c\u662f\u5f53\u524d\u6d41\u884c\u7684\u4f01\u4e1a\u7ea7\u641c\u7d22\u5f15\u64ce\u3002 \u007f</p> <p>Elastic\u5b98\u65b9\u5ba3\u5e03ElasticSearch \u8fdb\u5165Version 8\uff0c\u5728\u901f\u5ea6\u3001\u6269\u5c55\u3001\u9ad8\u76f8\u5173\u6027\u548c\u7b80\u5355\u6027\u65b9\u9762\u5f00\u542f\u4e86\u4e00\u4e2a\u5168\u65b0\u7684\u65f6\u4ee3\u3002</p> <p>\u8bf4\u660e\uff1aElasticSearch 8\u6700\u4f4ejdk\u7248\u672c\u8981\u6c42jdk17\uff0c\u5f53\u524d\u6211\u4eec\u9009\u62e9ElasticSearch\u7248\u672c\uff1aElasticSearch8.5.0</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#12","title":"1.2 \u7279\u6027","text":"<p>\u8fd1\u5b9e\u65f6 \u7406\u8bba\u4e0a\u6570\u636e\u4ece\u5199\u5165ElasticSearch\u5230\u6570\u636e\u53ef\u4ee5\u88ab\u641c\u7d22\u53ea\u9700\u89811\u79d2\u5de6\u53f3\u7684\u65f6\u95f4\uff0c\u5b9e\u73b0\u51c6\u5b9e\u65f6\u7684\u6570\u636e\u7d22\u5f15\u548c\u67e5\u8be2\u3002</p> <p>\u5206\u5e03\u5f0f\u3001\u53ef\u6269\u5c55 \u5929\u751f\u7684\u5206\u5e03\u5f0f\u7684\u8bbe\u8ba1\uff0c\u6570\u636e\u5206\u7247\u5bf9\u4e8e\u5e94\u7528\u5c42\u900f\u660e\uff0c\u6269\u5c55\u6027\u826f\u597d\uff0c\u53ef\u4ee5\u8f7b\u6613\u7684\u8fdb\u884c\u8282\u70b9\u6269\u5bb9\uff0c\u652f\u6301\u4e0a\u767e\u751a\u81f3\u4e0a\u5343\u7684\u670d\u52a1\u5668\u8282\u70b9\uff0c\u652f\u6301PB\u7ea7\u522b\u7684\u6570\u636e\u5b58\u50a8\u548c\u641c\u7d22\u3002</p> <p>\u7a33\u5b9a\u53ef\u9760 ElasticSearch\u7684\u5206\u5e03\u5f0f\u3001\u6570\u636e\u5197\u4f59\u7279\u6027\u63d0\u4f9b\u66f4\u52a0\u53ef\u9760\u7684\u8fd0\u884c\u673a\u5236\uff0c\u4e14\u7ecf\u8fc7\u5927\u578b\u4e92\u8054\u7f51\u516c\u53f8\u4f17\u591a\u9879\u76ee\u4f7f\u7528\uff0c\u53ef\u9760\u6027\u5f97\u5230\u9a8c\u8bc1\u3002</p> <p>\u9ad8\u53ef\u7528 \u6570\u636e\u591a\u526f\u672c\u3001\u591a\u8282\u70b9\u5b58\u50a8\uff0c\u5355\u8282\u70b9\u7684\u6545\u969c\u4e0d\u5f71\u54cd\u96c6\u7fa4\u7684\u4f7f\u7528\u3002</p> <p>Rest API ElasticSearch\u63d0\u4f9b\u6807\u51c6\u7684Rest API\uff0c\u8fd9\u4f7f\u5f97\u6240\u6709\u652f\u6301Rest API\u7684\u8bed\u8a00\u90fd\u80fd\u591f\u8f7b\u6613\u7684\u4f7f\u7528ElasticSearch\uff0c\u5177\u5907\u591a\u8bed\u8a00\u901a\u7528\u7684\u652f\u6301\u7279\u6027\uff0c\u6613\u4e8e\u4f7f\u7528\u3002ElasticSearch Version 8\u4ee5\u540e\uff0c\u53bb\u9664\u4e86\u4ee5\u524dTransport API\u3001High-Level API\u3001Low-Level API\uff0c\u7edf\u4e00\u6807\u51c6\u7684Rest API\uff0c\u8fd9\u5c06\u4f7f\u5f97ElasticSearch\u66f4\u52a0\u5bb9\u6613\u4f7f\u7528\uff0c\u539f\u6765\u88ab\u8bdf\u75c5\u7684API\u6df7\u4e71\u95ee\u9898\u7ec8\u4e8e\u5f97\u5230\u5b8c\u7f8e\u89e3\u51b3\u3002</p> <p>\u9ad8\u6027\u80fd ElasticSearch\u5e95\u5c42\u6784\u5efa\u57fa\u4e8eLucene\uff0c\u5177\u5907\u5f3a\u5927\u7684\u641c\u7d22\u80fd\u529b\uff0c\u5373\u4fbf\u662fPB\u7ea7\u522b\u7684\u6570\u636e\u4f9d\u7136\u80fd\u591f\u5b9e\u73b0\u79d2\u7ea7\u7684\u641c\u7d22\u3002</p> <p>\u591a\u5ba2\u6237\u7aef\u652f\u6301 \u652f\u6301Java\u3001Python\u3001Go\u3001PHP\u3001Ruby\u7b49\u591a\u8bed\u8a00\u5ba2\u6237\u7aef\uff0c\u8fd8\u652f\u6301JDBC\u3001ODBC\u7b49\u5ba2\u6237\u7aef\u3002</p> <p>\u5b89\u5168\u652f\u6301 \u63d0\u4f9b\u5355\u70b9\u767b\u5f55SSO\u3001\u52a0\u5bc6\u901a\u4fe1\u3001\u96c6\u7fa4\u89d2\u8272\u3001\u5c5e\u6027\u7684\u8bbf\u95ee\u63a7\u5236\uff0c\u652f\u6301\u5ba1\u8ba1\u7b49\u529f\u80fd\uff0c\u5728\u5b89\u5168\u5c42\u9762\u4e0a\u8fd8\u652f\u6301\u96c6\u6210\u7b2c\u4e09\u65b9\u7684\u5b89\u5168\u7ec4\u4ef6\uff0c\u5728Version 8\u4ee5\u540e\uff0c\u9ed8\u8ba4\u5f00\u542f\u4e86HTTPS\uff0c\u5927\u5927\u7b80\u5316\u4e86\u5b89\u5168\u4e0a\u7684\u914d\u7f6e\u3002</p> <p>\u76f4\u63a5\u652f\u6301NLP ElasticSearch\u652f\u6301NLP\uff0c\u53ef\u4ee5\u5b9e\u73b0\u60c5\u611f\u5206\u6790\u3001\u6587\u672c\u5206\u7c7b\u7b49\u529f\u80fd\uff0c\u5728Version 8\u4e4b\u524d\uff0c\u9700\u8981\u989d\u5916\u7684\u5916\u90e8\u7ec4\u4ef6\uff0c\u800c\u5728Version 8\uff0c\u53ef\u4ee5\u76f4\u63a5\u5728ElasticSearch\u4e2d\u4f7f\u7528\u8fd9\u4e9b\u529f\u80fd\uff0c\u65e0\u9700\u989d\u5916\u7684\u7ec4\u4ef6\u3002</p> <p>\u539f\u751f\u77e2\u91cf\u641c\u7d22\u652f\u6301 Elastic 8.0 \u7248\u5f15\u5165\u4e86\u4e00\u6574\u5957\u539f\u751f\u77e2\u91cf\u641c\u7d22\u529f\u80fd\uff0c\u589e\u52a0\u4e86\u5bf9\u8fd1\u4f3c\u6700\u8fd1\u90bb (ANN) \u641c\u7d22\u7684\u539f\u751f\u652f\u6301\uff0c\u53ef\u4ee5\u5feb\u901f\u4e14\u5927\u89c4\u6a21\u5730\u6bd4\u8f83\u57fa\u4e8e\u77e2\u91cf\u7684\u67e5\u8be2\u4e0e\u57fa\u4e8e\u77e2\u91cf\u7684\u6587\u6863\u8bed\u6599\u5e93\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#13","title":"1.3 \u5e94\u7528\u573a\u666f","text":"<p>\u642d\u5efa\u65e5\u5fd7\u7cfb\u7edf ELK\u5957\u4ef6\u65e5\u5fd7\u7cfb\u7edf\u5e94\u8be5\u662fElasticSearch\u4f7f\u7528\u6700\u5e7f\u6cdb\u7684\u573a\u666f\u4e4b\u4e00\u4e86\uff0cElasticSearch\u652f\u6301\u6d77\u91cf\u6570\u636e\u7684\u5b58\u50a8\u548c\u67e5\u8be2\uff0c\u7279\u522b\u9002\u5408\u65e5\u5fd7\u641c\u7d22\u573a\u666f\u3002\u5e7f\u6cdb\u4f7f\u7528\u7684ELK\u5957\u4ef6(ElasticSearch\u3001Logstash\u3001Kibana)\u662f\u65e5\u5fd7\u7cfb\u7edf\u6700\u7ecf\u5178\u7684\u6848\u4f8b\uff0c\u4f7f\u7528Logstash\u548cBeats\u7ec4\u4ef6\u8fdb\u884c\u65e5\u5fd7\u6536\u96c6\uff0cElasticSearch\u5b58\u50a8\u548c\u67e5\u8be2\u5e94\u7528\u65e5\u5fd7\uff0cKibana\u63d0\u4f9b\u65e5\u5fd7\u7684\u53ef\u89c6\u5316\u641c\u7d22\u754c\u9762\u3002</p> <p>![[Pasted image 20260123095430.png]]</p> <p>\u642d\u5efa\u6570\u636e\u5206\u6790\u7cfb\u7edf  Elasitcsearch\u652f\u6301\u6570\u636e\u5206\u6790\uff0c\u4f8b\u5982\u5f3a\u5927\u7684\u6570\u636e\u805a\u5408\u529f\u80fd\uff0c\u901a\u8fc7\u642d\u914dKibana\uff0c\u63d0\u4f9b\u8bf8\u5982\u76f4\u65b9\u56fe\u3001\u7edf\u8ba1\u5206\u7ec4\u3001\u8303\u56f4\u805a\u5408\u7b49\u65b9\u4fbf\u4f7f\u7528\u7684\u529f\u80fd\uff0c\u80fd\u591f\u5feb\u901f\u5b9e\u73b0\u4e00\u4e9b\u6570\u636e\u62a5\u8868\u7b49\u529f\u80fd\u3002 \u5728\u6570\u5b57\u5316\u8f6c\u578b\u7684\u5927\u884c\u5176\u9053\u7684\u5f53\u4e0b\uff0c\u9700\u8981\u4ece\u6d77\u91cf\u6570\u636e\u4e2d\u53d1\u73b0\u6570\u636e\u7684\u89c4\u5f8b\uff0c\u4ece\u800c\u505a\u51fa\u4e00\u5b9a\u7684\u51b3\u7b56\uff0cElasticSearch\u4e00\u5b9a\u662f\u6700\u9002\u5408\u7684\u89e3\u51b3\u65b9\u6848\u4e4b\u4e00\u3002</p> <p>\u642d\u5efa\u641c\u7d22\u7cfb\u7edf  ElasticSearch\u4e3a\u641c\u7d22\u800c\u751f\uff0c\u7528\u4e8e\u642d\u5efa\u5168\u6587\u641c\u7d22\u7cfb\u7edf\u662f\u81ea\u7136\u800c\u7136\u7684\u4e8b\u60c5\uff0c\u5b83\u80fd\u591f\u63d0\u4f9b\u5feb\u901f\u7684\u7d22\u5f15\u548c\u641c\u7d22\u529f\u80fd\uff0c\u8fd8\u6709\u76f8\u5173\u7684\u8bc4\u5206\u529f\u80fd\u3001\u5206\u8bcd\u63d2\u4ef6\u7b49\uff0c\u652f\u6301\u4e30\u5bcc\u7684\u641c\u7d22\u7279\u6027\uff0c\u53ef\u4ee5\u7528\u4e8e\u642d\u5efa\u5927\u578b\u7684\u641c\u7d22\u5f15\u64ce\uff0c\u66f4\u52a0\u5e38\u7528\u8bed\u5b9e\u73b0\u7ad9\u5185\u641c\u7d22\uff0c\u4f8b\u5982\u94f6\u884cApp\u3001\u8d2d\u7269App\u7b49\u7ad9\u5185\u5546\u54c1\u3001\u670d\u52a1\u641c\u7d22\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#14","title":"1.4 \u5168\u6587\u641c\u7d22\u5f15\u64ce","text":"<p>Google\uff0c\u767e\u5ea6\u7c7b\u7684\u7f51\u7ad9\u641c\u7d22\uff0c\u5b83\u4eec\u90fd\u662f\u6839\u636e\u7f51\u9875\u4e2d\u7684\u5173\u952e\u5b57\u751f\u6210\u7d22\u5f15\uff0c\u6211\u4eec\u5728\u641c\u7d22\u7684\u65f6\u5019\u8f93\u5165\u5173\u952e\u5b57\uff0c\u5b83\u4eec\u4f1a\u5c06\u8be5\u5173\u952e\u5b57\u5373\u7d22\u5f15\u5339\u914d\u5230\u7684\u6240\u6709\u7f51\u9875\u8fd4\u56de\uff1b\u8fd8\u6709\u5e38\u89c1\u7684\u9879\u76ee\u4e2d\u5e94\u7528\u65e5\u5fd7\u7684\u641c\u7d22\u7b49\u7b49\u3002\u5bf9\u4e8e\u8fd9\u4e9b\u975e\u7ed3\u6784\u5316\u7684\u6570\u636e\u6587\u672c\uff0c\u5173\u7cfb\u578b\u6570\u636e\u5e93\u641c\u7d22\u4e0d\u662f\u80fd\u5f88\u597d\u7684\u652f\u6301\u3002</p> <p>\u4e00\u822c\u4f20\u7edf\u6570\u636e\u5e93\uff0c\u5168\u6587\u68c0\u7d22\u90fd\u5b9e\u73b0\u7684\u5f88\u9e21\u808b\uff0c\u56e0\u4e3a\u4e00\u822c\u4e5f\u6ca1\u4eba\u7528\u6570\u636e\u5e93\u5b58\u6587\u672c\u5b57\u6bb5\u3002\u8fdb\u884c\u5168\u6587\u68c0\u7d22\u9700\u8981\u626b\u63cf\u6574\u4e2a\u8868\uff0c\u5982\u679c\u6570\u636e\u91cf\u5927\u7684\u8bdd\u5373\u4f7f\u5bf9SQL\u7684\u8bed\u6cd5\u4f18\u5316\uff0c\u4e5f\u6536\u6548\u751a\u5fae\u3002\u5efa\u7acb\u4e86\u7d22\u5f15\uff0c\u4f46\u662f\u7ef4\u62a4\u8d77\u6765\u4e5f\u5f88\u9ebb\u70e6\uff0c\u5bf9\u4e8e insert \u548c update \u64cd\u4f5c\u90fd\u4f1a\u91cd\u65b0\u6784\u5efa\u7d22\u5f15\u3002</p> <p>\u8fd9\u91cc\u8bf4\u5230\u7684\u5168\u6587\u641c\u7d22\u5f15\u64ce\u6307\u7684\u662f\u76ee\u524d\u5e7f\u6cdb\u5e94\u7528\u7684\u4e3b\u6d41\u641c\u7d22\u5f15\u64ce\u3002\u5b83\u7684\u5de5\u4f5c\u539f\u7406\u662f\u8ba1\u7b97\u673a\u7d22\u5f15\u7a0b\u5e8f\u901a\u8fc7\u626b\u63cf\u6587\u7ae0\u4e2d\u7684\u6bcf\u4e00\u4e2a\u8bcd\uff0c\u5bf9\u6bcf\u4e00\u4e2a\u8bcd\u5efa\u7acb\u4e00\u4e2a\u7d22\u5f15\uff0c\u6307\u660e\u8be5\u8bcd\u5728\u6587\u7ae0\u4e2d\u51fa\u73b0\u7684\u6b21\u6570\u548c\u4f4d\u7f6e\uff0c\u5f53\u7528\u6237\u67e5\u8be2\u65f6\uff0c\u68c0\u7d22\u7a0b\u5e8f\u5c31\u6839\u636e\u4e8b\u5148\u5efa\u7acb\u7684\u7d22\u5f15\u8fdb\u884c\u67e5\u627e\uff0c\u5e76\u5c06\u67e5\u627e\u7684\u7ed3\u679c\u53cd\u9988\u7ed9\u7528\u6237\u7684\u68c0\u7d22\u65b9\u5f0f\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u7c7b\u4f3c\u4e8e\u901a\u8fc7\u5b57\u5178\u4e2d\u7684\u68c0\u7d22\u5b57\u8868\u67e5\u5b57\u7684\u8fc7\u7a0b\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#15-lucene","title":"1.5 lucene \u4ecb\u7ecd","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#16","title":"1.6 \u5012\u6392\u7d22\u5f15","text":"<p>![[Pasted image 20260123095447.png]]</p> <p>\u5012\u6392\u7d22\u5f15\u6b65\u9aa4\uff1a \u7b2c\u4e00\u6b65\uff1a\u6570\u636e\u6839\u636e\u8bcd\u6761\u8fdb\u884c\u5206\u8bcd\uff0c\u540c\u65f6\u8bb0\u5f55\u6587\u6863\uff08Document-\u6570\u636e\uff09\u7d22\u5f15\u4f4d\u7f6e \u7b2c\u4e8c\u6b65\uff1a\u5206\u5b8c\u8bcd\u540e\u53ef\u80fd\u6709\u91cd\u590d\uff0c\u6211\u4eec\u8981\u8fdb\u884c\u53bb\u91cd \u7b2c\u4e09\u6b65\uff1a\u6309\u7167\u5e8f\u53f7\u6392\u5e8f\uff0c\u4ece\u800c\u4e3a\u540e\u7eed\u68c0\u7d22\u63d0\u9ad8\u6548\u7387</p> <p>\u67e5\u8be2\u6b65\u9aa4\uff1a \u7b2c\u4e00\u6b65\uff1a\u6839\u636e\u641c\u7d22\u8bcd\u8bed\u8fdb\u884c\u5206\u8bcd \u7b2c\u4e8c\u6b65\uff1a\u5206\u6b64\u540e\u5728\u5012\u6392\u7d22\u5f15\u5217\u8868\u67e5\u8be2\uff0c\u5feb\u901f\u627e\u5230\u6587\u6863id \u7b2c\u4e09\u6b65\uff1a\u6839\u636e\u6587\u6863 id \u5c31\u53ef\u80fd\u8def\u7531\uff0c\u7136\u540e\u627e\u5230\u8fd9\u4e2a\u6587\u6863\u7684\u4f4d\u7f6e</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#17-es-solr","title":"1.7 Es \u548c Solr \u7684\u5bf9\u6bd4","text":"<p>solr\u5bf9\u4e8e\u7d22\u5f15\u7684\u6784\u5efa\u662f\u5b9e\u65f6\u7684\uff0c\u6240\u4ee5\u6709\u4e9b\u65f6\u5019\u4f1a\u4ea7\u751fio\u963b\u585e\uff0c\u4ece\u800c\u5bfc\u81f4\u67e5\u8be2\u901f\u5ea6\u5ffd\u5feb\u5ffd\u6162\uff0c\u800ces\u975e\u5e38\u6587\u6863\uff0c\u5e76\u4e14\u968f\u7740\u6570\u636e\u7684\u589e\u591a\uff0ces\u68c0\u7d22\u6027\u80fd\u4e0d\u4f1a\u4e0b\u964d\uff0c\u4f46\u662fslor\u7684\u68c0\u7d22\u6548\u7387\u4f1a\u51fa\u73b0\u660e\u663e\u53d8\u5316\u3002</p> <ul> <li>es\u57fa\u672c\u662f\u5f00\u7bb1\u5373\u7528\uff0c\u975e\u5e38\u7b80\u5355\u3002Solr\u5b89\u88c5\u7565\u5fae\u590d\u6742\u3002</li> <li>Solr \u5229\u7528 Zookeeper \u8fdb\u884c\u5206\u5e03\u5f0f\u7ba1\u7406\uff0c\u800c ElasticSearch \u81ea\u8eab\u5e26\u6709\u5206\u5e03\u5f0f\u534f\u8c03\u7ba1\u7406\u529f\u80fd\u3002</li> <li>Solr \u652f\u6301\u66f4\u591a\u683c\u5f0f\u7684\u6570\u636e\uff0c\u6bd4\u5982JSON\u3001XML\u3001CSV\uff0c\u800c ElasticSearch \u4ec5\u652f\u6301json\u6587\u4ef6\u683c\u5f0f\u3002</li> <li>Solr \u662f\u4f20\u7edf\u641c\u7d22\u5e94\u7528\u7684\u6709\u529b\u89e3\u51b3\u65b9\u6848\uff0c\u4f46 ElasticSearch \u66f4\u9002\u7528\u4e8e\u65b0\u5174\u7684\u5b9e\u65f6\u641c\u7d22\u5e94\u7528\u3002 \u73b0\u5728\u5f88\u591a\u4e92\u8054\u7f51\u5e94\u7528\u90fd\u662f\u8981\u6c42\u5b9e\u65f6\u641c\u7d22\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u9009\u62e9\u4e86ElasticSearch\u3002</li> </ul>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2-elk-docker","title":"2. ELK \u7684\u5b89\u88c5\uff08docker\uff09","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#21-elasticsearch","title":"2.1 ElasticSearch \u7684\u5b89\u88c5","text":"<p>Install doc</p> <ol> <li> <p>\u62c9\u53d6\u955c\u50cf <pre><code>docker pull elasticsearch:8.5.0\n</code></pre></p> </li> <li> <p>\u5728\u5bbf\u4e3b\u673a\u5efa\u7acb\u8981\u88ab\u6302\u8f7d\u7684\u76ee\u5f55 <pre><code>rm -rf /opt/elasticsearch\nmkdir -p /opt/elasticsearch/{config,plugins,data}\n</code></pre></p> </li> <li> <p>\u53bb github \u4e0b\u8f7d\u4e2d\u6587\u5206\u8bcd\u5668\uff0c\u7136\u540e\u62f7\u8d1d\u5230plugins\u76ee\u5f55\u91cd\u542f es</p> </li> </ol> <pre><code>1. \u4e0b\u8f7delasticsearch-analysis-ik-8.5.0.zip\n2. \u4e0a\u4f20\u5230/mydata/elasticsearch/plugins \u76ee\u5f55\u540e\uff0c\u89e3\u538b\uff1aunzip elasticsearch-analysis-ik-8.5.0.zip -d ik-analyzer \u5fc5\u987b\u5220\u9664\u539f\u6765\u7684\u538b\u7f29\u5305elasticsearch-analysis-ik-8.5.0.zip**\n3. \u91cd\u542fes\uff1adocker restart a24eb9941759\n\nyum install -y unzip\nunzip elasticsearch-analysis-ik-8.5.0.zip -d ik-analyzer\nrm -rf elasticsearch-analysis-ik-8.5.0.zip \n</code></pre> <ol> <li> <p>\u5236\u4f5c\u914d\u7f6e\u6587\u4ef6 <pre><code>cat &lt;&lt;EOF&gt; /opt/elasticsearch/config/elasticsearch.yml\nxpack.security.enabled: true # true\u4e3a\u5f00\u59cb\u5bc6\u7801\u9a8c\u8bc1\nxpack.license.self_generated.type: basic\nxpack.security.transport.ssl.enabled: false  # \u4e0d\u914d\u62a5\u9519\nxpack.security.enrollment.enabled: true\nhttp.host: 0.0.0.0\nEOF\n</code></pre></p> </li> <li> <p>\u7ed9\u5f53\u524del\u76ee\u5f55\u8bbe\u7f6e\u6743\u9650 <pre><code>chmod -R 777 /opt/elasticsearch\n</code></pre></p> </li> <li> <p>\u542f\u52a8 el <pre><code>docker run --name elasticsearch -p 9200:9200 -p 9300:9300 \\\n--net elastic \\\n--restart=always \\\n-e \"discovery.type=single-node\" \\\n-e ES_JAVA_OPTS=\"-Xms512m -Xmx512m\" \\\n-v /opt/elasticsearch/config/elasticsearch.yml:/usr/share/elasticsearch/config/elasticsearch.yml \\\n-v /opt/elasticsearch/data:/usr/share/elasticsearch/data \\\n-v /opt/elasticsearch/plugins:/usr/share/elasticsearch/plugins \\\n-d elasticsearch:8.5.0\n</code></pre></p> </li> </ol> <p>\u5982\u679c\u8fd0\u884c\u65f6\u63d0\u793aelastic \u672a\u627e\u5230 \u6267\u884c\u8fd9\u4e2a\u547d\u4ee4 \uff1a docker network create elastic</p> <pre><code># \u91cd\u7f6e\u4e0b\u9762\u4e24\u4e2a\u5bc6\u7801\uff0c\u6ce8\u610f\uff1a\u9700\u7b49\u5f85es\u542f\u52a8\ndocker exec -it elasticsearch bin/elasticsearch-reset-password -u elastic  -i   # -i \u8868\u793a\u81ea\u5b9a\u4e49\u5bc6\u7801 \u7ed9java\u5ba2\u6237\u7aef\u7528\u7684\ndocker exec -it elasticsearch bin/elasticsearch-reset-password -u kibana_system -i  # \u7ed9 kibana \u7528\u7684\n\n\u7528\u6237\u540d: elastic \u5bc6\u7801\u53ef\u4ee5\u4f7f\u7528: liuqiang\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#22-logstach","title":"2.2 LogStach \u7684\u5b89\u88c5","text":"<ol> <li> <p>\u62c9\u53d6\u955c\u50cf <pre><code>docker pull logstach:8.5.0\ndocker pull swr.cn-north-4.myhuaweicloud.com/ddn-k8s/docker.elastic.co/logstash/logstash:8.5.0\n\n\ndocker tag swr.cn-north-4.myhuaweicloud.com/ddn-k8s/docker.elastic.co/logstash/logstash:8.5.0 logstash:8.5.0\n</code></pre></p> </li> <li> <p>\u7f16\u5199\u914d\u7f6e\u6587\u4ef6 <pre><code>vim /mydata/logstash/logstash.conf\ninput {\n  tcp {\n          mode =&gt; \"server\"\n          host =&gt; \"0.0.0.0\"\n          port =&gt; 5044\n          codec =&gt; json_lines\n      }\n}\nfilter{\n\n}\noutput {\n  elasticsearch {\n      hosts =&gt; \"152.136.97.27:9200\"\n      index =&gt; \"tingshu-%{+YYYY.MM}\"\n      user =&gt; \"elastic\"\n      password =&gt; \"liuqiang\"\n  }\n}\n</code></pre></p> </li> <li> <p>\u521b\u5efa\u5bb9\u5668 <pre><code>docker run --name logstash -p 5044:5044 \\\n--net elastic \\\n--restart=always \\\n--link elasticsearch:es \\\n-v /mydata/logstash/logstash.conf:/usr/share/logstash/pipeline/logstash.conf \\\n-d logstash:8.5.0\n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#23-kibana","title":"2.3 kibana\u7684\u5b89\u88c5","text":"<ol> <li> <p>\u62c9\u53d6\u955c\u50cf <pre><code>docker pull kibana:8.5.0\n</code></pre></p> </li> <li> <p>\u63d0\u524d\u521b\u5efa\u6302\u8f7d\u76ee\u5f55 <pre><code>rm -rf /opt/kibana\nmkdir -p /opt/kibana/{config,data}\n</code></pre></p> </li> <li> <p>\u5236\u4f5c\u914d\u7f6e\u6587\u4ef6 <pre><code>cat &lt;&lt;EOF&gt; /opt/kibana/config/kibana.yml\nserver.host: \"0.0.0.0\"  # \u4e0d\u914d\u62a5\u9519\nserver.shutdownTimeout: \"5s\"\nelasticsearch.hosts: [ \"http://elasticsearch:9200\" ]\nelasticsearch.username: \"kibana_system\"  # \u4e0d\u80fd\u7528 elastic \nelasticsearch.password: \"liuqiang\"\ni18n.locale: \"zh-CN\"\nEOF\n</code></pre></p> </li> <li> <p>\u542f\u52a8 <pre><code>sudo docker run --name kibana \\\n--net elastic \\\n-v /opt/kibana/config/kibana.yml:/usr/share/kibana/config/kibana.yml \\\n-p 5601:5601 -d kibana:8.5.0\n</code></pre></p> </li> </ol> <p>\u767b\u5f55kibana \uff0c\u6ce8\u610f\u9700\u8981\u4f7f\u7528elastic \u7528\u6237\u767b\u5f55\u4e0d\u80fd\u4f7f\u7528 kibana_system \u8fd9\u4e2a\u7528\u6237\u767b\u5f55\u3002</p> <p>\u6d4b\u8bd5\u662f\u5426\u5b89\u88c5\u6210\u529f <pre><code>GET  /_analyze\n{\n  \"analyzer\": \"ik_smart\", \n  \"text\":     \"\u6211\u662f\u4e2d\u56fd\u4eba\"\n}\n</code></pre></p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3-es","title":"3. es \u6838\u5fc3\u6982\u5ff5","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#31-es","title":"3.1 es \u4e0e \u5173\u7cfb\u578b\u6570\u636e\u5e93\u7684\u5bf9\u6bd4","text":"<p>![[imgs/image-3.png]]</p> <p>mysql \u7684\u6570\u636e\u6a21\u578b\u662f DDL \u6765\u63cf\u8ff0\u7684 \u800c es \u7684 document \u6709\u54ea\u4e9b field \u662f\u901a\u8fc7 mapping \u6765\u8bf4\u660e\u7684</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#32-index","title":"3.2 index","text":"<p>\u4e00\u4e2a\u7d22\u5f15\u5c31\u662f\u4e00\u4e2a\u62e5\u6709\u51e0\u5206\u76f8\u4f3c\u7279\u5f81\u7684\u6587\u6863\u7684\u96c6\u5408\u3002\u6bd4\u5982\u8bf4\uff0c\u4f60\u53ef\u4ee5\u6709\u4e00\u4e2a\u5ba2\u6237\u6570\u636e\u7684\u7d22\u5f15\uff0c\u53e6\u4e00\u4e2a\u4ea7\u54c1\u76ee\u5f55\u7684\u7d22\u5f15\uff0c\u8fd8\u6709\u4e00\u4e2a\u8ba2\u5355\u6570\u636e\u7684\u7d22\u5f15\u3002\u4e00\u4e2a\u7d22\u5f15\u7531\u4e00\u4e2a\u540d\u5b57\u6765\u6807\u8bc6\uff08\u5fc5\u987b\u5168\u90e8\u662f\u5c0f\u5199\u5b57\u6bcd\uff09\uff0c\u5e76\u4e14\u5f53\u6211\u4eec\u8981\u5bf9\u8fd9\u4e2a\u7d22\u5f15\u4e2d\u7684\u6587\u6863\u8fdb\u884c\u7d22\u5f15\u3001\u641c\u7d22\u3001\u66f4\u65b0\u548c\u5220\u9664\u7684\u65f6\u5019\uff0c\u90fd\u8981\u4f7f\u7528\u5230\u8fd9\u4e2a\u540d\u5b57\u3002\u5728\u4e00\u4e2a\u96c6\u7fa4\u4e2d\uff0c\u53ef\u4ee5\u5b9a\u4e49\u4efb\u610f\u591a\u7684\u7d22\u5f15\u3002</p> <p>\u80fd\u641c\u7d22\u7684\u6570\u636e\u5fc5\u987b\u7d22\u5f15\uff0c\u8fd9\u6837\u7684\u597d\u5904\u662f\u53ef\u4ee5\u63d0\u9ad8\u67e5\u8be2\u901f\u5ea6\uff0c\u6bd4\u5982\uff1a\u65b0\u534e\u5b57\u5178\u524d\u9762\u7684\u76ee\u5f55\u5c31\u662f\u7d22\u5f15\u7684\u610f\u601d\uff0c\u76ee\u5f55\u53ef\u4ee5\u63d0\u9ad8\u67e5\u8be2\u901f\u5ea6\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#33-type","title":"3.3 type","text":"<p>\u5728\u4e00\u4e2a\u7d22\u5f15\u4e2d\uff0c\u4f60\u53ef\u4ee5\u5b9a\u4e49\u4e00\u79cd\u6216\u591a\u79cd\u7c7b\u578b\u3002</p> <p>\u4e00\u4e2a\u7c7b\u578b\u662f\u4f60\u7684\u7d22\u5f15\u7684\u4e00\u4e2a\u903b\u8f91\u4e0a\u7684\u5206\u7c7b/\u5206\u533a\uff0c\u5176\u8bed\u4e49\u5b8c\u5168\u7531\u4f60\u6765\u5b9a\u3002\u901a\u5e38\uff0c\u4f1a\u4e3a\u5177\u6709\u4e00\u7ec4\u5171\u540c\u5b57\u6bb5\u7684\u6587\u6863\u5b9a\u4e49\u4e00\u4e2a\u7c7b\u578b\u3002\u4e0d\u540c\u7684\u7248\u672c\uff0c\u7c7b\u578b\u53d1\u751f\u4e86\u4e0d\u540c\u7684\u53d8\u5316</p> \u7248\u672c Type 5.x \u652f\u6301\u591a\u79cdtype 6.x \u53ea\u80fd\u6709\u4e00\u79cdtype 7.x \u9ed8\u8ba4\u4e0d\u518d\u652f\u6301\u81ea\u5b9a\u4e49\u7d22\u5f15\u7c7b\u578b\uff08\u9ed8\u8ba4\u7c7b\u578b\u4e3a\uff1a_doc\uff09 8.x \u9ed8\u8ba4\u7c7b\u578b\u4e3a\uff1a_doc ##### 3.4 document <p>\u4e00\u4e2a\u6587\u6863\u662f\u4e00\u4e2a\u53ef\u88ab\u7d22\u5f15\u7684\u57fa\u7840\u4fe1\u606f\u5355\u5143\uff0c\u4e5f\u5c31\u662f\u4e00\u6761\u6570\u636e</p> <p>\u6bd4\u5982\uff1a\u4f60\u53ef\u4ee5\u62e5\u6709\u67d0\u4e00\u4e2a\u5ba2\u6237\u7684\u6587\u6863\uff0c\u67d0\u4e00\u4e2a\u4ea7\u54c1\u7684\u4e00\u4e2a\u6587\u6863\uff0c\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u62e5\u6709\u67d0\u4e2a\u8ba2\u5355\u7684\u4e00\u4e2a\u6587\u6863\u3002\u6587\u6863\u4ee5JSON\uff08Javascript Object Notation\uff09\u683c\u5f0f\u6765\u8868\u793a\uff0c\u800cJSON\u662f\u4e00\u4e2a\u5230\u5904\u5b58\u5728\u7684\u4e92\u8054\u7f51\u6570\u636e\u4ea4\u4e92\u683c\u5f0f\u3002</p> <p>\u5728\u4e00\u4e2aindex/type\u91cc\u9762\uff0c\u4f60\u53ef\u4ee5\u5b58\u50a8\u4efb\u610f\u591a\u7684\u6587\u6863\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#35-field","title":"3.5 field","text":"<p>\u76f8\u5f53\u4e8e\u662f\u6570\u636e\u8868\u7684\u5b57\u6bb5\uff0c\u5bf9\u6587\u6863\u6570\u636e\u6839\u636e\u4e0d\u540c\u5c5e\u6027\u8fdb\u884c\u7684\u5206\u7c7b\u6807\u8bc6\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#37-mapping","title":"3.7 mapping","text":"<p>mapping\u662f\u5904\u7406\u6570\u636e\u7684\u65b9\u5f0f\u548c\u89c4\u5219\u65b9\u9762\u505a\u4e00\u4e9b\u9650\u5236\uff0c\u5982\uff1a\u67d0\u4e2a\u5b57\u6bb5\u7684\u6570\u636e\u7c7b\u578b\u3001\u9ed8\u8ba4\u503c\u3001\u5206\u6790\u5668\u3001\u662f\u5426\u88ab\u7d22\u5f15\u7b49\u7b49\u3002\u8fd9\u4e9b\u90fd\u662f\u6620\u5c04\u91cc\u9762\u53ef\u4ee5\u8bbe\u7f6e\u7684\uff0c\u5176\u5b83\u5c31\u662f\u5904\u7406ES\u91cc\u9762\u6570\u636e\u7684\u4e00\u4e9b\u4f7f\u7528\u89c4\u5219\u8bbe\u7f6e\u4e5f\u53eb\u505a\u6620\u5c04\uff0c\u6309\u7740\u6700\u4f18\u89c4\u5219\u5904\u7406\u6570\u636e\u5bf9\u6027\u80fd\u63d0\u9ad8\u5f88\u5927\uff0c\u56e0\u6b64\u624d\u9700\u8981\u5efa\u7acb\u6620\u5c04\uff0c\u5e76\u4e14\u9700\u8981\u601d\u8003\u5982\u4f55\u5efa\u7acb\u6620\u5c04\u624d\u80fd\u5bf9\u6027\u80fd\u66f4\u597d\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#4-es","title":"4. Es \u7684\u57fa\u7840\u529f\u80fd","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#41_1","title":"4.1 \u5206\u8bcd\u5668","text":"<p>\u5b98\u65b9\u63d0\u4f9b\u7684\u5206\u8bcd\u5668\u6709\u8fd9\u4e48\u51e0\u79cd: Standard\u3001Letter\u3001Lowercase\u3001Whitespace\u3001UAX URL Email\u3001Classic\u3001Thai\u7b49\uff0c\u4e2d\u6587\u5206\u8bcd\u5668\u53ef\u4ee5\u4f7f\u7528\u7b2c\u4e09\u65b9\u7684\u6bd4\u5982IK\u5206\u8bcd\u5668\u3002\u524d\u9762\u6211\u4eec\u5df2\u7ecf\u5b89\u88c5\u8fc7\u4e86\u3002</p> <p>ik_smart\uff1a\u667a\u80fd\u5207\u5206\uff0c\u7c92\u5ea6\u8f83\u7c97\u3002 ik_max_word\uff1a\u6700\u7ec6\u7c92\u5ea6\u5207\u5206\uff0c\u5c3d\u53ef\u80fd\u591a\u5730\u5207\u51fa\u8bcd\u8bed\uff0c\u5305\u62ec\u6240\u6709\u53ef\u80fd\u7684\u7ec4\u5408\u3002 <pre><code>post _analyze\n{\n  \"analyzer\":\"ik_smart\",\n  \"text\": \"\u6211\u662f\u4e2d\u56fd\u4eba\"\n}\n</code></pre></p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#42","title":"4.2 \u7d22\u5f15\u64cd\u4f5c","text":"<p>ES \u8f6f\u4ef6\u7684\u7d22\u5f15\u53ef\u4ee5\u7c7b\u6bd4\u4e3a MySQL \u4e2d\u8868\u7684\u6982\u5ff5\uff0c\u521b\u5efa\u4e00\u4e2a\u7d22\u5f15\uff0c\u7c7b\u4f3c\u4e8e\u521b\u5efa\u4e00\u4e2a\u8868 \u8be6\u7ec6\u64cd\u4f5c\u53ef\u770b\uff1a\u7d22\u5f15\u5b98\u65b9\u6587\u6863</p> <ol> <li> <p>\u521b\u5efa\u7d22\u5f15 <pre><code>PUT /my-index-000001\n{\n  \"settings\": {\n    \"index\": {\n      \"number_of_shards\": 3,  \n      \"number_of_replicas\": 0\n    }\n  }\n}\n\n\u5176\u4ed6\u914d\u7f6e\uff1amappings:\nPUT /test\n{\n  \"settings\": {\n    \"number_of_shards\": 1\n  },\n  \"mappings\": {\n    \"properties\": {\n      \"field1\": { \"type\": \"text\" }\n    }\n  }\n}\n</code></pre></p> </li> <li> <p>\u5220\u9664\u7d22\u5f15 <pre><code>DELETE /my-index-000001\n</code></pre></p> </li> <li> <p>\u67e5\u770b\u7d22\u5f15 <pre><code>GET /_cat/indices?v\nGET /{\u7d22\u5f15\u540d\u79f0}\n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#43_1","title":"4.3 \u6587\u6863\u64cd\u4f5c","text":"<p>\u6587\u6863\u662f ES \u8f6f\u4ef6\u641c\u7d22\u6570\u636e\u7684\u6700\u5c0f\u5355\u4f4d, \u4e0d\u4f9d\u8d56\u9884\u5148\u5b9a\u4e49\u7684\u6a21\u5f0f\uff0c\u6240\u4ee5\u53ef\u4ee5\u5c06\u6587\u6863\u7c7b\u6bd4\u4e3a\u8868\u7684\u4e00\u884cJSON\u7c7b\u578b\u7684\u6570\u636e\u3002\u6211\u4eec\u77e5\u9053\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e2d\uff0c\u8981\u63d0\u524d\u5b9a\u4e49\u5b57\u6bb5\u624d\u80fd\u4f7f\u7528\uff0c\u5728ElasticSearch\u4e2d\uff0c\u5bf9\u4e8e\u5b57\u6bb5\u662f\u975e\u5e38\u7075\u6d3b\u7684\uff0c\u6709\u65f6\u5019\u6211\u4eec\u53ef\u4ee5\u5ffd\u7565\u8be5\u5b57\u6bb5\uff0c\u6216\u8005\u52a8\u6001\u7684\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u5b57\u6bb5\u3002</p> <ol> <li> <p>\u65b0\u589e\u6587\u6863 <pre><code>put /\u7d22\u5f15\u540d/\u7c7b\u578b/{id}\n{\n  \"title\": \"\u5c0f\u7c73\u624b\u673a\",\n  \"brand\": \"\u5c0f\u7c73\",\n  \"images\": \"http://www.gulixueyuan.com/xm.jpg\",\n  \"price\": 3999\n}\n</code></pre></p> </li> <li> <p>\u67e5\u770b\u6587\u6863 <pre><code>get /\u7d22\u5f15/\u7c7b\u578b/id\n</code></pre></p> </li> <li> <p>\u67e5\u770b\u6240\u6709\u6587\u6863 <pre><code>get/\u7d22\u5f15/_search\n</code></pre></p> </li> <li> <p>\u4fee\u6539\u6587\u6863 <pre><code>// \u5168\u5c40\u4fee\u6539\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\u8986\u76d6\u4e86\u4ee5\u524d\u7684\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u65b0\u589e\nput /index/_doc/id\n{\n    jsonBody\n}\n\n// \u5c40\u90e8\u4fee\u6539\npost /index/_update/id\n{\n    \"doc\":{\n        \"\u5c5e\u6027\":\"\u503c\"\n    }\n}\n\neg:\npost /myindex/_update/1\n{\n  \"doc\":\n  {\n    \"title\":\"\u5927\u7c73\"\n  }\n\n}\n</code></pre></p> </li> <li> <p>\u5220\u9664\u6587\u6863 <pre><code>\u8bed\u6cd5: DELETE /{\u7d22\u5f15\u540d\u79f0}/{\u7c7b\u578b}/{id}\nDELETE /my_index/_doc/1\n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#44_1","title":"4.4 \u6620\u5c04","text":"<p>\u521b\u5efa\u6570\u636e\u5e93\u8868\u9700\u8981\u8bbe\u7f6e\u5b57\u6bb5\u540d\u79f0\uff0c\u7c7b\u578b\uff0c\u957f\u5ea6\uff0c\u7ea6\u675f\u7b49\uff1b\u7d22\u5f15\u5e93\u4e5f\u4e00\u6837\uff0c\u9700\u8981\u77e5\u9053\u8fd9\u4e2a\u7c7b\u578b\u4e0b\u6709\u54ea\u4e9b\u5b57\u6bb5\uff0c\u6bcf\u4e2a\u5b57\u6bb5\u6709\u54ea\u4e9b\u7ea6\u675f\u4fe1\u606f\uff0c\u8fd9\u5c31\u53eb\u505a\u6620\u5c04(mapping)\u3002</p> <ol> <li>\u67e5\u770b\u6620\u5c04 <pre><code>get /index/_mapping\n</code></pre></li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#441","title":"4.4.1 \u52a8\u6001\u6620\u5c04","text":"<p>\u5728\u5173\u7cfb\u6570\u636e\u5e93\u4e2d\uff0c\u9700\u8981\u4e8b\u5148\u521b\u5efa\u6570\u636e\u5e93\uff0c\u7136\u540e\u5728\u8be5\u6570\u636e\u5e93\u4e0b\u521b\u5efa\u6570\u636e\u8868\uff0c\u5e76\u521b\u5efa \u8868\u5b57\u6bb5\u3001\u7c7b\u578b\u3001\u957f\u5ea6\u3001\u4e3b\u952e\u7b49\uff0c\u6700\u540e\u624d\u80fd\u57fa\u4e8e\u8868\u63d2\u5165\u6570\u636e\u3002\u800cElasticSearch\u4e2d\u4e0d \u9700\u8981\u5b9a\u4e49Mapping\u6620\u5c04\uff08\u5373\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7684\u8868\u3001\u5b57\u6bb5\u7b49\uff09\uff0c\u5728\u6587\u6863\u5199\u5165 ElasticSearch\u65f6\uff0c\u4f1a\u6839\u636e\u6587\u6863\u5b57\u6bb5\u81ea\u52a8\u8bc6\u522b\u7c7b\u578b\uff0c\u8fd9\u79cd\u673a\u5236\u79f0\u4e4b\u4e3a\u52a8\u6001\u6620\u5c04\u3002</p> \u6570\u636e \u5bf9\u5e94\u7684\u7c7b\u578b null \u5b57\u6bb5\u4e0d\u6dfb\u52a0 true|flase boolean \u5b57\u7b26\u4e32 text/keyword \u6570\u503c long \u5c0f\u6570 float \u65e5\u671f date \u7279\u6b8a\u7c7b\u578b\uff1a\u5b57\u7b26\u4e32 <ul> <li> <p>text:\u7528\u4e8e\u957f\u6587\u672c\uff0c\u5bf9\u672c\u6587\u5185\u5bb9\u8fdb\u884c\u5206\u8bcd\uff08\u4ea7\u751f\u5012\u6392\u7d22\u5f15\u6587\u6863\u5217\u8868\uff09\uff0c\u652f\u6301\u591a\u5173\u952e\u5b57\u5168\u6587\u67e5\u8be2\u3002\u4f8b\u5982\uff1a\u7535\u5546\u9879\u76ee\u4e2d\u5546\u54c1\u540d\u79f0\uff0c\u6216\u8005\u535a\u5ba2\u9879\u76ee\u6587\u7ae0\u6807\u9898\uff0c\u6b63\u6587\u8bbe\u7f6e\u4e3atext \u7f3a\u70b9\uff1a\u4e0d\u80fd\u8fdb\u884c\u805a\u5408\uff08\u5206\u7ec4\uff09\uff0c\u4e0d\u652f\u6301\u6392\u5e8f\u3002</p> </li> <li> <p>keyword\uff1a\u7528\u4e8e\u8bcd\u6761\u7cbe\u786e\u67e5\u8be2\uff0c\u652f\u6301\u7b49\u503c\u67e5\u8be2\uff0c\u4e0d\u9700\u8981\u8fdb\u884c\u5206\u8bcd\u5b57\u7b26\u4e32\uff08\u5206\u8bcd\u540e\u65e0\u610f\u4e49\uff09\u3002\u4f8b\u5982\uff1a\u7528\u6237\u6635\u79f0\u3001\u7528\u6237\u624b\u673a\u53f7\u3001\u8eab\u4efd\u8bc1\u53f7\u3001\u56fe\u7247\u5730\u5740\u3002\u573a\u666f\uff1a\u6839\u636e\u54c1\u724c\u540d\u79f0\u7b49\u503c\u67e5\u8be2\u3002\u652f\u6301\u805a\u5408\uff08\u5206\u7ec4\uff09\u3001\u6392\u5e8f \u4e0d\u652f\u6301\u5168\u6587\u67e5\u8be2\u67e5\u8be2</p> </li> </ul> \u662f\u5426\u5206\u8bcd \u2705 \u662f\uff08\u4f7f\u7528 analyzer \u5206\u8bcd\uff09 \u274c \u5426\uff08\u6574\u4f53\u4f5c\u4e3a\u4e00\u4e2a term\uff09 \u9002\u7528\u573a\u666f \u5168\u6587\u641c\u7d22\uff08\u5982\u6587\u7ae0\u5185\u5bb9\u3001\u5546\u54c1\u63cf\u8ff0\uff09 \u7cbe\u786e\u5339\u914d\uff08\u5982\u54c1\u724c\u3001\u72b6\u6001\u3001ID\u3001\u6807\u7b7e\uff09 \u652f\u6301\u5168\u6587\u68c0\u7d22 \u2705\uff08<code>match</code>,\u00a0<code>multi_match</code>\u00a0\u7b49\uff09 \u274c\uff08\u4f46\u53ef\u7528\u00a0<code>term</code>\u00a0\u7cbe\u786e\u67e5\uff09 \u652f\u6301\u805a\u5408\uff08Aggregation\uff09 \u274c\uff08\u9ed8\u8ba4\u4e0d\u884c\uff0c\u9664\u975e\u5f00\u542f\u00a0<code>fielddata</code>\uff09 \u2705\uff08\u5929\u7136\u652f\u6301\uff09 \u652f\u6301\u6392\u5e8f\uff08Sort\uff09 \u274c\uff08\u540c\u4e0a\uff0c\u9700\u00a0<code>fielddata</code>\uff09 \u2705 \u5b58\u50a8\u65b9\u5f0f \u5012\u6392\u7d22\u5f15\uff08terms \u2192 docs\uff09 \u6b63\u6392\u7d22\u5f15\uff08doc \u2192 term\uff09 \u5927\u5c0f\u5199\u654f\u611f \u53d6\u51b3\u4e8e analyzer\uff08\u5982\u00a0<code>standard</code>\u00a0\u4f1a\u8f6c\u5c0f\u5199\uff09 \u5b8c\u5168\u4fdd\u7559\u539f\u59cb\u503c\uff08\u533a\u5206\u5927\u5c0f\u5199\uff09"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#442","title":"4.4.2 \u9759\u6001\u6620\u5c04","text":"<pre><code>PUT /my_index\n{\n  \"mappings\": {\n    \"properties\": {\n      \"title\": {\n        \"type\": \"text\",\n        \"index\": true,\n        \"store\": true,\n        \"analyzer\": \"ik_max_word\",\n        \"search_analyzer\": \"ik_smart\"\n      },\n      \"brand\": { \n        \"type\": \"keyword\",\n        \"index\": true,\n        \"store\": true\n      },\n      \"images\": {\n        \"type\": \"keyword\",\n        \"index\": false,\n        \"store\": true\n      },\n      \"price\": {\n        \"type\": \"integer\",\n        \"index\": true,\n        \"store\": true\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#45-nested","title":"4.5 nested","text":"<p>nested \u7c7b\u578b\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u5bf9\u8c61object\u6570\u636e\u7c7b\u578b(specialised version of the object datatype )\uff0c\u5141\u8bb8\u5bf9\u8c61\u6570\u7ec4\u5f7c\u6b64\u72ec\u7acb\u5730\u8fdb\u884c\u7d22\u5f15\u548c\u67e5\u8be2\u3002</p> <p>\u5bf9\u4e8e\u6570\u7ec4\u5f62\u5f0f\u7684\u6570\u636e\uff0c\u9ed8\u8ba4\u5b58\u50a8\u7c7b\u578b\u662f\uff1aObject\uff0c\u6545\u6211\u4eec\u7684\u6587\u6863\u5185\u90e8\u5b58\u50a8\u4e3a\uff1a <pre><code>{ \n\"title\": [ \u72c2\u4eba\u65e5\u8bb0], \n\"body\": [ \u300a\u72c2\u4eba\u65e5\u8bb0\u300b\u662f\u4e00\u7bc7\u8c61\u5f81\u6027\u548c\u5bd3\u610f\u5f88\u5f3a\u7684\u5c0f\u8bf4\uff0c\u5f53\u65f6... ], \"comments.name\": [ \u5f20\u4e09, \u674e\u56db, \u738b\u4e94 ], \n\"comments.comment\": [ \u975e\u5e38\u68d2\u7684\u6587\u7ae0,\u6587\u7ae0\u975e\u5e38\u597d,\u738b\u4e94,... ], \n\"comments.age\": [ 33, 34, 38 ], \n\"comments.rating\": [ 7, 8, 9 ] \n}\n</code></pre> \u6211\u4eec\u53ef\u4ee5\u6e05\u695a\u5730\u770b\u5230\uff0ccomments.name\u548ccomments.age\u4e4b\u95f4\u7684\u5173\u7cfb\u5df2\u4e22\u5931\u3002\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u6211\u4eec\u7684\u6587\u6863\u5339\u914d\u674e\u56db\u548c34\u7684\u67e5\u8be2\u3002</p> <p>\u4e5f\u5c31\u662f\uff0c\u5982\u679c\u96c6\u5408\u7528\u9ed8\u8ba4\u6570\u636e\u7c7b\u578b\uff0c\u90a3\u4e48\u6839\u636e\u96c6\u5408\u91cc\u5bf9\u8c61\u7684\u5b57\u6bb5\u53bb\u67e5\u8be2\u662f\u4e0d\u72ec\u7acb\u7684\uff0c\u4e5f\u5c31\u662f\u6bcf\u6b21\u67e5\u8be2\u90fd\u662f\u770b\u6240\u6709\u5bf9\u8c61\u7684\u67d0\u4e2a\u5b57\u6bb5\u3002</p> <p>\u6bd4\u5982\u6211\u4eec\u8981\u901a\u8fc7\u7cbe\u786e\u5339\u914d\u53bb\u67e5\u8be2\u5f53\u524d\u96c6\u5408\u4e2d\u6709\uff1a\u5e74\u9f84\u4e3a 35 \u4ee5\u53ca\u59d3\u540d\u4e3a\u5f20\u4e09\u7684 docment\uff0c\u4f46\u5982\u679c\u662f\u9ed8\u8ba4\u6570\u636e\u7c7b\u578b\uff0c\u5b83\u7684\u610f\u601d\u5c31\u53d8\u6210\u4e86\uff1a\u6240\u6709\u5bf9\u8c61\u4e2d\u6709\u5e74\u9f84\u4e3a35\u7684\uff0c\u4ee5\u53ca\u6240\u6709\u5bf9\u8c61\u4e2d\u59d3\u540d\u4e3a\u5f20\u4e09\u7684\u3002 \u672c\u8d28\u5b9e\u9645\u4e0a\u662f\uff1a\u96c6\u5408\u7684\u9ed8\u8ba4\u5b58\u50a8\u4f1a\u4f7f\u5bf9\u8c61\u7684\u7ed3\u6784\u4fe1\u606f\u4e22\u5931\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#5-dsl","title":"5. DSL \u9ad8\u7ea7\u67e5\u8be2\u529f\u80fd","text":"<p>Query DSL\u6982\u8ff0: Domain Specific Language(\u9886\u57df\u4e13\u7528\u8bed\u8a00)\uff0cElasticSearch\u63d0\u4f9b\u4e86\u57fa\u4e8eJSON\u7684DSL\u6765\u5b9a\u4e49\u67e5\u8be2\u3002 ![[imgs/image-4.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#51_2","title":"5.1 \u6a21\u7cca\u67e5\u8be2","text":"<p>\u8bed\u6cd5\uff1a <pre><code>get /index_name/_search\n{\n    \"query\":{\n        \"match | match_all | multi_match | prefix\"\n    }\n}\n</code></pre></p> <p>\u5168\u90e8\u67e5\u8be2</p> <pre><code>get /my_index/_search\n{\n  \"query\":{\n    \"match_all\": {}\n  }\n}\n</code></pre> <p>\u6a21\u7cca\u67e5\u8be2 get | post   \u5728\u6a21\u7cca\u67e5\u8be2\u4e2d\uff0c\u67e5\u8be2\u5185\u5bb9\u5206\u8bcd\u540e\u9ed8\u8ba4\u662f or \u5173\u7cfb  ``` java // \u5355\u6761\u4ef6\u67e5\u8be2 \u9ed8\u8ba4\u662f or \u5173\u7cfb get /my_index/_search {     \"query\": {         \"match\":{             \"title\" : \"\u7b14\u8bb0\u672c\u534e\u4e3a\"         }     } }</p> <p>// \u6539\u4e3a and \u5173\u7cfb get /my_index/_search {   \"query\": {     \"match\":{       \"title\":{         \"query\": \"\u534e\u4e3a\u7b14\u8bb0\u672c\u7535\u8111\",         \"operator\": \"and\"       }     }   } }  ```</p> <p>\u591a\u5b57\u6bb5\u67e5\u8be2\uff1a multi_match <pre><code>get /my_index/_search\n{\n  \"query\": {\n    \"multi_match\": {\n      \"query\": \"\u6c7d\u8f66\",\n      \"fields\": [\"title\", \"brand\"]\n    }\n  }\n}\n</code></pre></p> <p>\u524d\u7f00\u5339\u914d\uff1aprefix <pre><code>get /my_index/_search\n{\n  \"query\": {\n    \"prefix\": {\n      \"title\": {\n        \"value\": \"\u534e\u4e3a\"\n      }\n    }\n  }\n}\n</code></pre></p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#52_2","title":"5.2 \u7cbe\u786e\u67e5\u8be2","text":"<p>\u7cbe\u786e\u5339\u914d\uff1a\u7528\u6765\u67e5\u8be2\u6570\u503c\u6216\u8005\u5b57\u7b26\u4e32\u4e3a keyword \u7c7b\u578b\u7684</p> <ol> <li> <p>\u5355 keyword \u7cbe\u786e\u5339\u914d <pre><code>get /my_index/_search\n{\n  \"query\":{\n    \"term\":{\n      \"brand\":\"\u534e\u4e3a\"\n    }\n  }\n}\n</code></pre></p> </li> <li> <p>\u591a keyWord \u7cbe\u786e\u5339\u914d <pre><code>post /my_index/_search\n{\n  \"query\":{\n    \"terms\":{\n      \"brand\":[\"\u534e\u4e3a\",\"apple\"]\n    }\n  }\n}\n</code></pre></p> </li> <li> <p>\u6570\u503c\u7c7b\u578b\u7684\u8303\u56f4\u67e5\u8be2 <pre><code>post /my_index/_search\n{\n  \"query\":{\n    \"range\": {\n      \"price\": {\n        \"gte\": 1000,\n        \"lte\": 5000\n      }\n    }\n  }\n}\n</code></pre></p> </li> <li> <p>\u8fd4\u56de\u6307\u5b9a\u5b57\u6bb5 <pre><code>\"_source\": [\"title\",\"brand\"]\n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#53_2","title":"5.3 \u591a\u6761\u4ef6\u67e5\u8be2","text":"<ul> <li>must: \u5404\u4e2a\u6761\u4ef6\u90fd\u5fc5\u987b\u6ee1\u8db3\uff0c\u6240\u6709\u6761\u4ef6\u662fand\u7684\u5173\u7cfb</li> <li>should: \u5404\u4e2a\u6761\u4ef6\u6709\u4e00\u4e2a\u6ee1\u8db3\u5373\u53ef\uff0c\u5373\u5404\u6761\u4ef6\u662for\u7684\u5173\u7cfb</li> <li>must_not: \u4e0d\u6ee1\u8db3\u6240\u6709\u6761\u4ef6\uff0c\u5373\u5404\u6761\u4ef6\u662fnot\u7684\u5173\u7cfb</li> <li>filter: \u4e0emust\u6548\u679c\u7b49\u540c\uff0c\u4f46\u662f\u5b83\u4e0d\u8ba1\u7b97\u5f97\u5206\uff0c\u6548\u7387\u66f4\u9ad8\u70b9\u3002</li> </ul> <p>bool \u8282\u70b9 <pre><code>post /my_index/_search\n{\n  \"query\":{\n    \"bool\": {\n        \"must\":[\n            {\n                \"match\":{\n                    \"title\":\"xxx\"\n                },\n                ...\n            }\n        ],\n        \"should\":[],\n        \"must_not\":[],\n        ...\n    }\n  },\n  \"_source\":[]\n}\n</code></pre></p> <pre><code># \u6807\u9898\u6709\u534e\u4e3a\u5e76\u4e14\u4ef7\u683c\u533a\u95f4\u57283000-80000\npost /my_index/_search\n{\n  \"query\":{\n    \"bool\": {\n      \"must\": [\n        {\n          \"match\": {\n            \"title\": \"\u534e\u4e3a\"\n          }\n        },\n        {\n          \"range\": {\n            \"price\": {\n              \"gte\": 3000,\n              \"lte\": 80000\n            }\n          }\n        }\n      ]\n    }\n  }\n}\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#54_2","title":"5.4 \u805a\u5408\u67e5\u8be2","text":"<p>\u805a\u5408\u5141\u8bb8\u4f7f\u7528\u8005\u5bf9es\u6587\u6863\u8fdb\u884c\u7edf\u8ba1\u5206\u6790\uff0c\u7c7b\u4f3c\u4e0e\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e2d\u7684group by\uff0c\u5f53\u7136\u8fd8\u6709\u5f88\u591a\u5176\u4ed6\u7684\u805a\u5408\uff0c\u4f8b\u5982\u53d6\u6700\u5927\u503c\u3001\u5e73\u5747\u503c\u7b49\u7b49\u3002</p> <p>\u805a\u5408\u4e09\u8981\u7d20\uff1a\u805a\u5408\u540d\u79f0\uff08\u7ed9\u4e0d\u540c\u805a\u5408\u4e1a\u52a1\u5176\u540d\u79f0-\u7528\u4e8e\u89e3\u6790\u7ed3\u679c\uff09\u3001\u805a\u5408\u5b57\u6bb5\uff08\u5bf9\u54ea\u4e2a\u5b57\u6bb5\u8fdb\u884c\u5206\u7ec4\uff09\u3001\u805a\u5408\u7c7b\u578b\uff08\u5982\u4f55\u805a\u5408-\u5e38\u89c1\uff1a\u5b57\u6bb5\u503c\u76f8\u540c\u653e\u5728\u4e00\u7ec4\uff09</p> <pre><code>POST /my_index/_search\n{\n  \"query\": {\n    \"match_all\": {}\n  },\n  \"size\": 0, \n  \"aggs\": {\n    \"max_price\": {\n      \"max\": {\n        \"field\": \"price\"\n      }\n    }\n  }\n}\n</code></pre> <p>eg:\u76f4\u63a5\u5bf9\u5168\u90e8\u6570\u636e\u805a\u5408 <pre><code>post /my_index/_search\n{\n  \"query\":{\n    \"match_all\": {}\n  },\n\n  \"aggs\":{\n    // \u805a\u5408\u540d\u79f0\n    \"agg_max_price\":{\n      // \u805a\u5408\u7c7b\u578b\n      \"max\": {\n        // \u805a\u5408\u5b57\u6bb5 \n        \"field\": \"price\"\n      }\n    }\n  }\n}\n</code></pre></p> <p>eg:\u5148\u5206\u7ec4\uff0c\u5728\u805a\u5408 <pre><code>post /my_index/_search\n{\n  \"query\": {\n    \"match_all\": {}\n  },\n  \"aggs\": {\n    \"agg_by_brand\": {\n      \"terms\": {\n        \"field\": \"brand\",\n        \"size\": 10\n      },\n      \"aggs\": {\n        \"max_price\": {\n          \"max\": {\n            \"field\": \"price\"\n          }\n        }\n      }\n    }\n  }\n}\n</code></pre></p> <p>\u5e38\u89c1\u805a\u5408\u7c7b\u578b\uff1a</p> \u805a\u5408\u5927\u7c7b \u805a\u5408\u7c7b\u578b\uff08Aggregation Type\uff09 \u7528\u9014\u8bf4\u660e \u793a\u4f8b\u5b57\u6bb5 \u6307\u6807\u805a\u5408\uff08Metric Aggregations\uff09 <code>min</code> \u8ba1\u7b97\u67d0\u5b57\u6bb5\u7684\u6700\u5c0f\u503c <code>\"field\": \"price\"</code> <code>max</code> \u8ba1\u7b97\u67d0\u5b57\u6bb5\u7684\u6700\u5927\u503c <code>\"field\": \"price\"</code> <code>avg</code> \u8ba1\u7b97\u67d0\u5b57\u6bb5\u7684\u5e73\u5747\u503c <code>\"field\": \"price\"</code> <code>sum</code> \u8ba1\u7b97\u67d0\u5b57\u6bb5\u7684\u603b\u548c <code>\"field\": \"quantity\"</code> <code>value_count</code> \u7edf\u8ba1\u67d0\u5b57\u6bb5\u975e\u7a7a\u503c\u7684\u6570\u91cf <code>\"field\": \"user_id\"</code> <code>stats</code> \u540c\u65f6\u8fd4\u56de min/max/avg/sum/count \u7b49\u7edf\u8ba1\u4fe1\u606f <code>\"field\": \"price\"</code> <code>extended_stats</code> \u5728 stats \u57fa\u7840\u4e0a\u589e\u52a0\u65b9\u5dee\u3001\u6807\u51c6\u5dee\u7b49 <code>\"field\": \"price\"</code> <code>cardinality</code> \u4f30\u7b97\u5b57\u6bb5\u552f\u4e00\u503c\uff08\u53bb\u91cd\uff09\u6570\u91cf\uff08\u8fd1\u4f3c\u503c\uff09 <code>\"field\": \"user_id\"</code> \u6876\u805a\u5408\uff08Bucket Aggregations\uff09 <code>terms</code> \u6309\u5b57\u6bb5\u503c\u5206\u7ec4\uff08\u7c7b\u4f3c SQL \u7684 GROUP BY\uff09 <code>\"field\": \"category\"</code> <code>date_histogram</code> \u6309\u65f6\u95f4\u95f4\u9694\u5bf9\u65e5\u671f\u5b57\u6bb5\u5206\u7ec4\uff08\u5982\u6309\u5929\u3001\u6708\uff09 <code>\"field\": \"timestamp\", \"calendar_interval\": \"1d\"</code> <code>range</code> \u6309\u6570\u503c\u8303\u56f4\u5206\u7ec4\uff08\u81ea\u5b9a\u4e49\u533a\u95f4\uff09 <code>\"field\": \"price\", \"ranges\": [{\"from\":0,\"to\":100}]</code> <code>date_range</code> \u6309\u65e5\u671f\u8303\u56f4\u5206\u7ec4 <code>\"field\": \"order_date\", \"ranges\": [...]</code> <code>histogram</code> \u6309\u56fa\u5b9a\u6570\u503c\u95f4\u9694\u5206\u6876\uff08\u5982\u6bcf10\u5143\u4e00\u6863\uff09 <code>\"field\": \"price\", \"interval\": 10</code> <code>filter</code>\u00a0/\u00a0<code>filters</code> \u6839\u636e\u67e5\u8be2\u6761\u4ef6\u521b\u5efa\u4e00\u4e2a\u6216\u591a\u4e2a\u6876 <code>\"term\": {\"status\": \"completed\"}</code> <code>missing</code> \u5c06\u7f3a\u5931\u67d0\u5b57\u6bb5\u7684\u6587\u6863\u5f52\u4e3a\u4e00\u7ec4 <code>\"field\": \"description\"</code> \u7ba1\u9053\u805a\u5408\uff08Pipeline Aggregations\uff09 <code>derivative</code> \u8ba1\u7b97\u76f8\u90bb\u6876\u4e4b\u95f4\u7684\u5dee\u503c\uff08\u5e38\u7528\u4e8e\u65f6\u95f4\u5e8f\u5217\uff09 \u4f5c\u7528\u4e8e histogram \u6216 date_histogram \u7ed3\u679c <code>cumulative_sum</code> \u8ba1\u7b97\u7d2f\u8ba1\u548c \u4f5c\u7528\u4e8e sum \u6216 count \u7b49\u6307\u6807 <code>avg_bucket</code>,\u00a0<code>min_bucket</code>,\u00a0<code>max_bucket</code>,\u00a0<code>sum_bucket</code> \u5bf9\u5176\u4ed6\u805a\u5408\u7ed3\u679c\u7684\u6876\u8fdb\u884c\u4e8c\u6b21\u805a\u5408 \u4f8b\u5982\u5bf9\u6bcf\u65e5\u9500\u552e\u989d\u6c42\u5e73\u5747 <code>bucket_script</code> \u4f7f\u7528\u811a\u672c\u5bf9\u591a\u4e2a\u6876\u7684\u805a\u5408\u7ed3\u679c\u8fdb\u884c\u8ba1\u7b97 \u652f\u6301\u81ea\u5b9a\u4e49\u516c\u5f0f"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#55_1","title":"5.5 \u5206\u9875\u67e5\u8be2","text":"<p>\u548c query \u540c\u7ea7\uff0c\u5206\u522b\u662f \"from\", \"size\"</p> <pre><code>POST /my_index/_search\n{\n  \"query\": {\n    // \u67e5\u8be2\u6761\u4ef6\uff0c\u4f8b\u5982 match_all\u3001term\u3001bool \u7b49\n  },\n  \"from\": 0,     // \u8d77\u59cb\u4f4d\u7f6e\uff08\u7b2c0\u6761 = \u7b2c\u4e00\u9875\u7b2c\u4e00\u6761\uff09\n  \"size\": 10     // \u6bcf\u9875\u8fd4\u56de10\u6761\n}\n</code></pre> \u9879\u76ee \u8bf4\u660e \u9ed8\u8ba4\u6700\u5927\u7a97\u53e3 <code>from + size &lt;= 10000</code>\uff08\u53ef\u8c03\u5927\uff0c\u4f46\u4e0d\u63a8\u8350\uff09 \u6027\u80fd\u95ee\u9898 \u6df1\u5ea6\u5206\u9875\uff08\u5982\u00a0<code>from=999990</code>\uff09\u4f1a\u5bfc\u81f4\u6bcf\u4e2a\u5206\u7247\u52a0\u8f7d\u5e76\u6392\u5e8f\u5927\u91cf\u6570\u636e\uff0c\u6d88\u8017 CPU/\u5185\u5b58 \u9002\u7528\u573a\u666f \u4ec5\u9002\u7528\u4e8e\u6d45\u5206\u9875\uff08\u5982\u524d\u51e0\u5341\u9875\uff09 \u66ff\u4ee3\u65b9\u6848 \u6df1\u5ea6\u5206\u9875\u8bf7\u4f7f\u7528\u00a0<code>search_after</code>\u00a0\u6216\u00a0<code>scroll</code> ##### 5.6 \u6392\u5e8f \u6392\u5e8f\u7531\u6392\u5e8f\u5b57\u6bb5 + order:\"desc asc\" \u6784\u6210\uff0c sort \u8282\u70b9\u4e0b\u53ef\u4ee5\u6709\u591a\u4e2a\u6392\u5e8f\u89c4\u5219\u3002 \u9ed8\u8ba4\u6309\u7167\u76f8\u5173\u6027\u4ece\u5927\u5230\u5c0f\u6392\u5e8f <pre><code>POST /your_index/_search\n{\n  \"query\": {\n    // \u67e5\u8be2\u6761\u4ef6\n  },\n  \"sort\": [\n    {\n      \"\u5b57\u6bb5\u540d\": {\n        \"order\": \"asc\" \u6216 \"desc\"\n      }\n    }\n  ],\n  \"from\": 0,\n  \"size\": 10\n}\n</code></pre> <p>\ud83d\udd39 <code>sort</code> \u662f\u4e00\u4e2a\u6570\u7ec4\uff0c\u53ef\u4ee5\u5305\u542b\u591a\u4e2a\u6392\u5e8f\u89c4\u5219\uff08\u6309\u987a\u5e8f\u4f18\u5148\u7ea7\u5e94\u7528\uff09 \ud83d\udd39 \u4e0e <code>query</code>\u3001<code>aggs</code>\u3001<code>from</code>\u3001<code>size</code> \u7b49\u540c\u7ea7</p> <p>\u591a\u5173\u952e\u5b57\u6392\u5e8f\uff1a <pre><code>post /my_index/_search\n{\n  \"query\":{\n    \"match_all\": {}\n  },\n  \"sort\":[\n    {\n      \"price\":{\n        \"order\":\"desc\"\n      }\n    },\n    {\n      \"_score\":{\n        \"order\":\"desc\"\n      }\n    }\n  ]\n}\n</code></pre></p> <p>\u76f8\u5173\u6027\u6392\u5e8f\uff1a <pre><code>\"sort\": [\n  { \"_score\": { \"order\": \"desc\" } }\n]\n</code></pre></p> <ol> <li>\u5b57\u6bb5\u5fc5\u987b\u53ef\u6392\u5e8f\uff1a<ul> <li>\u6570\u503c\u3001\u65e5\u671f\u3001<code>keyword</code>\u00a0\u7c7b\u578b\u5929\u7136\u652f\u6301</li> <li><code>text</code>\u00a0\u7c7b\u578b\u9700\u4f7f\u7528\u00a0<code>.keyword</code>\uff08\u5982\u00a0<code>\"title.keyword\"</code>\uff09</li> </ul> </li> <li>\u6027\u80fd\u5f71\u54cd\uff1a<ul> <li>\u6392\u5e8f\u4f1a\u6d88\u8017\u5185\u5b58\u548c CPU\uff0c\u5c24\u5176\u662f\u975e\u00a0<code>_doc</code>\u00a0\u6216\u00a0<code>_score</code>\u00a0\u7684\u5b57\u6bb5</li> <li>\u5efa\u8bae\u5bf9\u9ad8\u9891\u6392\u5e8f\u5b57\u6bb5\u5f00\u542f\u00a0<code>doc_values: true</code>\uff08\u9ed8\u8ba4\u5df2\u5f00\u542f\uff09</li> </ul> </li> <li>\u5206\u9875 + \u6392\u5e8f\u4e00\u81f4\u6027\uff1a<ul> <li>\u4f7f\u7528\u00a0<code>from/size</code>\u00a0\u5206\u9875\u65f6\uff0c\u786e\u4fdd\u6392\u5e8f\u5b57\u6bb5\u5177\u6709\u552f\u4e00\u6027\uff08\u5982\u52a0\u4e0a\u00a0<code>_id</code>\uff09\uff0c\u907f\u514d\u5206\u9875\u7ed3\u679c\u8df3\u53d8</li> </ul> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#57","title":"5.7 \u9ad8\u4eae\u663e\u793a","text":"<pre><code>POST /your_index/_search\n{\n  \"query\": {\n    // \u67e5\u8be2\u6761\u4ef6\uff08\u5982 match\u3001multi_match \u7b49\uff09\n  },\n  \"highlight\": {\n    \"fields\": {\n      \"\u5b57\u6bb5\u540d1\": {},\n      \"\u5b57\u6bb5\u540d2\": {}\n    }\n  }\n}\n</code></pre> <ol> <li>\u81ea\u5b9a\u4e49\u9ad8\u4eae <pre><code>      \"pre_tags\": \"\",\n      \"post_tags\": \"\",\n      \"number_of_fragments\": 0,\n      \"fragment_size\": 150\n</code></pre></li> </ol> \u53c2\u6570 \u8bf4\u660e <code>pre_tags</code>\u00a0/\u00a0<code>post_tags</code> \u81ea\u5b9a\u4e49\u9ad8\u4eae\u524d/\u540e\u6807\u7b7e\uff0c\u9ed8\u8ba4\u662f\u00a0<code>[\"&lt;em&gt;\"]</code>\u00a0/\u00a0<code>[\"&lt;/em&gt;\"]</code> <code>number_of_fragments</code> \u8fd4\u56de\u591a\u5c11\u4e2a\u9ad8\u4eae\u7247\u6bb5\uff08\u9ed8\u8ba4 3\uff09\u3002\u8bbe\u4e3a\u00a0<code>0</code>\u00a0\u8868\u793a\u8fd4\u56de\u6574\u4e2a\u5b57\u6bb5\u5185\u5bb9\u5e76\u9ad8\u4eae <code>fragment_size</code> \u6bcf\u4e2a\u7247\u6bb5\u7684\u5b57\u7b26\u957f\u5ea6\uff08\u9ed8\u8ba4 100\uff09 <code>require_field_match</code> \u662f\u5426\u53ea\u9ad8\u4eae\u88ab\u67e5\u8be2\u547d\u4e2d\u7684\u5b57\u6bb5\uff08\u9ed8\u8ba4\u00a0<code>true</code>\uff09 ##### 5.8 \u9009\u62e9\u67e5\u8be2\u5b57\u6bb5 <pre><code>\"_source\": [\"f1\", \"f2\", ...]\n\"_source\": {\n    \"includes\":[\"f1\", \"f2\"],\n    \"excludes\":[\"f1\", \"f2\"]\n}\n</code></pre> #### 6. Java Api \u64cd\u4f5cEs"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#61-elasticsearch-java-api-client","title":"6.1 ElasticSearch Java API Client","text":"<p>Elasticsearch provides official clients for popular programming languages. These client libraries make it easier to use your preferred language to work with your Elasticsearch deployment.</p> <p>8.5 java client \u6587\u6863</p> <ol> <li>\u5bfc\u5165\u4f9d\u8d56 <pre><code>&lt;project&gt;\n  &lt;dependencies&gt;\n\n    &lt;dependency&gt;\n      &lt;groupId&gt;co.elastic.clients&lt;/groupId&gt;\n      &lt;artifactId&gt;elasticsearch-java&lt;/artifactId&gt;\n      &lt;version&gt;8.5.3&lt;/version&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n      &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;\n      &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;\n      &lt;version&gt;2.12.3&lt;/version&gt;\n    &lt;/dependency&gt;\n\n  &lt;/dependencies&gt;\n&lt;/project&gt;\n</code></pre></li> </ol> <p>\u5982\u679c\u62a5\u9519\uff0c\u5bfc\u5165\u4e0b\u9762\u7684\u4f9d\u8d56\uff1a</p> <pre><code>&lt;project&gt;\n  &lt;dependencies&gt;\n    ...\n    &lt;dependency&gt;\n      &lt;groupId&gt;jakarta.json&lt;/groupId&gt;\n      &lt;artifactId&gt;jakarta.json-api&lt;/artifactId&gt;\n      &lt;version&gt;2.0.1&lt;/version&gt;\n    &lt;/dependency&gt;\n\n  &lt;/dependencies&gt;\n&lt;/project&gt;\n</code></pre> <ol> <li> <p>\u521b\u5efa\u4e00\u4e2a c \u7aef\uff08\u5e26\u8d26\u53f7\u4ee5\u53ca\u5bc6\u7801\uff09 <pre><code>BasicCredentialsProvider credsProv = new BasicCredentialsProvider();  \ncredsProv.setCredentials(  \n        AuthScope.ANY, new UsernamePasswordCredentials(\"elastic\", \"liuqiang\")  \n);  \n\nRestClient restClient = RestClient  \n        .builder(new HttpHost(\"152.136.97.27\", 9200))  \n        .setHttpClientConfigCallback(hc -&gt; hc  \n                .setDefaultCredentialsProvider(credsProv)  \n        )  \n        .build();  \n\n// Create the transport and the API client  \nElasticsearchTransport transport = new RestClientTransport(restClient, new JacksonJsonpMapper());  \nclient = new ElasticsearchClient(transport);\n</code></pre></p> </li> <li> <p>\u4e4b\u540e\u5c31\u53ef\u4ee5\u8c03\u7528\u539f\u751f api \u4e86</p> </li> </ol> <p>\u65b0\u589e\u6587\u6863 <pre><code>// 1. lambda \u5199\u6cd5  \nGoods goods = new Goods();  \ngoods.setId(\"2\");  \ngoods.setBrand(\"\u5927\u7c73\");  \ngoods.setImages(\"https://www.baidu.com\");  \ngoods.setPrice(6666);  \ngoods.setTitle(\"\u5927\u7c73\u624b\u673a\");  \n\n// client.index(t -&gt; t.index(INDEX_NAME).id(goods.getId()).document(goods));  \n\n\n// 2. \u539f\u751f\u5199\u6cd5  \nIndexRequest.Builder&lt;Goods&gt; goodsBuilder = new IndexRequest.Builder&lt;&gt;();  \nIndexRequest&lt;Goods&gt; req = goodsBuilder.index(INDEX_NAME)  \n        .id(goods.getId())  \n        .document(goods)  \n        .build();  \nclient.index(req);\n</code></pre></p> <p>\u5176\u4ed6\u64cd\u4f5c\u4e00\u81f4\uff0c\u5176\u5b9e\u5c31\u662f\u5728\u62fc restful \u7684url\uff0c\u7136\u540e\u53bb\u53d1http\u8bf7\u6c42</p> <pre><code>@Test  \npublic void test02() throws IOException {  \n    GetResponse&lt;Goods&gt; goodsGetResponse = client.get(t -&gt; {  \n        return t.index(INDEX_NAME).id(\"1\");  \n    }, Goods.class);  \n\n    System.out.println(goodsGetResponse.source());  \n}  \n\n@Test  \npublic void test03() throws IOException {  \n    client.delete(t -&gt; t.index(INDEX_NAME).id(\"1\"))  \n}\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#62-spring-data-elasticsearch","title":"6.2 Spring Data Elasticsearch","text":"<p>Spring Data\u662f\u4e00\u4e2a\u7528\u4e8e\u7b80\u5316\u6570\u636e\u5e93\u3001\u975e\u5173\u7cfb\u578b\u6570\u636e\u5e93\u3001\u7d22\u5f15\u5e93\u8bbf\u95ee\uff0c\u5e76\u652f\u6301\u4e91\u670d\u52a1\u7684\u5f00\u6e90\u6846\u67b6\u3002\u5176\u4e3b\u8981\u76ee\u6807\u662f\u4f7f\u5f97\u5bf9\u6570\u636e\u7684\u8bbf\u95ee\u53d8\u5f97\u65b9\u4fbf\u5feb\u6377\u3002 Spring Data\u53ef\u4ee5\u6781\u5927\u7684\u7b80\u5316JPA\uff08ElasticSearch\u2026\uff09\u7684\u5199\u6cd5\uff0c\u53ef\u4ee5\u5728\u51e0\u4e4e\u4e0d\u7528\u5199\u5b9e\u73b0\u7684\u60c5\u51b5\u4e0b\uff0c\u5b9e\u73b0\u5bf9\u6570\u636e\u7684\u8bbf\u95ee\u548c\u64cd\u4f5c\u3002\u9664\u4e86CRUD\u5916\uff0c\u8fd8\u5305\u62ec\u5982\u5206\u9875\u3001\u6392\u5e8f\u7b49\u4e00\u4e9b\u5e38\u7528\u7684\u529f\u80fd\u3002</p> <p>Spring Data ElasticSearch \u57fa\u4e8e spring data API \u7b80\u5316 ElasticSearch\u64cd\u4f5c\uff0c\u5c06\u539f\u59cb\u64cd\u4f5cElasticSearch\u7684\u5ba2\u6237\u7aefAPI \u8fdb\u884c\u5c01\u88c5 \u3002Spring Data\u4e3aElasticSearch\u9879\u76ee\u63d0\u4f9b\u96c6\u6210\u641c\u7d22\u5f15\u64ce\u3002Spring Data ElasticSearch POJO\u7684\u5173\u952e\u529f\u80fd\u533a\u57df\u4e3a\u4e2d\u5fc3\u7684\u6a21\u578b\u4e0eElastichsearch\u4ea4\u4e92\u6587\u6863\u548c\u8f7b\u677e\u5730\u7f16\u5199\u4e00\u4e2a\u5b58\u50a8\u7d22\u5f15\u5e93\u6570\u636e\u8bbf\u95ee\u5c42\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#_6","title":"\u4f7f\u7528\u65b9\u6cd5","text":"<ol> <li> <p>\u5bfc\u5165\u4f9d\u8d56 <pre><code>&lt;dependency&gt;  \n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;  \n    &lt;artifactId&gt;spring-boot-starter-data-elasticsearch&lt;/artifactId&gt;  \n&lt;/dependency&gt;\n</code></pre></p> </li> <li> <p>\u53bb\u505a client \u7684\u914d\u7f6e <pre><code>1. \u5b98\u65b9\u7684\u5199\u6cd5\n@Configuration  \npublic class EsClientConf extends ElasticsearchConfiguration {  \n\n    @Override  \n    public ClientConfiguration clientConfiguration() {  \n        return ClientConfiguration.builder()  \n                .connectedTo(\"152.136.97.27:9200\")  \n                .withBasicAuth(\"elastic\", \"liuqiang\")  \n                .build();  \n    }  \n}\n</code></pre></p> </li> </ol> <pre><code>2. \u5199\u914d\u7f6e\u6587\u4ef6\nspring:  \n  elasticsearch:  \n    uris: http://152.136.97.27:9200  \n    username: elastic  \n    password: liuqiang\n</code></pre> <ol> <li>\u4e4b\u540e\u5c31\u53ef\u4ee5\u6ce8\u5165\u539f\u751f es-client \u6216\u8005 \u4f4e\u7ea7client\u4e86</li> </ol> <pre><code>// restClient \u6f14\u793a\n@Test  \npublic void test02() throws IOException {  \n    // 1. \u6784\u9020 GET /myindex/_doc/1    Request request = new Request(\"GET\", \"/myindex/_doc/1\");  \n\n    // 2. \u53d1\u9001\u8bf7\u6c42  \n    Response response = restClient.performRequest(request);  \n\n    // 3. \u8bfb\u53d6\u54cd\u5e94\u4f53\u4e3a\u5b57\u7b26\u4e32  \n    String responseBody = EntityUtils.toString(response.getEntity(), \"UTF-8\");  \n\n    // 4. \u4f7f\u7528 ObjectMapper \u89e3\u6790\u6574\u4e2a\u54cd\u5e94  \n    JsonNode root = objectMapper.readTree(responseBody);  \n\n    // 5. \u68c0\u67e5\u6587\u6863\u662f\u5426\u5b58\u5728  \n    if (!root.path(\"found\").asBoolean(true)) {  \n        System.out.println(\"Document not found!\");  \n        return;  \n    }  \n\n    // 6. \u63d0\u53d6 _source \u8282\u70b9  \n    JsonNode sourceNode = root.get(\"_source\");  \n    if (sourceNode == null) {  \n        throw new IllegalStateException(\"Missing '_source' in Elasticsearch response\");  \n    }  \n\n    // 7. \u5c06 _source \u53cd\u5e8f\u5217\u5316\u4e3a Goods \u5bf9\u8c61  \n    Goods goods = objectMapper.treeToValue(sourceNode, Goods.class);  \n\n    // 8. \u8f93\u51fa\u7ed3\u679c  \n    System.out.println(\"Retrieved goods: \" + goods);  \n}\n</code></pre> <pre><code>@Autowired  \nprivate ElasticsearchClient elasticsearchClient;  \n\n@Test  \npublic void get() throws IOException {  \n    GetResponse&lt;Goods&gt; myindex = elasticsearchClient.get(t -&gt;  \n                    t.index(\"myindex\").id(\"1\")  \n            , Goods.class);  \n\n    System.out.println(myindex.source());  \n}\n</code></pre> <ol> <li>\u5f53\u7136\uff0c\u6211\u4eec\u4e00\u7248\u4e0d\u7528\u539f\u751fclient\uff0c\u800c\u662fspring\u5c01\u88c5\u597d\u7684 esTemplate <pre><code>@Autowired  \nprivate ElasticsearchTemplate elasticsearchTemplate;  \n@Test  \npublic void test03() throws IOException {  \n\n    Goods goods = elasticsearchTemplate.get(\"1\", Goods.class, IndexCoordinates.of(\"myindex\"));  \n    System.out.println(goods);  \n}  \n\n@Test  \npublic void test04() throws IOException {  \n\n    Goods good = new Goods();  \n    good.setId(\"3\");  \n    good.setTitle(\"apple\u624b\u673a\");  \n    good.setBrand(\"apple\");  \n    good.setImages(\"https://www.baidu.com\");  \n    good.setPrice(9999);  \n    elasticsearchTemplate.save(good, IndexCoordinates.of(\"myindex\"));  \n}\n</code></pre></li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#es","title":"\u6620\u5c04\u4ee5\u53ca\u901a\u8fc7\u5b9e\u73b0\u63a5\u53e3\u6765\u4f7f\u7528es","text":"<p>Spring Data\u901a\u8fc7\u6ce8\u89e3\u6765\u58f0\u660e\u5b57\u6bb5\u7684\u6620\u5c04\u5c5e\u6027\uff0c\u6709\u4e0b\u9762\u7684\u4e09\u4e2a\u6ce8\u89e3\uff1a @Document \u4f5c\u7528\u5728\u7c7b\uff0c\u6807\u8bb0\u5b9e\u4f53\u7c7b\u4e3a\u6587\u6863\u5bf9\u8c61\uff0c indexName\uff1a\u5bf9\u5e94\u7d22\u5f15\u5e93\u540d\u79f0 @Id \u4f5c\u7528\u5728\u6210\u5458\u53d8\u91cf\uff0c\u6807\u8bb0\u4e00\u4e2a\u5b57\u6bb5\u4f5c\u4e3aid\u4e3b\u952e @Field \u4f5c\u7528\u5728\u6210\u5458\u53d8\u91cf\uff0c\u6807\u8bb0\u4e3a\u6587\u6863\u7684\u5b57\u6bb5\uff0c\u5e76\u6307\u5b9a\u5b57\u6bb5\u6620\u5c04\u5c5e\u6027\uff1a type\uff1a\u5b57\u6bb5\u7c7b\u578b\uff0c\u53d6\u503c\u662f\u679a\u4e3e\uff1aFieldType index\uff1a\u662f\u5426\u7d22\u5f15\uff0c\u5e03\u5c14\u7c7b\u578b\uff0c\u9ed8\u8ba4\u662ftrue store\uff1a\u662f\u5426\u5b58\u50a8\uff0c\u5e03\u5c14\u7c7b\u578b\uff0c\u9ed8\u8ba4\u662ffalse analyzer\uff1a\u5206\u8bcd\u5668\u540d\u79f0\uff1aik_max_word \u5176\u6b21\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u5728\u6301\u4e45\u5c42\u6765\u5b9e\u73b0\u63a5\u53e3\uff0c\u4ece\u800c\u5b9e\u73b0\u5bf9es\u7684\u64cd\u4f5c</p> <pre><code>1. \u5199\u5b9e\u4f53\u7c7b\u7684\u6620\u5c04\n@Data  \n@Document(indexName = \"index2\")  \npublic class Goods {  \n\n    @Id  \n    private String id;  \n    @Field(type = FieldType.Text)  \n    private String title;  \n    @Field(type = FieldType.Keyword)  \n    private String images;  \n    @Field(type = FieldType.Keyword)  \n    private String brand;  \n    @Field(type = FieldType.Integer)  \n    private Integer price;  \n}\n\n\n2. \u5199\u4e00\u4e2a\u63a5\u53e3\uff0c\u53bb\u7ee7\u627fElasticsearchRepository\n/**  \n * SpringData\u4f1a\u81ea\u52a8\u626b\u63cf\u7ee7\u627f\u81ea*Repository\u63a5\u53e3\u4ea7\u751f\u4ee3\u7406\u5bf9\u8c61  \n */  \npublic interface GoodsRepository extends ElasticsearchRepository&lt;Goods, Integer&gt; {  \n}\n\n\n3. \u4e4b\u540e\u5c31\u53ef\u4ee5\u6ce8\u5165\u8fd9\u4e2a\u63a5\u53e3\uff0c\u7136\u540e\u76f4\u63a5\u64cd\u4f5cbean\u5bf9\u4e8e\u7684\u7d22\u5f15\u5e93\u4e86\u3002\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#7_1","title":"7. \u63d0\u793a\u8bcd\u7684\u5b9e\u73b0","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#71","title":"7.1 \u57fa\u7840\u8bed\u6cd5","text":"<ol> <li> <p>\u521b\u5efa\u7d22\u5f15\u7684\u65f6\u5019\u5c31\u8981\u6307\u5b9a\u63d0\u793a\u8bcd <pre><code>PUT test\n{\n  \"mappings\": {\n    \"properties\": {\n      \"name\": {\n        \"type\": \"keyword\"\n      },\n      \"suggestKeyword\": {\n        \"type\": \"completion\"\n      },\n      \"suggestPinyin\": {\n        \"type\": \"completion\"\n      },\n      \"suggestLetter\": {\n        \"type\": \"completion\"\n      }\n    }\n  }\n}\n</code></pre></p> </li> <li> <p>\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u8f93\u5165\u53bb\u5339\u914d\u63d0\u793a\u8bcd\u4e86</p> </li> </ol> <pre><code>#\u6a21\u62df\u7528\u6237\u5f55\u5165\u90e8\u5206\u5173\u952e\u5b57\u5185\u5bb9\u540e\uff0c\u5b8c\u6210\u81ea\u52a8\u8865\u5168\n\n#\u5355\u72ec\u67e5\u8be2 \u62fc\u97f3\u5efa\u8bae\u8bcd\nGET /test/_search\n{\n  \"suggest\": {\n    \"mySuggestPinyin\": {\n      \"prefix\": \"8fen\",\n      \"completion\": {\n        \"field\": \"suggestPinyin\"\n      }\n    }\n  }\n}\n\n#\u5355\u72ec\u67e5\u8be2 \u62fc\u97f3\u5b57\u6bcd\u5efa\u8bae\u8bcd\nGET /test/_search\n{\n  \"suggest\": {\n    \"mySuggestLetter\": {\n      \"prefix\": \"8fz\",\n      \"completion\": {\n        \"field\": \"suggestLetter\"\n      }\n    }\n  }\n}\n\n#\u5355\u72ec\u67e5\u8be2 \u6c49\u5b57\u5efa\u8bae\u8bcd\nGET /test/_search\n{\n  \"suggest\": {\n    \"mySuggestKeyword\": {\n      \"prefix\": \"\u7ecf\u5178\",\n      \"completion\": {\n        \"field\": \"suggestKeyword\"\n      }\n    }\n  }\n}\n\n#\u4e00\u4e2a\u5efa\u8bae\u4e2d\u5305\u542b\u591a\u4e2a\u81ea\u5b9a\u4e49\u5efa\u8bae\u53c2\u6570\uff0c\u5206\u522b\u67e5\u8be2\u591a\u4e2a\u81ea\u52a8\u8865\u5168\u5b57\u6bb5\nGET /test/_search\n{\n  \"suggest\": {\n    \"mySuggestKeyword\": {\n      \"prefix\": \"8f\",\n      \"completion\": {\n        \"field\": \"suggestKeyword\",\n        \"size\": 10,\n        \"skip_duplicates\": true\n      }\n    },\n    \"mySuggestPinyin\": {\n      \"prefix\": \"8f\",\n      \"completion\": {\n        \"field\": \"suggestPinyin\",\n         \"skip_duplicates\": true\n      }\n    },\n    \"mySuggestLetter\": {\n      \"prefix\": \"8f\",\n      \"completion\": {\n        \"field\": \"suggestLetter\",\n         \"skip_duplicates\": true\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#72","title":"7.2 \u5b9e\u73b0\u65b9\u5f0f","text":"<p>\u9996\u5148\uff0c\u5148\u53bb\u521b\u5efa\u4e00\u4e2a\u63d0\u793a\u8bcd\u7d22\u5f15\u5e93\uff0c\u9759\u6001\u6620\u5c04\u5982\u4e0b\uff1a <pre><code>@Data  \n@Document(indexName = \"suggestinfo\")  \n@JsonIgnoreProperties(ignoreUnknown = true)//\u76ee\u7684\uff1a\u9632\u6b62json\u5b57\u7b26\u4e32\u8f6c\u6210\u5b9e\u4f53\u5bf9\u8c61\u65f6\u56e0\u672a\u8bc6\u522b\u5b57\u6bb5\u62a5\u9519  \npublic class SuggestIndex {  \n\n    /**  \n     * \u63d0\u793a\u8bcd\u6587\u6863 id\uff0c\u548c\u4e13\u8f91\u6587\u6863id\u7edf\u4e00  \n     */  \n    @Id  \n    private String id;  \n\n    /**  \n     * \u63d0\u793a\u8bcd\u540d\u79f0,\u4e5f\u5c31\u662f\u6587\u6863\u7684\u6807\u9898  \n     */  \n    @Field(type = FieldType.Text, analyzer = \"standard\")  \n    private String title;  \n\n    @CompletionField(analyzer = \"standard\", searchAnalyzer = \"standard\", maxInputLength = 20)  \n    private Completion keyword;  \n\n    @CompletionField(analyzer = \"standard\", searchAnalyzer = \"standard\", maxInputLength = 20)  \n    private Completion keywordPinyin;  \n\n    @CompletionField(analyzer = \"standard\", searchAnalyzer = \"standard\", maxInputLength = 20)  \n    private Completion keywordSequence;  \n\n}\n</code></pre></p> <p>\u7136\u540e\uff0c\u53bb\u5199 DSL \u5373\u53ef</p> <pre><code>post /suggestinfo/_search\n{\n  \"suggest\":{\n    \"KeyWordPingYingSuggst\":{\n      \"prefix\":\"dao\",\n      \"completion\":{\n        \"field\":\"keywordPinyin\",\n        \"skip_duplicates\": true\n      }\n    },\n    \"KeyWordSuggst\":{\n      \"prefix\":\"dao\",\n      \"completion\":{\n        \"field\":\"keyword\",\n        \"skip_duplicates\": true\n      }\n    },\n    \"KeyWordLettersSuggst\":{\n      \"prefix\":\"dao\",\n      \"completion\":{\n        \"field\":\"keywordSequence\",\n        \"skip_duplicates\": true\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#8-elk","title":"8. ELK \u65e5\u5fd7\u89e3\u51b3\u65b9\u6cd5","text":"<p>![[Springboot/imgs/image 1.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#81-elk","title":"8.1 ELK\u7684\u5b89\u88c5","text":"<p>[[#11 ElasticSearch#2. ELK \u7684\u5b89\u88c5\uff08docker\uff09]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#82-elk","title":"8.2 ELK\u7684\u4f7f\u7528","text":"<ol> <li> <p>\u5bfc\u5165\u4f9d\u8d56 <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;net.logstash.logback&lt;/groupId&gt;\n    &lt;artifactId&gt;logstash-logback-encoder&lt;/artifactId&gt;\n    &lt;version&gt;5.1&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre></p> </li> <li> <p>\u65e5\u5fd7\u914d\u7f6e\u6587\u4ef6<code>logback-spring.xml</code>\u589e\u52a0\uff0c\u65e5\u5fd7Logstash\u7b56\u7565 <pre><code>&lt;!-- logstash\u65e5\u5fd7 --&gt;\n&lt;appender name=\"LOGSTASH\" class=\"net.logstash.logback.appender.LogstashTcpSocketAppender\"&gt;\n    &lt;!-- logstash ip\u548c\u66b4\u9732\u7684\u7aef\u53e3\uff0clogback\u5c31\u662f\u901a\u8fc7\u8fd9\u4e2a\u5730\u5740\u628a\u65e5\u5fd7\u53d1\u9001\u7ed9logstash --&gt;\n    &lt;destination&gt;152.136.97.27:5044&lt;/destination&gt;\n    &lt;encoder charset=\"UTF-8\" class=\"net.logstash.logback.encoder.LogstashEncoder\" /&gt;\n&lt;/appender&gt;\n\n&lt;!-- \u5f00\u53d1\u73af\u5883 --&gt;\n&lt;springProfile name=\"dev\"&gt;\n    &lt;!-- com.atguigu\u65e5\u5fd7\u8bb0\u5f55\u5668\uff1a\u4e1a\u52a1\u7a0b\u5e8fINFO\u7ea7\u522b  --&gt;\n    &lt;logger name=\"com.atguigu\" level=\"INFO\" /&gt;\n    &lt;!--&lt;logger name=\"com.alibaba\" level=\"WARN\" /&gt;--&gt;\n    &lt;!-- \u6839\u65e5\u5fd7\u8bb0\u5f55\u5668\uff1aINFO\u7ea7\u522b  --&gt;\n    &lt;root level=\"INFO\"&gt;\n        &lt;appender-ref ref=\"CONSOLE\" /&gt;\n        &lt;appender-ref ref=\"LOGSTASH\" /&gt;\n    &lt;/root&gt;\n&lt;/springProfile&gt;\n</code></pre></p> </li> <li> <p>\u542f\u52a8\u9879\u76ee\u6d4b\u8bd5Java\u8fdb\u7a0b\u542f\u52a8\u4f1a\u5c06\u65e5\u5fd7\u53d1\u9001\u5230Logstash\uff0cLogstash\u4f1a\u81ea\u52a8\u5c06\u6570\u636e\u5b58\u5165ES</p> </li> </ol> <p>\u6ce8\uff1a\u522b\u5fd8\u4e86\u914d\u7f6e ELK\uff08es\u7684\u914d\u7f6e\u3001logstach\u7684\u914d\u7f6e\u3001Kibana\u7684\u914d\u7f6e\uff09</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#12-mongodb","title":"12 MongoDB","text":"<p>\u5b98\u65b9\u6587\u6863\uff1a\u4ec0\u4e48\u662f MongoDB\uff1f- \u6570\u636e\u5e93\u624b\u518c v7.0 - MongoDB Docs</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1_19","title":"1. \u57fa\u7840\u6982\u5ff5","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#11_1","title":"1.1 \u4ecb\u7ecd","text":"<p>MongoDB \u662f\u57282007\u5e74\u7531DoubleClick\u516c\u53f8\u7684\u51e0\u4f4d\u6838\u5fc3\u6210\u5458\u5f00\u53d1\u51fa\u7684\u4e00\u6b3e\u5206\u5e03\u5f0f\u6587\u6863\uff08\u6570\u636e\uff09\u6570\u636e\u5e93\uff0c\u7531C++\u8bed\u8a00\u7f16\u5199\u3002</p> <p>\u5728MongoDB\u4e2d\u6570\u636e\u4e3b\u8981\u7684\u7ec4\u7ec7\u7ed3\u6784\u5c31\u662f<code>\u6570\u636e\u5e93\u3001\u96c6\u5408\u548c\u6587\u6863</code>\uff0c\u6587\u6863\u5b58\u50a8\u5728\u96c6\u5408\u5f53\u4e2d\uff0c\u96c6\u5408\u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d\u3002</p> <p>MongoDB\u4e2d\u6bcf\u4e00\u6761\u6570\u636e\u8bb0\u5f55\u5c31\u662f\u4e00\u4e2a\u6587\u6863\uff0c<code>\u6570\u636e\u7ed3\u6784\u7531\u952e\u503c(key=&gt;value)\u5bf9\u7ec4\u6210</code>\u3002</p> <p>\u6587\u6863\u7c7b\u4f3c\u4e8e JSON \u5bf9\u8c61\uff0c\u5b83\u7684\u6570\u636e\u7ed3\u6784\u88ab\u53eb\u505a<code>BSON</code>\uff08Binary JSON\uff09\u3002</p> <p>![[Springboot/imgs/image-3 1.png]]</p> RDBMS\uff08MySQL\uff09 MongoDB \u6570\u636e\u5e93 \u6570\u636e\u5e93\uff08database\uff09 \u8868 \u96c6\u5408\uff08Collection\uff09 \u884c \u6587\u6863\uff08Document\uff09 \u5217 \u5b57\u6bb5\uff08Field\uff09 \u8868\u8054\u5408 \u5d4c\u5165\u6587\u6863 \u4e3b\u952e _id"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#12_1","title":"1.2 \u9002\u7528\u573a\u666f","text":"<pre><code>MongoDB\u4e0d\u9700\u8981\u53bb\u660e\u786e\u6307\u5b9a\u4e00\u4e2a\u6587\u6863\u7684\u5177\u4f53\u7ed3\u6784\uff0c\u5bf9\u5b57\u6bb5\u7684\u7ba1\u7406\u975e\u5e38\u7075\u6d3b\uff0c\u6709\u5f88\u5f3a\u7684\u53ef\u6269\u5c55\u6027\u3002\n\u652f\u6301\u9ad8\u5e76\u53d1\u3001\u9ad8\u53ef\u7528\u3001\u9ad8\u53ef\u6269\u5c55\u6027\uff0c\u81ea\u5e26\u6570\u636e\u538b\u7f29\u529f\u80fd\uff0c\u652f\u6301\u6d77\u91cf\u6570\u636e\u7684\u9ad8\u6548\u5b58\u50a8\u548c\u8bbf\u95ee\uff08\u78c1\u76d8\u5185\u5b58\u6620\u5c04\u6280\u672f\uff09\u3002\n\u652f\u6301\u57fa\u672c\u7684CRUD\u3001\u6570\u636e\u805a\u5408\u3001\u6587\u672c\u641c\u7d22\u548c\u5730\u7406\u7a7a\u95f4\u67e5\u8be2\u529f\u80fd\u3002\n</code></pre> <ul> <li>\u7f51\u7ad9\u6570\u636e\uff1aMongo\u975e\u5e38\u9002\u5408\u5b9e\u65f6\u7684\u63d2\u5165\uff0c\u66f4\u65b0\u4e0e\u67e5\u8be2\uff0c\u5e76\u5177\u5907\u7f51\u7ad9\u5b9e\u65f6\u6570\u636e\u5b58\u50a8\u6240\u9700\u7684\u590d\u5236\u53ca\u9ad8\u5ea6\u4f38\u7f29\u6027\u3002</li> <li>\u9ad8\u4f38\u7f29\u6027\u7684\u573a\u666f\uff1aMongo\u975e\u5e38\u9002\u5408\u7531\u6570\u5341\u6216\u6570\u767e\u53f0\u670d\u52a1\u5668\u7ec4\u6210\u7684\u6570\u636e\u5e93\u3002</li> <li>\u5927\u5c3a\u5bf8\uff0c\u4f4e\u4ef7\u503c\u7684\u6570\u636e\uff1a\u4f7f\u7528\u4f20\u7edf\u7684\u5173\u7cfb\u578b\u6570\u636e\u5e93\u5b58\u50a8\u4e00\u4e9b\u6570\u636e\u65f6\u53ef\u80fd\u4f1a\u6bd4\u8f83\u6602\u8d35\uff0c\u5728\u6b64\u4e4b\u524d\uff0c\u5f88\u591a\u65f6\u5019\u7a0b\u5e8f\u5458\u5f80\u5f80\u4f1a\u9009\u62e9\u4f20\u7edf\u7684\u6587\u4ef6\u8fdb\u884c\u5b58\u50a8\u3002</li> <li>\u7f13\u5b58\uff1a\u7531\u4e8e\u6027\u80fd\u5f88\u9ad8\uff0cMongo\u4e5f\u9002\u5408\u4f5c\u4e3a\u4fe1\u606f\u57fa\u7840\u8bbe\u65bd\u7684\u7f13\u5b58\u5c42\u3002\u5728\u7cfb\u7edf\u91cd\u542f\u4e4b\u540e\uff0c\u7531Mongo\u642d\u5efa\u7684\u6301\u4e45\u5316\u7f13\u5b58\u5c42\u53ef\u4ee5\u907f\u514d\u4e0b\u5c42\u7684\u6570\u636e\u6e90\u8fc7\u8f7d\u3002</li> </ul>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#13-mdb","title":"1.3 Mdb \u7684\u5b89\u88c5","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#docker","title":"docker \u7248\u672c","text":"<ol> <li> <p>\u76f4\u63a5\u62c9\u53d6\u955c\u50cf <pre><code>docker pull mongo:7.0.0\n</code></pre></p> </li> <li> <p>\u521b\u5efa\u5bbf\u4e3b\u673a\u4e0a\u7684\u6302\u8f7d\u76ee\u5f55 <pre><code>rm -rf /opt/mongo\nmkdir -p /opt/mongo/data/db\n</code></pre></p> </li> <li> <p>\u521b\u5efa\u5e76\u542f\u52a8\u5bb9\u5668 <pre><code>docker run -d --restart=always -p 27017:27017 --name mongo -v /opt/mongo/data/db:/data/db mongo:7.0.0\n</code></pre></p> </li> <li> <p>\u8fde\u63a5mongosh <pre><code>docker exec -it mongo mongosh\n</code></pre></p> </li> <li> <p>\u65ad\u5f00\u8fde\u63a5\uff08\u5728linux\u4e2d\uff09 <pre><code>exit \n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#windows","title":"windows \u7248\u672c","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2-mongodb","title":"2. MongoDB \u7528\u6cd5","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#21_3","title":"2.1 \u57fa\u672c\u547d\u4ee4","text":"<pre><code>show dbs\ndb.version() #\u5f53\u524ddb\u7248\u672c\ndb.getMongo() #\u67e5\u770b\u5f53\u524ddb\u7684\u8fde\u63a5\u673a\u5668\u5730\u5740\ndb.help() #\u5e2e\u52a9\nquit() #\u9000\u51fa\u547d\u4ee4\u884c\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#22_3","title":"2.2 \u6570\u636e\u5e93\u64cd\u4f5c","text":"<ol> <li>\u521b\u5efa\u6570\u636e\u5e93</li> </ol> <pre><code>use userdb // \u5982\u679c\u6570\u636e\u5e93\u4e0d\u5b58\u5728\uff0c\u5219\u521b\u5efa\u6570\u636e\u5e93\uff0c\u5426\u5219\u5207\u6362\u5230\u6307\u5b9a\u6570\u636e\u5e93\u3002\n</code></pre> <ol> <li> <p>\u67e5\u770b\u5f53\u524d\u6570\u636e\u5e93 <pre><code>db.getName()\n</code></pre></p> </li> <li> <p>\u663e\u793a\u5f53\u524d\u6570\u636e\u5e93\u72b6\u6001 <pre><code>db.stats()\n</code></pre></p> </li> <li> <p>\u5220\u9664\u5f53\u524d\u6570\u636e\u5e93 <pre><code>db.dropDatabase()\n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#23_3","title":"2.3 \u96c6\u5408\u7684\u64cd\u4f5c","text":"<ol> <li> <p>\u521b\u5efa\u96c6\u5408 <pre><code>db.createCollection(\"\u96c6\u5408\u540d\")\n</code></pre></p> </li> <li> <p>\u5220\u9664\u96c6\u5408 <pre><code>db.\u96c6\u5408\u540d.drop()\n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#24_1","title":"2.4 \u6587\u6863\u7684\u64cd\u4f5c","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1_20","title":"1. \u6587\u6863\u7684\u589e\u5220\u6539\u67e5","text":"<p>ObjectId \u662f\u4e00\u4e2a12\u5b57\u8282 BSON \u7c7b\u578b\u6570\u636e\uff0c\u6709\u4ee5\u4e0b\u683c\u5f0f\uff1a</p> <ul> <li>\u524d4\u4e2a\u5b57\u8282\u8868\u793a\u65f6\u95f4\u6233</li> <li>\u63a5\u4e0b\u6765\u76843\u4e2a\u5b57\u8282\u662f\u673a\u5668\u6807\u8bc6\u7801</li> <li>\u7d27\u63a5\u76842\u4e2a\u5b57\u8282\u7531\u8fdb\u7a0bid\u7ec4\u6210\uff08PID\uff09</li> <li>\u6700\u540e3\u4e2a\u5b57\u8282\u662f\u968f\u673a\u6570\u3002</li> </ul> <p>MongoDB\u4e2d\u5b58\u50a8\u7684\u6587\u6863\u5fc5\u987b\u6709\u4e00\u4e2a\"_id\"\u952e\u3002\u8fd9\u4e2a\u952e\u7684\u503c\u53ef\u4ee5\u662f\u4efb\u4f55\u7c7b\u578b\u7684\uff0c\u9ed8\u8ba4\u662f\u4e2aObjectId\u5bf9\u8c61\u3002 \u5728\u4e00\u4e2a\u96c6\u5408\u91cc\u9762\uff0c\u6bcf\u4e2a\u6587\u6863\u90fd\u6709\u552f\u4e00\u7684\"_id\"\u503c\uff0c\u6765\u786e\u4fdd\u96c6\u5408\u91cc\u9762\u6bcf\u4e2a\u6587\u6863\u90fd\u80fd\u88ab\u552f\u4e00\u6807\u8bc6\u3002</p> <p>\u6ce8\u610f\uff1a  - MongoDB\u533a\u5206\u7c7b\u578b\u548c\u5927\u5c0f\u5199\u3002  - MongoDB\u7684\u6587\u6863\u4e0d\u80fd\u6709\u91cd\u590d\u7684\u952e\u3002  - \u5728 7.0.0\u7248\u672c\u4e2d\uff0c\u6587\u6863\u7684\u589e\u5220\u6539\uff1ainsert,remove,update \u90fd\u88ab\u66ff\u6362\u4e3a\u4e86 xxxOne,xxxMany ... </p> <ol> <li> <p>\u63d2\u5165\u6587\u6863 <pre><code>db.\u96c6\u5408\u540d\u79f0.insertOne()\ndb.\u96c6\u5408\u540d\u79f0.insertMany()\n</code></pre></p> </li> <li> <p>\u67e5\u627e\u6587\u6863 <pre><code>db.user.find({_id:\"123\"}) // \u7b49\u503c\u67e5\u8be2\ndb.user.find() // \u67e5\u6240\u6709\ndb.user.find(field:{$lt:50})\n</code></pre> ![[Springboot/imgs/image-4 1.png]]</p> </li> <li> <p>\u4fee\u6539\u6587\u6863     <code>\u53ea\u66f4\u65b0\u5339\u914d\u5230\u7684\u7b2c\u4e00\u6761\u8bb0\u5f55 $set\u4fee\u6539\u5668\u4e0d\u4f1a\u5c06\u5df2\u6709\u5b57\u6bb5\u5220\u9664</code> <pre><code>db.user.update({name:\"liutianba\"}, {$set:{age:\"999\"}}) // \u53ea\u66f4\u65b0\u5339\u914d\u5230\u7684\u7b2c\u4e00\u6761\ndb.user.update({age:21}, {$set:{age:99}}, {multi: true})\n</code></pre></p> </li> <li> <p>\u5220\u9664\u6587\u6863 <pre><code>db.user.remove() // \u5220\u9664\u6240\u6709\ndb.user.remove({field:xxx}) // \u6761\u4ef6\u5220\u9664\n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2_18","title":"2. \u6587\u6863\u7684\u7d22\u5f15\u64cd\u4f5c","text":"<p>\u6d77\u91cf\u6570\u636e\u5b9e\u73b0\u6761\u4ef6\u9ad8\u6548\u7387\u67e5\u8be2\uff0c\u5168\u96c6\u5408\u626b\u63cf\u6027\u80fd\u76f8\u5bf9\u8f83\u4f4e\uff0c\u9488\u5bf9\u4e8e\u67e5\u8be2\u5b57\u6bb5\u521b\u5efa\u7d22\u5f15\uff08\u5355\u5217\u7d22\u5f15\uff0c\u590d\u5408\u7d22\u5f15\uff09</p> <p>\u5728md\u4e2d\u7684\u7b49\u7ea7\uff1a - <code>IDHACK</code>\uff1a\u76f4\u63a5\u901a\u8fc7\u00a0<code>_id</code>\u00a0\u4e3b\u952e\u67e5\u8be2\u3002 - <code>IXSCAN</code>\uff1a\u4f7f\u7528\u7d22\u5f15\u67e5\u627e\u5339\u914d\u7684\u7d22\u5f15\u6761\u76ee\u3002 - <code>FETCH</code>\uff1a\u4ece\u96c6\u5408\u4e2d\u53d6\u51fa\u5b8c\u6574\u6587\u6863\u3002 - <code>COLLSCAN</code>\uff1a\u6ca1\u6709\u53ef\u7528\u7d22\u5f15\uff0c\u904d\u5386\u6574\u4e2a\u96c6\u5408\u7684\u6bcf\u4e00\u6761\u6587\u6863\u3002 - <code>PROJECTION_SIMPLE</code>\u00a0/\u00a0<code>PROJECTION_COVERED</code>\uff1a\u53ea\u8fd4\u56de\u7d22\u5f15\u4e2d\u5df2\u5305\u542b\u7684\u5b57\u6bb5\uff08\u8986\u76d6\u67e5\u8be2\uff09\u3002 - <code>SORT</code>\u00a0/\u00a0<code>LIMIT</code>\u00a0/\u00a0<code>SKIP</code>\uff1a\u8fd9\u4e9b\u662f\u9644\u52a0\u64cd\u4f5c\u9636\u6bb5\uff0c\u901a\u5e38\u51fa\u73b0\u5728\u4e3b stage \u4e4b\u540e\u3002</p> <ol> <li>\u67e5\u770b\u6267\u884c\u8ba1\u5212 <pre><code>db.\u96c6\u5408\u540d\u79f0.find({\u6761\u4ef6}).explain()\n</code></pre></li> </ol> <p>![[Springboot/imgs/image-5.png]]</p> <ol> <li>\u5bf9\u9891\u7e41\u67e5\u8be2\u7684\u5b57\u6bb5\u521b\u5efa\u7d22\u5f15 <pre><code>db.user.createIndex({\u5b57\u6bb5:1})  #1 \u4e3a\u6307\u5b9a\u6309\u5347\u5e8f\u521b\u5efa\u7d22\u5f15\uff0c\u5982\u679c\u4f60\u60f3\u6309\u964d\u5e8f\u6765\u521b\u5efa\u7d22\u5f15\u6307\u5b9a\u4e3a -1\n\neg\uff1adb.user.createIndex({name:1})\n</code></pre></li> </ol> <p>![[Springboot/imgs/image-6.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3-spring-data-mongodb","title":"3. Spring Data MongoDB","text":"<p>spring-data-mongodb\u63d0\u4f9b\u4e86<code>MongoTemplate</code>\u4e0e<code>MongoRepository</code>\u4e24\u79cd\u65b9\u5f0f\u8bbf\u95eemongodb\uff0cMongoRepository\u64cd\u4f5c\u7b80\u5355\uff0cMongoTemplate\u64cd\u4f5c\u7075\u6d3b\uff0c\u6211\u4eec\u5728\u9879\u76ee\u4e2d\u53ef\u4ee5\u7075\u6d3b\u4f7f\u7528\u8fd9\u4e24\u79cd\u65b9\u5f0f\u64cd\u4f5cmongodb\u3002</p> <p>\u7279\u6027\uff1a - MongoTemplate: Helper class that increases productivity for common tasks.MongoTemplate\uff1a\u8f85\u52a9\u7c7b\uff0c\u53ef\u63d0\u9ad8\u5e38\u89c1\u4efb\u52a1\u7684\u751f\u4ea7\u6548\u7387\u3002 - Object Mapping: Feature rich, annotation driven object mapper.\u5bf9\u8c61\u6620\u5c04\uff1a\u529f\u80fd\u4e30\u5bcc\u3001\u57fa\u4e8e\u6ce8\u89e3\u7684\u5bf9\u8c61\u6620\u5c04\u5668\u3002 - Lifecycle Events: Before and after save, update, delete hooks and events.\u751f\u547d\u5468\u671f\u4e8b\u4ef6\uff1a\u4fdd\u5b58\u3001\u66f4\u65b0\u3001\u5220\u9664\u524d\u540e\u7684\u94a9\u5b50\u548c\u4e8b\u4ef6\u3002 - Data Repositories: Repository interfaces including support for custom queries &amp; aggregations.\u6570\u636e\u5b58\u50a8\u5e93\uff1a\u5305\u62ec\u5bf9\u81ea\u5b9a\u4e49\u67e5\u8be2\u548c\u805a\u5408\u652f\u6301\u7684\u5b58\u50a8\u5e93\u63a5\u53e3\u3002 - Multi Document Transactions: Managed transaction support for multi document modifications.\u591a\u6587\u6863\u4e8b\u52a1\uff1a\u652f\u6301\u5bf9\u591a\u6587\u6863\u4fee\u6539\u7684\u6258\u7ba1\u4e8b\u52a1\u3002 - Encryption: Automatic and explicit client side field level encryption.\u52a0\u5bc6\uff1a\u81ea\u52a8\u4e14\u660e\u786e\u7684\u5ba2\u6237\u7aef\u5b57\u6bb5\u7ea7\u52a0\u5bc6\u3002 - GridFS: Large file storage.GridFS\uff1a\u5927\u6587\u4ef6\u5b58\u50a8\u3002 - Querydsl: Type-safe query integration.Querydsl\uff1a\u7c7b\u578b\u5b89\u5168\u7684\u67e5\u8be2\u96c6\u6210\u3002 - Kotlin: Extensions to enrich developer experience.Kotlin\uff1a\u6269\u5c55\u529f\u80fd\u4ee5\u4e30\u5bcc\u5f00\u53d1\u8005\u4f53\u9a8c\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#31_4","title":"3.1 \u7248\u672c\u9700\u6c42","text":"<p>![[java/java\u516b\u80a1/imgs/image-7.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#32-mongodb","title":"3.2  \u8fde\u63a5\u5230 mongoDb","text":"<ol> <li>\u76f4\u63a5\u6ce8\u5165\u4e00\u4e2a\u914d\u7f6e\u7c7b <pre><code>@Configuration\npublic class AppConfig {\n\n  /*\n   * Use the standard Mongo driver API to create a com.mongodb.client.MongoClient instance.\n   */\n   public @Bean com.mongodb.client.MongoClient mongoClient() {\n       return com.mongodb.client.MongoClients.create(\"mongodb://localhost:27017\");\n   }\n}\n</code></pre></li> </ol> <p>\u4e0e\u76f4\u63a5\u5b9e\u4f8b\u5316\u00a0\u00a0<code>MongoClient</code>\u00a0\u00a0\u5b9e\u4f8b\u76f8\u6bd4\uff0c\u00a0<code>FactoryBean</code>\u00a0\u00a0\u8fd8\u5177\u6709\u989d\u5916\u7684\u4f18\u52bf\uff0c\u5373\u4e3a\u5bb9\u5668\u63d0\u4f9b\u4e00\u4e2a\u00a0\u00a0<code>ExceptionTranslator</code>\u00a0\u00a0\u5b9e\u73b0\uff0c\u8be5\u5b9e\u73b0\u5c06 MongoDB \u5f02\u5e38\u8f6c\u6362\u4e3a Spring \u53ef\u79fb\u690d\u7684\u00a0\u00a0<code>DataAccessException</code>\u00a0\u00a0\u5c42\u6b21\u7ed3\u6784\u4e2d\u7684\u5f02\u5e38\uff0c\u8be5\u5c42\u6b21\u7ed3\u6784\u9002\u7528\u4e8e\u4f7f\u7528\u00a0\u00a0<code>@Repository</code>\u00a0\u00a0\u6ce8\u89e3\u7684\u6570\u636e\u8bbf\u95ee\u7c7b\u3002 \u6b64\u5c42\u6b21\u7ed3\u6784\u4ee5\u53ca\u00a0\u00a0<code>@Repository</code>\u00a0\u00a0\u7684\u4f7f\u7528\u5728 Spring \u7684 DAO \u652f\u6301\u7279\u6027\u4e2d\u6709\u8be6\u7ec6\u63cf\u8ff0\u3002</p> <pre><code>@Configuration\npublic class AppConfig {\n\n    /*\n     * Factory bean that creates the com.mongodb.client.MongoClient instance\n     */\n     public @Bean MongoClientFactoryBean mongo() {\n          MongoClientFactoryBean mongo = new MongoClientFactoryBean();\n          mongo.setHost(\"localhost\");\n          return mongo;\n     }\n}\n</code></pre> <p>\u82e5\u8981\u5728\u5176\u4ed6\u00a0\u00a0<code>@Configuration</code>\u00a0\u00a0\u7c7b\u6216\u60a8\u81ea\u5df1\u7684\u7c7b\u4e2d\u8bbf\u95ee\u7531\u00a0\u00a0<code>FactoryBean</code>\u00a0\u00a0\u521b\u5efa\u7684\u00a0\u00a0<code>MongoClient</code>\u00a0\u00a0\u5bf9\u8c61\uff0c\u8bf7\u4f7f\u7528\u00a0\u00a0<code>private @Autowired MongoClient mongoClient;</code>\u00a0\u00a0\u5b57\u6bb5\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#33-mongotemplate","title":"3.3 mongoTemplate \u7684\u914d\u7f6e","text":"<ol> <li> <p>\u6839\u636e\u6ce8\u518c\u597d\u7684 mongoClient \u53bb\u6ce8\u518c mongoTemplate <pre><code>@Configuration\nclass ApplicationConfiguration {\n\n  @Bean\n  MongoClient mongoClient() {\n      return MongoClients.create(\"mongodb://localhost:27017\");\n  }\n\n  @Bean\n  MongoOperations mongoTemplate(MongoClient mongoClient) {\n      return new MongoTemplate(mongoClient, \"geospatial\");\n  }\n}\n</code></pre></p> </li> <li> <p>\u6216\u8005\u76f4\u63a5\u5199\u914d\u7f6e\u6587\u4ef6\u5373\u53ef <pre><code>spring:\n  data:\n    mongodb:\n      database: user\n      host: 192.168.200.6\n      port: 27017\n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#34","title":"3.4 \u4f7f\u7528\u65b9\u6cd5","text":"<ol> <li> <p>\u5bfc\u5165\u4f9d\u8d56 <pre><code>&lt;dependency&gt;  \n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;  \n    &lt;artifactId&gt;spring-boot-starter-data-mongodb&lt;/artifactId&gt;  \n&lt;/dependency&gt;\n</code></pre></p> </li> <li> <p>\u4e4b\u540e\u5c31\u53ef\u4ee5\u6309\u7167 3.5 | 3.6 \u8fd9\u4e24\u79cd\u65b9\u6cd5\u53bb\u4f7f\u7528\u4e86</p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#35","title":"3.5 \u6301\u4e45\u5c42\u63a5\u53e3\u4ee3\u7801\u6f14\u793a","text":"<ol> <li> <p>\u521b\u5efa\u4e00\u4e2a\u5b9e\u4f53\u7c7b\u6765\u548c\u6570\u636e\u5e93\u7684\u96c6\u5408\u505a\u6620\u5c04 <pre><code>@Document(collection = \"user\")  \n@Data  \npublic class UserDoc {  \n    @Id  \n    private Long id;  \n    private String name;  \n    private Integer age;  \n}\n</code></pre></p> </li> <li> <p>\u53bb\u5199\u6301\u4e45\u5c42\u63a5\u53e3\uff0c\u8981\u7ee7\u627f spring \u63d0\u4f9b\u7684\u63a5\u53e3 <pre><code>public interface UserRepository extends MongoRepository&lt;UserDoc,Long&gt; {  \n}\n</code></pre></p> </li> <li> <p>\u4e4b\u540e\u5c31\u53ef\u4ee5\u6ce8\u5165\u8be5\u63a5\u53e3\u53bb\u4f7f\u7528\u4e86 <pre><code>@Test  \npublic void testFind(){  \n    // \u901a\u8fc7id\u67e5\u8be2  \n    System.out.println(\"\u901a\u8fc7id\u67e5\u8be2\");  \n    Optional&lt;UserDoc&gt; user = userRepository.findById(3L);  \n    System.out.println(user.get());  \n\n    // \u6761\u4ef6\u67e5\u8be2  \n    System.out.println(\"\u6761\u4ef6\u67e5\u8be2\");  \n    UserDoc example = new UserDoc();  \n    example.setName(\"ltb\");  \n    example.setAge(19);  \n    Optional&lt;UserDoc&gt; one = userRepository.findOne(Example.of(example));  \n    System.out.println(one.get());  \n\n    // \u5206\u9875\u67e5\u8be2  \n    System.out.println(\"\u5206\u9875\u67e5\u8be2\");  \n    Page&lt;UserDoc&gt; all = userRepository.findAll(PageRequest.of(0, 2));  \n    for (UserDoc userDoc : all) {  \n        System.out.println(userDoc);  \n    }  \n\n    // \u6392\u5e8f  \n    System.out.println(\"\u6392\u5e8f\");  \n    List&lt;UserDoc&gt; age = userRepository.findAll(Sort.by(Sort.Direction.DESC, \"age\"));  \n    for (UserDoc userDoc : age) {  \n        System.out.println(userDoc);  \n    }  \n}\n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#36","title":"3.6 \u6a21\u677f\u7c7b\u4ee3\u7801\u6f14\u793a","text":"<ol> <li>\u8981\u4e48\u53bb\u914d\u7f6e\u6587\u4ef6\u4e2d\u5199\uff1aspring.data.mongodb \u8282\u70b9\u4e0b\u7684\u914d\u7f6e\uff0c\u8981\u4e48\u5c31\u53bb\u6309\u7167\u4e0a\u9762\u7684\u624b\u52a8\u6ce8\u518c\u7684\u914d\u7f6e\u8bf4\u660e\u6765\u914d\u7f6e</li> <li>\u914d\u7f6e\u5b8c\u4ee5\u540e\uff0c\u5c31\u53ef\u4ee5\u6ce8\u5165 mongoTemplate, \u7136\u540e\u4f7f\u7528\u4e86</li> </ol> <p>\u6ce8\uff1amongoTemplate \u53ef\u4ee5\u52a8\u6001\u7684\u6307\u5b9a\u8981\u64cd\u4f5c\u7684\u96c6\u5408\u540d\u79f0\uff0c\u6240\u4ee5\u6bd4\u6301\u4e45\u5c42\u63a5\u53e3\u7075\u6d3b\u7684\u591a\uff0c\u56e0\u4e3a\u6301\u4e45\u5c42\u63a5\u53e3\u53ea\u80fd\u64cd\u4f5c\u5176\u5b9e\u4f53\u7c7b\u6620\u5c04\u7684\u96c6\u5408\u3002 mongoTemplate \u9ed8\u8ba4\u64cd\u4f5c\u7684\u96c6\u5408\uff1a\u5982\u679c\u64cd\u4f5c\u662f\u65b0\u589e\uff0c\u5220\u9664\uff0c\u4fee\u6539\uff0c\u90a3\u4e48\u9ed8\u8ba4\u7684\u96c6\u5408\u5c31\u662f\u6539\u5b9e\u4f53\u7c7b\u5bf9\u5e94\u7684\u96c6\u5408\uff0c\u5982\u679c\u8be5\u5b9e\u4f53\u7c7b\u6ca1\u6709\u7528 @Document \u6307\u5b9a\u96c6\u5408\uff0c\u90a3\u4e48\u8fd9\u4e2a\u96c6\u5408\u7684\u540d\u79f0\u5c31\u662f\u6539\u5b9e\u4f53\u7c7b\u7684\u540d\u79f0\u3002 \u5982\u679c\u662f\u67e5\u8be2\uff0c\u5219\u4e5f\u4f1a\u6839\u636e\u4f20\u5165\u7684\u67e5\u8be2\u7684\u7c7b\u5bf9\u8c61\u53bb\u627e\u5f53\u524d\u96c6\u5408\u540d\u79f0\u3002 <pre><code>mongoTemplate.find(new Query().addCriteria(Criteria.where(\"id\").is(1L)), PersonDoc.class)\n</code></pre></p> <pre><code>@Test  \npublic void testTemplate(){  \n    // \u901a\u8fc7id\u67e5\u8be2  \n    Query query = new Query();  \n    UserDoc id = mongoTemplate.findOne(query.addCriteria(Criteria.where(\"id\").is(3L)), UserDoc.class, \"user\");  \n    System.out.println(id);  \n\n    // \u65b0\u589e  \n    UserDoc userDoc = new UserDoc();  \n    userDoc.setId(5L);  \n    userDoc.setName(\"\u5f20\u4e09\");  \n    userDoc.setAge(20);  \n    mongoTemplate.insert(userDoc);  \n}  \n\n@Test  \npublic void testTemplateUpdate(){  \n    PersonDoc personDoc = new PersonDoc();  \n    personDoc.setId(1L);  \n    personDoc.setName(\"\u5f20\u4e09\");  \n    personDoc.setAge(20);  \n\n    mongoTemplate.insert(personDoc);  \n}\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#13-zipkin","title":"13 zipkin","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1_21","title":"1. \u4e3a\u4ec0\u4e48\u8981\u6709\u94fe\u8def\u8ffd\u8e2a","text":"<pre><code>\u4e00\u4e2a\u770b\u8d77\u6765\u5f88\u7b80\u5355\u7684\u5e94\u7528\uff0c\u80cc\u540e\u53ef\u80fd\u9700\u8981\u6570\u5341\u6216\u6570\u767e\u4e2a\u670d\u52a1\u6765\u652f\u6491\uff0c\u4e00\u4e2a\u8bf7\u6c42\u5c31\u8981\u591a\u6b21\u670d\u52a1\u8c03\u7528\u3002\u5f53\u8bf7\u6c42\u53d8\u6162\u3001\u6216\u8005\u4e0d\u80fd\u4f7f\u7528\u65f6\uff0c\u6211\u4eec\u662f\u4e0d\u77e5\u9053\u662f\u54ea\u4e2a\u540e\u53f0\u670d\u52a1\u5f15\u8d77\u7684\u3002\u8fd9\u65f6\uff0c\u6211\u4eec\u4f7f\u7528 Zipkin \u5c31\u80fd\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\u7531\u4e8e\u4e1a\u52a1\u8bbf\u95ee\u91cf\u7684\u589e\u5927\uff0c\u4e1a\u52a1\u590d\u6742\u5ea6\u589e\u52a0\uff0c\u4ee5\u53ca\u5fae\u670d\u52a1\u67b6\u6784\u548c\u5bb9\u5668\u6280\u672f\u7684\u5174\u8d77\uff0c\u8981\u5bf9\u7cfb\u7edf\u8fdb\u884c\u5404\u79cd\u62c6\u5206\u3002\u5fae\u670d\u52a1\u7cfb\u7edf\u62c6\u5206\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 Zipkin \u94fe\u8def\uff0c\u6765\u5feb\u901f\u5b9a\u4f4d\u8ffd\u8e2a\u6709\u6545\u969c\u7684\u670d\u52a1\u70b9\u3002\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2-zipkin","title":"2. zipkin \u4e3b\u8981\u529f\u80fd","text":"<p>Zipkin \u5176\u4e3b\u8981\u529f\u80fd\u662f\u805a\u96c6\u6765\u81ea\u5404\u4e2a\u5f02\u6784\u7cfb\u7edf\u7684\u5b9e\u65f6\u76d1\u63a7\u6570\u636e\uff0c\u5728\u5fae\u670d\u52a1\u67b6\u6784\u4e0b\uff0c\u5341\u5206\u65b9\u4fbf\u5730\u7528\u4e8e\u670d\u52a1\u54cd\u5e94\u5ef6\u8fdf\u7b49\u95ee\u9898\u7684\u5b9a\u4f4d\u3002</p> <p>Zipkin \u6bcf\u4e00\u4e2a\u8c03\u7528\u94fe\u8def\u901a\u8fc7\u4e00\u4e2a trace id \u6765\u4e32\u8054\u8d77\u6765\uff0c\u53ea\u8981\u4f60\u6709\u4e00\u4e2a trace id \uff0c\u5c31\u80fd\u591f\u76f4\u63a5\u5b9a\u4f4d\u5230\u8fd9\u6b21\u8c03\u7528\u94fe\u8def\uff0c\u5e76\u4e14\u53ef\u4ee5\u6839\u636e\u670d\u52a1\u540d\u3001\u6807\u7b7e\u3001\u54cd\u5e94\u65f6\u95f4\u7b49\u8fdb\u884c\u67e5\u8be2\uff0c\u8fc7\u6ee4\u90a3\u4e9b\u8017\u65f6\u6bd4\u8f83\u957f\u7684\u94fe\u8def\u8282\u70b9\u3002</p> <p>Zipkin \u5206\u5e03\u5f0f\u8ddf\u8e2a\u7cfb\u7edf\u5c31\u80fd\u975e\u5e38\u597d\u5730\u89e3\u51b3\u8be5\u95ee\u9898\uff0c\u4e3b\u8981\u89e3\u51b3\u4ee5\u4e0b3\u70b9\u95ee\u9898\uff1a - 1. \u52a8\u6001\u5c55\u793a\u670d\u52a1\u7684\u94fe\u8def\uff1b   - 2. \u5206\u6790\u670d\u52a1\u94fe\u8def\u7684\u74f6\u9888\u5e76\u5bf9\u5176\u8fdb\u884c\u8c03\u4f18\uff1b - 3. \u5feb\u901f\u8fdb\u884c\u670d\u52a1\u94fe\u8def\u7684\u6545\u969c\u53d1\u73b0;</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3_10","title":"3. \u4f7f\u7528\u65b9\u5f0f","text":"<ol> <li> <p>\u5bfc\u5165\u4f9d\u8d56 <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;io.micrometer&lt;/groupId&gt;\n    &lt;artifactId&gt;micrometer-tracing-bridge-brave&lt;/artifactId&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;io.zipkin.reporter2&lt;/groupId&gt;\n    &lt;artifactId&gt;zipkin-reporter-brave&lt;/artifactId&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;io.micrometer&lt;/groupId&gt;\n    &lt;artifactId&gt;micrometer-observation&lt;/artifactId&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-zipkin&lt;/artifactId&gt;\n    &lt;version&gt;2.2.8.RELEASE&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;io.github.openfeign&lt;/groupId&gt;\n    &lt;artifactId&gt;feign-micrometer&lt;/artifactId&gt;\n    &lt;version&gt;12.5&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre></p> </li> <li> <p>\u5199\u914d\u7f6e</p> </li> </ol> <pre><code>management:\n  zipkin:\n    tracing:\n      endpoint: http://host:9411/api/v2/spans\n  tracing:\n    sampling:\n      probability: 1.0 # \u8bb0\u5f55\u901f\u7387100%\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#4-openfeign-zipkin","title":"4. \u89e3\u51b3\u5f02\u6b65 openfeign \u65e0\u6cd5\u88ab zipkin \u5b8c\u6574\u8ffd\u8e2a\u7684\u95ee\u9898","text":"<p>\u95ee\u9898\u539f\u56e0\uff1a\u7531\u4e8e\u6574\u5408\u4e13\u8f91\u8be6\u60c5\u63a5\u53e3\u662f\u901a\u8fc74\u4e2a\u5b50\u7ebf\u7a0b\u6765\u5b8c\u6210\u8fdc\u7a0b\u63a5\u53e3\u7684\u8c03\u7528\u7684\uff0c\u9ed8\u8ba4\u662f\u65e0\u6cd5\u5c06\u4e3b\u7ebf\u7a0b\u7684\u94fe\u8defid\u4f20\u5230\u5b50\u7ebf\u7a0b\uff0c\u6240\u4ee5\u5c31\u5c06\u8fd9\u4e9b\u8c03\u7528\u5206\u5f00\u8ffd\u8e2a\u4e86\u3002</p> <p>\u89e3\u51b3\u65b9\u6848\uff1a\u7528 spring \u7684\u7ebf\u7a0b\u6c60\uff0c\u7136\u540e\u4ece\u7236\u7ebf\u7a0b\u62ff\u5230\u94fe\u8defid</p> <pre><code>//\u8bbe\u7f6e\u89e3\u51b3zipkin\u94fe\u8def\u8ffd\u8e2a\u4e0d\u5b8c\u6574\u88c5\u9970\u5668\u5bf9\u8c61\ntaskExecutor.setTaskDecorator(new ZipkinTaskDecorator(zipkinHelper));\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#14-redisson","title":"14 Redisson","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1_22","title":"1. \u4ecb\u7ecd","text":"<p>Redisson\u662f\u4e00\u4e2a\u5728Redis\u7684\u57fa\u7840\u4e0a\u5b9e\u73b0\u7684Java\u9a7b\u5185\u5b58\u6570\u636e\u7f51\u683c\uff08In-Memory Data Grid\uff09\u3002\u5b83\u4e0d\u4ec5\u63d0\u4f9b\u4e86\u4e00\u7cfb\u5217\u7684\u5206\u5e03\u5f0f\u7684Java\u5e38\u7528\u5bf9\u8c61\uff0c\u8fd8\u63d0\u4f9b\u4e86\u8bb8\u591a\u5206\u5e03\u5f0f\u670d\u52a1\u3002\u5176\u4e2d\u5305\u62ec(BitSet, Set, Multimap, SortedSet, Map, List, Queue, BlockingQueue, Deque, BlockingDeque, Semaphore, Lock, AtomicLong, CountDownLatch, Publish / Subscribe, Bloom filter, Remote service, Spring cache, Executor service, Live Object service, Scheduler service) Redisson\u63d0\u4f9b\u4e86\u4f7f\u7528Redis\u7684\u6700\u7b80\u5355\u548c\u6700\u4fbf\u6377\u7684\u65b9\u6cd5\u3002Redisson\u7684\u5b97\u65e8\u662f\u4fc3\u8fdb\u4f7f\u7528\u8005\u5bf9Redis\u7684\u5173\u6ce8\u5206\u79bb\uff08Separation of Concern\uff09\uff0c\u4ece\u800c\u8ba9\u4f7f\u7528\u8005\u80fd\u591f\u5c06\u7cbe\u529b\u66f4\u96c6\u4e2d\u5730\u653e\u5728\u5904\u7406\u4e1a\u52a1\u903b\u8f91\u4e0a\u3002</p> <p>set nx \u5b9e\u73b0\u7684\u5206\u5e03\u5f0f\u9501\u5b58\u5728\u4ee5\u4e0b\u95ee\u9898\uff1a 1. \u4ee3\u7801\u5b9e\u73b0\u4e0d\u65b9\u4fbf</p> <ol> <li> <p>\u4e0d\u53ef\u91cd\u5165\u6027\uff08Reentrancy Issue\uff09\uff1a\u540c\u4e00\u4e2a\u7ebf\u7a0b\u5728\u5df2\u7ecf\u6301\u6709\u9501\u7684\u60c5\u51b5\u4e0b\uff0c\u518d\u6b21\u5c1d\u8bd5\u83b7\u53d6\u8be5\u9501\u4f1a\u5931\u8d25\uff08\u5bfc\u81f4\u6b7b\u9501\u6216\u903b\u8f91\u963b\u585e\uff09\u3002</p> </li> <li> <p>\u9501\u8d85\u65f6\u91ca\u653e\u5bfc\u81f4\u5e76\u53d1\u5b89\u5168\u5931\u6548\uff1a\u7ebf\u7a0b A \u83b7\u53d6\u9501\u540e\u53d1\u751f GC \u505c\u987f\uff08STW\uff09\u6216\u8017\u65f6\u64cd\u4f5c\uff0c\u5bfc\u81f4\u9501\u5728 Redis \u7aef\u5230\u671f\u81ea\u52a8\u91ca\u653e\u3002</p> </li> <li> <p>\u7f3a\u4e4f\u7b49\u5f85\u963b\u585e\u673a\u5236\uff08\u81ea\u65cb\u538b\u529b\uff09\uff1a\u5982\u679c\u4e1a\u52a1\u9700\u8981\u7b49\u5f85\u9501\uff0c\u5f00\u53d1\u8005\u901a\u5e38\u8981\u5199 <code>while(true)</code> \u5faa\u73af\u4e0d\u65ad\u91cd\u8bd5\uff08\u81ea\u65cb\uff09\uff0c\u8fd9\u4f1a\u7ed9 Redis \u670d\u52a1\u5668\u5e26\u6765\u5de8\u5927\u7684 QPS \u538b\u529b\uff0c\u4e14\u6d6a\u8d39 CPU \u8d44\u6e90\u3002</p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1-redission","title":"1. redission \u7684\u4f7f\u7528","text":"<p>\u672c\u8d28\u8fd8\u662f\u6ce8\u518c\u4e00\u4e2a c \u7aef 1. \u5bfc\u5165\u4f9d\u8d56 <pre><code>&lt;dependency&gt;\n   &lt;groupId&gt;org.redisson&lt;/groupId&gt;\n   &lt;artifactId&gt;redisson-spring-boot-starter&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre></p> <ol> <li>\u914d\u7f6e\u4e00\u4e2a redission \u7684\u914d\u7f6e\u7c7b,\u5e76\u4e14\u624b\u52a8\u6ce8\u518c\u4e00\u4e2a RedissonClient <pre><code>/**\n * redisson\u914d\u7f6e\u4fe1\u606f\n */\n@Data\n@Configuration\n@ConfigurationProperties(\"spring.data.redis\")\npublic class RedissonConfig {\n\n    private String host;\n\n    private String password;\n\n    private String port;\n\n    private int timeout = 3000;\n    private static String ADDRESS_PREFIX = \"redis://\";\n\n    /**\n     * \u81ea\u52a8\u88c5\u914d\n     */\n    @Bean\n    RedissonClient redissonSingle() {\n        Config config = new Config();\n\n        if (StringUtils.isBlank(host)) {\n            throw new RuntimeException(\"host is  empty\");\n        }\n        SingleServerConfig serverConfig = config.useSingleServer()\n                .setAddress(ADDRESS_PREFIX + this.host + \":\" + port)\n                .setTimeout(this.timeout);\n        if (StringUtils.isNotBlank(this.password)) {\n            serverConfig.setPassword(this.password);\n        }\n        return Redisson.create(config);\n    }\n}\n</code></pre></li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2_19","title":"2. \u5206\u5e03\u5f0f\u9501\u7684\u4f7f\u7528\uff1a\u7f13\u5b58\u51fb\u7a7f","text":"\u89e3\u51b3\u70b9 Redisson \u7684\u5b9e\u73b0\u65b9\u5f0f \u4ee3\u7801\u5b9e\u73b0\u4e0d\u65b9\u4fbf \u5c01\u88c5\u4e86\u590d\u6742\u7684 Lua \u811a\u672c\uff0cAPI \u6781\u5176\u7b80\u6d01\uff08\u7c7b\u4f3c <code>ReentrantLock</code>\uff09\u3002 \u4e0d\u53ef\u91cd\u5165 Hash \u7ed3\u6784\u5b58\u50a8\uff1aKey \u662f\u9501\u540d\uff0cField \u662f <code>UUID:ThreadID</code>\uff0cValue \u662f\u91cd\u5165\u6b21\u6570\uff08Counter\uff09\u3002 \u9501\u8d85\u65f6\u91ca\u653e \u770b\u95e8\u72d7 (Watch Dog)\uff1a\u53ea\u8981\u4e1a\u52a1\u6ca1\u6267\u884c\u5b8c\uff08\u672a\u4e3b\u52a8\u8c03\u7528 unlock\uff09\uff0c\u540e\u53f0\u7ebf\u7a0b\u6bcf 10 \u79d2\u4f1a\u81ea\u52a8\u5ef6\u957f\u8fc7\u671f\u65f6\u95f4\u3002 \u963b\u585e\u91cd\u8bd5 \u53d1\u5e03/\u8ba2\u9605 (Pub/Sub)\uff1a\u83b7\u53d6\u9501\u5931\u8d25\u540e\uff0c\u7ebf\u7a0b\u4f1a\u8ba2\u9605\u8be5\u9501\u7684\u91ca\u653e\u6d88\u606f\uff0c\u800c\u4e0d\u662f\u4e00\u76f4\u6b7b\u5faa\u73af\u81ea\u65cb\uff0c\u8282\u7701 CPU\u3002 <pre><code>@Service\npublic class RankingService {\n\n    @Autowired\n    private RedissonClient redissonClient;\n\n    public void processDataWithLock(String categoryId) {\n        // 1. \u83b7\u53d6\u9501\u5bf9\u8c61\uff08\u6b64\u65f6\u5e76\u672a\u52a0\u9501\uff09\n        // \u8fd9\u91cc\u7684 key \u53ef\u4ee5\u6839\u636e\u4e1a\u52a1\u7ef4\u5ea6\u8fdb\u884c\u62c6\u5206\uff0c\u5b9e\u73b0\u7ec6\u7c92\u5ea6\u9501\n        String lockKey = \"lock:ranking:\" + categoryId;\n        RLock lock = redissonClient.getLock(lockKey);\n\n        try {\n            /**\n             * 2. \u5c1d\u8bd5\u52a0\u9501 (\u53c2\u6570\u8bf4\u660e):\n             * waitTime:  \u7b49\u5f85\u83b7\u53d6\u9501\u7684\u6700\u957f\u65f6\u95f4\uff08\u671f\u95f4\u4f1a\u4e0d\u65ad\u91cd\u8bd5\uff09\n             * leaseTime: \u9501\u81ea\u52a8\u91ca\u653e\u7684\u65f6\u95f4\uff08\u5efa\u8bae\u8bbe\u4e3a -1\uff0c\u542f\u7528\u770b\u95e8\u72d7\u673a\u5236\uff09\n             * unit:      \u65f6\u95f4\u5355\u4f4d\n             */\n            boolean isLocked = lock.tryLock(10, -1, TimeUnit.SECONDS);\n\n            if (isLocked) {\n                // 3. \u6267\u884c\u4e1a\u52a1\u903b\u8f91\n                System.out.println(\"\u6210\u529f\u83b7\u53d6\u9501\uff0c\u5f00\u59cb\u5904\u7406\u4e1a\u52a1...\");\n                Thread.sleep(5000); // \u6a21\u62df\u8017\u65f6\u64cd\u4f5c\n            } else {\n                System.out.println(\"\u83b7\u53d6\u9501\u5931\u8d25\uff0c\u5f53\u524d\u6709\u5176\u4ed6\u7ebf\u7a0b\u6b63\u5728\u5904\u7406\");\n            }\n        } catch (InterruptedException e) {\n            Thread.currentThread().interrupt();\n        } finally {\n            // 4. \u91ca\u653e\u9501 (\u6838\u5fc3\uff1a\u5fc5\u987b\u5224\u65ad\u9501\u662f\u5426\u5b58\u5728\uff0c\u4e14\u662f\u5426\u7531\u5f53\u524d\u7ebf\u7a0b\u6301\u6709)\n            if (lock.isHeldByCurrentThread()) {\n                lock.unlock();\n                System.out.println(\"\u9501\u5df2\u91ca\u653e\");\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3_11","title":"3. \u83b7\u53d6\u9501\u7684\u4e0d\u540c\u65b9\u5f0f","text":"<p>leaseTime: \u7ecf\u8fc7 leaseTime \u540e\u5f3a\u5236\u91ca\u653e waitTime: \u6700\u591a\u7b49\u5f85 waitTime \u79d2</p> \u65b9\u6cd5 \u963b\u585e\u7b49\u5f85 \u8fd4\u56de\u503c \u81ea\u52a8\u7eed\u671f(\u770b\u95e8\u72d7) \u5f3a\u5236\u91ca\u653e\u65f6\u95f4 <code>lock()</code> \u662f\uff08\u6b7b\u7b49\uff09 <code>void</code> \u5f00\u542f \u2705 \u65e0\uff08\u76f4\u5230\u624b\u52a8 unlock\uff09 <code>lock(5, SECONDS)</code> \u662f\uff08\u6b7b\u7b49\uff09 <code>void</code> \u5173\u95ed \u274c 5\u79d2\u540e\u5f3a\u5236\u91ca\u653e <code>tryLock(5, 10, SECONDS)</code> \u662f\uff08\u9650\u65f6\u91cd\u8bd5\uff09 <code>boolean</code> \u5173\u95ed \u274c 10\u79d2\u540e\u5f3a\u5236\u91ca\u653e <code>tryLock(5, -1, SECONDS)</code> \u662f\uff08\u9650\u65f6\u91cd\u8bd5\uff09 <code>boolean</code> \u5f00\u542f \u2705 \u65e0\uff08\u76f4\u5230\u624b\u52a8 unlock\uff09"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#4-day10","title":"4. \u6e90\u7801\u5206\u6790 day10","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1_23","title":"1. \u52a0\u9501","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2_20","title":"2. \u770b\u95e8\u72d7\u673a\u5236","text":"<p>\u53ea\u6709\u8bbe\u7f6e\u7684\u9501\u7684\u8fc7\u671f\u65f6\u95f4 leaseTime \u5c0f\u4e8e0\u624d\u4f1a\u5f00\u542f\u8be5\u529f\u80fd\u3002\u56fa\u5b9a\u9891\u7387\u662f leasetime / 3\uff0c\u9ed8\u8ba4\u662f 10 s,\u56e0\u4e3a\u9501\u7684\u9ed8\u8ba4\u8fc7\u671f\u65f6\u95f4\u4e3a30s</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3_12","title":"3. \u89e3\u9501","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#5_6","title":"5. \u5e03\u9686\u8fc7\u6ee4\u5668","text":"<p>\u5e03\u9686\u8fc7\u6ee4\u5668\uff08Bloom Filter\uff09\uff0c\u662f1970\u5e74\uff0c\u7531\u4e00\u4e2a\u53eb\u5e03\u9686\u7684\u5c0f\u4f19\u5b50\u63d0\u51fa\u7684\uff0c\u8ddd\u4eca\u5df2\u7ecf\u4e94\u5341\u5e74\u4e86\u3002\u5b83\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u5f88\u957f\u7684\u4e8c\u8fdb\u5236\u5411\u91cf\u548c\u4e00\u7cfb\u5217\u968f\u673a\u6620\u5c04\u51fd\u6570\u3002\u5e03\u9686\u8fc7\u6ee4\u5668\u53ef\u4ee5\u7528\u4e8e\u68c0\u7d22\u4e00\u4e2a\u5143\u7d20\u662f\u5426\u5728\u4e00\u4e2a\u96c6\u5408\u4e2d\u3002\u5b83\u7684\u4f18\u70b9\u662f\u7a7a\u95f4\u6548\u7387\u548c\u67e5\u8be2\u65f6\u95f4\u90fd\u6bd4\u4e00\u822c\u7684\u7b97\u6cd5\u8981\u597d\u7684\u591a\uff0c\u7f3a\u70b9\u662f\u6709\u4e00\u5b9a\u7684\u8bef\u8bc6\u522b\u7387\u548c\u5220\u9664\u56f0\u96be\u3002\u4e8c\u8fdb\u5236\u5927\u5bb6\u5e94\u8be5\u90fd\u6e05\u695a\uff0c\u5b58\u50a8\u7684\u6570\u636e\u4e0d\u662f0\u5c31\u662f1\uff0c\u9ed8\u8ba4\u662f0\u3002</p> <p>\u4e3b\u8981\u7528\u4e8e\u5224\u65ad\u4e00\u4e2a\u5143\u7d20\u662f\u5426\u5728\u4e00\u4e2a\u96c6\u5408\u4e2d\uff0c0\u4ee3\u8868\u4e0d\u5b58\u5728\u67d0\u4e2a\u6570\u636e\uff0c1\u4ee3\u8868\u5b58\u5728\u67d0\u4e2a\u6570\u636e\u3002</p> <p>\u603b\u7ed3\uff1a \u5224\u65ad\u4e00\u4e2a\u5143\u7d20\u4e00\u5b9a\u4e0d\u5b58\u5728 \u6216\u8005 \u53ef\u80fd\u5b58\u5728\uff01 \u5b58\u5728\u4e00\u5b9a\u7684\u8bef\u5224\u7387{\u901a\u8fc7\u4ee3\u7801\u8c03\u8282}</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#51_3","title":"5.1 \u539f\u7406","text":"<p>\u8bb0\u5f55\u6570\u636e 1. \u901a\u8fc7K\u4e2a\u54c8\u5e0c\u51fd\u6570\u8ba1\u7b97\u8be5\u6570\u636e\uff0c\u8fd4\u56deK\u4e2a\u8ba1\u7b97\u51fa\u7684hash\u503c 2. \u8fd9\u4e9bK\u4e2ahash\u503c\u6620\u5c04\u5230\u5bf9\u5e94\u7684K\u4e2a\u4e8c\u8fdb\u5236\u7684\u6570\u7ec4\u4e0b\u6807 3. \u5c06K\u4e2a\u4e0b\u6807\u5bf9\u5e94\u7684\u4e8c\u8fdb\u5236\u6570\u636e\u6539\u62101\u3002</p> <p>\u67e5\u8be2\u6570\u636e\u662f\u5426\u5728\u96c6\u5408\u4e2d 1. \u901a\u8fc7\u76f8\u540c\u7684 K \u4e2a\u54c8\u5e0c\u51fd\u6570\u53bb\u8ba1\u7b97\u8be5\u6570\u636e\uff0c\u5f97\u5230 K \u4e2a Hash \u503c\u3002 2. \u53bb\u67e5\u8be2\u8fd9\u4ee5\u8fd9 K \u4e2a hash \u503c \u4e3a\u4e0b\u6807\u7684\u4e8c\u8fdb\u5236\u6570\u636e 3. \u5982\u679c\u90fd\u4e3a1\uff0c\u5219\u8be5\u5143\u7d20\u53ef\u80fd\u5b58\u5728\uff0c\u5982\u679c\u5b58\u57280\uff0c\u5219\u8be5\u5143\u7d20\u4e00\u5b9a\u4e0d\u5b58\u5728\u3002</p> <p>\u65f6\u95f4\u590d\u6742\u5ea6$O(k)$ \uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 $O(m)$ $k$ : \u54c8\u5e0c\u51fd\u6570\u7684\u4e2a\u6570 $m$ : \u4e8c\u8fdb\u5236\u4e3a\u7684\u4e2a\u6570</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#52_3","title":"5.2 \u4f18\u7f3a\u70b9","text":"<p>\u4f18\u70b9 1. \u65f6\u95f4\u590d\u6742\u5ea6$O(k)$ \uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 $O(m)$ 2. \u4fdd\u5bc6\u6027\u597d\uff1a\u4e0d\u5b58\u539f\u59cb\u6570\u636e\uff0c\u53ea\u7528\u4e8c\u8fdb\u5236\u4f4d\u6765\u8868\u793a\u5143\u7d20\u662f\u5426\u5b58\u5728</p> <p>\u7f3a\u70b9  1. \u7531\u4e8e\u5e95\u5c42\u662f\u54c8\u5e0c\u51fd\u6570\uff0c\u6240\u4ee5\u53ef\u80fd\u51fa\u73b0\u54c8\u5e0c\u51b2\u7a81\uff0c\u56e0\u6b64\uff0c\u5bf9\u4e8e\u5143\u7d20\u662f\u5426\u5b58\u5728\u7684\u5224\u65ad\uff0c\u662f\u4e00\u4e2a\u53ef\u80fd\u6027   2. \u4e0d\u652f\u6301\u5220\u9664\u5143\u7d20\uff1a\u56e0\u4e3a\u4e0d\u540c\u6570\u636e\u7684\u591a\u4e2ahash\u503c\u53ef\u80fd\u5b58\u5728\u76f8\u540c\uff0c\u5982\u679c\u5220\u9664\u4e86a\u5143\u7d20\uff0c\u5f88\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5176\u4ed6\u5143\u7d20\u4e5f\u5b58\u57280\uff0c\u4ece\u800c\u5f71\u54cd\u5176\u4ed6\u5143\u7d20\u7684\u5224\u65ad\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#53_3","title":"5.3 \u4f7f\u7528\u65b9\u5f0f","text":"<p>Must be initialized with capacity size by\u00a0<code>tryInit(expectedInsertions, falseProbability)</code>\u00a0method before usage.</p> <pre><code>code example\uff1a\nRBloomFilter&lt;SomeObject&gt; bloomFilter = redisson.getBloomFilter(\"sample\");\nbloomFilter.tryInit(55000000L, 0.03);\n\nbloomFilter.add(new SomeObject(\"field1Value\", \"field2Value\"));\nboolean contains = bloomFilter.contains(new SomeObject(\"field1Value\", \"field8Value\"));\nlong count = bloomFilter.count();\n</code></pre> <p>\u6dfb\u52a0\u6570\u636e\u3001\u5224\u65ad\u6570\u636e\u662f\u5426\u5b58\u5728</p> <pre><code>RClusteredBloomFilter&lt;SomeObject&gt; bloomFilter = redisson.getClusteredBloomFilter(\"sample\");\n// initialize bloom filter with \n// expectedInsertions = 255000000  \n// falseProbability = 0.03\nbloomFilter.tryInit(255000000L, 0.03);\nbloomFilter.add(new SomeObject(\"fi  eld1Value\", \"field2Value\"));\nbloomFilter.add(new SomeObject(\"field5Value\", \"field8Value\"));\nbloomFilter.contains(new SomeObject(\"field1Value\", \"field8Value\"));\n</code></pre> <p>\u5728\u521d\u59cb\u5316\u540e\uff0c\u4f1a\u5728redis\u4e2d\u4ea7\u751f\u4e00\u4e2a hash\uff0c\u7528\u6765\u8bb0\u5f55\u5f53\u524d\u5e03\u9686\u8fc7\u6ee4\u5668\u7684\u4e00\u4e9b\u914d\u7f6e\u4fe1\u606f\u3002 ![[Springboot/imgs/image 2.png]]</p> <p>\u4e4b\u540e\uff0c\u6211\u4eec\u4fbf\u53ef\u4ee5\u6839\u636e\u5e03\u9686\u8fc7\u6ee4\u5668\u7684\u540d\u79f0\u53bb\u83b7\u5f97\u5e03\u9686\u8fc7\u6ee4\u5668\uff0c\u6ce8\u610f\uff0c\u53ea\u6709\u5728\u7b2c\u4e00\u6b21\u6dfb\u52a0\u6570\u636e\u65f6\u624d\u4f1a\u4ea7\u751f\u771f\u6b63\u7684\u4f4d\u56fe\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#54_3","title":"5.4 \u5e03\u9686\u8fc7\u6ee4\u5668\u7684\u91cd\u5efa\u4e0e\u6269\u5bb9","text":"<pre><code>@Scheduled(cron = \"0 0 2 1 * ?\")  \n// @Scheduled(cron = \"0/59 * * * * ?\")  \npublic void rebuildBloomFilter() {  \n    // 1. \u62ff\u5230\u5f53\u524d\u5e03\u9686\u8fc7\u6ee4\u5668\u7684\u9884\u4f30\u503c  \n    RBloomFilter&lt;Object&gt; old_bloomFilter = redissonClient.getBloomFilter(RedisConstant.ALBUM_BLOOM_FILTER);  \n    long count = old_bloomFilter.count(); // \u9884\u4f30\u63d2\u5165\u6570\u91cf  \n    long exceptedInsertions = old_bloomFilter.getExpectedInsertions(); // \u671f\u671b\u5927\u5c0f  \n    double falseProbability = old_bloomFilter.getFalseProbability();  \n\n    // all: \u65b0\u5efa\u5e03\u9686\u8fc7\u6ee4\u5668  \n    RBloomFilter&lt;Object&gt; new_bloomFilter = redissonClient.getBloomFilter(\"temp\");  \n\n    // 2. \u5982\u679c\u9884\u4f30\u503c\u5927\u4e8e\u5f53\u524d\u5e03\u9686\u8fc7\u6ee4\u5668\u7684 exceptedInsertions\uff0c\u5219\u6269\u5bb9  \n    if(count &gt; exceptedInsertions){  \n        // 2.1 \u6269\u5bb9\u89c4\u5219 exceptedInsertions * 1.5        exceptedInsertions = (long) (exceptedInsertions * 1.5);  \n\n        // 2.2 \u521d\u59cb\u5316  \n        new_bloomFilter.tryInit(exceptedInsertions, falseProbability);  \n\n        // 2.3 \u5220\u9664\u65e7\u7684\u5e03\u9686\u8fc7\u6ee4\u5668  \n        boolean delete = old_bloomFilter.delete();  \n        if(delete){  \n            // 2.5 \u5220\u9664\u6210\u529f\uff0c\u5219\u5c06\u65b0\u7684\u5e03\u9686\u8fc7\u6ee4\u5668\u91cd\u547d\u540d\u4e3a\u65e7\u7684\u5e03\u9686\u8fc7\u6ee4\u5668  \n            new_bloomFilter.rename(RedisConstant.ALBUM_BLOOM_FILTER);  \n        }  \n\n        // 2.4 \u6dfb\u52a0\u4e13\u8f91 id \u5230\u5e03\u9686\u8fc7\u6ee4\u5668\u4e2d  \n        albumInfoService.batchUpperToBloom();  \n        log.info(\"\u6269\u5bb9\u4e13\u8f91 id \u7684\u5e03\u9686\u8fc7\u6ee4\u5668\u6210\u529f\uff01\");  \n    }else{  \n        // 3. \u53cd\u4e4b\u53ea\u9700\u8981\u91cd\u5efa\u5373\u53ef\uff08\u56e0\u4e3a\u53ef\u80fd\u6709\u5f88\u591a\u4e13\u8f91\u90fd\u4e0b\u67b6\u4e86\uff0c\u4f46\u662f\u5e03\u9686\u8fc7\u6ee4\u5668\u65e0\u6cd5\u5220\u9664\u5143\u7d20\uff09  \n        // 3.1 \u521d\u59cb\u5316  \n        new_bloomFilter.tryInit(exceptedInsertions, falseProbability);  \n\n        // 3.2 \u5220\u9664\u65e7\u7684\u5e03\u9686\u8fc7\u6ee4\u5668  \n        boolean delete = old_bloomFilter.delete();  \n        if(delete){  \n            // 3.3 \u5220\u9664\u6210\u529f\uff0c\u5219\u5c06\u65b0\u7684\u5e03\u9686\u8fc7\u6ee4\u5668\u91cd\u547d\u540d\u4e3a\u65e7\u7684\u5e03\u9686\u8fc7\u6ee4\u5668  \n            new_bloomFilter.rename(RedisConstant.ALBUM_BLOOM_FILTER);  \n        }  \n\n        // 3.4 \u6dfb\u52a0\u4e13\u8f91 id \u5230\u5e03\u9686\u8fc7\u6ee4\u5668\u4e2d  \n        albumInfoService.batchUpperToBloom();  \n\n        log.info(\"\u91cd\u5efa\u4e13\u8f91 id \u7684\u5e03\u9686\u8fc7\u6ee4\u5668\u6210\u529f\uff01\");  \n    }  \n\n}\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#6_1","title":"6. \u7f13\u5b58\u6570\u636e\u4e00\u81f4\u6027","text":"<p>\u53ea\u80fd\u505a\u5230\u6700\u7ec8\u4e00\u81f4</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#61","title":"6.1 \u53cc\u5199\u7b56\u7565","text":"<p>![[Springboot/imgs/image 3.png]]</p> <p>\u5e76\u53d1\u573a\u666f\u4e0b\uff0c\u8fd9\u6837\u7684\u60c5\u51b5\u662f\u5f88\u5bb9\u6613\u51fa\u73b0\u7684\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u7684\u64cd\u4f5c\u5148\u540e\u987a\u5e8f\u4e0d\u540c\uff0c\u8fd9\u6837\u5c31\u5bfc\u81f4\u8bf7\u6c42B\u7684\u7f13\u5b58\u503c\u88ab\u8bf7\u6c42A\u7ed9\u8986\u76d6\u4e86\uff0c\u6570\u636e\u5e93\u4e2d\u662f\u7ebf\u7a0bB\u7684\u65b0\u503c\uff0c\u7f13\u5b58\u4e2d\u662f\u7ebf\u7a0bA\u7684\u65e7\u503c\uff0c\u5e76\u4e14\u4f1a\u4e00\u76f4\u8fd9\u4e48\u810f\u4e0b\u53bb\u76f4\u5230\u7f13\u5b58\u5931\u6548\uff08\u8bbe\u7f6e\u4e86\u8fc7\u671f\u65f6\u95f4\uff09</p> <p>![[Springboot/imgs/image-1 1.png]]</p> <p>\u548c\u524d\u9762\u4e00\u79cd\u60c5\u51b5\u76f8\u53cd\uff0c\u7f13\u5b58\u4e2d\u662f\u7ebf\u7a0bB\u7684\u65b0\u503c\uff0c\u800c\u6570\u636e\u5e93\u4e2d\u662f\u7ebf\u7a0bA\u7684\u65e7\u503c\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#62","title":"6.2 \u5148\u5220\u9664\u7f13\u5b58\u518d\u66f4\u65b0\u6570\u636e\u5e93","text":"<p>\u53ef\u4ee5\u89e3\u51b3\u53cc\u5199\u51fa\u73b0\u7684\u4e0d\u4e00\u81f4\u95ee\u9898\uff0c\u4f46\u662f\u518d\u5e76\u53d1\u8bfb\u5199\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u80fd\u51fa\u73b0\uff1a\u5199\u7ebf\u7a0b\u521a\u628a\u65e7\u7f13\u5b58\u5220\u4e86\uff0c\u8fd8\u6ca1\u6765\u5f97\u53ca\u5199\u6570\u636e\u5e93\uff0c\u8bfb\u7ebf\u7a0b\u5c31\u53bb\u6570\u636e\u5e93\u8bfb\u5230\u4e86\u8fd8\u6ca1\u66f4\u65b0\u7684\u6570\u636e\uff0c\u5e76\u4e14\u5bfc\u81f4\u8fd9\u4e2a\u521a\u88ab\u5220\u9664\u7684\u65e7\u6570\u636e\u53c8\u88ab\u7f13\u5b58\u5230\u4e86 redis \u4e2d\uff0c\u4e4b\u540e\u5199\u7ebf\u7a0b\u66f4\u65b0\u5b8c\u6570\u636e\u5e93\uff0c\u5c31\u4f1a\u5bfc\u81f4\u6570\u636e\u5e93\u4e0e\u7f13\u5b58\u7684\u4e0d\u4e00\u81f4\u3002 \u4e5f\u5c31\u662f\u5bfc\u81f4\u4e86\u6570\u636e\u5e93\u4e3a\u65b0\u503c\uff0c\u4f46\u7f13\u5b58\u4e3a\u65e7\u503c\u3002 </p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#63_1","title":"6.3 \u5ef6\u8fdf\u53cc\u5220","text":"<ol> <li>\u5148\u53bb\u5220\u9664\u7f13\u5b58</li> <li>\u518d\u53bb\u66f4\u65b0\u6570\u636e\u5e93</li> <li>\u7761\u7720\u4e00\u6bb5\u65f6\u95f4\uff08500ms\uff09</li> <li>\u518d\u53bb\u5220\u9664\u7f13\u5b58\uff08\u6b64\u5220\u9664\u662f\u4e3a\u4e86\u907f\u514d\u6570\u636e\u5e93\u8fd8\u6ca1\u66f4\u65b0\u6216\u8005\u662f\u6ca1\u540c\u6b65\u5b8c\u6210\uff0c\u5176\u4ed6\u8fdb\u7a0b\u8bfb\u5230\u4e86\u65e7\u6570\u636e\u4ece\u800c\u5bfc\u81f4\u53c8\u7f13\u5b58\u4e86\u65e7\u6570\u636e\uff09 </li> </ol> <p>\u95ee\u9898\uff1a\u8fd9\u4e2a\u5ef6\u65f6\u65f6\u95f4\u4e0d\u592a\u597d\u8bbe\u7f6e\uff01\u8bbe\u7f6e\u957f\u4e86\u6027\u80fd\u5dee\uff0c\u8bbe\u7f6e\u77ed\u4e86\u4f1a\u5bfc\u81f4\u6570\u636e\u4e0d\u4e00\u81f4</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#64","title":"6.4 \u5206\u5e03\u5f0f\u8bfb\u5199\u9501","text":"<p>\u8bfb\u8bfb\u5141\u8bb8\u5e76\u53d1 \u8bfb\u5199\u3001\u5199\u5199\u4e0d\u5141\u8bb8\u5e76\u53d1 \u95ee\u9898\uff1a\u6548\u7387\u4f4e</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#65-binlog","title":"6.5 Binlog \u65b9\u6848","text":"<p>\u300c\u5148\u66f4\u65b0\u6570\u636e\u5e93\uff0c\u518d\u5220\u7f13\u5b58\u300d\u7684\u7b56\u7565\u7684\u7b2c\u4e00\u6b65\u662f\u66f4\u65b0\u6570\u636e\u5e93\uff0c\u90a3\u4e48\u66f4\u65b0\u6570\u636e\u5e93\u6210\u529f\uff0c\u5c31\u4f1a\u4ea7\u751f\u4e00\u6761\u53d8\u66f4\u65e5\u5fd7\uff0c\u8bb0\u5f55\u5728 binlog \u91cc\u3002</p> <p>\u4e8e\u662f\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u8ba2\u9605 binlog \u65e5\u5fd7\uff0c\u62ff\u5230\u5177\u4f53\u8981\u64cd\u4f5c\u7684\u6570\u636e\uff0c\u7136\u540e\u518d\u6267\u884c\u7f13\u5b58\u5220\u9664\uff0c\u963f\u91cc\u5df4\u5df4\u5f00\u6e90\u7684 Canal \u4e2d\u95f4\u4ef6\u5c31\u662f\u57fa\u4e8e\u8fd9\u4e2a\u5b9e\u73b0\u7684\u3002</p> <p>Canal \u6a21\u62df MySQL \u4e3b\u4ece\u590d\u5236\u7684\u4ea4\u4e92\u534f\u8bae\uff0c\u628a\u81ea\u5df1\u4f2a\u88c5\u6210\u4e00\u4e2a MySQL \u7684\u4ece\u8282\u70b9\uff0c\u5411 MySQL \u4e3b\u8282\u70b9\u53d1\u9001 dump \u8bf7\u6c42\uff0cMySQL \u6536\u5230\u8bf7\u6c42\u540e\uff0c\u5c31\u4f1a\u5f00\u59cb\u63a8\u9001 Binlog \u7ed9 Canal\uff0cCanal \u89e3\u6790 Binlog \u5b57\u8282\u6d41\u4e4b\u540e\uff0c\u8f6c\u6362\u4e3a\u4fbf\u4e8e\u8bfb\u53d6\u7684\u7ed3\u6784\u5316\u6570\u636e\uff0c\u4f9b\u4e0b\u6e38\u7a0b\u5e8f\u8ba2\u9605\u4f7f\u7528\u3002</p> <p>![[Springboot/imgs/image 4.png]]</p> <p>\u5177\u4f53\u89e3\u51b3\u65b9\u6848\u5982\u4e0b\u56fe\uff1a canel \u4f2a\u88c5\u6210\u4e00\u4e2a mysql \u4e3b\u8282\u70b9\u7684\u4ece\u8282\u70b9\u3002\u7136\u540e\u53d1\u8d77 dump \u53bb\u63a5\u53d7\u4e3b\u8282\u70b9\u7684 binlog \u65e5\u5fd7\uff0c\u4e4b\u540e\uff0c\u5c31\u4f1a\u50cf\u8fd9\u4e9b\u6570\u636e\u53d1\u9001\u5230\u6d88\u606f\u961f\u5217\u4e2d\uff0c\u800c\u6211\u4eec\u8981\u5199\u4ee3\u7801\u53bb\u83b7\u53d6\u6570\u636e\uff0c\u7136\u540e\u51b3\u5b9a\u5982\u4f55\u5904\u7406\u8fd9\u4e9b\u6570\u636e\uff0c\u4e3a\u4e86\u89e3\u51b3\u6570\u636e\u4e00\u81f4\u6027\u95ee\u9898\uff0c\u6bcf\u5f53\u6211\u4eec\u76d1\u542c\u5230\u4e86\u6570\u636e\u5e93\u7684\u5199\u64cd\u4f5c\uff0c\u5c31\u53bb\u628a\u5bf9\u4e8e\u7684\u7f13\u5b58\u6570\u636e\u5220\u6389\u5373\u53ef\u3002</p> <p>![[Springboot/imgs/image 5.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#canal","title":"Canal \u670d\u52a1\u7aef","text":"<ol> <li> <p>\u67e5\u770b\u662f\u5426\u5f00\u542f\u4e86 bin_log \u65e5\u5fd7 <pre><code>show variables like '%log_bin%';\n</code></pre></p> </li> <li> <p>\u5728MySQL\u65b0\u589e\u7528\u6237\u7528\u4e8e\u76d1\u542cBinlog\u65e5\u5fd7\uff0c\u5728Canal\u5bb9\u5668\u4e2d\u8981\u4f7f\u7528\u8be5\u7528\u6237 <pre><code>#\u521b\u5efa\u7528\u6237\nCREATE USER canal IDENTIFIED BY 'liuqiang';  \n#\u7ed9\u7528\u6237\u6388\u6743-\u6240\u6709\u5e93\u6240\u6709\u8868\u4e3b\u4ece\u540c\u6b65\u6743\u9650\nGRANT SELECT, REPLICATION SLAVE, REPLICATION CLIENT ON *.* TO 'canal'@'%';\n\n#\u5982\u679c\u662fMySQL8.X\u4ee5\u4e0a\u9700\u8981\u5bf9\u52a0\u5bc6\u65b9\u5f0f\u8fdb\u884c\u8bbe\u7f6e\nALTER USER 'canal'@'%' IDENTIFIED WITH mysql_native_password BY 'liuqiang';\n#\u5237\u65b0\u751f\u6548\nFLUSH PRIVILEGES;\n</code></pre></p> </li> <li> <p>\u67e5\u8be2MySQL\u4e3b\u8282\u70b9\u72b6\u6001\uff1b\u5b8c\u6210\u91cd\u7f6e <pre><code>SHOW MASTER STATUS; \nreset master;\n</code></pre></p> </li> <li> <p>\u91c7\u7528Docker\u65b9\u5f0f\u521b\u5efaCanal\u670d\u52a1\u7aef\u3002\u4ee5\u4e0b\u4e3a\u521b\u5efaCanal\u5bb9\u5668\u547d\u4ee4\uff0c\u8981\u4fee\u6539\u8981\u76d1\u542c\u4e3bMySQL\u6570\u636e\u5e93IP\u8ddf\u7aef\u53e3\u7528\u6237\u540d\u4ee5\u53ca\u5bc6\u7801\u786e\u4fdd\u6b63\u786e(\u4e0d\u9700\u8981\u6267\u884c)</p> </li> </ol> <pre><code>docker run -p 11111:11111 --name canal \\\n-e canal.destinations=tingshuTopic \\\n-e canal.instance.master.address=j36b695c.natappfree.cc:5272  \\\n-e canal.instance.dbUsername=canal  \\\n-e canal.instance.dbPassword=liuqiang  \\\n-e canal.instance.connectionCharset=UTF-8 \\\n-e canal.instance.tsdb.enable=true \\\n-e canal.instance.gtidon=false  \\\n-d canal/canal-server:v1.1.8\n\n\n\n// \ndocker stop canal &amp;&amp; docker rm canal\n\ndocker run -d --name canal \\\n-p 11111:11111 \\\n-e canal.destinations=tingshuTopic \\\n-e canal.instance.master.address=j36b695c.natappfree.cc:5272 \\\n-e canal.instance.dbUsername=canal \\\n-e canal.instance.dbPassword=liuqiang \\\n-e canal.instance.connectionCharset=UTF-8 \\\n-e canal.instance.tsdb.enable=true \\\n-e JAVA_OPTS=\"-Xms512m -Xmx512m\" \\\ncanal/canal-server:v1.1.8\n\n\n// 3.\nmkdir -p /opt/canal &amp;&amp; vi /opt/canal/instance.properties\n\ndocker run -d --name canal -p 11111:11111 -e canal.destinations=tingshuTopic -e JAVA_OPTS=\"-Xms256m -Xmx512m -XX:MaxDirectMemorySize=256m\"  -v /opt/canal/instance.properties:/home/admin/canal-server/conf/tingshuTopic/instance.properties canal/canal-server:v1.1.8\n</code></pre> <ol> <li> <p>Canal \u65e5\u5fd7\u5728\u5bb9\u5668 <pre><code>/home/admin/canal-server/logs/tingshuTopic \u65e5\u5fd7\u8def\u5f84\n</code></pre></p> </li> <li> <p>\u67e5\u770b\u662f\u5426\u6210\u529f\u540c\u6b65\u6211\u4eec\u7684\u4e3b\u8282\u70b9 <pre><code>// canel \u662f\u5426\u542f\u52a8\u6210\u529f\ndocker logs -f canal\n\n# \u8fdb\u5165\u5bb9\u5668\u67e5\u770b instance \u65e5\u5fd7\ndocker exec -it canal sh -c \"tail -f /home/admin/canal-server/logs/tingshuTopic/tingshuTopic.log\"\n// \n</code></pre></p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#canal_1","title":"Canal \u5ba2\u6237\u7aef","text":"<ol> <li> <p>\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6a21\u5757\uff0c\u5e76\u5f15\u5165\u4f9d\u8d56 <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt;\n    &lt;parent&gt;\n        &lt;artifactId&gt;service&lt;/artifactId&gt;\n        &lt;groupId&gt;com.atguigu.tingshu&lt;/groupId&gt;\n        &lt;version&gt;1.0&lt;/version&gt;\n    &lt;/parent&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\n    &lt;artifactId&gt;service-cdc&lt;/artifactId&gt;\n\n    &lt;properties&gt;\n        &lt;maven.compiler.source&gt;17&lt;/maven.compiler.source&gt;\n        &lt;maven.compiler.target&gt;17&lt;/maven.compiler.target&gt;\n        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n    &lt;/properties&gt;\n\n\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;io.github.xizixuejie&lt;/groupId&gt;\n            &lt;artifactId&gt;canal-spring-boot-starter&lt;/artifactId&gt;\n            &lt;version&gt;0.0.17&lt;/version&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n\n&lt;/project&gt;\n</code></pre></p> </li> <li> <p>\u63d0\u4f9b\u542f\u52a8\u7c7b <pre><code>package com.atguigu.tingshu;\n\nimport io.xzxj.canal.spring.annotation.EnableCanalListener;\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration;\n\n@EnableCanalListener\n@SpringBootApplication(exclude = DataSourceAutoConfiguration.class)\npublic class CDCApplicaiton {\n\n    public static void main(String[] args) {\n        SpringApplication.run(CDCApplicaiton.class, args);\n    }\n}\n</code></pre></p> </li> <li> <p>\u5728nacos\u5199\u914d\u7f6e\u6587\u4ef6</p> </li> </ol> <pre><code>server:\n  port: 8601\ncanal:\n  server: canal \u5730\u5740\n  destination: tingshuTopic\n</code></pre> <ol> <li>\u5728\u672c\u5730\u521b\u5efa bootStrap.yaml</li> </ol> <pre><code>spring.application.name=service-canal\nspring.profiles.active=dev\nspring.main.allow-bean-definiton-overriding=true\nspring.cloud.nacos.discovery.server-addr=192.168.200.6:8848\nspring.cloud.nacos.config.server-addr=192.168.200.6:8848\nspring.cloud.nacos.config.prefix=${spring.application.name}\nspring.cloud.nacos.config.file-extension=yaml\nspring.cloud.nacos.config.shared-configs[0].data-id=common.yaml\n</code></pre> <ol> <li>\u76d1\u542c\u5230\u53d8\u66f4\u4e1a\u52a1\u5904\u7406\u7c7b-\u7528\u6237\u4fe1\u606f <pre><code>@Slf4j\n@CanalListener(destination = \"tingshuTopic\", schemaName = \"tingshu_user\", tableName = \"user_info\")\npublic class UserListener implements EntryListener&lt;UserInfo&gt; {\n\n    @Autowired\n    private RedisTemplate redisTemplate;\n\n    /**\n     * \u76d1\u542c\u7528\u6237\u8868\u66f4\u65b0\u56de\u8c03\u65b9\u6cd5\n     * @param before\n     * @param after\n     * @param fields\n     */\n    @Override\n    public void update(UserInfo before, UserInfo after, Set&lt;String&gt; fields) {\n        log.info(\"[cdc]\u76d1\u542c\u5230\u53d8\u66f4\u6570\u636e\");\n        String redisKey = \"user:info:\"+after.getId();\n        redisTemplate.delete(redisKey);\n    }\n}\n</code></pre></li> </ol> <p>\u6ce8\u610f\uff1a\u7531\u4e8e\u6211\u7684\u6570\u636e\u5e93\u5728\u672c\u673a\uff0ccanal\u5728\u4e91\u670d\u52a1\u5668\u4e0a\uff0c\u6240\u4ee5\uff0c\u9700\u8981\u628a\u672c\u673a\u4e0a\u7684 mysql:3306 \u901a\u8fc7\u5185\u7f51\u7a7f\u900f\u66b4\u9732\u5230\u516c\u7f51\u4e0a</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#66_1","title":"6.6 \u5185\u7f51\u7a7f\u900f","text":"<p>\u9009\u62e9 natapp \u5b9e\u73b0\u5185\u7f51\u7a7f\u900f \u8d26\u53f7\uff1a18604849909 \u5bc6\u7801...</p> <p>\u8d2d\u4e70\u5b8c\u96a7\u9053\u540e\u6309\u7167NATAPP1\u5206\u949f\u5feb\u901f\u65b0\u624b\u56fe\u6587\u6559\u7a0b - NATAPP-\u5185\u7f51\u7a7f\u900f \u57fa\u4e8engrok\u7684\u56fd\u5185\u9ad8\u901f\u5185\u7f51\u6620\u5c04\u5de5\u5177\u5373\u53ef\u4f7f\u7528</p> <p>\u5185\u7f51\u7a7f\u900f\u914d\u7f6e\u5b8c\u6bd5\u540e\uff0c\u4e4b\u540e\u4f7f\u7528\u547d\u4ee4\uff1a <pre><code>telnet tcp://j36b695c.natappfree.cc:5272(\u5185\u7f51\u7a7f\u900f\u540e\u7684ip\u5730\u5740)\ncurl j36b695c.natappfree.cc:5272\n</code></pre></p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#15-seata","title":"15. seata","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1-cap","title":"1. CAP","text":"<p>\u5728\u4e00\u4e2a<code>\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d</code>\uff0c\u5f53\u6d89\u53ca\u8bfb\u5199\u64cd\u4f5c\u65f6\uff0c\u53ea\u80fd\u4fdd\u8bc1\u4e00\u81f4\u6027\uff08Consistence\uff09\u3001\u53ef\u7528\u6027\uff08Availability\uff09\u3001\u5206\u533a\u5bb9\u9519\u6027\uff08Partition Tolerance\uff09\u4e09\u8005\u4e2d\u7684\u4e24\u4e2a\uff0c\u53e6\u5916\u4e00\u4e2a\u5fc5\u987b\u88ab\u727a\u7272\u3002</p> <ul> <li>C \u4e00\u81f4\u6027\uff08Consistency\uff09\uff1a\u5bf9\u67d0\u4e2a\u6307\u5b9a\u7684\u5ba2\u6237\u7aef\u6765\u8bf4\uff0c\u8bfb\u64cd\u4f5c\u4fdd\u8bc1\u80fd\u591f\u8fd4\u56de\u6700\u65b0\u7684\u5199\u64cd\u4f5c\u7ed3\u679c</li> <li>A \u53ef\u7528\u6027\uff08Availability\uff09\uff1a\u975e\u6545\u969c\u7684\u8282\u70b9\u5728\u5408\u7406\u7684\u65f6\u95f4\u5185\u8fd4\u56de\u5408\u7406\u7684\u54cd\u5e94<code>\uff08\u4e0d\u662f\u9519\u8bef\u548c\u8d85\u65f6\u7684\u54cd\u5e94\uff09</code></li> <li>P \u5206\u533a\u5bb9\u5fcd\u6027\uff08Partition Tolerance\uff09\uff1a\u5f53\u51fa\u73b0\u7f51\u7edc\u5206\u533a\u540e<code>\uff08\u53ef\u80fd\u662f\u4e22\u5305\uff0c\u4e5f\u53ef\u80fd\u662f\u8fde\u63a5\u4e2d\u65ad\uff0c\u8fd8\u53ef\u80fd\u662f\u62e5\u585e\uff09</code>\uff0c\u7cfb\u7edf\u80fd\u591f\u7ee7\u7eed\u201c\u5c65\u884c\u804c\u8d23\u201d-\u5fc5\u987b\u6ee1\u8db3</li> </ul>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2-base","title":"2. Base \u5b9a\u7406","text":"<p>BASE\u7406\u8bba\u662f\u5bf9CAP\u7684\u4e00\u79cd\u89e3\u51b3\u601d\u8def\uff0c\u5305\u542b\u4e09\u4e2a\u601d\u60f3\uff1a - Basically Available \uff08\u57fa\u672c\u53ef\u7528\uff09\uff1a\u5206\u5e03\u5f0f\u7cfb\u7edf\u5728\u51fa\u73b0\u6545\u969c\u65f6\uff0c\u5141\u8bb8\u635f\u5931\u90e8\u5206\u53ef\u7528\u6027\uff0c\u5373\u4fdd\u8bc1\u6838\u5fc3\u53ef\u7528\u3002 - Soft State\uff08\u8f6f\u72b6\u6001\uff09\uff1a\u5728\u4e00\u5b9a\u65f6\u95f4\u5185\uff0c\u5141\u8bb8\u51fa\u73b0\u4e2d\u95f4\u72b6\u6001\uff0c\u6bd4\u5982\u4e34\u65f6\u7684\u4e0d\u4e00\u81f4\u72b6\u6001\u3002 - Eventually Consistent\uff08\u6700\u7ec8\u4e00\u81f4\u6027\uff09\uff1a\u867d\u7136\u65e0\u6cd5\u4fdd\u8bc1\u5f3a\u4e00\u81f4\u6027\uff0c\u4f46\u662f\u5728\u8f6f\u72b6\u6001\u7ed3\u675f\u540e\uff0c\u6700\u7ec8\u8fbe\u5230\u6570\u636e\u4e00\u81f4\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3_13","title":"3. \u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u89e3\u51b3\u65b9\u6848","text":"<p>![[Springboot/imgs/image 6.png]]</p> <ul> <li> <p>AP\u6a21\u5f0f\uff1a\u5404\u5b50\u4e8b\u52a1\u5206\u522b\u6267\u884c\u548c\u63d0\u4ea4\uff0c\u5141\u8bb8\u51fa\u73b0\u7ed3\u679c\u4e0d\u4e00\u81f4\uff0c\u7136\u540e\u91c7\u7528\u5f25\u8865\u63aa\u65bd\u6062\u590d\u6570\u636e\u5373\u53ef\uff0c\u5b9e\u73b0\u6700\u7ec8\u4e00\u81f4\uff08\u67d4\u6027\u4e8b\u52a1\uff09\u3002</p> </li> <li> <p>CP\u6a21\u5f0f\uff1a\u5404\u4e2a\u5b50\u4e8b\u52a1\u6267\u884c\u540e\u4e92\u76f8\u7b49\u5f85\uff0c\u540c\u65f6\u63d0\u4ea4\uff0c\u540c\u65f6\u56de\u6eda\uff0c\u8fbe\u6210\u5f3a\u4e00\u81f4\u3002\u4f46\u4e8b\u52a1\u7b49\u5f85\u8fc7\u7a0b\u4e2d\uff0c\u5904\u4e8e\u5f31\u53ef\u7528\u72b6\u6001\uff08\u521a\u6027\u4e8b\u52a1\uff09\u3002</p> </li> </ul> <p>\u8fd9\u91cc\u7684\u5b50\u7cfb\u7edf\u4e8b\u52a1\uff0c\u79f0\u4e3a\u5206\u652f\u4e8b\u52a1\uff1b\u6709\u5173\u8054\u7684\u5404\u4e2a\u5206\u652f\u4e8b\u52a1\u5728\u4e00\u8d77\u79f0\u4e3a\u5168\u5c40\u4e8b\u52a1\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#4-seata","title":"4. Seata\u7b80\u4ecb","text":"<p>Seata \u7684\u8bbe\u8ba1\u76ee\u6807\u662f\u5bf9\u4e1a\u52a1\u65e0\u4fb5\u5165\uff0c\u5b83\u628a\u4e00\u4e2a\u5206\u5e03\u5f0f\u4e8b\u52a1\u7406\u89e3\u6210\u4e00\u4e2a\u5305\u542b\u4e86\u82e5\u5e72\u5206\u652f\u4e8b\u52a1\u7684\u5168\u5c40\u4e8b\u52a1\u3002\u5168\u5c40\u4e8b\u52a1\u7684\u804c\u8d23\u662f\u534f\u8c03\u5176\u4e0b\u7ba1\u8f96\u7684\u5206\u652f\u4e8b\u52a1\u8fbe\u6210\u4e00\u81f4\uff0c\u8981\u4e48\u4e00\u8d77\u6210\u529f\u63d0\u4ea4\uff0c\u8981\u4e48\u4e00\u8d77\u5931\u8d25\u56de\u6eda\u3002\u6b64\u5916\uff0c\u901a\u5e38\u5206\u652f\u4e8b\u52a1\u672c\u8eab\u5c31\u662f\u4e00\u4e2a\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7684\u672c\u5730\u4e8b\u52a1\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#41_2","title":"4.1 \u67b6\u6784","text":"<ul> <li> <p>TC (Transaction Coordinator) - \u4e8b\u52a1\u534f\u8c03\u8005\uff08Seata\u670d\u52a1\uff09\uff1a\u7ef4\u62a4\u5168\u5c40\u548c\u5206\u652f\u4e8b\u52a1\u7684\u72b6\u6001\uff0c\u534f\u8c03\u5168\u5c40\u4e8b\u52a1\u63d0\u4ea4\u6216\u56de\u6eda\u3002</p> </li> <li> <p>TM (Transaction Manager) - \u4e8b\u52a1\u7ba1\u7406\u5668\uff1a\u5b9a\u4e49\u5168\u5c40\u4e8b\u52a1\u7684\u8303\u56f4\u3001\u5f00\u59cb\u5168\u5c40\u4e8b\u52a1\u3001\u63d0\u4ea4\u6216\u56de\u6eda\u5168\u5c40\u4e8b\u52a1\u3002</p> </li> <li> <p>RM (Resource Manager) - \u8d44\u6e90\u7ba1\u7406\u5668\uff1a\u7ba1\u7406\u5206\u652f\u4e8b\u52a1\u5904\u7406\u7684\u8d44\u6e90\uff0c\u4e0eTC\u901a\u4fe1\u4ee5\u6ce8\u518c\u5206\u652f\u4e8b\u52a1\u548c\u62a5\u544a\u5206\u652f\u4e8b\u52a1\u7684\u72b6\u6001\uff0c\u5e76\u9a71\u52a8\u5206\u652f\u4e8b\u52a1\u63d0\u4ea4\u6216\u56de\u6eda\u3002</p> </li> </ul> <p>![[Springboot/imgs/image-1 2.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#42-xa-cp","title":"4.2 XA \u6a21\u5f0f CP","text":"<p>XA \u6a21\u5f0f\u5c31\u662f\u727a\u7272\u4e86\u6570\u636e\u7684\u53ef\u7528\u6027\uff0c\u4ece\u800c\u53bb\u5b9e\u73b0\u5f3a\u4e00\u81f4\u6027\uff0c\u4e5f\u5c31\u662f\u4e0d\u4f1a\u8f93\u5148\u6570\u636e\u4e0d\u4e00\u81f4\u7684\u60c5\u51b5\uff0c\u5177\u4f53\u5b9e\u73b0\u65b9\u5f0f\u5c31\u662f\u5206\u652f\u4e8b\u52a1\u6267\u884c\u5b8csql\u540e\u5e76\u4e0d\u76f4\u63a5\u63d0\u4ea4\uff0c\u800c\u662f\u5411tc\u4e0a\u62a5\u72b6\u6001\u5e76\u7b49\u5f85\u5176\u4ed6\u4e8b\u52a1\u7684\u6267\u884c\uff0c\u6700\u540e\uff0c\u5982\u679c\u90fd\u6ca1\u53d1\u751f\u5f02\u5e38\uff0c\u5c31\u540c\u65f6\u63d0\u4ea4\uff0c\u5426\u5c31\uff0c\u5c31\u5168\u90e8\u56de\u6eda\u3002Seate \u5728 XA \u6a21\u5f0f\u4e0b\u65e0\u4e1a\u52a1\u5165\u4fb5\uff0c\u4f46\u662f\u6548\u7387\u6bd4\u8f83\u4f4e\u3002 ![[Springboot/imgs/image-2 1.png]]</p> <p>\u603b\u7ed3\uff1a 1. \u5404\u4e2a\u670d\u52a1\u9700\u8981\u96c6\u6210 seata \u5e76\u5c06\u81ea\u5df1\u6ce8\u518c\u5230 seata\uff0c\u6210\u4e3a\u4e00\u4e2a seata \u773c\u91cc\u7684 RM 2. \u5f53\u9700\u8981\u5f00\u542f\u5168\u5c40\u4e8b\u52a1\u65f6\uff0cTM \u8981\u4e0e TC \u901a\u4fe1\uff0c\u4ece\u800c\u8ba9 tc \u534f\u8c03\u672c\u6b21\u5168\u5c40\u4e8b\u52a1\u7684\u63d0\u4ea4\uff0c\u56de\u6eda\u3002\uff08\u83b7\u5f97\u5168\u5c40\u4e8b\u52a1id\uff0c\u7136\u540e\u4f20\u9012\u7ed9rm\uff0c\u4ece\u800c\u5b9e\u73b0\u5206\u652f\u4e8b\u52a1\u4e0e\u5168\u5c40\u4e8b\u52a1\u7684\u7ed1\u5b9a\uff09 3. \u4e4b\u540e\uff0c\u6bcf\u4e2a RM \u5c31\u53ef\u4ee5\u6267\u884c\u81ea\u5df1\u7684 sql\uff0c\u5728 XA \u6a21\u5f0f\u4e0b\uff0c\u6267\u884c\u5b8c\u4e0d\u63d0\u4ea4\uff0c\u800c\u662f\u5411 TC \u4e0a\u62a5\u72b6\u6001\uff0c\u7531 TC \u534f\u8c03 TM \u7edf\u4e00\u7684\u7ba1\u7406\u8fd9\u4e9b\u5206\u652f\u4e8b\u52a1\u7684\u63d0\u4ea4\u4e0e\u56de\u6eda\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#43-at-ap","title":"4.3 AT \u6a21\u5f0f AP","text":"<p>Seata AT \u6a21\u5f0f | Apache Seata</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1_24","title":"1. \u6982\u8ff0","text":"<ul> <li>\u4e00\u9636\u6bb5\uff1a\u4e1a\u52a1\u6570\u636e\u548c\u56de\u6eda\u65e5\u5fd7\u8bb0\u5f55\u5728\u540c\u4e00\u4e2a\u672c\u5730\u4e8b\u52a1\u4e2d\u63d0\u4ea4\uff0c\u91ca\u653e\u672c\u5730\u9501\u548c\u8fde\u63a5\u8d44\u6e90\u3002</li> <li>\u4e8c\u9636\u6bb5\uff1a<ul> <li>\u63d0\u4ea4\u5f02\u6b65\u5316\uff0c\u975e\u5e38\u5feb\u901f\u5730\u5b8c\u6210\u3002</li> <li>\u56de\u6eda\u901a\u8fc7\u4e00\u9636\u6bb5\u7684\u56de\u6eda\u65e5\u5fd7\u8fdb\u884c\u53cd\u5411\u8865\u507f\u3002</li> </ul> </li> </ul> <p>\u5199\u9694\u79bb - \u4e00\u9636\u6bb5\u672c\u5730\u4e8b\u52a1\u63d0\u4ea4\u524d\uff0c\u9700\u8981\u786e\u4fdd\u5148\u62ff\u5230\u00a0\u5168\u5c40\u9501\u00a0\u3002 - \u62ff\u4e0d\u5230\u00a0\u5168\u5c40\u9501\u00a0\uff0c\u4e0d\u80fd\u63d0\u4ea4\u672c\u5730\u4e8b\u52a1\u3002 - \u62ff\u00a0\u5168\u5c40\u9501\u00a0\u7684\u5c1d\u8bd5\u88ab\u9650\u5236\u5728\u4e00\u5b9a\u8303\u56f4\u5185\uff0c\u8d85\u51fa\u8303\u56f4\u5c06\u653e\u5f03\uff0c\u5e76\u56de\u6eda\u672c\u5730\u4e8b\u52a1\uff0c\u91ca\u653e\u672c\u5730\u9501\u3002</p> <p>\u8bfb\u9694\u79bb \u5728\u6570\u636e\u5e93\u672c\u5730\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\u00a0\u8bfb\u5df2\u63d0\u4ea4\uff08Read Committed\uff09\u00a0\u6216\u4ee5\u4e0a\u7684\u57fa\u7840\u4e0a\uff0cSeata\uff08AT \u6a21\u5f0f\uff09\u7684\u9ed8\u8ba4\u5168\u5c40\u9694\u79bb\u7ea7\u522b\u662f\u00a0\u8bfb\u672a\u63d0\u4ea4\uff08Read Uncommitted\uff09\u00a0\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2_21","title":"2. \u5177\u4f53\u8fc7\u7a0b","text":"<p>\u4e00\u9636\u6bb5\uff1a 1. \u89e3\u6790 SQL\uff1a\u5f97\u5230 SQL \u7684\u7c7b\u578b\uff08UPDATE\uff09\uff0c\u8868\uff08product\uff09\uff0c\u6761\u4ef6\uff08where name = 'TXC'\uff09\u7b49\u76f8\u5173\u7684\u4fe1\u606f\u3002 2.  \u67e5\u8be2\u524d\u955c\u50cf\uff1a\u6839\u636e\u89e3\u6790\u5f97\u5230\u7684\u6761\u4ef6\u4fe1\u606f\uff0c\u751f\u6210\u67e5\u8be2\u8bed\u53e5\uff0c\u5b9a\u4f4d\u6570\u636e\u3002 3. \u6267\u884c\u4e1a\u52a1 SQL\uff1a\u66f4\u65b0\u8fd9\u6761\u8bb0\u5f55\u7684 name \u4e3a 'GTS'\u3002 4. \u67e5\u8be2\u540e\u955c\u50cf\uff1a\u6839\u636e\u524d\u955c\u50cf\u7684\u7ed3\u679c\uff0c\u901a\u8fc7\u00a0\u4e3b\u952e\u00a0\u5b9a\u4f4d\u6570\u636e\u3002 5. \u63d2\u5165\u56de\u6eda\u65e5\u5fd7\uff1a\u628a\u524d\u540e\u955c\u50cf\u6570\u636e\u4ee5\u53ca\u4e1a\u52a1 SQL \u76f8\u5173\u7684\u4fe1\u606f\u7ec4\u6210\u4e00\u6761\u56de\u6eda\u65e5\u5fd7\u8bb0\u5f55\uff0c\u63d2\u5165\u5230\u00a0<code>UNDO_LOG</code>\u00a0\u8868\u4e2d\u3002 6. \u63d0\u4ea4\u524d\uff0c\u5411 TC \u6ce8\u518c\u5206\u652f\uff1a\u7533\u8bf7\u00a0<code>product</code>\u00a0\u8868\u4e2d\uff0c\u4e3b\u952e\u503c\u7b49\u4e8e 1 \u7684\u8bb0\u5f55\u7684\u00a0\u5168\u5c40\u9501\u00a0\u3002 7. \u672c\u5730\u4e8b\u52a1\u63d0\u4ea4\uff1a\u4e1a\u52a1\u6570\u636e\u7684\u66f4\u65b0\u548c\u524d\u9762\u6b65\u9aa4\u4e2d\u751f\u6210\u7684 UNDO LOG \u4e00\u5e76\u63d0\u4ea4\u3002 8. \u5c06\u672c\u5730\u4e8b\u52a1\u63d0\u4ea4\u7684\u7ed3\u679c\u4e0a\u62a5\u7ed9 TC\u3002</p> <p>\u4e8c\u9636\u6bb5\u56de\u6eda\uff1a 1. \u6536\u5230 TC \u7684\u5206\u652f\u56de\u6eda\u8bf7\u6c42\uff0c\u5f00\u542f\u4e00\u4e2a\u672c\u5730\u4e8b\u52a1\uff0c\u6267\u884c\u5982\u4e0b\u64cd\u4f5c\u3002 2. \u901a\u8fc7 XID \u548c Branch ID \u67e5\u627e\u5230\u76f8\u5e94\u7684 UNDO LOG \u8bb0\u5f55\u3002 3. \u6570\u636e\u6821\u9a8c\uff1a\u62ff UNDO LOG \u4e2d\u7684\u540e\u955c\u4e0e\u5f53\u524d\u6570\u636e\u8fdb\u884c\u6bd4\u8f83\uff0c\u5982\u679c\u6709\u4e0d\u540c\uff0c\u8bf4\u660e\u6570\u636e\u88ab\u5f53\u524d\u5168\u5c40\u4e8b\u52a1\u4e4b\u5916\u7684\u52a8\u4f5c\u505a\u4e86\u4fee\u6539\u3002\u8fd9\u79cd\u60c5\u51b5\uff0c\u9700\u8981\u6839\u636e\u914d\u7f6e\u7b56\u7565\u6765\u505a\u5904\u7406\uff0c\u8be6\u7ec6\u7684\u8bf4\u660e\u5728\u53e6\u5916\u7684\u6587\u6863\u4e2d\u4ecb\u7ecd\u3002 4. \u6839\u636e UNDO LOG \u4e2d\u7684\u524d\u955c\u50cf\u548c\u4e1a\u52a1 SQL \u7684\u76f8\u5173\u4fe1\u606f\u751f\u6210\u5e76\u6267\u884c\u56de\u6eda\u7684\u8bed\u53e5\uff1a</p> <p>\u4e8c\u9636\u6bb5\u63d0\u4ea4\uff1a 1. \u6536\u5230 TC \u7684\u5206\u652f\u63d0\u4ea4\u8bf7\u6c42\uff0c\u628a\u8bf7\u6c42\u653e\u5165\u4e00\u4e2a\u5f02\u6b65\u4efb\u52a1\u7684\u961f\u5217\u4e2d\uff0c\u9a6c\u4e0a\u8fd4\u56de\u63d0\u4ea4\u6210\u529f\u7684\u7ed3\u679c\u7ed9 TC\u3002 2. \u5f02\u6b65\u4efb\u52a1\u9636\u6bb5\u7684\u5206\u652f\u63d0\u4ea4\u8bf7\u6c42\u5c06\u5f02\u6b65\u548c\u6279\u91cf\u5730\u5220\u9664\u76f8\u5e94 UNDO LOG \u8bb0\u5f55\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#3_14","title":"3. \u4f18\u7f3a\u70b9","text":"<p>1\uff09\u4e00\u9636\u6bb5\u76f4\u63a5\u63d0\u4ea4\u4e8b\u52a1\uff0c\u7136\u540e\u91ca\u653e\u8d44\u6e90\uff0c\u6027\u80fd\u6bd4 XA \u6a21\u5f0f\u597d 2\uff09\u5229\u7528\u5168\u5c40\u9501\u5b9e\u73b0\u4e86\u8bfb\u5199\u9694\u79bb\uff0c\u907f\u514d\u4e86\u810f\u5199\u95ee\u9898 3\uff09\u6ca1\u6709\u4ee3\u7801\u5165\u4fb5\uff0c\u6846\u67b6\u81ea\u52a8\u5b8c\u6210\u56de\u6eda\u548c\u63d0\u4ea4</p> <p>1\uff09\u4e24\u9636\u6bb5\u4e4b\u95f4\u5c5e\u4e8e\u8f6f\u72b6\u6001\uff0c\u4e5f\u5c31\u662f\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u4e00\u81f4\u6027\u662f\u6700\u7ec8\u624d\u5b9e\u73b0\u7684, \u5b58\u5728\u77ed\u6682\u7684\u6570\u636e\u4e0d\u4e00\u81f4\u6027. 2\uff09\u6846\u67b6\u7684\u5feb\u7167\u4f1a\u5f71\u54cd\u6027\u80fd\uff0c\u4f46\u6bd4 XA \u6a21\u5f0f\u8981\u597d.</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#44-seata-docker","title":"4.4 Seata \u90e8\u7f72\uff08docker)","text":"<ol> <li> <p>\u521d\u59cb\u5316 Seata \u6570\u636e\u5e93 <pre><code>-- 1. \u6267\u884c\u8bed\u53e5\u521b\u5efa\u540d\u4e3a seata \u7684\u6570\u636e\u5e93\nCREATE DATABASE seata DEFAULT CHARACTER SET utf8mb4 DEFAULT COLLATE utf8mb4_general_ci;\n\n-- 2.\u6267\u884c\u811a\u672c\u5b8c\u6210 Seata \u8868\u7ed3\u6784\u7684\u521b\u5efa\nuse seata;\n\n-- the table to store GlobalSession data\nCREATE TABLE IF NOT EXISTS `global_table`\n(\n    `xid`                       VARCHAR(128) NOT NULL,\n    `transaction_id`            BIGINT,\n    `status`                    TINYINT      NOT NULL,\n    `application_id`            VARCHAR(32),\n    `transaction_service_group` VARCHAR(32),\n    `transaction_name`          VARCHAR(128),\n    `timeout`                   INT,\n    `begin_time`                BIGINT,\n    `application_data`          VARCHAR(2000),\n    `gmt_create`                DATETIME,\n    `gmt_modified`              DATETIME,\n    PRIMARY KEY (`xid`),\n    KEY `idx_status_gmt_modified` (`status` , `gmt_modified`),\n    KEY `idx_transaction_id` (`transaction_id`)\n) ENGINE = InnoDB\n  DEFAULT CHARSET = utf8mb4;\n\n-- the table to store BranchSession data\nCREATE TABLE IF NOT EXISTS `branch_table`\n(\n    `branch_id`         BIGINT       NOT NULL,\n    `xid`               VARCHAR(128) NOT NULL,\n    `transaction_id`    BIGINT,\n    `resource_group_id` VARCHAR(32),\n    `resource_id`       VARCHAR(256),\n    `branch_type`       VARCHAR(8),\n    `status`            TINYINT,\n    `client_id`         VARCHAR(64),\n    `application_data`  VARCHAR(2000),\n    `gmt_create`        DATETIME(6),\n    `gmt_modified`      DATETIME(6),\n    PRIMARY KEY (`branch_id`),\n    KEY `idx_xid` (`xid`)\n) ENGINE = InnoDB\n  DEFAULT CHARSET = utf8mb4;\n\n-- the table to store lock data\nCREATE TABLE IF NOT EXISTS `lock_table`\n(\n    `row_key`        VARCHAR(128) NOT NULL,\n    `xid`            VARCHAR(128),\n    `transaction_id` BIGINT,\n    `branch_id`      BIGINT       NOT NULL,\n    `resource_id`    VARCHAR(256),\n    `table_name`     VARCHAR(32),\n    `pk`             VARCHAR(36),\n    `status`         TINYINT      NOT NULL DEFAULT '0' COMMENT '0:locked ,1:rollbacking',\n    `gmt_create`     DATETIME,\n    `gmt_modified`   DATETIME,\n    PRIMARY KEY (`row_key`),\n    KEY `idx_status` (`status`),\n    KEY `idx_branch_id` (`branch_id`),\n    KEY `idx_xid_and_branch_id` (`xid` , `branch_id`)\n) ENGINE = InnoDB\n  DEFAULT CHARSET = utf8mb4;\n\nCREATE TABLE IF NOT EXISTS `distributed_lock`\n(\n    `lock_key`       CHAR(20) NOT NULL,\n    `lock_value`     VARCHAR(20) NOT NULL,\n    `expire`         BIGINT,\n    primary key (`lock_key`)\n) ENGINE = InnoDB\n  DEFAULT CHARSET = utf8mb4;\n\nINSERT INTO `distributed_lock` (lock_key, lock_value, expire) VALUES ('AsyncCommitting', ' ', 0);\nINSERT INTO `distributed_lock` (lock_key, lock_value, expire) VALUES ('RetryCommitting', ' ', 0);\nINSERT INTO `distributed_lock` (lock_key, lock_value, expire) VALUES ('RetryRollbacking', ' ', 0);\nINSERT INTO `distributed_lock` (lock_key, lock_value, expire) VALUES ('TxTimeoutCheck', ' ', 0);\n</code></pre></p> </li> <li> <p>\u5728 Nacos \u9ed8\u8ba4\u7684 public \u547d\u540d\u7a7a\u95f4\u4e0b \uff0c\u65b0\u5efa\u914d\u7f6e Data ID \u4e3a seata-server.properties \uff0cGroup \u4e3a DEFAULT_GROUP \u7684\u914d\u7f6e\uff0c\u83b7\u53d6Seata \u914d\u7f6e\u5728\u7ebf\u5730\u5740\uff1a\u5b98\u65b9\u914d\u7f6e \u4ec5\u9700\u4fee\u5b58\u50a8\u6a21\u5f0f\u4e3adb\u4ee5\u53ca\u5bf9\u5e94\u7684db\u8fde\u63a5\u914d\u7f6e</p> </li> </ol> <pre><code>#For details about configuration items, see https://seata.io/zh-cn/docs/user/configurations.html\n#Transport configuration, for client and server\ntransport.type=TCP\ntransport.server=NIO\ntransport.heartbeat=true\ntransport.enableTmClientBatchSendRequest=false\ntransport.enableRmClientBatchSendRequest=true\ntransport.enableTcServerBatchSendResponse=false\ntransport.rpcRmRequestTimeout=30000\ntransport.rpcTmRequestTimeout=30000\ntransport.rpcTcRequestTimeout=30000\ntransport.threadFactory.bossThreadPrefix=NettyBoss\ntransport.threadFactory.workerThreadPrefix=NettyServerNIOWorker\ntransport.threadFactory.serverExecutorThreadPrefix=NettyServerBizHandler\ntransport.threadFactory.shareBossWorker=false\ntransport.threadFactory.clientSelectorThreadPrefix=NettyClientSelector\ntransport.threadFactory.clientSelectorThreadSize=1\ntransport.threadFactory.clientWorkerThreadPrefix=NettyClientWorkerThread\ntransport.threadFactory.bossThreadSize=1\ntransport.threadFactory.workerThreadSize=default\ntransport.shutdown.wait=3\ntransport.serialization=seata\ntransport.compressor=none\n\n#Transaction routing rules configuration, only for the client\nservice.vgroupMapping.default_tx_group=default\n#If you use a registry, you can ignore it\nservice.default.grouplist=127.0.0.1:8091\nservice.enableDegrade=false\nservice.disableGlobalTransaction=false\n\n#Transaction rule configuration, only for the client\nclient.rm.asyncCommitBufferLimit=10000\nclient.rm.lock.retryInterval=10\nclient.rm.lock.retryTimes=30\nclient.rm.lock.retryPolicyBranchRollbackOnConflict=true\nclient.rm.reportRetryCount=5\nclient.rm.tableMetaCheckEnable=true\nclient.rm.tableMetaCheckerInterval=60000\nclient.rm.sqlParserType=druid\nclient.rm.reportSuccessEnable=false\nclient.rm.sagaBranchRegisterEnable=false\nclient.rm.sagaJsonParser=fastjson\nclient.rm.tccActionInterceptorOrder=-2147482648\nclient.tm.commitRetryCount=5\nclient.tm.rollbackRetryCount=5\nclient.tm.defaultGlobalTransactionTimeout=60000\nclient.tm.degradeCheck=false\nclient.tm.degradeCheckAllowTimes=10\nclient.tm.degradeCheckPeriod=2000\nclient.tm.interceptorOrder=-2147482648\nclient.undo.dataValidation=true\nclient.undo.logSerialization=jackson\nclient.undo.onlyCareUpdateColumns=true\nserver.undo.logSaveDays=7\nserver.undo.logDeletePeriod=86400000\nclient.undo.logTable=undo_log\nclient.undo.compress.enable=true\nclient.undo.compress.type=zip\nclient.undo.compress.threshold=64k\n#For TCC transaction mode\ntcc.fence.logTableName=tcc_fence_log\ntcc.fence.cleanPeriod=1h\n\n#Log rule configuration, for client and server\nlog.exceptionRate=100\n\n#Transaction storage configuration, only for the server. The file, DB, and redis configuration values are optional.\nstore.mode=db\nstore.lock.mode=db\nstore.session.mode=db\n#Used for password encryption\nstore.publicKey=\n\n#If `store.mode,store.lock.mode,store.session.mode` are not equal to `file`, you can remove the configuration block.\nstore.file.dir=file_store/data\nstore.file.maxBranchSessionSize=16384\nstore.file.maxGlobalSessionSize=512\nstore.file.fileWriteBufferCacheSize=16384\nstore.file.flushDiskMode=async\nstore.file.sessionReloadReadSize=100\n\n#These configurations are required if the `store mode` is `db`. If `store.mode,store.lock.mode,store.session.mode` are not equal to `db`, you can remove the configuration block.\nstore.db.datasource=druid\nstore.db.dbType=mysql\nstore.db.driverClassName=com.mysql.jdbc.Driver\nstore.db.url=jdbc:mysql://127.0.0.1:3306/seata?useUnicode=true&amp;rewriteBatchedStatements=true\nstore.db.user=root\nstore.db.password=liuqiang\nstore.db.minConn=5\nstore.db.maxConn=30\nstore.db.globalTable=global_table\nstore.db.branchTable=branch_table\nstore.db.distributedLockTable=distributed_lock\nstore.db.queryLimit=100\nstore.db.lockTable=lock_table\nstore.db.maxWait=5000\n\n#These configurations are required if the `store mode` is `redis`. If `store.mode,store.lock.mode,store.session.mode` are not equal to `redis`, you can remove the configuration block.\nstore.redis.mode=single\nstore.redis.single.host=127.0.0.1\nstore.redis.single.port=6379\nstore.redis.sentinel.masterName=\nstore.redis.sentinel.sentinelHosts=\nstore.redis.maxConn=10\nstore.redis.minConn=1\nstore.redis.maxTotal=100\nstore.redis.database=0\nstore.redis.password=\nstore.redis.queryLimit=100\n\n#Transaction rule configuration, only for the server\nserver.recovery.committingRetryPeriod=1000\nserver.recovery.asynCommittingRetryPeriod=1000\nserver.recovery.rollbackingRetryPeriod=1000\nserver.recovery.timeoutRetryPeriod=1000\nserver.maxCommitRetryTimeout=-1\nserver.maxRollbackRetryTimeout=-1\nserver.rollbackRetryTimeoutUnlockEnable=false\nserver.distributedLockExpireTime=10000\nserver.xaerNotaRetryTimeout=60000\nserver.session.branchAsyncQueueSize=5000\nserver.session.enableBranchAsyncRemove=false\nserver.enableParallelRequestHandle=false\n\n#Metrics configuration, only for the server\nmetrics.enabled=false\nmetrics.registryType=compact\nmetrics.exporterList=prometheus\nmetrics.exporterPrometheusPort=9898\n</code></pre> <ul> <li>store.mode=db \u5b58\u50a8\u6a21\u5f0f\u9009\u62e9\u4e3a\u6570\u636e\u5e93</li> <li>192.168.200.6 MySQL\u4e3b\u673a\u5730\u5740</li> <li>store.db.user=root \u6570\u636e\u5e93\u7528\u6237\u540d</li> <li> <p>store.db.password=root \u6570\u636e\u5e93\u5bc6\u7801</p> </li> <li> <p>\u83b7\u53d6 seata \u914d\u7f6e <pre><code>// 1. \u521b\u5efa\u4e34\u65f6\u5bb9\u5668\ndocker run -d --name seata-server -p 8091:8091 -p 7091:7091 seataio/seata-server:1.7.0\n\n// 2. \u521b\u5efa\u6587\u4ef6\u5939\u4e3a\u5bb9\u5668\u6302\u8f7d\u76ee\u5f55\nmkdir -p /mydata/seata/config\n\n\n// 3. \u8d4b\u503c\u5bb9\u5668\u914d\u65e5\u5fd7\u5230\u5bbf\u4e3b\u673a\ndocker cp seata-server:/seata-server/resources/ /mydata/seata/config\n\n// 4.\u5220\u9664\u4e34\u65f6\u5bb9\u5668\n// docker rm -f seata-server\n</code></pre></p> </li> <li> <p>\u4fee\u6539\u914d\u7f6e</p> </li> </ul> <p>\u5728\u83b7\u53d6\u5230 seata-server \u7684\u5e94\u7528\u914d\u7f6e\u4e4b\u540e\uff0c\u56e0\u4e3a\u8fd9\u91cc\u91c7\u7528 Nacos \u4f5c\u4e3a seata \u7684\u914d\u7f6e\u4e2d\u5fc3\u548c\u6ce8\u518c\u4e2d\u5fc3\uff0c\u6240\u4ee5\u9700\u8981\u4fee\u6539 application.yml \u91cc\u7684\u914d\u7f6e\u4e2d\u5fc3\u548c\u6ce8\u518c\u4e2d\u5fc3\u5730\u5740\uff0c\u8be6\u7ec6\u914d\u7f6e\u6211\u4eec\u53ef\u4ee5\u4ece application.example.yml \u62ff\u5230\u3002</p> <pre><code>server:\n  port: 7091\nseata:\n  config:\n    type: nacos\n    nacos:\n      server-addr: 192.168.200.6:8848\n      namespace:\n      group: DEFAULT_GROUP\n      data-id: seata-server.properties\n  security:\n    secretKey: SeataSecretKey0c382ef121d778043159209298fd40bf3850a017\n    tokenValidityInMilliseconds: 1800000\n  registry:\n    type: nacos\n    nacos:\n      application: seata-server  \n      server-addr: 192.168.200.6:8848\n      namespace:\n      group: DEFAULT_GROUP\n      cluster: default\nconsole:\n  user:\n    username: seata\n    password: seata\nlogging:\n  config: classpath:logback-spring.xml\n  file:\n    path: /mydata/seata/logs\n</code></pre> <ul> <li>namespace nacos\u547d\u540d\u7a7a\u95f4id\uff0c\u4e0d\u586b\u9ed8\u8ba4\u662fpublic\u547d\u540d\u7a7a\u95f4</li> <li>data-id: seataServer.properties Seata\u5916\u7f6e\u6587\u4ef6\u6240\u5904Naocs\u7684Data ID\uff0c\u53c2\u8003\u4e0a\u5c0f\u8282\u7684 \u5bfc\u5165\u914d\u7f6e\u81f3 Nacos</li> <li>group: SEATA_GROUP \u6307\u5b9a\u6ce8\u518c\u81f3nacos\u6ce8\u518c\u4e2d\u5fc3\u7684\u5206\u7ec4\u540d</li> <li> <p>cluster: default \u6307\u5b9a\u6ce8\u518c\u81f3nacos\u6ce8\u518c\u4e2d\u5fc3\u7684\u96c6\u7fa4\u540d</p> </li> <li> <p>\u542f\u52a8 <pre><code>docker run -d --name seata-server --restart=always  -p 8091:8091 -p 7091:7091 -e SEATA_IP=192.168.200.6 -v /mydata/seata/config/resources:/seata-server/resources seataio/seata-server:1.7.0\n</code></pre></p> </li> </ul>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#45-seata-windows","title":"4.5 Seata \u90e8\u7f72\uff08windows)","text":"<pre><code>\u5728\u672c\u5730\u90e8\u7f72 seata \u65f6\uff0c\u6ce8\u610f\uff1a\u9ed8\u8ba4\u5411nacos\u6ce8\u518c\u65f6\u4e0a\u4f20\u7684\u662f\u4e00\u4e2a\u4e34\u65f6\u7684\u516c\u7f51ip\u5730\u5740\uff0c\u4e4b\u540e\u5fae\u670d\u52a1\u4ecenacos\u4e0b\u62c9seata\u5b9e\u4f8b\u65f6\u5019\u5c31\u4f1a\u901a\u8fc7\u8fd9\u4e2a\u9519\u8bef\u7684 ip \u53bb\u8bbf\u95eeseata\uff0c\u4ece\u800c\u5bfc\u81f4\u8bbf\u95ee\u4e0d\u5230\uff0c\u56e0\u6b64\uff0c\u6211\u4eec\u8981\u624b\u52a8\u6307\u5b9a seata \u6ce8\u518c\u5230 nacos \u7684 ip \u5730\u5740\uff08\u73af\u56de\u5730\u5740\uff09\nseata-server.bat -Dseata.service.host-address=127.0.0.1\n</code></pre>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#46-seata","title":"4.6 \u96c6\u6210 Seata","text":"<ol> <li>\u5982\u679c\u662f TA \u6a21\u5f0f\uff0c\u9700\u8981\u5728\u96c6\u6210 seata \u7684\u670d\u52a1\u7684\u6570\u636e\u6e90\u521b\u5efa\u4e00\u4e2a undo_log \u8868 <pre><code>/*\n Navicat Premium Data Transfer\n\n Source Server         : local\n Source Server Type    : MySQL\n Source Server Version : 50622\n Source Host           : localhost:3306\n Source Schema         : seata_demo\n\n Target Server Type    : MySQL\n Target Server Version : 50622\n File Encoding         : 65001\n\n Date: 20/06/2021 12:39:03\n*/\n\nSET NAMES utf8mb4;\nSET FOREIGN_KEY_CHECKS = 0;\n\n-- ----------------------------\n-- Table structure for undo_log\n-- ----------------------------\nDROP TABLE IF EXISTS `undo_log`;\n-- \u6ce8\u610f\u6b64\u59040.3.0+ \u589e\u52a0\u552f\u4e00\u7d22\u5f15 ux_undo_log\nCREATE TABLE `undo_log` (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT,\n  `branch_id` bigint(20) NOT NULL,\n  `xid` varchar(100) NOT NULL,\n  `context` varchar(128) NOT NULL,\n  `rollback_info` longblob NOT NULL,\n  `log_status` int(11) NOT NULL,\n  `log_created` datetime NOT NULL,\n  `log_modified` datetime NOT NULL,\n  `ext` varchar(100) DEFAULT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `ux_undo_log` (`xid`,`branch_id`)\n) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;\n\n-- ----------------------------\n-- Records of undo_log\n-- ----------------------------\n\n\nSET FOREIGN_KEY_CHECKS = 1;\n</code></pre></li> <li>\u5bfc\u5165\u4f9d\u8d56 <pre><code>    &lt;!--seata--&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-cloud-starter-alibaba-seata&lt;/artifactId&gt;\n        &lt;!-- \u9ed8\u8ba4seata\u5ba2\u6237\u7aef\u7248\u672c\u6bd4\u8f83\u4f4e\uff0c\u6392\u9664\u540e\u91cd\u65b0\u5f15\u5165\u6307\u5b9a\u7248\u672c--&gt;\n        &lt;exclusions&gt;\n            &lt;exclusion&gt;\n                &lt;groupId&gt;io.seata&lt;/groupId&gt;\n                &lt;artifactId&gt;seata-spring-boot-starter&lt;/artifactId&gt;\n            &lt;/exclusion&gt;\n        &lt;/exclusions&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;io.seata&lt;/groupId&gt;\n        &lt;artifactId&gt;seata-spring-boot-starter&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n</code></pre></li> <li>\u7136\u540e\u53bb\u5199\u914d\u7f6e\u6587\u4ef6\u5373\u53ef nacos \u4f5c\u4e3a\u6ce8\u518c\u4e2d\u5fc3 <pre><code>seata:\n  enabled: true\n  tx-service-group: ${spring.application.name}-group # \u4e8b\u52a1\u7ec4\u540d\u79f0\n  service:\n    vgroup-mapping:\n      #\u6307\u5b9a\u4e8b\u52a1\u5206\u7ec4\u81f3\u96c6\u7fa4\u6620\u5c04\u5173\u7cfb\uff0c\u96c6\u7fa4\u540ddefault\u9700\u8981\u4e0eseata-server\u6ce8\u518c\u5230Nacos\u7684cluster\u4fdd\u6301\u4e00\u81f4\n      order-service-group: default\n  registry:\n    type: nacos # \u4f7f\u7528nacos\u4f5c\u4e3a\u6ce8\u518c\u4e2d\u5fc3\n    nacos:\n      server-addr: 192.168.200.6:8848 # nacos\u670d\u52a1\u5730\u5740\n      group: DEFAULT_GROUP # \u9ed8\u8ba4\u670d\u52a1\u5206\u7ec4\n      namespace: \"\" # \u9ed8\u8ba4\u547d\u540d\u7a7a\u95f4\n      cluster: default # \u9ed8\u8ba4TC\u96c6\u7fa4\u540d\u79f0\n</code></pre></li> </ol> <p>\u76f4\u63a5\u8bbf\u95ee seata <pre><code>seata: \n  enabled: true\n  application-id: ${spring.application.name}\n  tx-service-group: default_tx_group # \u52a1\u5fc5\u4e0e properties \u4e2d\u7684\u5206\u7ec4\u540d\u5bf9\u5e94\n\n  # 1. \u5173\u952e\uff1a\u5c06\u6ce8\u518c\u4e2d\u5fc3\u6539\u4e3a file\uff0c\u8fd9\u6837\u5b83\u5c31\u4e0d\u4f1a\u53bb Nacos \u627e Seata \u5730\u5740\u4e86\n  registry:\n    type: file\n\n  # 2. \u5173\u952e\uff1a\u76f4\u63a5\u786c\u7f16\u7801 Seata Server \u7684\u5730\u5740\n  service:\n    vgroup-mapping:\n      default_tx_group: default\n    grouplist:\n      default: 127.0.0.1:8091  # \u8fd9\u91cc\u76f4\u63a5\u6307\u5411\u4f60\u672c\u5730\u542f\u52a8\u7684 Seata \u7aef\u53e3\n</code></pre></p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#47","title":"4.7 \u603b\u7ed3","text":"<p>\u4f7f\u7528 seata \u5b9e\u9645\u5f88\u7b80\u5355 1\u3001\u9996\u5148\u5148\u90e8\u7f72\u4e00\u4e2a seata\uff0c\u53ef\u4ee5\u662f windows\uff0c\u4e5f\u53ef\u4ee5\u662f docker 2\u3001\u53bb\u5199 seata \u7684\u914d\u7f6e\uff0c\u4e3b\u8981\u662f\u50a8\u5b58\u6a21\u5f0f\uff0c\u6570\u636e\u5e93\u7684\u8fde\u63a5url\u4ee5\u53ca\u8d26\u6237\u548c\u5bc6\u7801 2\u3001\u5982\u679c\u662f TA \u6a21\u5f0f\uff08\u9ed8\u8ba4\u6a21\u5f0f\uff09\uff0c\u5219\u521b\u5efa\u4e00\u4e2a undo_log \u8868\u5728\u5f53\u524d\u670d\u52a1\u7684\u6570\u636e\u5e93\u4e0b 3\u3001\u5bfc\u5165\u4f9d\u8d56 4\u3001\u53bb\u5199\u914d\u7f6e\uff0c\u4ece\u800c\u8ba9\u5f53\u524d\u5fae\u670d\u52a1\u8fde\u63a5\u5230seata\u3002 5\u3001\u6700\u540e\uff0c\u5728\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u5165\u53e3\u52a0\u4e0a\u6ce8\u89e3\uff1a@GloableTransactional \u5373\u53ef\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#5_7","title":"5. \u5168\u5c40\u9501","text":"<p>\u5982\u679c\u6ca1\u6709\u5168\u5c40\u9501,\u4f1a\u5b58\u5728\u810f\u5199\u95ee\u9898.</p> <p>![[Springboot/imgs/image-3 2.png]]</p> <p>Seata\u89e3\u51b3\u601d\u8def\u5c31\u662f\u5f15\u5165\u4e86\u5168\u5c40\u9501\u7684\u6982\u5ff5\u3002\u5728\u91ca\u653eDB\u9501\u4e4b\u524d\uff08\u63d0\u4ea4\u672c\u5730\u4e8b\u52a1\u524d\uff09\uff0c\u5148\u62ff\u5230\u5168\u5c40\u9501\u3002\u907f\u514d\u540c\u4e00\u65f6\u523b\u6709\u53e6\u5916\u4e00\u4e2a\u4e8b\u52a1\u6765\u64cd\u4f5c\u5f53\u524d\u6570\u636e\u3002 \u5168\u5c40\u9501\u7684\u6301\u6709\u65f6\u95f4\u662f\u4e00\u76f4\u5230\u4e8c\u9636\u6bb5\u7ed3\u675f, \u9700\u8981\u6ce8\u610f:\u5f53\u6211\u4eec\u7684\u4e8b\u52a1 A \u9700\u8981\u56de\u6eda\u65f6, \u5fc5\u987b\u8981\u62ff\u5230\u672c\u5730\u9501,\u4f46\u6b64\u65f6\u672c\u5730\u9501\u88ab\u4e8b\u52a12\u5360\u6709,\u4f46\u7531\u4e8e\u4e8b\u52a12\u62ff\u4e0d\u5230\u5168\u5c40\u9501,\u6240\u4ee5\u5728\u5c1d\u8bd5\u4e00\u5b9a\u6b21\u6570\u540e,\u5c31\u4f1a\u91ca\u653e\u672c\u5730\u9501,\u7136\u540e\u56de\u6eda.</p> <p>![[Springboot/imgs/image-4 2.png]]</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#6_2","title":"6. \u5168\u5c40\u4e8b\u52a1\u7684\u8fb9\u754c\u9009\u62e9","text":"<p>\u6211\u4eec\u53ef\u4ee5\u9009\u62e9\u5728\u4e00\u4e2a\u5168\u5c40\u4e8b\u52a1\u4e0b,\u5f53\u51fa\u73b0\u5f02\u5e38\u65f6,\u54ea\u4e9b\u5206\u652f\u4e8b\u52a1\u9700\u8981\u56de\u6eda,\u54ea\u4e9b\u4e0d\u9700\u8981\u56de\u6eda,\u56e0\u4e3a\u5728\u67d0\u4e9b\u573a\u666f\u4e0b\u4e0d\u9700\u8981\u4e00\u80a1\u8111\u5168\u90e8\u90fd\u56de\u6eda.</p> <p>\u89e3\u51b3\u65b9\u5f0f: \u5c06\u9700\u8981\u4e00\u8d77\u56de\u6eda\u7684\u5206\u652f\u4e8b\u52a1\u901a\u8fc7seata\u7684 @GlobleTransactional \u6765\u7ba1\u7406,\u6ce8\u610f,\u5982\u679c\u662f\u5728\u5176\u4ed6\u65b9\u6cd5\u5185\u90e8,\u5219\u9700\u8981\u628a\u8fd9\u4e2a\u5168\u5c40\u4e8b\u52a1\u62bd\u6210\u4e00\u4e2a\u5355\u72ec\u7684\u7c7b\u4e0b\u9762\u7684\u65b9\u6cd5,\u8fd9\u6837\u624d\u80fd\u4ea7\u751f\u4ee3\u7406\u5bf9\u8c61.</p> <p>![[Springboot/imgs/image-5 1.png]]</p> <p>\u5982\u679c\u6b64\u65f6\u6211\u4eec\u4e0d\u5e0c\u671b\u6263\u51cf\u4f59\u989d\u5931\u8d25\u5c31\u53bb\u56de\u6eda\u6211\u4eec\u7684\u4fdd\u5b58\u8ba2\u5355\u4e1a\u52a1,\u90a3\u4e48\u5c31\u53ef\u4ee5\u5c06\u5728 submitOrder \u65b9\u6cd5\u4e0b\u7684 \u8fdc\u7a0b\u8c03\u7528<code>\u6263\u51cf\u4f59\u989d</code>\u4ee5\u53ca<code>\u53d1\u653e\u5546\u54c1\u6743\u76ca</code> \u8fd9\u4e24\u6bb5\u4ee3\u7801\u903b\u8f91\u62bd\u53d6\u5230\u4e00\u4e2a\u65b0\u7684\u7c7b\u4e0b\u7684\u65b0\u7684\u65b9\u6cd5,\u7136\u540e,\u53bb\u5728\u8fd9\u4e2a\u65b9\u6cd5\u4e0b\u901a\u8fc7\u6ce8\u89e3 @GlobleTransactional.... \u6765\u63a7\u5236\u6263\u51cf\u4f59\u989d\u4ee5\u53ca\u65b9\u6cd5\u6743\u76ca\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1 </p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#7_2","title":"7. \u672c\u5730\u4e8b\u52a1\u5931\u6548\u7684\u5e38\u89c1\u573a\u666f","text":"<ol> <li> <p>@Transactional \u6807\u6ce8\u4e86\u4e00\u4e2a private| static| final... \u4fee\u9970\u7684\u65b9\u6cd5\uff1a\u56e0\u4e3a\u4e8b\u52a1\u80fd\u751f\u6548\u7684\u672c\u8d28\u662f\u4ea7\u751f\u4e86\u4e2a\u4ee3\u7406\u5bf9\u8c61\uff0c\u7136\u540e\u901a\u8fc7\u4ee3\u7406\u5bf9\u8c61\u53bb\u8c03\u7528\u8fd9\u4e2a\u76ee\u6807\u5730\u65b9\uff0c\u4f46\u662f\u73b0\u5728\u76ee\u6807\u65b9\u6cd5\u79c1\u6709\uff0c\u6240\u4ee5\u4ee3\u7406\u5bf9\u8c61\u6ca1\u6cd5\u91cd\u5199\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u6240\u4ee5\u5c31\u5931\u6548\u4e86\u3002 <pre><code>@Transactional()\nprivate void a(){\n    // a\u8868\u64cd\u4f5c\n    // b\u8868\u64cd\u4f5c\n}\n</code></pre></p> </li> <li> <p>\u5f02\u5e38\u4ec5\u4ec5\u53ea\u662f\u88ab\u4f60\u81ea\u5df1\u6355\u83b7\u5e76\u6253\u5370\uff0c\u6ca1\u6709\u629b\u51fa\u53bb</p> </li> <li> <p>\u6ca1\u6709\u76f4\u63a5\u901a\u8fc7\u4ee3\u7406\u5bf9\u8c61\u53bb\u8c03\u7528\u65b9\u6cd5\uff0c\u800c\u662f\u901a\u8fc7\u76ee\u6807\u5bf9\u8c61\u76f4\u63a5\u8c03\u7528\u65b9\u6cd5\uff0c\u4e5f\u4f1a\u5bfc\u81f4\u4e8b\u52a1\u5931\u6548     <code>\u4e0b\u9762\u8fd9\u79cd\u60c5\u51b5\u53ef\u4ee5\u751f\u6548\uff0c\u56e0\u4e3a\u5b58\u5728\u4e8b\u52a1\u7684\u4f20\u64ad</code> <pre><code>@Transactional(rollback=Exception.class)\npublic void a(){\n    // a\u8868\u64cd\u4f5c\n    // b\u8868\u64cd\u4f5c \u901a\u8fc7this\u8c03\u7528\u4e86\u672c\u7c7b\u4e0b\u7684\u5176\u4ed6\u65b9\u6cd5\n    this.b()\n}\npublic void b(){\n    // b\u8868\u64cd\u4f5c\n}\n</code></pre></p> </li> </ol> <p><code>\u8fd9\u6837\u4e0d\u884c\uff0c\u4f20\u64ad\u4e5f\u6551\u4e0d\u4e86\uff0c\u56e0\u4e3a\u90fd\u6ca1\u8c03\u4ee3\u7406\u5bf9\u8c61</code> <pre><code>public void a(){\n    // a\u8868\u64cd\u4f5c\n    // b\u8868\u64cd\u4f5c \u901a\u8fc7this\u8c03\u7528\u4e86\u672c\u7c7b\u4e0b\u7684\u5176\u4ed6\u65b9\u6cd5\n    this.b()\n}\n@Transactional(rollback=Exception.class)\npublic void b(){\n    // b\u8868\u64cd\u4f5c\n}\n</code></pre></p> <ol> <li> <p>\u9009\u62e9\u7684\u6570\u636e\u5e93\u5f15\u64ce\u4e0d\u652f\u6301\u4e8b\u52a1\uff1aMyIsam...</p> </li> <li> <p>\u9ed8\u8ba4\u56de\u6eda\u7c7b\u578b\uff1aRuntimeException \u548c Error \u4e0d\u5339\u914d</p> </li> </ol>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#8","title":"8.  \u5206\u5e03\u5f0f\u4e8b\u52a1\u5931\u6548\u95ee\u9898","text":"<p>\u5982\u679c\u5728\u8fdc\u5904\u8c03\u7528\u4e4b\u540e\u6ca1\u624b\u52a8\u5224\u65ad\u4e1a\u52a1\u7801\uff0c\u5c31\u53ef\u80fd\u5bfc\u81f4\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u5931\u6548\uff0c\u56e0\u4e3a\u6211\u4eec\u7684\u8fdc\u7a0b\u8c03\u7528\u505a\u4e86\u964d\u7ea7\u5904\u7406\uff0c\u5373\u4f7f\u4e1a\u52a1\u5931\u8d25\uff0c\u4e5f\u4e0d\u4f1a\u629b\u51fa\u5f02\u5e38\uff0c\u800c\u662f\u76f4\u63a5\u8fd4\u56de\u964d\u7ea7\u8fd4\u56de\uff0c\u5982\u679c\u6211\u4eec\u6ca1\u6709\u624b\u52a8\u7684\u53bb\u5224\u65ad\u4e1a\u52a1\u72b6\u6001\u7801\u662f\u5426\u4e3a200\uff0c\u5c31\u4f1a\u51fa\u73b0\u8fdc\u7a0b\u8c03\u7528\u5931\u8d25\u4e86\uff0c\u4f46\u662f\u6211\u4eec\u7684TC\u6839\u672c\u4e0d\u77e5\u9053\u6709\u4e00\u4e2a\u5206\u652f\u4e8b\u52a1\u51fa\u73b0\u4e86\u5f02\u5e38\uff0c\u4ece\u800c\u5bfc\u81f4\u4e86\u6570\u636e\u7684\u4e0d\u4e00\u81f4\u6027.</p> <p>\u89e3\u51b3\u65b9\u6cd5:oa 1. \u6bcf\u6b21\u90fd\u5224\u65ad\u8fdc\u7a0b\u8c03\u7528\u7684\u7ed3\u679c\u662f\u5426\u6210\u529f,\u5931\u8d25\u624b\u52a8\u629b\u51fa\u5f02\u5e38 2. \u5229\u7528 AOP \u7684\u5f02\u5e38\u901a\u77e5,\u5bf9Service\u5c42\u53d1\u653e\u8fdb\u884c\u589e\u5f3a,\u5982\u679c\u68c0\u67e5\u51fa\u6709\u5f02\u5e38\u5e76\u4e14\u662f\u6211\u4eec\u5f53\u524d\u5168\u5c40\u4e8b\u52a1\u7684\u4e00\u4e2a\u5206\u652f\u4e8b\u52a1,\u5c31\u624b\u52a8\u7684\u53bb\u8c03\u7528\u5168\u5c40\u4e8b\u52a1\u7684\u56de\u6eda.</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#16-xxj-job","title":"16. Xxj-Job","text":""},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#1_25","title":"1. \u6982\u8ff0","text":"<p>XXL-JOB\u662f\u4e00\u4e2a\u5206\u5e03\u5f0f\u4efb\u52a1\u8c03\u5ea6\u5e73\u53f0\uff0c\u5176\u6838\u5fc3\u8bbe\u8ba1\u76ee\u6807\u662f\u5f00\u53d1\u8fc5\u901f\u3001\u5b66\u4e60\u7b80\u5355\u3001\u8f7b\u91cf\u7ea7\u3001\u6613\u6269\u5c55\u3002\u73b0\u5df2\u5f00\u653e\u6e90\u4ee3\u7801\u5e76\u63a5\u5165\u591a\u5bb6\u516c\u53f8\u7ebf\u4e0a\u4ea7\u54c1\u7ebf\uff0c\u5f00\u7bb1\u5373\u7528\u3002</p>"},{"location":"java/SpringBoot%20%2B%20git%20%2B%20Linux%20%2B%20Redis%20%2B%20Docker%20%2B%20RMQ/#2_22","title":"2. \u4f7f\u7528","text":"<p>\u5b98\u65b9\u6587\u6863\uff1aXxj-Job \u5f53\u8c03\u5ea6\u4e2d\u5fc3\u90e8\u7f72\u5b8c\u6210\u540e\uff0c\u53ef\u4ee5\u8bbf\u95eeweb\u7ba1\u7406\u9875\u9762</p>"},{"location":"java/ssm/","title":"ssm","text":"<p>Spring \uff1a\u4f01\u4e1a\u7ea7\u4e00\u7ad9\u5f0f\u6846\u67b6</p> <p></p>"},{"location":"java/ssm/#container","title":"\u4e00\u3001Container","text":""},{"location":"java/ssm/#1","title":"1. \u7ec4\u4ef6\u548c\u5bb9\u5668","text":"<p>\u200b   \u7ec4\u4ef6\uff1a\u5177\u6709\u4e00\u5b9a\u529f\u80fd\u7684\u5bf9\u8c61\uff0c\u7ec4\u4ef6\u7684\u4e09\u5927\u7279\u6027\uff1a(\u540d\u5b57\u3001\u7c7b\u578b)\u3001\u5bf9\u8c61\u3001\u4f5c\u7528\u57df\uff0c\u7ec4\u4ef6\u7684\u540d\u5b57\u662f\u5168\u5c40\u552f\u4e00\u7684\u3002\u5728Spring\u4e2d\uff0c\u7ec4\u4ef6\u7684\u521b\u5efa\u65f6\u673a\u662f\u5bb9\u5668\u542f\u52a8\u8fc7\u7a0b\u4e2d\uff0c\u5355\u5b9e\u4f8b\u7279\u6027\uff1a\u6bcf\u6b21\u83b7\u53d6\u76f4\u63a5\u62ff\u5c31\u5b8c\u4e8b\u4e86\u3002</p> <p>\u200b   \u5bb9\u5668\uff1a\u7ba1\u7406\u7ec4\u4ef6\uff08\u521b\u5efa\u3001\u83b7\u53d6\u3001\u4fdd\u5b58\u3001\u9500\u6bc1\uff09</p>"},{"location":"java/ssm/#2-ioc","title":"2. IOC \u63a7\u5236\u53cd\u8f6c","text":"<p>\u200b   IOC \u662f\u4e00\u79cd\u8bbe\u8ba1\u601d\u60f3\uff0c\u4e0d\u662f\u5177\u4f53\u7684\u6280\u672f\u3002\u5b83\u7684\u6838\u5fc3\u7406\u5ff5\u662f\uff1a\u5c06\u5bf9\u8c61\u7684\u521b\u5efa\u548c\u4f9d\u8d56\u7ba1\u7406\u4ea4\u7ed9\u5916\u90e8\u5bb9\u5668\u63a7\u5236\uff0c\u800c\u4e0d\u662f\u7531\u5bf9\u8c61\u81ea\u5df1\u63a7\u5236\u3002</p> <p>\u4f20\u7edf\u65b9\u5f0f\u4e0b\uff0c\u4e00\u4e2a\u5bf9\u8c61\u4e3b\u52a8\u53bb\u521b\u5efa\u5b83\u6240\u4f9d\u8d56\u7684\u5bf9\u8c61\uff1b \u800c\u5728 IOC \u6a21\u5f0f\u4e0b\uff0c\u5bf9\u8c61\u88ab\u52a8\u5730\u63a5\u6536\u4f9d\u8d56\u5bf9\u8c61\uff08\u7531\u5bb9\u5668\u63d0\u4f9b\uff09\u3002</p> <p>\u200b   \u201c\u63a7\u5236\u201d \u6307\u7684\u662f\u5bf9\u8c61\u4f9d\u8d56\u7684\u521b\u5efa\u4e0e\u7ba1\u7406\u3002\u201c\u53cd\u8f6c\u201d\u6307\u7684\u662f\u8fd9\u79cd\u63a7\u5236\u6743\u4ece\u7a0b\u5e8f\u5458\u624b\u4e2d\u53cd\u8f6c\u7ed9\u4e86\u5916\u90e8\u5bb9\u5668\uff08\u5982 Spring \u5bb9\u5668\uff09\u3002</p>"},{"location":"java/ssm/#3-di","title":"3. DI \u4f9d\u8d56\u6ce8\u5165","text":"<p>\u200b   DI \u662f\u5b9e\u73b0 IOC \u7684\u5177\u4f53\u624b\u6bb5\u3002 \u5373\uff1a\u5bb9\u5668\u5728\u8fd0\u884c\u65f6\u5c06\u5bf9\u8c61\u6240\u4f9d\u8d56\u7684\u5b9e\u4f8b\u201c\u6ce8\u5165\u201d\u8fdb\u53bb\u3002</p>"},{"location":"java/ssm/#4","title":"4. \u6ce8\u518c\u7ec4\u4ef6\u7684\u4e0d\u540c\u65b9\u6cd5","text":""},{"location":"java/ssm/#41-bean","title":"4.1 @Bean","text":""},{"location":"java/ssm/#1_1","title":"1. \u6982\u5ff5","text":"<p>\u200b   <code>@Bean</code> \u662f Spring \u4e2d\u7684\u4e00\u79cd \u663e\u5f0f\u6ce8\u518c Bean \u7684\u65b9\u5f0f\uff0c\u7528\u4e8e\u544a\u8bc9 IOC \u5bb9\u5668\uff1a\u201c\u6211\u8981\u624b\u52a8\u5b9a\u4e49\u5e76\u6ce8\u518c\u4e00\u4e2a\u7ec4\u4ef6\uff08Bean\uff09\u5230\u5bb9\u5668\u4e2d\u8fdb\u884c\u7ba1\u7406\u3002\u201d  \u6362\u53e5\u8bdd\u8bf4\uff0c\u4f7f\u7528 <code>@Bean</code> \u6807\u6ce8\u7684\u65b9\u6cd5\u4f1a\u7531 Spring \u8c03\u7528\uff0c\u5176\u8fd4\u56de\u5bf9\u8c61\u4f1a\u88ab\u52a0\u5165\u5230 IOC \u5bb9\u5668\u4e2d\uff0c\u5e76\u7531\u5bb9\u5668\u7edf\u4e00\u7ba1\u7406\u751f\u547d\u5468\u671f\u548c\u4f9d\u8d56\u5173\u7cfb\u3002</p>"},{"location":"java/ssm/#2","title":"2. \u4e3b\u8981\u4f5c\u7528","text":"<p>\u200b   1\uff09\u6ce8\u518c Bean \u5230\u5bb9\u5668\uff1a\u901a\u8fc7 <code>@Bean</code> \u6807\u6ce8\u7684\u65b9\u6cd5\u8fd4\u56de\u7684\u5bf9\u8c61\uff0c\u4f1a\u81ea\u52a8\u6210\u4e3a Spring \u7ba1\u7406\u7684 Bean\u3002</p> <p>\u200b   2\uff09\u4ee3\u66ff XML \u914d\u7f6e\uff1a\u5728\u6ce8\u89e3\u9a71\u52a8\u7684\u914d\u7f6e\u7c7b\u4e2d\uff0c\u7528 <code>@Bean</code> \u65b9\u6cd5\u4ee3\u66ff <code>&lt;bean&gt;</code> \u6807\u7b7e\u8fdb\u884c\u914d\u7f6e\u3002</p> <p>\u200b   3\uff09\u81ea\u5b9a\u4e49\u7b2c\u4e09\u65b9\u7c7b\u7684\u6ce8\u5165\uff1a\u5f53\u67d0\u4e2a\u7c7b\u4e0d\u662f\u7531\u6211\u4eec\u81ea\u5df1\u7f16\u5199\uff08\u4f8b\u5982\u5916\u90e8\u5e93\u4e2d\u7684\u5de5\u5177\u7c7b\uff09\uff0c\u65e0\u6cd5\u76f4\u63a5\u52a0\u4e0a <code>@Component</code> \u6ce8\u89e3\u65f6\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7 <code>@Bean</code> \u624b\u52a8\u6ce8\u518c\u3002</p>"},{"location":"java/ssm/#3","title":"3. \u83b7\u5f97\u7ec4\u4ef6\u7684\u65b9\u6cd5","text":"<pre><code>// \u6309\u7167\u7ec4\u4ef6\u540d\u79f0\u83b7\u53d6\u7ec4\u4ef6\u5bf9\u8c61\nStudent ltb = (Student) ioc.getBean(\"LiuTianBa\");\nSystem.out.println(\"ltb  \" + ltb);\n\n// \u6309\u7167\u7ec4\u4ef6\u7c7b\u578b\u83b7\u53d6\u7ec4\u4ef6\u5bf9\u8c61\nDog dog = ioc.getBean(Dog.class);\nSystem.out.println(\"bean = \" + dog);\n\n// \u6309\u7167\u540d\u5b57\u52a0\u7c7b\u578b\uff0c\u5c31\u4e0d\u9700\u8981\u5f3a\u8f6c\u4e86\n</code></pre>"},{"location":"java/ssm/#42-conguration","title":"4.2 @Conguration\u6ce8\u89e3","text":"<p>\u200b   <code>@Configuration</code> \u662f Spring \u4e2d\u7684\u4e00\u4e2a\u6ce8\u89e3\uff0c\u7528\u4e8e\u6807\u8bb0\u4e00\u4e2a\u7c7b\u4e3a\u914d\u7f6e\u7c7b\u3002\u5b83\u544a\u8bc9 Spring \u5bb9\u5668\uff1a\u8fd9\u4e2a\u7c7b\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a <code>@Bean</code> \u6ce8\u89e3\u7684\u65b9\u6cd5\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u5c06\u8fd4\u56de\u9700\u8981\u88ab Spring \u5bb9\u5668\u7ba1\u7406\u7684\u5bf9\u8c61\uff08\u5373 Bean\uff09\u3002Spring \u4f1a\u5904\u7406\u8fd9\u4e2a\u7c7b\uff0c\u6267\u884c\u5176 <code>@Bean</code> \u65b9\u6cd5\uff0c\u5e76\u5c06\u8fd4\u56de\u7684\u5bf9\u8c61\u6ce8\u518c\u5230 IoC \u5bb9\u5668\u4e2d\uff0c\u4ee5\u4fbf\u540e\u7eed\u4f9d\u8d56\u6ce8\u5165\u548c\u4f7f\u7528\u3002</p> <p>\u200b   \u76f8\u5f53\u4e8e\u4f20\u7edf\u7684 XML \u914d\u7f6e\u6587\u4ef6\uff08\u5982 <code>applicationContext.xml</code>\uff09\uff0c\u53ea\u4e0d\u8fc7\u73b0\u5728\u7528 Java \u7c7b\u6765\u7f16\u5199\u914d\u7f6e\uff0c\u7c7b\u578b\u5b89\u5168\u3001\u6613\u4e8e\u8c03\u8bd5\u548c\u91cd\u6784\u3002</p>"},{"location":"java/ssm/#43-mvc","title":"4.3 MVC\u5206\u5c42\u6ce8\u89e3","text":"<p>\u200b   \u7528 @Bean \u624b\u52a8\u6ce8\u518c\u7ec4\u4ef6\u592a\u9ebb\u70e6\uff0c\u6240\u4ee5 Spring \u63d0\u4f9b\u4e86\u4e00\u4e9b\u7279\u6b8a\u7c7b\u7684\u5feb\u901f\u6ce8\u518c\u3002\u6ce8\uff1a\u5206\u5c42\u6ce8\u89e3\u80fd\u8d77\u4f5c\u7528\u7684\u524d\u63d0\u662f\uff1a\u8fd9\u4e9b\u7c7b\u5fc5\u987b\u5728\u4e3b\u7a0b\u5e8f\u6240\u5728\u7684\u5305\u53ca\u5176\u5b50\u5305\u7684\u7a0b\u5e8f\u4e0b\u3002\u5982\u679c\u975e\u8981\u653e\u5230\u5916\u90e8\u5305\uff0c\u5728\u4e3b\u7a0b\u5e8f\u4e0a\u52a0\u4e2aComponentScan\u5b9e\u73b0\u6279\u91cf\u626b\u63cf\u3002\uff08\u4f46\u6700\u597d\u8fd8\u662f\u8001\u8001\u5b9e\u5b9e\u7684\u5728\u4e3b\u7a0b\u5e8f\u6240\u5728\u5305\u4e0b\u9762\u73a9\uff09    </p>"},{"location":"java/ssm/#1-controller","title":"1. @Controller","text":"<p>\u200b   \u7528\u4e8e\u6807\u8bb0\u63a7\u5236\u5c42\uff08Controller\uff09\u7684\u7c7b\uff0c\u8868\u793a\u8be5\u7c7b\u662f Spring MVC \u4e2d\u7684\u63a7\u5236\u5668\u7ec4\u4ef6\uff0c\u8d1f\u8d23\u5904\u7406 HTTP \u8bf7\u6c42\u3002\u88ab\u6b64\u6ce8\u89e3\u6807\u8bb0\u7684\u7c7b\u4f1a\u88ab Spring \u5bb9\u5668\u81ea\u52a8\u626b\u63cf\u5e76\u6ce8\u518c\u4e3a Bean\u3002</p>"},{"location":"java/ssm/#2-service","title":"2. @Service","text":"<p>\u200b   \u7528\u4e8e\u6807\u8bb0\u4e1a\u52a1\u903b\u8f91\u5c42\uff08Service\uff09\u7684\u7c7b\uff0c\u8868\u793a\u8be5\u7c7b\u662f\u670d\u52a1\u7ec4\u4ef6\uff0c\u901a\u5e38\u5305\u542b\u6838\u5fc3\u4e1a\u52a1\u903b\u8f91\u3002\u5b83\u662f\u4e00\u79cd\u7279\u6b8a\u7684 @Component\uff0c\u8bed\u4e49\u66f4\u660e\u786e\uff0c\u4fbf\u4e8e\u5206\u5c42\u7ba1\u7406\u3002</p>"},{"location":"java/ssm/#3-repository","title":"3. @Repository","text":"<p>\u200b   \u7528\u4e8e\u6807\u8bb0\u6570\u636e\u8bbf\u95ee\u5c42\uff08DAO/Repository\uff09\u7684\u7c7b\uff0c\u8868\u793a\u8be5\u7c7b\u8d1f\u8d23\u4e0e\u6570\u636e\u5e93\u8fdb\u884c\u4ea4\u4e92\u3002\u8be5\u6ce8\u89e3\u8fd8\u5177\u6709\u81ea\u52a8\u7ffb\u8bd1\u6570\u636e\u5e93\u5f02\u5e38\u7684\u80fd\u529b\uff08\u5982\u5c06 SQLException \u8f6c\u4e3a Spring \u7684\u6570\u636e\u8bbf\u95ee\u5f02\u5e38\uff09\uff0c\u4f7f\u6570\u636e\u5c42\u5f02\u5e38\u5904\u7406\u66f4\u7edf\u4e00\u3002</p>"},{"location":"java/ssm/#44","title":"4.4  \u6ce8\u518c\u7b2c\u4e09\u65b9\u7ec4\u4ef6","text":"<p>\u200b   \u6709\u4e24\u4e2a\u65b9\u6cd5\uff0c\u4e00\u662f\u76f4\u63a5\u7528@Bean\u6ce8\u89e3\u53bb\u624b\u52a8\u7684new\u4e00\u4e2a\u5bf9\u8c61\u5e76\u8fd4\u56de\uff0c\u4e8c\u662f@Import\u6ce8\u89e3\u53bb\u6ce8\u518c\u7b2c\u4e09\u65b9\u7c7b\u5bf9\u8c61\u3002</p>"},{"location":"java/ssm/#45-scope","title":"4.5 @Scope","text":"<p>\u200b   <code>@Scope</code> \u662f Spring \u4e2d\u7684\u4e00\u4e2a\u6ce8\u89e3\uff0c\u7528\u4e8e\u6307\u5b9a\u7531 <code>@Component</code> \u6216 <code>@Bean</code> \u7b49\u6ce8\u89e3\u521b\u5efa\u7684 Bean \u5b9e\u4f8b\u5728 Spring \u5bb9\u5668\u4e2d\u7684\u4f5c\u7528\u57df\uff08\u5373\u751f\u547d\u5468\u671f\u548c\u53ef\u89c1\u8303\u56f4\uff09\u3002\u5177\u4f53\u800c\u8a00\uff0c\u5b83\u662f\u7528\u6765\u63a7\u5236\u4e00\u4e2a Bean \u662f\u5355\u4f8b\u7684\u3001\u6bcf\u6b21\u8bf7\u6c42\u90fd\u65b0\u5efa\u7684\uff0c\u8fd8\u662f\u4e0e Web \u4e2d\u7684\u8bf7\u6c42\u3001\u4f1a\u8bdd\u7b49\u7ed1\u5b9a\u7684\u3002</p>"},{"location":"java/ssm/#_1","title":"\u5e38\u89c1\u53d6\u503c","text":"<ul> <li>singleton\uff08\u9ed8\u8ba4\uff09\uff1a\u5728\u6574\u4e2a Spring \u5bb9\u5668\u4e2d\uff0c\u8be5 Bean \u53ea\u6709\u4e00\u4e2a\u5171\u4eab\u7684\u5b9e\u4f8b\u3002</li> <li>prototype\uff1a\u6bcf\u6b21\u8bf7\u6c42\u8be5 Bean \u65f6\uff08\u5982\u6ce8\u5165\u6216\u8c03\u7528 <code>getBean()</code>\uff09\uff0c\u90fd\u4f1a\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5b9e\u4f8b\u3002</li> <li>request\uff1a\u6bcf\u4e2a HTTP \u8bf7\u6c42\u521b\u5efa\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u4ec5\u9002\u7528\u4e8e Web \u5e94\u7528\u3002</li> <li>session\uff1a\u6bcf\u4e2a HTTP Session \u521b\u5efa\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u4ec5\u9002\u7528\u4e8e Web \u5e94\u7528\u3002</li> <li>application\uff1a\u6bcf\u4e2a ServletContext \u751f\u547d\u5468\u671f\u5185\u521b\u5efa\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u4ec5\u9002\u7528\u4e8e Web \u5e94\u7528\u3002</li> </ul>"},{"location":"java/ssm/#46-lazy","title":"4.6 @Lazy","text":"<p>\u200b   \u5b83\u6307\u793a Spring \u5bb9\u5668\u5728\u542f\u52a8\u65f6\u4e0d\u7acb\u5373\u521b\u5efa\u88ab\u6807\u8bb0\u7684 Bean\uff0c\u800c\u662f\u7b49\u5230\u8be5 Bean \u7b2c\u4e00\u6b21\u88ab\u5b9e\u9645\u4f7f\u7528\uff08\u5982\u6ce8\u5165\u3001\u8c03\u7528 <code>getBean()</code>\uff09\u65f6\u624d\u8fdb\u884c\u521d\u59cb\u5316\u3002</p> <p>\u200b    \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cSpring \u5bb9\u5668\u5728\u542f\u52a8\u65f6\u4f1a\u9884\u521d\u59cb\u5316\u6240\u6709 singleton \u4f5c\u7528\u57df\u7684 Bean\u3002<code>@Lazy</code> \u53ef\u7528\u4e8e\u7c7b\u4e0a\uff08\u914d\u5408 <code>@Component</code> \u7b49\uff09\u6216\u65b9\u6cd5\u4e0a\uff08\u914d\u5408 <code>@Bean</code>\uff09\u3002</p> <p>\u200b   prototype\u4f5c\u7528\u57df\u7684 Bean \u672c\u8eab\u5c31\u662f\u61d2\u52a0\u8f7d\u7684\uff0c\u6bcf\u6b21\u4f7f\u7528\u90fd\u4f1a\u65b0\u5efa\u3002\u61d2\u52a0\u8f7d\u7684 Bean \u5728\u7b2c\u4e00\u6b21\u4f7f\u7528\u65f6\u4f1a\u6709\u521d\u59cb\u5316\u5f00\u9500\uff0c\u53ef\u80fd\u5f71\u54cd\u54cd\u5e94\u65f6\u95f4\u3002 </p>"},{"location":"java/ssm/#47-factorybean","title":"4.7 FactoryBean\u63a5\u53e3","text":"<p>\u200b   <code>FactoryBean</code> \u662f Spring \u63d0\u4f9b\u7684\u4e00\u4e2a\u63a5\u53e3\uff0c\u7528\u4e8e\u81ea\u5b9a\u4e49\u590d\u6742\u5bf9\u8c61\u7684\u521b\u5efa\u8fc7\u7a0b\u3002</p> <p>\u200b   \u5f53\u67d0\u4e2a Bean \u7684\u5b9e\u4f8b\u5316\u8fc7\u7a0b\u6bd4\u8f83\u590d\u6742\uff08\u4f8b\u5982\u9700\u8981\u52a8\u6001\u4ee3\u7406\u3001\u7ec4\u5408\u591a\u4e2a\u5bf9\u8c61\u3001\u8bfb\u53d6\u914d\u7f6e\u751f\u6210\u7b49\uff09\uff0c\u65e0\u6cd5\u901a\u8fc7\u7b80\u5355\u7684\u6784\u9020\u51fd\u6570\u6216\u5de5\u5382\u65b9\u6cd5\u5b8c\u6210\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u5b9e\u73b0 <code>FactoryBean</code> \u63a5\u53e3\u6765\u7cbe\u786e\u63a7\u5236 Bean \u7684\u521b\u5efa\u903b\u8f91\u3002</p> <pre><code>- \u5b9e\u73b0 `FactoryBean` \u7684\u7c7b\u672c\u8eab\u4e5f\u662f\u4e00\u4e2a Bean\uff0c\u4f1a\u88ab Spring \u5bb9\u5668\u7ba1\u7406\u3002\n- \u4ece\u5bb9\u5668\u4e2d\u83b7\u53d6\u8be5 Bean \u65f6\uff0c\u9ed8\u8ba4\u8fd4\u56de\u7684\u662f `getObject()` \u65b9\u6cd5\u7684\u8fd4\u56de\u503c\uff0c\u800c\u4e0d\u662f `FactoryBean` \u5b9e\u4f8b\u672c\u8eab\u3002\n- \u82e5\u60f3\u83b7\u53d6 `FactoryBean` \u672c\u8eab\uff0c\u9700\u5728 Bean \u540d\u79f0\u524d\u52a0 `&amp;`\uff0c\u5982 `context.getBean(\"&amp;myFactoryBean\")`\u3002\n</code></pre>"},{"location":"java/ssm/#48-conditional","title":"4.8 @Conditional \u6761\u4ef6\u6ce8\u518c","text":"<p>\u200b   <code>@Conditional</code> \u662f Spring \u4e2d\u7684\u4e00\u4e2a\u6ce8\u89e3\uff0c\u7528\u4e8e\u5b9e\u73b0\u6761\u4ef6\u5316\u6ce8\u518c Bean\u3002\u5b83\u53ef\u4ee5\u6839\u636e\u6307\u5b9a\u7684\u6761\u4ef6\u6765\u51b3\u5b9a\u662f\u5426\u5c06\u67d0\u4e2a Bean \u6ce8\u518c\u5230 Spring \u5bb9\u5668\u4e2d\u3002\u53ea\u6709\u5f53\u6761\u4ef6\u6ee1\u8db3\u65f6\uff0c\u5bf9\u5e94\u7684\u7ec4\u4ef6\uff08\u7c7b\u6216\u65b9\u6cd5\uff09\u624d\u4f1a\u88ab\u52a0\u8f7d\u548c\u5b9e\u4f8b\u5316\u3002</p>"},{"location":"java/ssm/#1_2","title":"1. \u6838\u5fc3\u673a\u5236","text":"<ul> <li><code>@Conditional</code> \u63a5\u6536\u4e00\u4e2a\u6216\u591a\u4e2a <code>Condition</code> \u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u3002</li> <li>Spring \u5728\u89e3\u6790\u914d\u7f6e\u65f6\u4f1a\u5148\u68c0\u67e5\u8fd9\u4e9b\u6761\u4ef6\u7684 <code>matches()</code> \u65b9\u6cd5\u8fd4\u56de\u503c\u3002</li> <li>\u5982\u679c\u8fd4\u56de <code>true</code>\uff0c\u5219\u6ce8\u518c Bean\uff1b\u5426\u5219\u8df3\u8fc7\u3002</li> </ul>"},{"location":"java/ssm/#2_1","title":"2. \u884d\u751f\u6ce8\u89e3","text":"<ul> <li><code>@ConditionalOnClass</code>\uff1a\u5f53\u7c7b\u8def\u5f84\u4e2d\u5b58\u5728\u6307\u5b9a\u7c7b\u65f6\u624d\u6ce8\u518c\u3002</li> <li><code>@ConditionalOnMissingBean</code>\uff1a\u5f53\u5bb9\u5668\u4e2d\u4e0d\u5b58\u5728\u6307\u5b9a\u7c7b\u578b\u7684 Bean \u65f6\u624d\u6ce8\u518c\u3002</li> <li><code>@ConditionalOnProperty</code>\uff1a\u5f53\u914d\u7f6e\u6587\u4ef6\u4e2d\u5b58\u5728\u7279\u5b9a\u5c5e\u6027\u4e14\u503c\u7b26\u5408\u6761\u4ef6\u65f6\u6ce8\u518c\u3002</li> <li><code>@ConditionalOnWebApplication</code>\uff1a\u5f53\u5e94\u7528\u662f Web \u73af\u5883\u65f6\u6ce8\u518c\u3002</li> <li><code>@ConditionalOnExpression</code>\uff1a\u6839\u636e SpEL \u8868\u8fbe\u5f0f\u7ed3\u679c\u51b3\u5b9a\u662f\u5426\u6ce8\u518c\u3002</li> </ul>"},{"location":"java/ssm/#5","title":"5. \u6ce8\u5165\u7ec4\u4ef6\u7684\u5404\u79cd\u65b9\u5f0f","text":""},{"location":"java/ssm/#1-autowired","title":"1.  @Autowired","text":"<p>\u200b   <code>@Autowired</code> \u662f Spring \u63d0\u4f9b\u7684\u6ce8\u89e3\uff0c\u7528\u4e8e\u81ea\u52a8\u88c5\u914d Bean\u3002\u5b83\u53ef\u4ee5\u6807\u8bb0\u5728\u5b57\u6bb5\u3001\u6784\u9020\u51fd\u6570\u3001Setter \u65b9\u6cd5\u6216\u666e\u901a\u65b9\u6cd5\u4e0a\uff0cSpring \u5bb9\u5668\u4f1a\u81ea\u52a8\u4ece IoC \u5bb9\u5668\u4e2d\u67e5\u627e\u5339\u914d\u7684 Bean \u5e76\u6ce8\u5165\u3002</p> <p>\u200b   \u88c5\u914d\u6d41\u7a0b\uff1a</p> <p>\u200b   1\uff09\u5148\u6309\u7c7b\u578b\u627e\uff0c\u627e\u5230\u4e86\u5c31\u6ce8\u5165</p> <p>\u200b   2\uff09\u82e5\u6309\u7c7b\u578b\u6ca1\u627e\u5230\u6216\u8005\u627e\u5230\u4e86\u591a\u4e2a\uff0c\u5c31\u6309\u7ec4\u4ef6\u7684\u540d\u5b57\u6765\u627e\uff08\u5c31\u662f\u628a\u5f53\u524d\u7684\u5bf9\u8c61\u540d\u770b\u4f5c\u662f\u7ec4\u4ef6\u540d\uff0c\u7136\u540e\u53bbioc\u5bb9\u5668\u627e\uff09</p> <p>\u200b   3\uff09\u82e5\u672a\u627e\u5230\u5339\u914d\u7684 Bean\uff0c\u9ed8\u8ba4\u4f1a\u629b\u51fa\u5f02\u5e38</p> <pre><code>\u5339\u914d\u89c4\u5219\n- \u9ed8\u8ba4\u6309**\u7c7b\u578b**\uff08byType\uff09\u8fdb\u884c\u5339\u914d\u3002\n- \u5982\u679c\u540c\u4e00\u7c7b\u578b\u5b58\u5728\u591a\u4e2a Bean\uff0c\u5219\u7ed3\u5408 `@Qualifier` \u6ce8\u89e3\u6309\u540d\u79f0\uff08byName\uff09\u533a\u5206\u3002\n- \u82e5\u672a\u627e\u5230\u5339\u914d\u7684 Bean\uff0c\u9ed8\u8ba4\u4f1a\u629b\u51fa\u5f02\u5e38\uff1b\u53ef\u8bbe\u7f6e `required = false` \u5141\u8bb8\u4e3a null\u3002\n</code></pre> <pre><code># \u53ef\u4ee5\u81ea\u52a8\u88c5\u914d\u5f88\u591a\n@ToString\n@Controller\npublic class UserController {\n\n    // \u81ea\u52a8\u6ce8\u5165\u6f14\u793a\n    @Autowired\n    UserService userService;\n\n\n    @Autowired(required = false)\n    Person bill;\n\n    @Autowired\n    List&lt;Person&gt; arr;\n\n    @Autowired\n    Map&lt;String, Person&gt; map;\n\n    @Autowired\n    ConfigurableApplicationContext ioc;\n}\n</code></pre> <p>\u200b   \u5c0f\u62d3\u5c55\uff1a@Qualifier(\"beanname\") \u53ef\u4ee5\u6307\u5b9a\u8981\u6ce8\u5165\u7684\u7ec4\u4ef6\u540d\u79f0\uff08\u65b0\u7248\u672c\u76f4\u63a5\u7528\u53d8\u91cf\u540d\u5c31\u53ef\u4ee5\u4e86\uff09 @Primary \u5c31\u662f\u628a\u67d0\u4e2a @Bean \u6807\u8bb0\u7684\u65b9\u6cd5\u8fd4\u56de\u7684\u7ec4\u4ef6\u6807\u4e3a\u4e00\u4e2a\u7279\u6b8a\u7684Bean\uff08\u9ed8\u8ba4\u7ec4\u4ef6\uff09\uff0c\u4ee5\u540e\u4e3b\u52a8\u6ce8\u5165\u65f6\u5982\u679c\u6709\u591a\u4e2a\u8be5\u7c7b\u578b\u7684\u7ec4\u4ef6\uff0c\u5c31\u7528\u8fd9\u4e2a\u7279\u6b8a\u7684\u6765\u6ce8\u5165\u3002</p> <p>\u200b   \u7279\u522b\u7684\uff0c\u5f53\u6211\u4eec\u5f00\u542f\u4e86\u9ed8\u8ba4\u7ec4\u4ef6\u540e\uff0c\u5728\u60f3\u7528\u5176\u4ed6\u7684\uff0c\u5c31\u5f97\u9760@Qualifier\u4e86\uff0c\u6b64\u65f6\u8be5\u5c5e\u6027\u540d\u4e0d\u80fd\u5b9e\u73b0\u7ec4\u4ef6\u7684\u5207\u6362\u4e86\u3002</p> <p>\u200b   </p>"},{"location":"java/ssm/#2-resource","title":"2. @Resource","text":"<p>\u200b   <code>@Resource</code> \u662f JSR-250 \u89c4\u8303\u63d0\u4f9b\u7684\u6ce8\u89e3\uff0c\u7528\u4e8e\u5b9e\u73b0\u4f9d\u8d56\u6ce8\u5165\u3002\u5b83\u5e76\u975e Spring \u7279\u6709\uff0c\u4f46\u88ab Spring \u5bb9\u5668\u652f\u6301\u3002</p> <p>\u200b   \u88c5\u914d\u6d41\u7a0b\uff1a</p> <p>\u200b   1\uff09\u9ed8\u8ba4\u6309\u540d\u79f0\uff08byName\uff09\u8fdb\u884c\u5339\u914d\u3002\u5373\u4f7f\u7528\u5b57\u6bb5\u540d\u6216\u65b9\u6cd5\u540d\u4f5c\u4e3a Bean \u7684\u540d\u79f0\u53bb\u67e5\u627e\u3002</p> <p>\u200b   2\uff09\u5982\u679c\u627e\u4e0d\u5230\u5bf9\u5e94\u540d\u79f0\u7684 Bean\uff0c\u5219\u9000\u56de\u5230\u6309\u7c7b\u578b\uff08byType\uff09\u5339\u914d\u3002</p> <p>\u200b   3\uff09\u53ef\u901a\u8fc7 <code>name</code> \u5c5e\u6027\u663e\u5f0f\u6307\u5b9a\u8981\u6ce8\u5165\u7684 Bean \u540d\u79f0\uff1a<code>@Resource(name = \"userService\")</code>\u3002</p> <p>\u200b   \u4e0e @Autowired \u7684\u533a\u522b</p> <p>\u200b   1\uff09<code>@Resource</code> \u662f Java \u6807\u51c6\u6ce8\u89e3\uff0c<code>@Autowired</code> \u662f Spring \u7279\u6709\u3002</p> <p>\u200b   2\uff09<code>@Resource</code> \u4f18\u5148\u6309\u540d\u79f0\u6ce8\u5165\uff0c<code>@Autowired</code> \u9ed8\u8ba4\u6309\u7c7b\u578b\u6ce8\u5165\u3002</p> <p>\u200b   3\uff09<code>@Resource</code> \u4e0d\u652f\u6301 <code>required = false</code> \u8bed\u6cd5\u3002</p>"},{"location":"java/ssm/#3_1","title":"3. \u6784\u9020\u5668\u6ce8\u5165\uff08\u65e0\u6ce8\u89e3\uff09","text":"<p>\u200b   \u6982\u5ff5\uff1a\u5728 Spring \u914d\u7f6e\u7c7b\u6216\u7ec4\u4ef6\u4e2d\uff0c\u901a\u8fc7\u6784\u9020\u51fd\u6570\u7684\u53c2\u6570\u6765\u63a5\u6536\u4f9d\u8d56\u5bf9\u8c61\u7684\u6ce8\u5165\u65b9\u5f0f\u3002\u5f53\u7c7b\u4e2d\u53ea\u6709\u4e00\u4e2a\u6784\u9020\u51fd\u6570\u65f6\uff0cSpring \u4f1a\u81ea\u52a8\u5c06\u5176\u53c2\u6570\u4f5c\u4e3a\u4f9d\u8d56\u8fdb\u884c\u6ce8\u5165\uff0c\u65e0\u9700\u6dfb\u52a0 <code>@Autowired</code> \u6ce8\u89e3\u3002</p> <p>\u200b   \u4f5c\u7528\uff1a\u5b9e\u73b0\u4f9d\u8d56\u7684\u5f3a\u5236\u6ce8\u5165\uff0c\u786e\u4fdd\u5bf9\u8c61\u521b\u5efa\u65f6\u6240\u9700\u7684\u6240\u6709\u4f9d\u8d56\u90fd\u5df2\u63d0\u4f9b\uff0c\u4ece\u800c\u4fdd\u8bc1\u5bf9\u8c61\u7684\u5b8c\u6574\u6027\u4e0e\u4e0d\u53ef\u53d8\u6027\u3002</p> <p>\u200b   \u7279\u70b9\uff1a</p> <p>\u200b   1\uff09\u65e0\u9700\u6ce8\u89e3\uff1aSpring 4.3+ \u7248\u672c\u5f00\u59cb\uff0c\u82e5\u7c7b\u4e2d\u53ea\u6709\u4e00\u4e2a\u6784\u9020\u51fd\u6570\uff0c\u53ef\u7701\u7565 <code>@Autowired</code>\u3002</p> <p>\u200b   2\uff09\u63a8\u8350\u4f7f\u7528\uff1a\u6784\u9020\u5668\u6ce8\u5165\u662f Spring \u5b98\u65b9\u63a8\u8350\u7684\u4f9d\u8d56\u6ce8\u5165\u65b9\u5f0f\uff0c\u6709\u5229\u4e8e\u5b9e\u73b0\u4e0d\u53ef\u53d8\u5bf9\u8c61\uff0c\u4fbf\u4e8e\u5355\u5143\u6d4b\u8bd5\u3002</p> <p>\u200b   3\uff09\u4f9d\u8d56\u660e\u786e\uff1a\u6240\u6709\u5fc5\u9700\u7684\u4f9d\u8d56\u90fd\u5728\u6784\u9020\u51fd\u6570\u4e2d\u58f0\u660e\uff0c\u4ee3\u7801\u53ef\u8bfb\u6027\u5f3a\u3002</p>"},{"location":"java/ssm/#4-setter","title":"4. Setter \u65b9\u6cd5\u6ce8\u5165","text":"<p>\u200b   \u901a\u8fc7\u7c7b\u7684 <code>setter</code> \u65b9\u6cd5\u5c06\u4f9d\u8d56\u5bf9\u8c61\u6ce8\u5165\u5230 Bean \u4e2d\u3002\u901a\u5e38\u914d\u5408 <code>@Autowired</code> \u6ce8\u89e3\u4f7f\u7528\uff0cSpring \u5bb9\u5668\u5728\u5b9e\u4f8b\u5316\u5bf9\u8c61\u540e\uff0c\u4f1a\u81ea\u52a8\u8c03\u7528\u5bf9\u5e94\u7684 setter \u65b9\u6cd5\u5b8c\u6210\u4f9d\u8d56\u6ce8\u5165\u3002</p>"},{"location":"java/ssm/#5-awarexxx","title":"5. AwareXXX \u611f\u77e5\u63a5\u53e3","text":"<p>\u200b   Aware \u63a5\u53e3\u662f Spring \u63d0\u4f9b\u7684\u4e00\u7cfb\u5217\u4ee5 <code>Aware</code> \u7ed3\u5c3e\u7684\u63a5\u53e3\uff0c\u7528\u4e8e\u8ba9 Bean \u611f\u77e5\u5e76\u83b7\u53d6 Spring \u5bb9\u5668\u6216\u5176\u5185\u90e8\u7ec4\u4ef6\u7684\u5e95\u5c42\u8d44\u6e90\u3002</p> <p>\u200b   \u4f5c\u7528\uff1a\u5f53\u4e00\u4e2a Bean \u5b9e\u73b0\u4e86\u67d0\u4e2a <code>Aware</code> \u63a5\u53e3\u540e\uff0cSpring \u5bb9\u5668\u4f1a\u5728\u521d\u59cb\u5316\u8be5 Bean \u65f6\uff0c\u81ea\u52a8\u8c03\u7528\u5176\u63d0\u4f9b\u7684\u56de\u8c03\u65b9\u6cd5\uff0c\u5c06\u5bf9\u5e94\u7684\u8fd0\u884c\u65f6\u5bf9\u8c61\u6ce8\u5165\u8fdb\u53bb\uff0c\u4ece\u800c\u8ba9 Bean \u80fd\u591f\u8bbf\u95ee\u5bb9\u5668\u7684\u5185\u90e8\u670d\u52a1\u3002</p> <pre><code>// \u5e38\u89c1 Aware \u63a5\u53e3\n- `ApplicationContextAware`\uff1a\u83b7\u53d6 `ApplicationContext` \u5bb9\u5668\u672c\u8eab\u3002\n- `BeanFactoryAware`\uff1a\u83b7\u53d6 `BeanFactory` \u5de5\u5382\u5b9e\u4f8b\u3002\n- `BeanNameAware`\uff1a\u83b7\u53d6\u5f53\u524d Bean \u5728\u5bb9\u5668\u4e2d\u7684\u540d\u79f0\u3002\n- `EnvironmentAware`\uff1a\u83b7\u53d6 `Environment` \u5bf9\u8c61\uff0c\u7528\u4e8e\u8bfb\u53d6\u914d\u7f6e\u73af\u5883\uff08\u5982 profile\u3001properties\uff09\u3002\n- `ResourceLoaderAware`\uff1a\u83b7\u53d6 `ResourceLoader`\uff0c\u7528\u4e8e\u52a0\u8f7d\u8d44\u6e90\u6587\u4ef6\u3002\n- `ApplicationEventPublisherAware`\uff1a\u83b7\u53d6\u4e8b\u4ef6\u53d1\u5e03\u5668\uff0c\u7528\u4e8e\u53d1\u5e03\u81ea\u5b9a\u4e49\u4e8b\u4ef6\u3002\n</code></pre>"},{"location":"java/ssm/#6-value","title":"6. @Value","text":"<p>\u200b   <code>@Value</code> \u662f Spring \u63d0\u4f9b\u7684\u4e00\u4e2a\u6ce8\u89e3\uff0c\u7528\u4e8e\u5c06\u5916\u90e8\u503c\u6ce8\u5165\u5230 Bean \u7684\u5b57\u6bb5(\u975e\u7ec4\u4ef6\u7684\u5b57\u6bb5\uff0c\u7ec4\u4ef6\u53ef\u4ee5\u901a\u8fc7Autowired\u81ea\u52a8\u6ce8\u5165)\u6216\u65b9\u6cd5\u53c2\u6570\u4e2d\u3002</p> <p>\u200b   \u4f5c\u7528\uff1a\u5b9e\u73b0\u914d\u7f6e\u5c5e\u6027\u3001\u5b57\u9762\u91cf\u3001SpEL \u8868\u8fbe\u5f0f\u7684\u6ce8\u5165\uff0c\u4f7f\u4ee3\u7801\u53ef\u4ee5\u52a8\u6001\u83b7\u53d6\u914d\u7f6e\u4fe1\u606f\uff0c\u800c\u4e0d\u5fc5\u786c\u7f16\u7801\u3002     </p> <p>\u200b   \u6ce8\u5165\u65b9\u5f0f\uff1a</p> <p>\u200b   1\uff09\u76f4\u63a5@Value(\u5b57\u9762\u91cf)</p> <p>\u200b   2\uff09\u4ece\u914d\u7f6e\u6587\u4ef6\u4e2d\u83b7\u53d6\u6570\u636e\uff1a@Value(\"${key}\")</p> <pre><code>@Value(\"${app.name}\")\nprivate String appName;\n</code></pre> <p>\u200b   3\uff09SpEL\uff08Spring Expression Language\uff09\u8868\u8fbe\u5f0f</p> <pre><code>@Value(\"#{systemProperties['user.home']}\")\nprivate String userHome;\n\n@Value(\"#{T(java.lang.Math).random() * 100}\")\nprivate double randomValue;\n</code></pre> <p>\u200b   \u7efc\u5408\u6f14\u793a\uff1a</p> <pre><code>public class Cat {\n    @Value(\"Tom\")\n    private String name;\n    @Value(\"12\")\n    private Integer age;\n    @Value(\"${cat.color}\")\n    private String color;\n    @Value(\"#{T(java.util.UUID).randomUUID().toString()}\")\n    private String id;\n\n}\n</code></pre>"},{"location":"java/ssm/#7-propertysource","title":"7. @PropertySource","text":"<p>\u200b   <code>@PropertySource</code> \u662f Spring \u63d0\u4f9b\u7684\u4e00\u4e2a\u6ce8\u89e3\uff0c\u7528\u4e8e\u5c06\u5916\u90e8\u7684 properties \u914d\u7f6e\u6587\u4ef6\u52a0\u8f7d\u5230 Spring \u7684 <code>Environment</code> \u62bd\u8c61\u4e2d\u3002</p> <pre><code>@PropertySource(\"classpath:app.properties\")\n</code></pre> <p>\u200b   \u8865\u5145\u77e5\u8bc6\uff1a\u7c7b\u8def\u5f84\u627e\u8d44\u6e90\u65b9\u5f0f</p> <p>\u200b   classpath: \u4ee3\u8868\u81ea\u5df1\u5f53\u524d\u9879\u76ee\u7684\u7c7b\u8def\u5f84\uff08java\u4ee5\u53caresources)</p> <p>\u200b   classpath*: \u4ece\u6240\u6709\u5305\u7684\u7c7b\u8def\u5f84\u4e0b\u9762\u627e</p> <p>\u200b   \u5728Spring\u4e2d\uff0c\u63d0\u4f9b\u4e86\u8d44\u6e90\u83b7\u53d6\u5de5\u5177\u7c7b\uff1aResouceUtils \u6765\u83b7\u53d6\u6587\u4ef6</p>"},{"location":"java/ssm/#8-profile","title":"8. @Profile","text":"<p>\u200b   \u5b9e\u9645\u4e5f\u662f @Conditional \u7684\u4e00\u79cd\uff0c\u573a\u666f\uff1a\u5f53\u6211\u4eec\u6709\u591a\u4e2a\u6570\u636e\u6e90\uff0c\u4e5f\u5c31\u662f\u5f00\u53d1\u3001\u6d4b\u8bd5\u3001\u751f\u6210\u8fd9\u4e09\u5957\uff0c\u5982\u679c\u6211\u4eec\u7528 @Primary \u6216\u8005@Qualifier\uff0c\u5219\u9700\u8981\u4fee\u6539\u4ee3\u7801\uff0c\u4f46\u7528 @Profile \u53ef\u4ee5\u8f93\u5165\u4e00\u4e2a\u73af\u5883\u8868\u793a\uff0c\u4ece\u800c\u6839\u636e\u4e0d\u540c\u7684\u73af\u5883\u8868\u793a\u6765\u6ce8\u518c\u7ec4\u4ef6\u3002</p> <p>\u200b   \u5177\u4f53\u4f7f\u7528\uff1a</p> <p>\u200b   1\uff09\u5148\u5b9a\u4e49\u73af\u5883\u8868\u793a\uff0c\u9ed8\u8ba4\u662f \u201ddefault\u201c \uff1a\u81ea\u5b9a\u4e49\u65b9\u6cd5\u5c31\u662f\u53bb\u8d44\u6e90\u6587\u4ef6\u4e0b\u9762\u5b9a\u4e49\u3002 spring.profiles.active=\u751f\u4ea7\u73af\u5883</p> <p>\u200b   2\uff09\u4f7f\u7528 @Profile \u6765\u5b9e\u73b0\u6761\u4ef6\u6ce8\u518c </p>"},{"location":"java/ssm/#6","title":"6. \u7ec4\u4ef6\u751f\u547d\u5468\u671f","text":"<p>\u200b   Spring \u5bb9\u5668\u4e2d\u6bcf\u4e2a Bean \u90fd\u6709\u5176\u5b8c\u6574\u7684\u751f\u547d\u5468\u671f\uff0c\u4ece\u521b\u5efa\u3001\u521d\u59cb\u5316\u3001\u4f7f\u7528\u5230\u9500\u6bc1\u3002Spring \u63d0\u4f9b\u4e86\u591a\u79cd\u673a\u5236\u8ba9\u5f00\u53d1\u8005\u53ef\u4ee5\u5728\u7279\u5b9a\u751f\u547d\u5468\u671f\u9636\u6bb5\u63d2\u5165\u81ea\u5b9a\u4e49\u903b\u8f91\u3002</p> <p>\u200b   \u7b2c\u4e00\u79cd\uff1a\u901a\u8fc7 @Bean \u6ce8\u89e3\u53bb\u6307\u5b9a init \u4ee5\u53ca destory\u3002</p> <p>\u200b   \u7b2c\u4e8c\u79cd\uff1a\u53bb\u5b9e\u73b0 InitializingBean  \u4ee5\u53ca DisposableBean </p> <p></p> <p>\u200b   \u5177\u4f53\u751f\u547d\u5468\u671f\u5982\u4e0b\uff1a</p> <p>\u200b   1\u3001\u5b9e\u4f8b\u5316\uff08Instantiation\uff09 \uff1aSpring \u5bb9\u5668\u6839\u636e\u914d\u7f6e\u6216\u6ce8\u89e3\u521b\u5efa Bean \u7684\u5b9e\u4f8b\uff08\u901a\u8fc7\u6784\u9020\u51fd\u6570\u6216\u5de5\u5382\u65b9\u6cd5\uff09\u3002</p> <p>\u200b   2\u3001\u5c5e\u6027\u8d4b\u503c\uff08Populate Properties\uff09\uff1a\u5bb9\u5668\u5c06\u914d\u7f6e\u4e2d\u5b9a\u4e49\u7684\u5c5e\u6027\u503c\u6216\u4f9d\u8d56\u5bf9\u8c61\u6ce8\u5165\u5230 Bean \u4e2d\uff08\u5982\u901a\u8fc7 <code>@Autowired</code>\u3001<code>@Value</code> \u7b49\uff09\u3002</p> <p>\u200b   3\u3001\u521d\u59cb\u5316\uff08Initialization\uff09</p> <pre><code>   - \u8865\u5145: \u8c03\u7528\u540e\u7f6e\u5904\u7406\u5668\u7684\u524d\u7f6e\u64cd\u4f5c\n   - \u8c03\u7528 `@PostConstruct` \u6ce8\u89e3\u7684\u65b9\u6cd5\u3002\n   - \u8c03\u7528 `InitializingBean` \u7684 `afterPropertiesSet()` \u65b9\u6cd5\u3002\n   - \u8c03\u7528\u81ea\u5b9a\u4e49\u7684\u521d\u59cb\u5316\u65b9\u6cd5\uff08\u901a\u8fc7 `@Bean(initMethod = \"init\")` \u6307\u5b9a\uff09\u3002\n   - \u5e94\u7528 BeanPostProcessor \u7684 `postProcessBeforeInitialization` \u548c `postProcessAfterInitialization`\u3002\n</code></pre> <p>\u200b   4\u3001\u4f7f\u7528\uff08In Use\uff09\uff1aBean \u5df2\u51c6\u5907\u597d\uff0c\u53ef\u4ee5\u88ab\u5176\u4ed6\u7ec4\u4ef6\u4f7f\u7528\u6216\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\u3002</p> <p>\u200b   5\u3001\u9500\u6bc1\uff08Destruction\uff09\uff1a</p> <pre><code>   - \u8c03\u7528 `@PreDestroy` \u6ce8\u89e3\u7684\u65b9\u6cd5\u3002\n   - \u8c03\u7528 `DisposableBean` \u7684 `destroy()` \u65b9\u6cd5\u3002\n   - \u8c03\u7528\u81ea\u5b9a\u4e49\u7684\u9500\u6bc1\u65b9\u6cd5\uff08\u901a\u8fc7 `@Bean(destroyMethod = \"cleanup\")` \u6307\u5b9a\uff09\u3002\n   - \u4ec5\u9002\u7528\u4e8e singleton \u4f5c\u7528\u57df\u7684 Bean\uff0c\u5728\u5bb9\u5668\u5173\u95ed\u65f6\u6267\u884c\u3002\n</code></pre> <p> </p>"},{"location":"java/ssm/#7-beanpostprocessor","title":"7. BeanPostProcessor","text":"<p>\u200b   \u4e4b\u524d Bean \u7684\u751f\u547d\u5468\u671f\u5176\u5b9e\u53ea\u662f\u5728\u4eba\u5bb6\u521d\u59cb\u5316\u5b8c\uff0c\u6216\u8005\u9500\u6bc1\u524d\u8ba9\u4f60\u505a\u70b9\u5176\u4ed6\u7684\uff0c\u800c\u4e0d\u80fd\u5f71\u54cd\u8fd9\u4e2a\u8fc7\u7a0b\u3002</p> <p>\u200b   \u800c BeanPostProcessor \u80fd\u591f\u5728\u751f\u547d\u5468\u671f\u8fc7\u7a0b\u4e2d\u6b63\u5728\u7684\u4fee\u6539\u8fd9\u4e2a Bean\u3002</p>"},{"location":"java/ssm/#aop","title":"\u4e8c\u3001AOP \u2b50","text":"<p>\u200b   \u6982\u5ff5\uff1aAspect Oriented Programming\uff08AOP\uff09\u662f Spring \u6846\u67b6\u7684\u91cd\u8981\u7279\u6027\u4e4b\u4e00\uff0c\u5b83\u5141\u8bb8\u5f00\u53d1\u8005\u5c06\u6a2a\u5207\u5173\u6ce8\u70b9\uff08\u5982\u65e5\u5fd7\u3001\u4e8b\u52a1\u3001\u5b89\u5168\u3001\u7f13\u5b58\u7b49\uff09\u4e0e\u6838\u5fc3\u4e1a\u52a1\u903b\u8f91\u5206\u79bb\u3002</p> <p>\u200b   \u672c\u8d28\uff1aAOP \u7684\u5e95\u5c42\u5b9e\u73b0\u539f\u7406\u786e\u5b9e\u662f\u4ee3\u7406\u6a21\u5f0f\u3002Spring \u5728\u8fd0\u884c\u65f6\u4e3a\u76ee\u6807\u5bf9\u8c61\u521b\u5efa\u4e00\u4e2a\u4ee3\u7406\u5bf9\u8c61\uff0c\u5f53\u8c03\u7528\u76ee\u6807\u65b9\u6cd5\u65f6\uff0c\u5b9e\u9645\u6267\u884c\u7684\u662f\u4ee3\u7406\u5bf9\u8c61\u7684\u65b9\u6cd5\u3002\u4ee3\u7406\u5bf9\u8c61\u53ef\u4ee5\u5728\u76ee\u6807\u65b9\u6cd5\u6267\u884c\u7684\u524d\u540e\uff0c\u751a\u81f3\u73af\u7ed5\u6267\u884c\u81ea\u5b9a\u4e49\u903b\u8f91\uff0c\u4ece\u800c\u5b9e\u73b0\u529f\u80fd\u589e\u5f3a\u3002</p> <p></p>"},{"location":"java/ssm/#1-aop","title":"1. AOP \u7f16\u7801\u5b9e\u73b0","text":"<p>\u200b   1\uff09\u5bfc\u5165 AOP \u4f9d\u8d56 </p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-aop&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u200b   2\uff09\u7f16\u5199\u5207\u9762 Aspect \u6ce8\uff1a\u8bb0\u5f97\u7528 @Aspect \u6765\u6807\u6ce8\u5207\u9762\u7c7b </p> <p>\u200b   3\uff09\u7f16\u5199\u901a\u77e5\u65b9\u5f0f</p> <p>\u200b   4\uff09\u6307\u660e\u8fd9\u4e9b\u901a\u77e5\u65b9\u6cd5\u4f55\u65f6\u4f55\u5730\u8fd0\u884c\uff08\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\uff09 \u6ce8\uff1a\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u8868\u8fbe\u5f0f\u62bd\u79bb\u51fa\u6765</p> <pre><code>    // \u5207\u5165\u70b9\u8868\u8fbe\u5f0f\u62bd\u79bb\n    @Pointcut(\"execution(* person.liutianba.spring02Aop.calculator.MathCal.*(..))\")\n    void pointCut(){}\n\n    @Before(\"pointCut()\")\n    public void logStart(JoinPoint joinPoint){\n        System.out.println(\"\u3010\u5207\u9762 - \u65e5\u5fd7\u3011\u5f00\u59cb... \u65b9\u6cd5\u540d:\" + joinPoint.getSignature().getName() + \"\u53c2\u6570\u4e3a\uff1a\" + Arrays.asList(joinPoint.getArgs()).toString());\n    }\n</code></pre> <p>\u200b   5\uff09\u6d4b\u8bd5AOP\u52a8\u6001\u7ec7\u5165</p> <pre><code>@Aspect  // \u5207\u9762\u7c7b\n@Component\npublic class LogAspect {\n\n    /**\n     * \u544a\u8bc9 Spring\uff0c\u4ee5\u4e0b\u901a\u77e5\u65b9\u6cd5\u4f55\u65f6\u4f55\u5730\u8fd0\u884c\n     * \u4f55\u65f6\uff1a\n     * @Before,\n     * @After(\u4e0d\u7ba1\u6b63\u5e38\u5f02\u5e38\uff0c\u90fd\u8fd0\u884c),\n     * @AfterReturning(\u6b63\u5e38\u8fd4\u56de\u7ed3\u679c),\n     * @AfterThrowing(\u51fa\u73b0\u5f02\u5e38),\n     * @Around\n     *\n     * \u4f55\u5730\uff1a\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\n     *   execution(\u65b9\u6cd5\u7684\u5168\u7b7e\u540d)\n     *      \u5168\u5199\u6cd5 \uff1apublic int \u5168\u7c7b\u540d.\u65b9\u6cd5\u540d(\u53c2\u6570\u5217\u8868) throws \u5f02\u5e38\n     *      \u7701\u7565\u5199\u6cd5\uff1aint \u65b9\u6cd5\u540d(\u53c2\u6570\u5217\u8868) int *(int, int)\n     *      * \u8868\u793a\u4efb\u610f\u957f\u5ea6\u5b57\u7b26\u4e32\n     *\n     */\n\n    @Before(\"execution(int *(int,int))\")\n    public void logStart(){\n        System.out.println(\"\u3010\u5207\u9762 - \u65e5\u5fd7\u3011\u5f00\u59cb...\");\n    }\n    @After(\"execution(int *(int,int))\")\n    public void logEnd(){\n        System.out.println(\"\u3010\u5207\u9762 - \u65e5\u5fd7\u3011\u7ed3\u675f...\");\n    }\n\n    @AfterThrowing(\"execution(int*(int, int))\")\n    public void logException(){\n        System.out.println(\"\u3010\u5207\u9762 - \u65e5\u5fd7\u3011\u5f02\u5e38...\");\n    }\n\n\n    @AfterReturning(pointcut = \"execution(int *(int, int))\", returning = \"result\")\n    public void logReturn(Object result){\n        System.out.println(\"\u3010\u5207\u9762 - \u65e5\u5fd7\u3011\u7ed3\u679c\uff1a\" + result);\n    }\n}\n</code></pre>"},{"location":"java/ssm/#2-aop","title":"2. AOP \u5207\u5165\u70b9\u8868\u793a\u5f0f\u5199\u6cd5","text":"<p>\u200b   \u5207\u5165\u70b9\uff08Pointcut\uff09\u7528\u4e8e\u5b9a\u4e49 \u54ea\u4e9b\u65b9\u6cd5\u9700\u8981\u88ab AOP \u589e\u5f3a\u3002\u5b83\u662f\u901a\u8fc7\u4e00\u4e2a\u8868\u8fbe\u5f0f\u6765\u5339\u914d\u7c7b\u548c\u65b9\u6cd5\u7684\uff0c\u53ea\u6709\u5339\u914d\u6210\u529f\u7684\u65b9\u6cd5\u624d\u4f1a\u6267\u884c\u901a\u77e5\uff08Advice\uff09\u3002</p> <p></p>"},{"location":"java/ssm/#1-excution","title":"1. excution(\u65b9\u6cd5\u7b7e\u540d)","text":"<p>\u200b   \u5207\u5165\u67d0\u4e2a\u63a5\u53e3\u4e0b\u7684\u6240\u6709\u65b9\u6cd5\uff1aexecution(* person.liutianba.spring02Aop.calculator.MathCal. ***(..))</p> <p>\u200b   \u6ce8\uff1a\u53ea\u8981\u6709\u4e86\u5207\u9762\u7c7b\u518d\u5207\u5165\uff0c\u90a3\u4e48\u8fd9\u4e2a\u7c7b\u7684\u5b9e\u4f8b\u5728\u5bb9\u5668\u4e2d\u5c31\u4e0d\u518d\u662f\u539f\u672c\u7684\u7c7b\u578b\u4e86\uff0c\u800c\u662fCGLIB\u4ea7\u751f\u7684\u4e00\u4e2a\u4ee3\u7406\u5bf9\u8c61\u3002   </p> <pre><code> /**\n     * \u544a\u8bc9 Spring\uff0c\u4ee5\u4e0b\u901a\u77e5\u65b9\u6cd5\u4f55\u65f6\u4f55\u5730\u8fd0\u884c\n     * \u4f55\u65f6\uff1a\n     * @Before,\n     * @After(\u4e0d\u7ba1\u6b63\u5e38\u5f02\u5e38\uff0c\u90fd\u8fd0\u884c),\n     * @AfterReturning(\u6b63\u5e38\u8fd4\u56de\u7ed3\u679c),\n     * @AfterThrowing(\u51fa\u73b0\u5f02\u5e38),\n     * @Around\n     *\n     * \u4f55\u5730\uff1a\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\n     *   execution(\u65b9\u6cd5\u7684\u5168\u7b7e\u540d)\n     *      \u5168\u5199\u6cd5 \uff1apublic int \u5168\u7c7b\u540d.\u65b9\u6cd5\u540d(\u53c2\u6570\u5217\u8868) throws \u5f02\u5e38\n     *      \u7701\u7565\u5199\u6cd5\uff1aint \u65b9\u6cd5\u540d(\u53c2\u6570\u5217\u8868) int *(int, int)\n     *      *\uff1a\u8868\u793a\u4efb\u610f\u957f\u5ea6\u5b57\u7b26\u4e32\n     *      ..\uff1a\n     *       1\uff09\u53c2\u6570\u4f4d\u7f6e\uff1a\u8868\u793a\u591a\u4e2a\u53c2\u6570\uff0c\u4efb\u610f\u7c7b\u578b\n     *       2\uff09\u7c7b\u578b\u4f4d\u7f6e\uff1a\u8868\u793a\u591a\u4e2a\u5c42\u7ea7  \n\n     *   @annotation(com.spzx.common.security.annotation.RequiresLogin) || \"  \n        + \"@annotation(com.spzx.common.security.annotation.RequiresPermissions)\n     *  \n     *  \n     *  \n*/  \n</code></pre>"},{"location":"java/ssm/#2-args","title":"2. args","text":"<p>\u200b   \u5339\u914d\u90a3\u4e9b\u53c2\u6570\u5217\u8868\u4e00\u76f4\u7684\u6240\u6709\u65b9\u6cd5</p>"},{"location":"java/ssm/#3-args","title":"3. @args","text":"<p>\u200b   \u5339\u914d\u53c2\u6570\u5217\u8868\u6709\u7279\u5b9a\u6ce8\u89e3\u7684\u65b9\u6cd5</p>"},{"location":"java/ssm/#3-aop","title":"3. \u83b7\u53d6 AOP \u7684\u8fde\u63a5\u70b9\u7684\u4fe1\u606f","text":"<p>\u200b   \u76f4\u63a5\u4f20\u4e00\u4e2a\u8fde\u63a5\u70b9\uff0c\u7136\u540e\u901a\u8fc7\u5b83\u83b7\u5f97\u4fe1\u606f\u3002</p> <p>\u200b   \u4e00\u822c\u5c31\u662f\u901a\u8fc7getSignature\uff08\uff09\u83b7\u5f97\u65b9\u6cd5\u7b7e\u540d\uff0c\u7136\u540e\u901a\u8fc7\u65b9\u6cd5\u7b7e\u540d\u5c31\u53ef\u4ee5\u83b7\u5f97\u8be5\u65b9\u6cd5\u7684\u8be6\u7ec6\u4fe1\u606f\u3002</p> <pre><code>@Before(\"execution(* person.liutianba.spring02Aop.calculator.MathCal.*(..))\")\npublic void logStart(JoinPoint joinPoint){\n    System.out.println(\"\u3010\u5207\u9762 - \u65e5\u5fd7\u3011\u5f00\u59cb... \u65b9\u6cd5\u540d:\" + joinPoint.getSignature().getName());\n}\n</code></pre>"},{"location":"java/ssm/#4_1","title":"4. \u591a\u5207\u9762\u6267\u884c\u6267\u884c\u987a\u5e8f","text":"<p>\u200b   \u6211\u7684\u7406\u89e3\uff1a\u5355\u4e2a\u5207\u9762\u5b9e\u9645\u5c31\u662f\u628a\u76ee\u6807\u65b9\u6cd5\u505a\u4e86\u4e2a\u4ee3\u7406\uff0c\u5f53\u6709\u5176\u4ed6\u5207\u9762\u65f6\uff0c\u5b83\u4f1a\u628a\u4ee3\u7406\u540e\u7684\u65b9\u6cd5\u770b\u6210\u662f\u4e00\u4e2a\u8981\u4ee3\u7406\u7684\u76ee\u6807\u65b9\u6cd5\uff0c\u7136\u540e\u53bb\u4ee3\u7406\uff0c\u6240\u4ee5\uff0c\u591a\u4e2a\u5207\u9762\u7684\u6267\u884c\u987a\u5e8f\u662f\u7531\u8c01\u5148\u4ee3\u7406\uff0c\u8c01\u540e\u4ee3\u7406\u51b3\u5b9a\u7684\u3002</p> <p>\u200b   \u6ce8\uff1a\u9ed8\u8ba4\u4ee3\u7406\u987a\u5e8f\u662f\u6309\u7c7b\u540d\u81ea\u7136\u6392\u5e8f\u7684\uff0c\u4f46\u4e5f\u53ef\u4ee5\u901a\u8fc7 @Order \u6ce8\u89e3\u624b\u52a8\u6307\u5b9a\u3002<code>@Order</code> \u503c\u8d8a\u5c0f\uff0c\u4f18\u5148\u7ea7\u8d8a\u9ad8\uff0c\u5728\u4ee3\u7406\u94fe\u4e2d\u4f4d\u4e8e\u5916\u5c42\u3002</p> <p>\u200b   </p>"},{"location":"java/ssm/#5-around","title":"5. \u73af\u7ed5\u901a\u77e5 @Around \u91cd\u70b9\uff01\uff01\uff01","text":"<p>\u200b   <code>@Before</code>\u3001<code>@After</code> \u7b49\u901a\u77e5\u5c5e\u4e8e\u201c\u611f\u77e5\u578b\u201d\u589e\u5f3a\uff0c\u53ea\u80fd\u5728\u65b9\u6cd5\u6267\u884c\u524d\u540e\u6267\u884c\u989d\u5916\u903b\u8f91\uff0c\u65e0\u6cd5\u63a7\u5236\u76ee\u6807\u65b9\u6cd5\u7684\u6267\u884c\u6d41\u7a0b\uff08\u5982\u8df3\u8fc7\u65b9\u6cd5\u3001\u4fee\u6539\u53c2\u6570\u3001\u6539\u53d8\u8fd4\u56de\u503c\uff09\u3002\u800c <code>@Around</code> \u662f\u6700\u5f3a\u5927\u7684\u901a\u77e5\u7c7b\u578b\uff0c\u5b83\u5b8c\u5168\u5305\u88f9\u76ee\u6807\u65b9\u6cd5\uff0c\u53ef\u4ee5\uff1a</p> <ul> <li>\u63a7\u5236\u662f\u5426\u6267\u884c\u76ee\u6807\u65b9\u6cd5</li> <li>\u4fee\u6539\u65b9\u6cd5\u53c2\u6570</li> <li>\u4fee\u6539\u8fd4\u56de\u503c</li> <li>\u6355\u83b7\u5e76\u5904\u7406\u5f02\u5e38 (\u8fd9\u91cc\u5efa\u8bae\u629b\u51fa\u5f02\u5e38\uff0c\u5982\u679c\u4e0d\u629b\u51fa\u7684\u8bdd\uff0c\u51fa\u4e86\u5f02\u5e38\u522b\u4eba\u90fd\u611f\u77e5\u4e0d\u5230)</li> <li>\u77ed\u8def\u8fd4\u56de\uff08\u4e0d\u8c03\u7528\u76ee\u6807\u65b9\u6cd5\uff09</li> </ul>"},{"location":"java/ssm/#51","title":"5.1 \u56fa\u5b9a\u5199\u6cd5","text":"<pre><code>@Aspect\n@Component\npublic class LogAspect {\n\n    @Around(\"execution(* com.example.service.*.*(..))\")\n    public Object around(ProceedingJoinPoint joinPoint) throws Throwable {\n        // \u83b7\u53d6\u65b9\u6cd5\u7b7e\u540d\n        Signature signature = joinPoint.getSignature();\n        String methodName = signature.getName();\n\n        // \u83b7\u53d6\u65b9\u6cd5\u53c2\u6570\n        Object[] args = joinPoint.getArgs();\n\n        System.out.println(\"\u3010\u73af\u7ed5\u524d\u7f6e\u3011\u65b9\u6cd5 \" + methodName + \" \u5f00\u59cb\u6267\u884c\uff0c\u53c2\u6570\uff1a\" + Arrays.toString(args));\n\n        Object result = null;\n        try {\n            // -----------------------------\n            // \u6838\u5fc3\uff1a\u51b3\u5b9a\u662f\u5426\u7ee7\u7eed\u6267\u884c\u76ee\u6807\u65b9\u6cd5\n            // \u53ef\u5728\u6b64\u5904\u4fee\u6539\u53c2\u6570\n            // args[0] = \"modifiedArg\";\n            result = joinPoint.proceed(args); // \u6267\u884c\u76ee\u6807\u65b9\u6cd5\uff08\u53ef\u4f20\u5165\u4fee\u6539\u540e\u7684\u53c2\u6570\uff09\n            // -----------------------------\n\n            System.out.println(\"\u3010\u73af\u7ed5\u8fd4\u56de\u3011\u65b9\u6cd5 \" + methodName + \" \u6267\u884c\u6210\u529f\uff0c\u8fd4\u56de\u503c\uff1a\" + result);\n            return result; // \u53ef\u5728\u6b64\u5904\u4fee\u6539\u8fd4\u56de\u503c\n        } catch (Exception e) {\n            System.out.println(\"\u3010\u73af\u7ed5\u5f02\u5e38\u3011\u65b9\u6cd5 \" + methodName + \" \u6267\u884c\u51fa\u9519\uff1a\" + e.getMessage());\n            throw e; // \u53ef\u4ee5\u5904\u7406\u6216\u5305\u88c5\u5f02\u5e38\n        } finally {\n            System.out.println(\"\u3010\u73af\u7ed5\u540e\u7f6e\u3011\u65b9\u6cd5 \" + methodName + \" \u6267\u884c\u7ed3\u675f\");\n        }\n    }\n}\n</code></pre>"},{"location":"java/ssm/#6-aop","title":"6. AOP \u7684\u5e94\u7528\u573a\u666f","text":"<p>pass(\u61d2\u5f97\u5199\u4e86)</p>"},{"location":"java/ssm/#_2","title":"\u4e09\u3001\u4e8b\u52a1\u2b50","text":"<p>\u200b   Spring \u4e2d\u7684\u4e8b\u52a1\u662f\u5bf9\u6570\u636e\u5e93\u4e8b\u52a1\u7684\u62bd\u8c61\u548c\u7ba1\u7406\u673a\u5236\uff0c\u5176\u6838\u5fc3\u76ee\u6807\u662f\uff1a\u8ba9\u5f00\u53d1\u8005\u65e0\u9700\u624b\u52a8\u7ba1\u7406 commit \u548c rollback\uff0c\u5c31\u80fd\u786e\u4fdd\u4e00\u7ec4\u6570\u636e\u5e93\u64cd\u4f5c\u5177\u5907 ACID \u7279\u6027\u3002</p>"},{"location":"java/ssm/#1spring","title":"1\u3001Spring \u8fde\u63a5\u6570\u636e\u5e93\u7684\u65b9\u6cd5","text":"<p>\u200b   1\uff09\u5bfc\u5165\u4f9d\u8d56\uff1a\u6570\u636e\u5e93\u9a71\u52a8\u3001spring-boot-starter- data-jdbc</p> <p>\u200b   2\uff09\u914d\u7f6e\u6570\u636e\u5e93\u8fde\u63a5\u4fe1\u606f\uff1a\u5728 xxx.properties \u4e2d\u7684 spring.datasource</p> <p>\u200b   3\uff09\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 DataSource\u3001 JDBCTemplate</p>"},{"location":"java/ssm/#2_2","title":"2\u3001\u5f00\u542f\u4e8b\u52a1\u7ba1\u7406","text":"<p>\u200b   1\uff09\u5728\u542f\u52a8\u7c7b\u4e0a\u52a0\u4e00\u4e2a\u6ce8\u89e3\uff1a@EnableTransactionManagement \u6307\u660e\u5f00\u542f\u4e8b\u52a1\u7ba1\u7406</p> <p>\u200b   2\uff09\u4e4b\u540e\u5728\u9700\u8981\u4e8b\u52a1\u7ba1\u7406\u7684\u65b9\u6cd5\u4e0a\u6dfb\u52a0\u4e00\u4e2a @Transactional \u5373\u53ef\u8fdb\u884c\u4e8b\u52a1\u7ba1\u7406</p>"},{"location":"java/ssm/#3_2","title":"3\u3001\u4e8b\u52a1\u7ba1\u7406\u7684\u539f\u7406","text":"<p>\u200b   Spring \u7684\u4e8b\u52a1\u7ba1\u7406\u662f\u57fa\u4e8e AOP\uff08\u9762\u5411\u5207\u9762\u7f16\u7a0b\uff09 + \u62e6\u622a\u5668\u6a21\u5f0f \u5b9e\u73b0\u7684\uff0c\u5176\u6838\u5fc3\u539f\u7406\u662f\u901a\u8fc7\u4ee3\u7406\u673a\u5236\uff0c\u5728\u76ee\u6807\u65b9\u6cd5\u6267\u884c\u524d\u540e\u81ea\u52a8\u63a7\u5236\u6570\u636e\u5e93\u4e8b\u52a1\u7684\u5f00\u542f\u3001\u63d0\u4ea4\u6216\u56de\u6eda\u3002</p>"},{"location":"java/ssm/#31","title":"3.1 \u52a8\u6001\u4ee3\u7406","text":"<p>\u5f53\u4e00\u4e2a\u65b9\u6cd5\u88ab <code>@Transactional</code> \u6ce8\u89e3\u6807\u8bb0\u65f6\uff1a</p> <ul> <li>Spring \u5bb9\u5668\u4f1a\u4e3a\u8be5 Bean \u521b\u5efa\u4e00\u4e2a\u4ee3\u7406\u5bf9\u8c61\uff08Proxy\uff09\u3002</li> <li>\u539f\u59cb\u5bf9\u8c61\u7684\u65b9\u6cd5\u8c03\u7528\u4f1a\u88ab\u4ee3\u7406\u62e6\u622a\u3002</li> <li>\u4ee3\u7406\u5728\u65b9\u6cd5\u6267\u884c\u524d\u5f00\u542f\u4e8b\u52a1\uff0c\u6267\u884c\u540e\u6839\u636e\u7ed3\u679c\u51b3\u5b9a\u63d0\u4ea4\u6216\u56de\u6eda\u3002</li> </ul>"},{"location":"java/ssm/#32","title":"3.2 \u5173\u952e\u7ec4\u4ef6","text":"\u7ec4\u4ef6 \u4f5c\u7528 <code>PlatformTransactionManager</code> \u4e8b\u52a1\u7ba1\u7406\u5668\u63a5\u53e3\uff0c\u8d1f\u8d23\u5b9e\u9645\u7684\u4e8b\u52a1\u64cd\u4f5c\uff08\u5982 <code>DataSourceTransactionManager</code>\uff09\u3002 <code>@Transactional</code> \u58f0\u660e\u5f0f\u4e8b\u52a1\u6ce8\u89e3\uff0c\u5b9a\u4e49\u4e8b\u52a1\u5c5e\u6027\uff08\u4f20\u64ad\u884c\u4e3a\u3001\u9694\u79bb\u7ea7\u522b\u7b49\uff09\u3002 <code>TransactionInterceptor</code> \u4e8b\u52a1\u62e6\u622a\u5668\uff0cAOP \u7684\u901a\u77e5\u903b\u8f91\uff0c\u771f\u6b63\u6267\u884c\u201c\u5f00\u542f \u2192 \u6267\u884c \u2192 \u63d0\u4ea4/\u56de\u6eda\u201d\u7684\u6d41\u7a0b\u3002 <code>TransactionSynchronizationManager</code> \u7ed1\u5b9a\u5f53\u524d\u7ebf\u7a0b\u4e0e\u4e8b\u52a1\u8d44\u6e90\uff08\u5982 Connection\uff09\uff0c\u4fdd\u8bc1\u540c\u4e00\u4e2a\u4e8b\u52a1\u4e2d\u4f7f\u7528\u540c\u4e00\u4e2a\u6570\u636e\u5e93\u8fde\u63a5\u3002"},{"location":"java/ssm/#33","title":"3.3 \u6267\u884c\u6d41\u7a0b","text":"<pre><code>1. \u8c03\u7528 @Transactional \u65b9\u6cd5\n        \u2193\n2. \u4ee3\u7406\u62e6\u622a\uff08TransactionInterceptor\uff09\n        \u2193\n3. \u83b7\u53d6\u4e8b\u52a1\u7ba1\u7406\u5668\uff08PlatformTransactionManager\uff09\n        \u2193\n4. \u5f00\u542f\u4e8b\u52a1\uff08doBegin\uff09 \u2192 \u83b7\u53d6 Connection \u5e76\u7ed1\u5b9a\u5230\u5f53\u524d\u7ebf\u7a0b\n        \u2193\n5. \u6267\u884c\u4e1a\u52a1\u65b9\u6cd5\uff08\u6240\u6709 DAO \u64cd\u4f5c\u5171\u4eab\u540c\u4e00 Connection\uff09\n        \u2193\n6. \u65b9\u6cd5\u6b63\u5e38\u7ed3\u675f \u2192 \u63d0\u4ea4\u4e8b\u52a1\n        \u2193\n7. \u5f02\u5e38\u629b\u51fa \u2192 \u56de\u6eda\u4e8b\u52a1\uff08\u9ed8\u8ba4 RuntimeException \u548c Error\uff09\n        \u2193\n8. \u6e05\u7406\u8d44\u6e90\uff08\u89e3\u7ed1 Connection\uff09\n</code></pre>"},{"location":"java/ssm/#4transactional","title":"4\u3001@Transactional","text":"<p>\u200b   <code>@Transactional</code> \u662f Spring \u6846\u67b6\u63d0\u4f9b\u7684\u58f0\u660e\u5f0f\u4e8b\u52a1\u7ba1\u7406\u6ce8\u89e3\uff0c\u5f00\u53d1\u8005\u53ea\u9700\u5728\u65b9\u6cd5\u6216\u7c7b\u4e0a\u6dfb\u52a0\u8be5\u6ce8\u89e3\uff0c\u5373\u53ef\u81ea\u52a8\u83b7\u5f97\u4e8b\u52a1\u652f\u6301\uff0c\u65e0\u9700\u624b\u52a8\u7f16\u5199 <code>commit</code> \u548c <code>rollback</code> \u4ee3\u7801\u3002</p>"},{"location":"java/ssm/#41","title":"4.1 \u8be5\u6ce8\u89e3\u7684\u5c5e\u6027","text":"<p>\u200b   timeout\uff1a\u5f53\u4e8b\u52a1\u8d85\u8fc7\u8fd9\u4e2a\u4e8b\u4ef6\u540e\uff0c\u5c31\u4f1a\u56de\u6eda\u3002</p> <p>\u200b   readOnly\uff1a\u53ea\u8bfb\u4f18\u5316\uff08\u4f18\u5316\u64cd\u4f5c\uff0c\u5c31\u4e0d\u9700\u8981\u5f00\u542f\u4e00\u5806\u4e8b\u52a1\u7ba1\u7406\u76f8\u5173\u7684\u4e1c\u897f\u4e86\uff09</p> <p>\u200b   rollbackFor\uff1aDefines zero (0) or more exception types, which must be subclasses of Throwable, indicating which exception types must cause a transaction rollback.</p> <p>\u200b   \u6ce8\uff1a\u8fd0\u884c\u65f6\u5f02\u5e38\u90fd\u56de\u6eda\uff0c\u800c\u7f16\u8bd1\u65f6\u5f02\u5e38\u4e0d\u56de\u6eda\u3002\u800crollbackFor\u5c31\u662f\u7528\u6765\u6307\u5b9a\u90a3\u4e9b\u5f02\u5e38\u9700\u8981\u56de\u6eda</p> <p>\u200b   \u4e0b\u9762\uff0c\u91cd\u70b9\u5c5e\u6027\u5355\u72ec\u4ecb\u7ecd</p>"},{"location":"java/ssm/#42-isolation","title":"4.2 \u9694\u79bb\u7ea7\u522b isolation","text":"<p>\u200b   \u9694\u79bb\u6027\uff08Isolation\uff09 \u662f\u4e8b\u52a1 ACID \u7279\u6027\u4e2d\u7684 \"I\"\uff0c\u5b83\u63a7\u5236\u7684\u662f\uff1a\u591a\u4e2a\u4e8b\u52a1\u5e76\u53d1\u6267\u884c\u65f6\uff0c\u5f7c\u6b64\u4e4b\u95f4\u7684\u53ef\u89c1\u6027\u548c\u5f71\u54cd\u7a0b\u5ea6\u3002\u5982\u679c\u5b8c\u5168\u4e0d\u9694\u79bb \u2192 \u6570\u636e\u6df7\u4e71\u3002\u5982\u679c\u5b8c\u5168\u9694\u79bb \u2192 \u6027\u80fd\u6781\u5dee\uff0c\u51e0\u4e4e\u4e32\u884c\u6267\u884c\u3002\u6240\u4ee5\uff0c\u6570\u636e\u5e93\u63d0\u4f9b\u4e86 \u4e0d\u540c\u7684\u9694\u79bb\u7ea7\u522b\uff0c\u5728\u6570\u636e\u4e00\u81f4\u6027\u548c\u5e76\u53d1\u6027\u80fd\u4e4b\u95f4\u505a\u6743\u8861\u3002</p> <p>\u200b   \u4e00\u4e9b\u5e76\u53d1\u95ee\u9898\u4ecb\u7ecd\uff1a</p> \u95ee\u9898 \u5b9a\u4e49 \u793a\u4f8b \u810f\u8bfb\uff08Dirty Read\uff09 \u4e00\u4e2a\u4e8b\u52a1\u8bfb\u53d6\u4e86\u53e6\u4e00\u4e2a\u4e8b\u52a1\u5c1a\u672a\u63d0\u4ea4\u7684\u6570\u636e\u3002 \u4e8b\u52a1 A \u4fee\u6539\u4e86\u6570\u636e\u4f46\u672a\u63d0\u4ea4\uff0c\u4e8b\u52a1 B \u8bfb\u5230\u4e86\u8fd9\u4e2a\u4fee\u6539\uff1b\u5982\u679c A \u56de\u6eda\uff0cB \u8bfb\u5230\u7684\u5c31\u662f\u201c\u810f\u201d\u6570\u636e\u3002 \u4e0d\u53ef\u91cd\u590d\u8bfb\uff08Non-repeatable Read\uff09 \u5728\u540c\u4e00\u4e2a\u4e8b\u52a1\u4e2d\uff0c\u4e24\u6b21\u8bfb\u53d6\u540c\u4e00\u884c\u6570\u636e\uff0c\u7ed3\u679c\u4e0d\u540c\u3002 \u4e8b\u52a1 A \u7b2c\u4e00\u6b21\u8bfb id=1 \u7684\u8bb0\u5f55\u4e3a name='\u5f20\u4e09'\uff1b\u4e8b\u52a1 B \u5c06\u5176\u6539\u4e3a '\u674e\u56db' \u5e76\u63d0\u4ea4\uff1bA \u518d\u6b21\u8bfb\u53d6\uff0c\u53d8\u6210\u4e86 '\u674e\u56db'\u3002 \u5e7b\u8bfb\uff08Phantom Read\uff09 \u5728\u540c\u4e00\u4e2a\u4e8b\u52a1\u4e2d\uff0c\u4e24\u6b21\u6267\u884c\u76f8\u540c\u67e5\u8be2\uff0c\u8fd4\u56de\u7684\u884c\u6570\u4e0d\u540c\uff08\u51fa\u73b0\u4e86\u201c\u5e7b\u5f71\u201d\u884c\uff09\u3002 \u4e8b\u52a1 A \u67e5\u8be2 <code>age &gt; 18</code> \u6709 3 \u6761\u8bb0\u5f55\uff1b\u4e8b\u52a1 B \u63d2\u5165\u4e00\u6761 <code>age=20</code> \u7684\u8bb0\u5f55\u5e76\u63d0\u4ea4\uff1bA \u518d\u6b21\u67e5\u8be2\uff0c\u53d8\u6210 4 \u6761\u3002 <p>\u200b   \u9694\u79bb\u7ea7\u522b\uff1a</p> \u9694\u79bb\u7ea7\u522b \u810f\u8bfb \u4e0d\u53ef\u91cd\u590d\u8bfb \u5e7b\u8bfb \u8bf4\u660e READ UNCOMMITTED\uff08\u8bfb\u672a\u63d0\u4ea4\uff09 \u2705 \u5141\u8bb8 \u2705 \u5141\u8bb8 \u2705 \u5141\u8bb8 \u6700\u4f4e\u7ea7\u522b\uff0c\u6027\u80fd\u6700\u597d\uff0c\u4f46\u6570\u636e\u6700\u4e0d\u5b89\u5168\u3002 READ COMMITTED\uff08\u8bfb\u5df2\u63d0\u4ea4\uff09 \u274c \u7981\u6b62 \u2705 \u5141\u8bb8 \u2705 \u5141\u8bb8 \u5927\u591a\u6570\u6570\u636e\u5e93\u9ed8\u8ba4\u7ea7\u522b\uff08\u5982 Oracle\u3001SQL Server\uff09\u3002\u53ea\u80fd\u8bfb\u5df2\u63d0\u4ea4\u7684\u6570\u636e\u3002 REPEATABLE READ\uff08\u53ef\u91cd\u590d\u8bfb\uff09 \u274c \u7981\u6b62 \u274c \u7981\u6b62 \u2705 \u5141\u8bb8\uff08\u90e8\u5206\u6570\u636e\u5e93\u4e0d\u5141\u8bb8\uff09 MySQL \u9ed8\u8ba4\u7ea7\u522b\u3002\u4fdd\u8bc1\u4e8b\u52a1\u5185\u591a\u6b21\u8bfb\u53d6\u540c\u4e00\u6570\u636e\u7ed3\u679c\u4e00\u81f4\u3002 SERIALIZABLE\uff08\u4e32\u884c\u5316\uff09 \u274c \u7981\u6b62 \u274c \u7981\u6b62 \u274c \u7981\u6b62 \u6700\u9ad8\u7ea7\u522b\uff0c\u4e8b\u52a1\u4e32\u884c\u6267\u884c\uff0c\u907f\u514d\u6240\u6709\u5e76\u53d1\u95ee\u9898\uff0c\u4f46\u6027\u80fd\u6700\u5dee\u3002"},{"location":"java/ssm/#43-propagation","title":"4.3 \u4f20\u64ad\u884c\u4e3a propagation","text":"<p>\u200b   \u4f20\u64ad\u884c\u4e3a\uff08Propagation Behavior\uff09 \u662f\u6307\uff1a\u5f53\u4e00\u4e2a\u4e8b\u52a1\u65b9\u6cd5\u88ab\u53e6\u4e00\u4e2a\u4e8b\u52a1\u65b9\u6cd5\u8c03\u7528\u65f6\uff0c\u4e8b\u52a1\u8be5\u5982\u4f55\u8fdb\u884c\u4f20\u64ad\u6216\u5904\u7406\u3002\u6362\u53e5\u8bdd\u8bf4\uff1a  \"\u6211\u5df2\u7ecf\u5728\u4e00\u4e2a\u4e8b\u52a1\u91cc\u4e86\uff0c\u73b0\u5728\u53c8\u8c03\u7528\u4e86\u53e6\u4e00\u4e2a\u6807\u6709 <code>@Transactional</code> \u7684\u65b9\u6cd5\uff0c\u90a3\u8fd9\u4e2a\u65b0\u65b9\u6cd5\u662f\u52a0\u5165\u5f53\u524d\u4e8b\u52a1\uff1f\u65b0\u5efa\u4e00\u4e2a\u4e8b\u52a1\uff1f\u8fd8\u662f\u4e0d\u4f7f\u7528\u4e8b\u52a1\uff1f\u201d</p> <p>\u200b   \u8fd9\u5c31\u662f \u4e8b\u52a1\u7684\u4f20\u64ad\u884c\u4e3a \u8981\u89e3\u51b3\u7684\u95ee\u9898\u3002</p> <pre><code>\u7c7b\u6bd4\u7406\u89e3\n\n\u60f3\u8c61\u4f60\u6b63\u5728\u505a\u4e00\u987f\u996d\uff08\u5916\u5c42\u4e8b\u52a1\uff09\uff0c\u8fc7\u7a0b\u4e2d\u9700\u8981\u6d17\u83dc\u3001\u5207\u83dc\u3001\u7092\u83dc\u3002\n\n- \u5982\u679c\u201c\u6d17\u83dc\u201d\u4e5f\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u4efb\u52a1\uff08\u5185\u5c42\u65b9\u6cd5\uff09\uff0c\u4f46\u5b83\u5fc5\u987b\u548c\u505a\u996d\u5728\u540c\u4e00\u4e2a\u6d41\u7a0b\u4e2d\u5b8c\u6210 \u2192 \u90a3\u5b83\u5c31**\u52a0\u5165\u5f53\u524d\u4e8b\u52a1**\u3002\n- \u5982\u679c\u201c\u63a5\u4e2a\u7535\u8bdd\u201d\u662f\u4e00\u4e2a\u64cd\u4f5c\uff0c\u5b83\u4e0d\u5f71\u54cd\u505a\u996d \u2192 \u5b83\u53ef\u4ee5**\u4e0d\u53c2\u4e0e\u4e8b\u52a1**\u3002\n- \u5982\u679c\u201c\u5c1d\u4e00\u53e3\u54b8\u6de1\u201d\u5931\u8d25\u4e86\uff0c\u4f60\u60f3\u56de\u6eda\u6574\u4e2a\u505a\u996d\u8fc7\u7a0b \u2192 \u90a3\u5b83\u5c31\u548c\u5916\u5c42\u4e8b\u52a1**\u7ed1\u5b9a\u5728\u4e00\u8d77**\u3002\n- \u5982\u679c\u201c\u70e7\u4e00\u58f6\u6c34\u201d\u662f\u53e6\u4e00\u4e2a\u72ec\u7acb\u4efb\u52a1\uff0c\u5373\u4f7f\u5b83\u5931\u8d25\u4e5f\u4e0d\u5f71\u54cd\u505a\u996d \u2192 \u5b83\u5e94\u8be5**\u5f00\u542f\u4e00\u4e2a\u65b0\u4e8b\u52a1**\u3002\n\n\u8fd9\u5c31\u662f\u4e0d\u540c\u4f20\u64ad\u884c\u4e3a\u7684\u73b0\u5b9e\u6620\u5c04\u3002\n\n\nSpring \u4e2d\u7684 7 \u79cd\u4f20\u64ad\u884c\u4e3a\n\n| \u4f20\u64ad\u884c\u4e3a | \u542b\u4e49 |\n|--------|------|\n| `REQUIRED`\uff08\u9ed8\u8ba4\uff09 | \u5982\u679c\u5f53\u524d\u6709\u4e8b\u52a1\uff0c\u5c31\u52a0\u5165\uff1b\u6ca1\u6709\u5c31\u65b0\u5efa\u4e00\u4e2a\u3002 |\n| `REQUIRES_NEW` | \u65e0\u8bba\u5f53\u524d\u662f\u5426\u6709\u4e8b\u52a1\uff0c\u90fd**\u6302\u8d77\u5f53\u524d\u4e8b\u52a1\uff0c\u65b0\u5efa\u4e00\u4e2a\u65b0\u4e8b\u52a1**\u3002 |\n| `SUPPORTS` | \u652f\u6301\u5f53\u524d\u4e8b\u52a1\uff0c\u4f46\u5982\u679c\u5f53\u524d\u6ca1\u6709\u4e8b\u52a1\uff0c\u4e5f\u4e0d\u521b\u5efa\u65b0\u4e8b\u52a1\uff08\u4ee5\u975e\u4e8b\u52a1\u65b9\u5f0f\u8fd0\u884c\uff09\u3002 |\n| `NOT_SUPPORTED` | \u4e0d\u652f\u6301\u4e8b\u52a1\uff0c**\u4ee5\u975e\u4e8b\u52a1\u65b9\u5f0f\u6267\u884c**\uff0c\u5982\u679c\u5f53\u524d\u6709\u4e8b\u52a1\u5219\u5c06\u5176\u6302\u8d77\u3002 |\n| `MANDATORY` | \u5fc5\u987b\u5728\u4e8b\u52a1\u4e2d\u8fd0\u884c\uff0c\u5982\u679c\u5f53\u524d\u6ca1\u6709\u4e8b\u52a1\uff0c\u5219\u629b\u51fa\u5f02\u5e38\u3002 |\n| `NEVER` | \u4e0d\u80fd\u5728\u4e8b\u52a1\u4e2d\u8fd0\u884c\uff0c\u5982\u679c\u5f53\u524d\u6709\u4e8b\u52a1\uff0c\u5219\u629b\u51fa\u5f02\u5e38\u3002 |\n| `NESTED` | \u5982\u679c\u5f53\u524d\u6709\u4e8b\u52a1\uff0c\u5219\u5728\u5d4c\u5957\u4e8b\u52a1\u4e2d\u6267\u884c\uff1b\u5426\u5219\u65b0\u5efa\u4e00\u4e2a\u4e8b\u52a1\u3002\uff08\u7c7b\u4f3c `REQUIRED`\uff0c\u4f46\u53ef\u72ec\u7acb\u56de\u6eda\uff09 \n</code></pre>"},{"location":"java/ssm/#springmvc","title":"\u56db\u3001SpringMvc\u2b50\u2b50","text":""},{"location":"java/ssm/#1-requestmapping","title":"1. RequestMapping","text":"<p>\u200b   \u8def\u5f84\u6620\u5c04\uff1a\u8d1f\u8d23\u6620\u5c04\u65b9\u6cd5\u4e0e\u8bf7\u6c42\u8def\u5f84\u3002</p> <p>\u200b   \u8def\u5f84\u4f4d\u7f6e\u901a\u914d\u7b26\uff1a*\u5339\u914d\u4efb\u610f\u591a\u5b57\u7b26  ** \u5339\u914d\u4efb\u610f\u591a\u5c42\u8def\u5f84  \uff1f\u5339\u914d\u5355\u4e2a\u5b57\u7b26  \u5982\u679c\u6709\u591a\u4e2a\u65b9\u6cd5\u90fd\u80fd\u5339\u914d\u4e0a\u8bf7\u6c42\u8def\u5f84\uff0c\u5219\u6309\u7740\u7cbe\u786e\u5ea6\u6765\u5904\u7406\uff0c\u4e5f\u5c31\u662f\u8d8a\u7cbe\u786e\uff0c\u8d8a\u4f18\u5148\u3002</p>"},{"location":"java/ssm/#_3","title":"\u8bf7\u6c42\u9650\u5b9a\uff1a","text":"<p>\u200b   1\uff09method</p> <p>\u200b   2\uff09params</p> <p>\u200b   3\uff09headers</p> <p>\u200b   4\uff09consumes</p> <p>\u200b   5\uff09produces</p>"},{"location":"java/ssm/#2-springmvc","title":"2. SpringMvc \u4e2d\u7684\u8bf7\u6c42\u5904\u7406","text":""},{"location":"java/ssm/#1keyvalue","title":"1\u3001\u63a5\u6536\u666e\u901a\u8bf7\u6c42\u53c2\u6570\uff08<code>?key=value</code>\uff09","text":"<p>\u200b   \u9002\u7528\u4e8e GET \u8bf7\u6c42\u7684\u67e5\u8be2\u53c2\u6570 \u6216 POST \u8bf7\u6c42\u7684\u8868\u5355\u6570\u636e\u3002\u76f4\u63a5\u7ed1\u5b9a\u6216\u8005\u7528 @RequestParam \u6ce8\u89e3</p>"},{"location":"java/ssm/#2restful","title":"2\u3001\u63a5\u53d7\u8def\u5f84\u53d8\u91cf\uff08RESTful \u98ce\u683c\uff09","text":"<pre><code>@GetMapping(\"/user/{id}\")\npublic String getUserById(@PathVariable Long id) {\n    System.out.println(\"\u7528\u6237ID\uff1a\" + id);\n    return \"user\";\n}               \n</code></pre>"},{"location":"java/ssm/#3jsonxml","title":"3\u3001\u63a5\u6536\u8bf7\u6c42\u4f53\uff08JSON/XML\uff09\u6570\u636e","text":"<pre><code>@PostMapping(\"/user\")\npublic String createUser(@RequestBody User user) {\n    System.out.println(\"\u521b\u5efa\u7528\u6237\uff1a\" + user.getName());\n    return \"created\";\n}\n</code></pre> <ul> <li>\u5ba2\u6237\u7aef\u8bbe\u7f6e <code>Content-Type: application/json</code></li> <li>\u540e\u7aef\u6709 Jackson/Gson \u7b49 JSON \u8f6c\u6362\u5668\uff08Spring Boot \u9ed8\u8ba4\u96c6\u6210\uff09</li> </ul>"},{"location":"java/ssm/#4_2","title":"4\u3001\u63a5\u6536\u6587\u4ef6\u4e0a\u4f20","text":"<pre><code>@PostMapping(\"/upload\")\npublic String uploadFile(@RequestPart(\"file\") MultipartFile file,\n                         @RequestParam String description) {\n    System.out.println(\"\u6587\u4ef6\u540d\uff1a\" + file.getOriginalFilename());\n    System.out.println(\"\u63cf\u8ff0\uff1a\" + description);\n    return \"uploaded\";\n}\n</code></pre>"},{"location":"java/ssm/#5-json","title":"5\u3001\u81ea\u52a8\u7ed1\u5b9a\u5bf9\u8c61\uff08\u8868\u5355\u6216 JSON\uff09","text":"<pre><code>public class User {\n    private String name;\n    private int age;\n    // getter/setter\n}\n\n@PostMapping(\"/user/form\")\npublic String createUserForm(User user) {\n    System.out.println(\"\u7528\u6237\uff1a\" + user.getName());\n    return \"success\";\n}\n</code></pre> <ul> <li>\u8868\u5355\u63d0\u4ea4 \u2192 \u4f7f\u7528 <code>User user</code></li> <li>JSON \u63d0\u4ea4 \u2192 \u5fc5\u987b\u52a0 <code>@RequestBody</code></li> </ul>"},{"location":"java/ssm/#6header","title":"6\u3001\u63a5\u6536\u8bf7\u6c42\u5934\uff08Header\uff09\u4fe1\u606f","text":"<pre><code>@GetMapping(\"/info\")\npublic String getInfo(@RequestHeader(\"User-Agent\") String userAgent,\n                      @RequestHeader(\"Authorization\") String token) {\n    System.out.println(\"\u6d4f\u89c8\u5668\uff1a\" + userAgent);\n    System.out.println(\"Token\uff1a\" + token);\n    return \"info\";\n}\n</code></pre>"},{"location":"java/ssm/#7-cookies","title":"7. \u63a5\u6536 Cookies","text":"<pre><code>@GetMapping(\"/cookie\")\npublic String getCookie(@CookieValue(\"JSESSIONID\") String sessionId) {\n    System.out.println(\"Session ID\uff1a\" + sessionId);\n    return \"cookie\";\n}\n</code></pre>"},{"location":"java/ssm/#8http","title":"8\u3001\u83b7\u53d6\u6574\u4e2ahttp\u8bf7\u6c42","text":"<pre><code>    /**\n     *\n     * @param httpEntity \u5b83\u7684\u6cdb\u578b\u5c31\u662f\u8981\u628a http \u8bf7\u6c42\u4f53\u8f6c\u4e3a\u8fd9\u4e2a\u6cdb\u578b\n     * @return\n     */\n    @PostMapping(\"/test03\")\n    public String test03(HttpEntity&lt;User&gt; httpEntity){\n        // \u83b7\u5f97\u8bf7\u6c42\u5934\n        httpEntity.getHeaders().forEach((n, v) -&gt; System.out.println(n + \":\" + v));\n        // \u83b7\u5f97\u8bf7\u6c42\u53c2\u6570\n        System.out.println(\"user = \" +  httpEntity.getBody());\n        return \"ok_test03\";\n    }\n</code></pre>"},{"location":"java/ssm/#3-springmvc","title":"3. SpringMvc \u4e2d\u7684\u54cd\u5e94\u5904\u7406","text":""},{"location":"java/ssm/#1-json","title":"1. \u8fd4\u56dejson","text":"<p>\u200b   \u6ce8\u89e3 @ResponseBody \u80fd\u591f\u5c06\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u81ea\u52a8\u7684\u5c01\u88c5\u4e3ajson\uff0c\u73b0\u5728\u90fd\u7528\u7ec4\u5408\u6ce8\u89e3 @RestController</p>"},{"location":"java/ssm/#2_3","title":"2. \u6587\u4ef6\u4e0b\u8f7d\uff08\u8fd4\u56de\u7684\u6570\u636e\u662f\u8ba9\u6d4f\u89c8\u5668\u4e0b\u8f7d\u7684\uff09","text":"<pre><code>  @RequestMapping(\"/test03\")\n    public ResponseEntity&lt;byte[]&gt; download() throws Exception{\n        FileInputStream fileInputStream = new FileInputStream(\"E:\\\\school_work\\\\glories\\\\\u5934\u50cf\\\\2.jpg\");\n\n        byte[] alls = fileInputStream.readAllBytes();\n\n        return ResponseEntity.ok().contentType(MediaType.APPLICATION_OCTET_STREAM).contentLength(alls.length)\n                .header(\"Content-Disposition\", \"attachment;filename=2.jpg\")\n                .body(alls);\n    }\n</code></pre> <p>\u95ee\u98981\uff1a\u6587\u4ef6\u540d\u5982\u679c\u662f\u4e2d\u6587\u4f1a\u4e71\u7801</p> <p>\u95ee\u98982\uff1a\u6587\u4ef6\u592a\u5927\u4f1a\u51fa\u73b0oom</p> <pre><code>@RequestMapping(\"/test03\")\n    public ResponseEntity&lt;InputStreamResource&gt; download() throws Exception{\n\n        FileInputStream fileInputStream = new FileInputStream(\"E:\\\\school_work\\\\glories\\\\\u5934\u50cf\\\\2.jpg\");\n        // \u4e00\u53e3\u6c14\u8bfb\u4f1a\u5f02\u5e38\n//        byte[] alls = fileInputStream.readAllBytes();\n        InputStreamResource resource = new InputStreamResource(fileInputStream)\n        // \u89e3\u51b3\u4e2d\u6587\u4e71\u7801\uff1a\u628a\u4e2d\u6587\u8f6c\u7801\u6210utf-8\n        String name = URLEncoder.encode(\"\u54c8\u54c8.jpg\", \"utf-8\");\n\n        return ResponseEntity.ok().contentType(MediaType.APPLICATION_OCTET_STREAM).contentLength(fileInputStream.available())\n                .header(\"Content-Disposition\", \"attachment;filename=\"+ name)\n                .body(resource);\n    }\n</code></pre>"},{"location":"java/ssm/#spring-mvc","title":"\u4e94\u3001Spring Mvc \u7684\u6700\u4f73\u5b9e\u8df5\uff01\uff01\uff01\u2b50\u2b50\u2b50","text":""},{"location":"java/ssm/#1-restful","title":"1. RESTful\u98ce\u683c\u2b50\u2b50\u2b50","text":"<p>\u200b   REST \u5c31\u662f\u628a\u4efb\u4f55web\u8bf7\u6c42\u770b\u4f5c\u662f\u5bf9\u8d44\u6e90\u7684\u64cd\u4f5c\uff0c\u5bf9\u540c\u4e00\u8d44\u6e90\u7684\u4e0d\u540c\u64cd\u4f5c\uff0c\u4ed6\u4eec\u7684\u8bf7\u6c42\u8def\u5f84\u662f\u4e00\u6837\u7684\uff0c\u5177\u4f53\u662f\u901a\u8fc7\u4e0d\u540c\u7684\u52a8\u4f5c\u6765\u533a\u5206\u4e0d\u540c\u5904\u7406\u65b9\u6cd5\u7684\u3002</p>"},{"location":"java/ssm/#2_4","title":"2. \u62e6\u622a\u5668\u2b50\u2b50","text":""},{"location":"java/ssm/#1_3","title":"1. \u6982\u5ff5","text":"<p>\u200b   \u62e6\u622a\u5668\uff08Interceptor\uff09 \u662f Spring MVC \u63d0\u4f9b\u7684\u4e00\u79cd\u673a\u5236\uff0c\u7528\u4e8e\u5728 \u8bf7\u6c42\u5904\u7406\u7684\u524d\u540e \u5bf9\u8bf7\u6c42\u8fdb\u884c\u9884\u5904\u7406\u6216\u540e\u5904\u7406\uff0c\u800c\u65e0\u9700\u4fee\u6539\u6bcf\u4e2a\u63a7\u5236\u5668\u7684\u4ee3\u7801\u3002\u5b83\u7c7b\u4f3c\u4e8e Servlet \u4e2d\u7684 Filter\uff08\u8fc7\u6ee4\u5668\uff09\uff0c\u4f46\u66f4\u8d34\u8fd1 Spring MVC \u7684\u6267\u884c\u6d41\u7a0b\uff0c\u4e3b\u8981\u7528\u4e8e\uff1a</p> <ul> <li>\u6743\u9650\u6821\u9a8c\uff08\u5982\u767b\u5f55\u68c0\u67e5\uff09</li> <li>\u65e5\u5fd7\u8bb0\u5f55</li> <li>\u6027\u80fd\u76d1\u63a7\uff08\u7edf\u8ba1\u8bf7\u6c42\u8017\u65f6\uff09</li> <li>\u8bf7\u6c42\u53c2\u6570\u9884\u5904\u7406</li> <li>\u9632\u6b62\u91cd\u590d\u63d0\u4ea4</li> <li>\u7f16\u7801\u8bbe\u7f6e\u7b49</li> </ul>"},{"location":"java/ssm/#2_5","title":"2. \u6267\u884c\u65f6\u673a\uff08\u4e0e\u8bf7\u6c42\u751f\u547d\u5468\u671f\u7684\u5173\u7cfb\uff09","text":"<p>\u200b   \u8bf7\u6c42 \u2192 preHandle() \u2192 (\u76ee\u6807\u65b9\u6cd5 execute) \u2192 postHandle() \u2192 (\u89c6\u56fe\u6e32\u67d3) \u2192 afterCompletion()</p>"},{"location":"java/ssm/#3_3","title":"3. \u4e09\u4e2a\u6838\u5fc3\u65b9\u6cd5","text":"\u65b9\u6cd5 \u89e6\u53d1\u65f6\u673a \u8fd4\u56de\u503c\u542b\u4e49 <code>boolean preHandle(HttpServletRequest, HttpServletResponse, Object handler)</code> \u63a7\u5236\u5668\u65b9\u6cd5\u6267\u884c\u524d <code>true</code>\uff1a\u653e\u884c\uff0c\u7ee7\u7eed\u6267\u884c\uff1b<code>false</code>\uff1a\u4e2d\u65ad\uff0c\u4e0d\u518d\u6267\u884c\u540e\u7eed\u64cd\u4f5c <code>void postHandle(HttpServletRequest, HttpServletResponse, Object handler, ModelAndView modelAndView)</code> \u63a7\u5236\u5668\u65b9\u6cd5\u6267\u884c\u540e\uff0c\u89c6\u56fe\u6e32\u67d3\u524d \u901a\u5e38\u7528\u4e8e\u4fee\u6539 Model \u6216 View <code>void afterCompletion(HttpServletRequest, HttpServletResponse, Object handler, Exception ex)</code> \u6574\u4e2a\u8bf7\u6c42\u5b8c\u6210\u4e4b\u540e\uff08\u89c6\u56fe\u6e32\u67d3\u5b8c\u6bd5\uff09 \u7528\u4e8e\u8d44\u6e90\u6e05\u7406\u3001\u5f02\u5e38\u5904\u7406\u7b49 <p>\u26a0\ufe0f \u6ce8\u610f\uff1a - <code>postHandle</code> \u548c <code>afterCompletion</code> \u53ea\u6709\u5728 <code>preHandle</code> \u8fd4\u56de <code>true</code> \u65f6\u624d\u4f1a\u6267\u884c\u3002 - \u5982\u679c <code>preHandle</code> \u8fd4\u56de <code>false</code>\uff0c\u5219\u540e\u7eed\u90fd\u4e0d\u4f1a\u6267\u884c\u3002</p>"},{"location":"java/ssm/#4_3","title":"4. \u5b9e\u73b0\u65b9\u5f0f","text":"<p>\u200b   Spring MVC \u4e2d\u5b9e\u73b0\u62e6\u622a\u5668\u6709\u4e24\u79cd\u4e3b\u8981\u65b9\u5f0f\uff1a\u7b2c\u4e8c\u79cd\u8fc7\u65f6\u4e86\uff0c\u5c31\u4e0d\u8bb0\u5f55\u4e86\u3002</p> <p>\u2705 \u65b9\u5f0f\u4e00\uff1a\u5b9e\u73b0 <code>HandlerInterceptor</code> \u63a5\u53e3\uff08\u63a8\u8350\uff09\uff0c</p> <pre><code>import org.springframework.web.servlet.HandlerInterceptor;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\npublic class LoginInterceptor implements HandlerInterceptor {\n\n    @Override\n    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {\n        // \u6a21\u62df\u767b\u5f55\u68c0\u67e5\n        Object user = request.getSession().getAttribute(\"user\");\n        if (user == null) {\n            response.sendRedirect(\"/login\"); // \u672a\u767b\u5f55\uff0c\u8df3\u8f6c\u5230\u767b\u5f55\u9875\n            return false; // \u4e2d\u65ad\u8bf7\u6c42\n        }\n        return true; // \u653e\u884c\n    }\n\n    @Override\n    public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception {\n        // \u53ef\u4ee5\u4fee\u6539 modelAndView\uff0c\u6bd4\u5982\u6dfb\u52a0\u516c\u5171\u6570\u636e\n        System.out.println(\"postHandle: \u63a7\u5236\u5668\u6267\u884c\u5b8c\u6bd5\");\n    }\n\n    @Override\n    public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception {\n        // \u8bf7\u6c42\u7ed3\u675f\uff0c\u53ef\u7528\u4e8e\u6e05\u7406\u8d44\u6e90\n        System.out.println(\"afterCompletion: \u8bf7\u6c42\u5df2\u5b8c\u6210\");\n    }\n}\n</code></pre> <p>\u200b   \u5f53\u5199\u5b8c\u81ea\u5b9a\u4e49\u7684\u62e6\u622a\u5668\u540e\uff0c\u8981\u628a\u5b83\u6ce8\u518c\u5230 Spring MVC \u7684\u62e6\u622a\u5668\u94fe\u4e2d\u3002\uff08\u901a\u8fc7 WebMvcConfigurer\uff09</p> <pre><code>@Configuration\npublic class WebConfig implements WebMvcConfigurer {\n\n    @Override\n    public void addInterceptors(InterceptorRegistry registry) {\n        registry.addInterceptor(new LoginInterceptor())\n                .addPathPatterns(\"/admin/**\")        // \u62e6\u622a\u54ea\u4e9b\u8def\u5f84\n                .excludePathPatterns(\"/login\", \"/css/**\", \"/js/**\"); // \u653e\u884c\u54ea\u4e9b\u8def\u5f84\n    }\n}   \n</code></pre>"},{"location":"java/ssm/#5-interceptor","title":"5. Interceptor \u7684\u6267\u884c\u987a\u5e8f","text":"<p>\u200b   preHandle\u987a\u5e8f\u6267\u884c\uff0cpostHandle, afterCompletation \u5012\u5e8f\u6267\u884c\uff0c\u6709\u4e00\u4e2a\u62e6\u622a\u5668\u4e0d\u653e\u884c\uff0c\u6240\u6709 postHandle \u90fd\u4e0d\u80fd\u6267\u884c\uff0c \u90a3\u4e9b\u653e\u884c\u7684\u62e6\u622a\u5668\u7684 afterCompletation \u53ef\u4ee5\u6267\u884c\u3002</p>"},{"location":"java/ssm/#6-interceptor-fliter","title":"6. Interceptor \u4e0e Fliter \u7684\u533a\u522b","text":"<p>\u200b    <code>Interceptor</code>\uff08\u62e6\u622a\u5668\uff09\u548c <code>Filter</code>\uff08\u8fc7\u6ee4\u5668\uff09\u90fd\u7528\u4e8e\u5bf9\u8bf7\u6c42\u8fdb\u884c\u9884\u5904\u7406\uff0c\u4f46 <code>Filter</code> \u662f Servlet \u89c4\u8303\u7684\u4e00\u90e8\u5206\uff0c\u4f5c\u7528\u4e8e\u6574\u4e2a Web \u8bf7\u6c42\u751f\u547d\u5468\u671f\uff0c\u80fd\u62e6\u622a\u6240\u6709\u8bf7\u6c42\uff08\u5305\u62ec\u9759\u6001\u8d44\u6e90\uff09\uff0c\u4e14\u4e0d\u4f9d\u8d56 Spring \u5bb9\u5668\uff1b\u800c <code>Interceptor</code> \u662f Spring MVC \u63d0\u4f9b\u7684\u673a\u5236\uff0c\u53ea\u62e6\u622a\u63a7\u5236\u5668\uff08Controller\uff09\u76f8\u5173\u7684\u8bf7\u6c42\uff0c\u53ef\u4ee5\u65b9\u4fbf\u5730\u6ce8\u5165 Spring Bean\uff0c\u6267\u884c\u65f6\u673a\u66f4\u7cbe\u7ec6\uff08\u5982 preHandle\u3001postHandle\uff09\uff0c\u66f4\u9002\u5408\u5728\u4e1a\u52a1\u903b\u8f91\u5c42\u8fdb\u884c\u6743\u9650\u6821\u9a8c\u3001\u65e5\u5fd7\u8bb0\u5f55\u7b49\u64cd\u4f5c</p>"},{"location":"java/ssm/#3_4","title":"3. \u5f02\u5e38\u5904\u7406\u2b50\u2b50\u2b50","text":"<p>\u200b   \u5f02\u5e38\u5904\u7406\u5206\u4e3a\u4e24\u7c7b\uff1a\u7f16\u7a0b\u5f0f\uff08\u5982 <code>try-catch</code>\uff09\u548c \u58f0\u660e\u5f0f\u3002\u5728 Spring \u4e2d\uff0c\u63a8\u8350\u4f7f\u7528 \u58f0\u660e\u5f0f\u5f02\u5e38\u5904\u7406\uff0c\u56e0\u4e3a\u5b83\u66f4\u7b80\u6d01\u3001\u53ef\u7ef4\u62a4\u6027\u5f3a\uff0c\u80fd\u5b9e\u73b0\u5168\u5c40\u7edf\u4e00\u5904\u7406\u3002</p> <p></p>"},{"location":"java/ssm/#1_4","title":"1. \u5b9e\u73b0\u65b9\u5f0f","text":"<p>Spring MVC \u63d0\u4f9b\u4e86\u4e24\u4e2a\u6838\u5fc3\u6ce8\u89e3\u6765\u5b9e\u73b0\u58f0\u660e\u5f0f\u5f02\u5e38\u5904\u7406\uff1a</p>"},{"location":"java/ssm/#exceptionhandler-controller","title":"\u65b9\u5f0f\u4e00\uff1a<code>@ExceptionHandler</code> \u2014\u2014 \u5904\u7406\u5355\u4e2a Controller \u7684\u5f02\u5e38","text":"<p>\u9002\u7528\u4e8e\u67d0\u4e2a\u63a7\u5236\u5668\u5185\u90e8\u7684\u5f02\u5e38\u5904\u7406\u3002</p> <pre><code>@RestController\npublic class UserController {\n\n    @GetMapping(\"/user/{id}\")\n    public User getUser(@PathVariable Long id) {\n        if (id == -1) {\n            throw new UserNotFoundException(\"\u7528\u6237\u4e0d\u5b58\u5728\");\n        }\n        return userService.findById(id);\n    }\n\n    // \u4f7f\u7528 @ExceptionHandler \u5904\u7406\u8be5 Controller \u5185\u90e8\u629b\u51fa\u7684\u5f02\u5e38\n    @ExceptionHandler(UserNotFoundException.class)\n    public ResponseEntity&lt;String&gt; handleUserNotFound(UserNotFoundException ex) {\n        return ResponseEntity.status(HttpStatus.NOT_FOUND).body(\"\u7528\u6237\u672a\u627e\u5230\uff1a\" + ex.getMessage());\n    }\n}\n</code></pre> <ul> <li>\u53ea\u4f5c\u7528\u4e8e\u5f53\u524d Controller</li> <li>\u53ef\u4ee5\u5904\u7406\u7279\u5b9a\u7c7b\u578b\u7684\u5f02\u5e38</li> <li>\u4e0d\u5f71\u54cd\u5176\u4ed6 Controller</li> </ul>"},{"location":"java/ssm/#controlleradvice","title":"\u65b9\u5f0f\u4e8c\uff1a<code>@ControllerAdvice</code> \u2014\u2014 \u5168\u5c40\u5f02\u5e38\u5904\u7406","text":"<p>\u7528\u4e8e\u96c6\u4e2d\u5904\u7406 \u6240\u6709 Controller \u7684\u5f02\u5e38\uff0c\u662f\u5b9e\u73b0\u201c\u5168\u5c40\u7edf\u4e00\u5f02\u5e38\u5904\u7406\u201d\u7684\u6700\u4f73\u65b9\u5f0f\u3002</p> <pre><code>@ControllerAdvice\n@ResponseBody\npublic class GlobalExceptionHandler {\n\n    @ExceptionHandler(UserNotFoundException.class)\n    public ResponseEntity&lt;String&gt; handleUserNotFound(UserNotFoundException ex) {\n        return ResponseEntity.status(HttpStatus.NOT_FOUND).body(\"\u7528\u6237\u672a\u627e\u5230\uff1a\" + ex.getMessage());\n    }\n\n    @ExceptionHandler(Exception.class)\n    public ResponseEntity&lt;String&gt; handleGenericException(Exception ex) {\n        return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(\"\u670d\u52a1\u5668\u5185\u90e8\u9519\u8bef\uff1a\" + ex.getMessage());\n    }\n}\n</code></pre> <ul> <li>\u4f7f\u7528 <code>@ControllerAdvice</code> \u6ce8\u89e3\u6807\u8bb0\u7c7b</li> <li>\u6240\u6709 Controller \u90fd\u4f1a\u81ea\u52a8\u5e94\u7528\u8be5\u5f02\u5e38\u5904\u7406\u5668</li> <li>\u53ef\u4ee5\u5904\u7406\u4efb\u610f\u7c7b\u578b\u5f02\u5e38\uff08\u5982 <code>Exception.class</code>\uff09</li> <li>\u652f\u6301\u8fd4\u56de JSON\u3001\u89c6\u56fe\u9875\u9762\u7b49</li> </ul>"},{"location":"java/ssm/#2_6","title":"2. \u9879\u76ee\u4e2d\u6700\u4f73\u5b9e\u8df5","text":"<p>\u200b   \u5728\u5b9e\u9645\u9879\u76ee\u5f00\u53d1\u4e2d\uff0c\u5f02\u5e38\u79cd\u7c7b\u7e41\u591a\uff0c\u65e0\u6cd5\u7a77\u5c3d\u6240\u6709\u60c5\u51b5\u3002\u56e0\u6b64\uff0c\u540e\u7aef\u5e94\u805a\u7126\u4e8e\u6838\u5fc3\u4e1a\u52a1\u903b\u8f91\u7684\u6b63\u786e\u5b9e\u73b0\uff0c\u5f53\u9047\u5230\u975e\u6cd5\u72b6\u6001\u3001\u6570\u636e\u6821\u9a8c\u5931\u8d25\u3001\u8d44\u6e90\u4e0d\u5b58\u5728\u7b49\u5f02\u5e38\u60c5\u51b5\u65f6\uff0c\u65e0\u9700\u624b\u52a8\u5904\u7406\u6bcf\u4e00\u4e2a\u5f02\u5e38\uff0c\u800c\u662f\u901a\u8fc7\u4e3b\u52a8\u629b\u51fa\u6709\u610f\u4e49\u7684\u5f02\u5e38\uff0c\u63d0\u524d\u7ec8\u6b62\u5f53\u524d\u4e1a\u52a1\u6d41\u7a0b\u3002</p> <p>\u200b   \u8fd9\u4e9b\u5f02\u5e38\u7531\u5168\u5c40\u5f02\u5e38\u5904\u7406\u5668\uff08\u5982 <code>@ControllerAdvice</code> + <code>@ExceptionHandler</code>\uff09\u7edf\u4e00\u6355\u83b7\uff0c\u8f6c\u6362\u4e3a\u6807\u51c6\u7684\u9519\u8bef\u54cd\u5e94\u683c\u5f0f\uff08\u5982 JSON \u9519\u8bef\u7801\u3001\u6d88\u606f\u63d0\u793a\uff09\uff0c\u8fd4\u56de\u7ed9\u524d\u7aef\u3002\u8fd9\u6837\u65e2\u4fdd\u8bc1\u4e86\u4ee3\u7801\u7684\u7b80\u6d01\u6027\u548c\u53ef\u7ef4\u62a4\u6027\uff0c\u53c8\u80fd\u8ba9\u524d\u7aef\u6e05\u6670\u611f\u77e5\u5230\u5f02\u5e38\u7c7b\u578b\u548c\u539f\u56e0\uff0c\u8fdb\u800c\u505a\u51fa\u76f8\u5e94\u7684\u7528\u6237\u63d0\u793a\u6216\u91cd\u8bd5\u64cd\u4f5c\u3002</p> <p>\u200b   </p>"},{"location":"java/ssm/#_4","title":"\u5b9e\u73b0\u65b9\u5f0f:","text":"<p>\u200b   1\uff09\u5148\u81ea\u5b9a\u4e49\u4e00\u4e2a\u4e1a\u52a1\u5f02\u5e38\u7c7b\uff0c\u5c5e\u6027\u6709code\uff0cmes</p> <p>\u200b   2\uff09\u518d\u53bb\u7528\u679a\u4e3e\u7c7b\u5217\u51fa\u7cfb\u7edf\u4e2d\u6240\u6709\u53ef\u80fd\u7684\u4e1a\u52a1\u9519\u8bef</p> <p>\u200b   3\uff09\u5f53\u51fa\u73b0\u4e1a\u52a1\u9519\u8bef\u65f6\uff0c\u76f4\u63a5\u629b\u51fa\u4e1a\u52a1\u5f02\u5e38\u5373\u53ef</p> <p>\u200b   4\uff09\u4e4b\u540e\u5c31\u53ef\u4ee5\u4ea4\u7ed9\u5168\u5c40\u5f02\u5e38\u5904\u7406\u5668\u6216\u8005\u662f\u672c\u7c7b\u4e0b\u7684\u5f02\u5e38\u5904\u7406\u5668\u5904\u7406\u4e86</p>"},{"location":"java/ssm/#4_4","title":"4. \u6570\u636e\u6821\u9a8c\u2b50\u2b50\u2b50","text":"<p>\u200b   1) \u5bfc\u5165\u573a\u666f\u542f\u52a8\u5668</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-validation&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u200b    2\uff09\u7f16\u5199\u6821\u9a8c\u6ce8\u89e3 @NotNull, @Max, @Min, @Email ...</p> <p>\u200b    3\uff09\u544a\u8bc9 spring MVC \u5f00\u542f\u6821\u9a8c @valid </p> <pre><code> public R add(@RequestBody @Valid Employee employee, BindingResult bindingResult)\n</code></pre> <p>\u200b    4\uff09\u83b7\u5f97\u6821\u9a8c\u7ed3\u679c\uff1aBindResult</p> <pre><code> public R add(@RequestBody @Valid Employee employee, BindingResult bindingResult){\n        if (!bindingResult.hasErrors()){\n            return R.success();\n        }\n        HashMap&lt;String, String&gt; errorMap = new HashMap&lt;&gt;();\n        bindingResult.getFieldErrors().forEach(fieldError -&gt; {\n            errorMap.put(fieldError.getField(), fieldError.getDefaultMessage());\n        });\n\n        return R.error(500, \"\u6821\u9a8c\u5931\u8d25\", errorMap);\n    }\n</code></pre>"},{"location":"java/ssm/#1-bindresult","title":"1. BindResult","text":"<p>\u200b   \u5b83\u662f\u7528\u6765\u53bb\u83b7\u5f97\u6821\u9a8c\u7ed3\u679c\u7684\u3002\u53ef\u4ee5\u83b7\u5f97\u6821\u9a8c\u7684\u5b57\u6bb5\u4ee5\u53ca\u6821\u9a8c\u7684\u7ed3\u679c\u3002</p>"},{"location":"java/ssm/#2_7","title":"2. \u5168\u5c40\u5f02\u5e38\u5904\u7406\u6821\u9a8c\u5931\u8d25","text":"<pre><code> // \u5904\u7406\u6821\u9a8c\u5f02\u5e38\n    @ExceptionHandler(MethodArgumentNotValidException.class)\n    public R handleMethodArgumentNotValidException(MethodArgumentNotValidException e) {\n        // \u83b7\u5f97\u6821\u9a8c\u7ed3\u679c\n        BindingResult bindingResult = e.getBindingResult();\n        List&lt;FieldError&gt; fieldErrors = bindingResult.getFieldErrors();\n        HashMap&lt;String, String&gt;data = new HashMap&lt;&gt;();\n        fieldErrors.forEach(fieldError -&gt; {\n            data.put(fieldError.getField(), fieldError.getDefaultMessage());\n        });\n\n        return R.error(500, \"\u6821\u9a8c\u5931\u8d25\", data);\n    }\n</code></pre>"},{"location":"java/ssm/#3_5","title":"3. \u81ea\u5b9a\u4e49\u6821\u9a8c\u5668","text":"<p>\u200b   1\uff09\u6b63\u5219\u8868\u8fbe\u5f0f</p> <pre><code>@Pattern(regexp=\"^\u7537|\u5973&amp;\" , message = \"\u6027\u522b\u53ea\u80fd\u662f\u7537\u6216\u5973\")\n</code></pre> <p>\u200b   2\uff09\u81ea\u5b9a\u4e49\u6ce8\u89e3\uff08\u5199\u4e00\u4e2a\u81ea\u5b9a\u4e49\u6ce8\u89e3\uff0c\u7136\u540e\u7ed1\u5b9a\u4e00\u4e2a\u81ea\u5b9a\u4e49\u6821\u9a8c\u5668\uff09</p> <pre><code>==========================================================================================\n1\uff1a\u81ea\u5b9a\u4e49\u6821\u9a8c\u6ce8\u89e3\uff08\u6284\u6e90\u7801\u5373\u53ef\uff09\n@Documented\n@Constraint(\n        validatedBy = {GenderValidator.class}\n)\n@Target({ElementType.FIELD})\n@Retention(RetentionPolicy.RUNTIME)\n\npublic @interface Gender {\n    String message() default \"{jakarta.validation.constraints.Email.message}\";\n    Class&lt;?&gt;[] groups() default {};\n    Class&lt;? extends Payload&gt;[] payload() default {};\n\n\n}\n===================================================================================\n2\uff1a\u81ea\u5b9a\u4e49\u6821\u9a8c\u5668\uff08\u5b9e\u73b0ConstraintValidator\u63a5\u53e3\uff09\npublic class GenderValidator implements ConstraintValidator&lt;Gender, String&gt; {\n    /**\n     *\n     * @param s \u524d\u7aef\u4f20\u6765\u7684\u5c5e\u6027\n     * @param constraintValidatorContext \u6821\u9a8c\u4e0a\u4e0b\u6587\n     * @return\n     */\n    @Override\n    public boolean isValid(String s, ConstraintValidatorContext constraintValidatorContext) {\n        return s.equals(\"\u7537\") || s.equals(\"\u5973\");\n    }\n}\n===================================================================================\n3\uff1a\u5e94\u7528\u81ea\u5df1\u7684\u6821\u9a8c\u5668\n@Constraint(\n        validatedBy = {GenderValidator.class}\n)\n</code></pre>"},{"location":"java/ssm/#4_5","title":"4 \u9519\u8bef\u4fe1\u606f\u63d0\u793a\uff08\u56fd\u9645\u5316\uff0c\u5176\u5b9e\u6ca1\u5565\u7528\uff09","text":"<p>\u200b   \u56fd\u9645\u5316\u662f\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u6765\u5b8c\u6210\u7684</p> <p>\u200b   1\uff09\u914d\u7f6e\u63d0\u793a\u4fe1\u606f\u7684\u7f16\u7801\u65b9\u5f0f\u4ee5\u53ca\u4f4d\u7f6e\uff08\u9ed8\u8ba4\u662fmessages\uff09</p> <pre><code>spring.messages.encoding=UTF-8\nspring.messages.basename=i18n/messages_en_US\n</code></pre> <p>\u200b   2\uff09\u76f4\u63a5\u5728\u4e0d\u540c\u56fd\u5bb6\u7684\u914d\u7f6e\u6587\u4ef6\u4e0b\u5199\u5c31\u5b8c\u4e8b\u4e86</p> <pre><code># messages_en_US.properties\u4e0b\ngender.message=gender is allowed only for male or female\n# messages_zh_CH.properties\u4e0b\ngender.message=\u6027\u522b\u53ea\u80fd\u4e3a\u7537\u6216\u5973\n# messages\n\u9ed8\u8ba4\u73af\u5883\n</code></pre>"},{"location":"java/ssm/#5-o","title":"5. \u5404\u79cdo\u7684\u5206\u5c42\u6a21\u578b","text":"<p>\u200b   \u5728\u4f20\u7edf\u7684 Java Web \u5f00\u53d1\u4e2d\uff0c\u5f88\u591a\u5f00\u53d1\u8005\u4e60\u60ef\u4e8e\u4f7f\u7528\u540c\u4e00\u4e2a POJO \u7c7b\uff08\u5982 <code>User</code>\uff09\u65e2\u4f5c\u4e3a\u6570\u636e\u5e93\u5b9e\u4f53\uff0c\u53c8\u4f5c\u4e3a\u63a5\u53e3\u8fd4\u56de\u7ed9\u524d\u7aef\u7684\u6570\u636e\u5bf9\u8c61\u3002\u8fd9\u79cd\u505a\u6cd5\u867d\u7136\u7b80\u5355\uff0c\u4f46\u5b58\u5728\u4e25\u91cd\u7684\u5b89\u5168\u9690\u60a3\u548c\u8bbe\u8ba1\u7f3a\u9677\u3002\u4f8b\u5982\uff0c\u6570\u636e\u5e93\u5b9e\u4f53\u4e2d\u901a\u5e38\u5305\u542b\u654f\u611f\u5b57\u6bb5\uff0c\u5982\u7528\u6237\u5bc6\u7801\u3001\u624b\u673a\u53f7\u3001\u8eab\u4efd\u8bc1\u53f7\u7b49\uff0c\u5982\u679c\u76f4\u63a5\u5c06\u8fd9\u4e2a\u5bf9\u8c61\u5e8f\u5217\u5316\u4e3a JSON \u8fd4\u56de\u7ed9\u524d\u7aef\uff0c\u5c31\u53ef\u80fd\u5bfc\u81f4\u654f\u611f\u4fe1\u606f\u6cc4\u9732\u3002\u5373\u4f7f\u4f60\u5728\u5b57\u6bb5\u4e0a\u52a0\u4e86 <code>@JsonIgnore</code>\uff0c\u8fd9\u79cd\u65b9\u5f0f\u4e5f\u5c5e\u4e8e\u201c\u6253\u8865\u4e01\u5f0f\u201d\u7f16\u7a0b\uff0c\u96be\u4ee5\u7ef4\u62a4\uff0c\u4e14\u5bb9\u6613\u9057\u6f0f\u3002</p> <p>\u200b   \u66f4\u5408\u7406\u7684\u8bbe\u8ba1\u662f\u91c7\u7528\u5206\u5c42\u6a21\u578b\uff0c\u5c06\u4e0d\u540c\u7684\u804c\u8d23\u5206\u79bb\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u5e94\u8be5\u4e3a\u4e0d\u540c\u573a\u666f\u5b9a\u4e49\u4e0d\u540c\u7684 Java Bean\uff1a\u4f7f\u7528 <code>Entity</code> \u7c7b\u4e0e\u6570\u636e\u5e93\u8868\u6620\u5c04\uff0c\u7528\u4e8e\u6301\u4e45\u5c42\u64cd\u4f5c\uff1b\u4f7f\u7528 <code>DTO</code>\uff08Data Transfer Object\uff09\u7c7b\u4e13\u95e8\u7528\u4e8e\u5411\u524d\u7aef\u8fd4\u56de\u6570\u636e\uff1b\u4f7f\u7528 <code>VO</code> \u6216 <code>Form</code> \u7c7b\u63a5\u6536\u524d\u7aef\u4f20\u6765\u7684\u8bf7\u6c42\u53c2\u6570\u3002\u8fd9\u6837\uff0c\u6bcf\u4e2a\u7c7b\u53ea\u627f\u62c5\u5355\u4e00\u804c\u8d23\uff0c\u7cfb\u7edf\u66f4\u52a0\u6e05\u6670\u3001\u5b89\u5168\u3001\u53ef\u7ef4\u62a4\u3002</p> <p>\u200b   \u7279\u522b\u662f\u5728\u6570\u636e\u8131\u654f\u573a\u666f\u4e0b\uff0c\u8fd9\u79cd\u5206\u5c42\u8bbe\u8ba1\u7684\u4f18\u52bf\u5c24\u4e3a\u660e\u663e\u3002\u6bd4\u5982\uff0c\u7528\u6237\u624b\u673a\u53f7 <code>13812345678</code> \u5728\u8fd4\u56de\u524d\u7aef\u65f6\u5e94\u663e\u793a\u4e3a <code>138****5678</code>\uff0c\u8eab\u4efd\u8bc1\u53f7\u4e5f\u5e94\u90e8\u5206\u9690\u85cf\u3002\u5982\u679c\u4f7f\u7528\u7edf\u4e00\u7684 POJO\uff0c\u4f60\u9700\u8981\u5728\u6bcf\u4e2a Controller \u4e2d\u624b\u52a8\u5904\u7406\u8131\u654f\u903b\u8f91\uff0c\u4ee3\u7801\u91cd\u590d\u4e14\u5bb9\u6613\u51fa\u9519\u3002\u800c\u901a\u8fc7 <code>DTO</code> \u7c7b\uff0c\u4f60\u53ef\u4ee5\u5728\u5176\u9759\u6001\u65b9\u6cd5\u6216\u6784\u9020\u51fd\u6570\u4e2d\u7edf\u4e00\u5b8c\u6210\u8131\u654f\u8f6c\u6362\uff0c\u4f8b\u5982\u63d0\u4f9b\u4e00\u4e2a <code>fromEntity()</code> \u65b9\u6cd5\uff0c\u5c06 <code>UserEntity</code> \u8f6c\u6362\u4e3a\u5df2\u8131\u654f\u7684 <code>UserDTO</code>\uff0c\u4ece\u800c\u786e\u4fdd\u6240\u6709\u63a5\u53e3\u8fd4\u56de\u7684\u6570\u636e\u90fd\u7ecf\u8fc7\u7edf\u4e00\u5904\u7406\u3002</p> <p>\u200b   \u6b64\u5916\uff0c\u4f7f\u7528 DTO \u8fd8\u80fd\u6709\u6548\u89e3\u8026\u6570\u636e\u5e93\u7ed3\u6784\u4e0e\u63a5\u53e3\u534f\u8bae\u3002\u5f53\u6570\u636e\u5e93\u8868\u7ed3\u6784\u53d1\u751f\u53d8\u5316\u65f6\uff08\u5982\u5b57\u6bb5\u91cd\u547d\u540d\u3001\u62c6\u5206\uff09\uff0c\u53ea\u9700\u8c03\u6574 Entity \u5230 DTO \u7684\u6620\u5c04\u903b\u8f91\uff0c\u800c\u65e0\u9700\u4fee\u6539\u5bf9\u5916\u63a5\u53e3\uff0c\u907f\u514d\u5f71\u54cd\u524d\u7aef\u4ee3\u7801\u3002\u540c\u6837\uff0c\u524d\u7aef\u9700\u6c42\u53d8\u5316\u65f6\uff0c\u4e5f\u53ef\u4ee5\u7075\u6d3b\u8c03\u6574 DTO \u5b57\u6bb5\uff0c\u800c\u4e0d\u5fc5\u6539\u52a8\u6570\u636e\u5e93\u8bbe\u8ba1\u3002\u8fd9\u79cd\u677e\u8026\u5408\u7ed3\u6784\u5927\u5927\u63d0\u5347\u4e86\u7cfb\u7edf\u7684\u53ef\u6269\u5c55\u6027\u548c\u56e2\u961f\u534f\u4f5c\u6548\u7387\u3002</p> <p>\u200b   \u4e3a\u4e86\u8fdb\u4e00\u6b65\u7b80\u5316 DTO \u4e0e Entity \u4e4b\u95f4\u7684\u8f6c\u6362\uff0c\u53ef\u4ee5\u5f15\u5165 MapStruct \u7b49\u6620\u5c04\u6846\u67b6\u3002\u5b83\u901a\u8fc7\u6ce8\u89e3\u5728\u7f16\u8bd1\u671f\u751f\u6210\u9ad8\u6548\u7684\u6620\u5c04\u4ee3\u7801\uff0c\u907f\u514d\u4e86\u624b\u52a8\u7f16\u5199\u5927\u91cf setter \u548c getter \u7684\u7e41\u7410\u5de5\u4f5c\uff0c\u540c\u65f6\u4fdd\u6301\u9ad8\u6027\u80fd\u3002\u76f8\u6bd4\u53cd\u5c04\u5de5\u5177\uff08\u5982 BeanUtils\uff09\uff0cMapStruct \u66f4\u5b89\u5168\u3001\u66f4\u5feb\u901f\u3002</p> <p>\u200b   \u603b\u4e4b\uff0c\u907f\u514d\u5c06\u6570\u636e\u5e93\u5b9e\u4f53\u7c7b\u76f4\u63a5\u66b4\u9732\u7ed9\u524d\u7aef\uff0c\u662f\u6784\u5efa\u5b89\u5168\u3001\u5065\u58ee Web \u5e94\u7528\u7684\u57fa\u672c\u539f\u5219\u3002\u901a\u8fc7\u5f15\u5165 DTO \u6a21\u5f0f\uff0c\u4e0d\u4ec5\u80fd\u5b9e\u73b0\u654f\u611f\u6570\u636e\u7684\u81ea\u52a8\u8131\u654f\uff0c\u8fd8\u80fd\u63d0\u5347\u4ee3\u7801\u7684\u53ef\u8bfb\u6027\u3001\u53ef\u7ef4\u62a4\u6027\u548c\u53ef\u6269\u5c55\u6027\u3002\u8fd9\u662f\u4e00\u79cd\u4ece\u201c\u80fd\u7528\u201d\u5230\u201c\u597d\u7528\u201d\u7684\u5de5\u7a0b\u601d\u7ef4\u5347\u7ea7\uff0c\u4e5f\u662f\u4f01\u4e1a\u7ea7\u5f00\u53d1\u4e2d\u7684\u6700\u4f73\u5b9e\u8df5\u3002</p>"},{"location":"java/ssm/#6_1","title":"6. \u65e5\u671f\u5904\u7406\u2b50","text":""},{"location":"java/ssm/#1-jsonformat","title":"1. <code>@JsonFormat</code> \u7684\u4f5c\u7528","text":"<p>\u200b   \u5f53\u6211\u4eec\u628a Java \u5bf9\u8c61\u8f6c\u6362\u6210 JSON \u5b57\u7b26\u4e32\uff08\u6bd4\u5982\u63a5\u53e3\u8fd4\u56de\u7ed9\u524d\u7aef\uff09\u65f6\uff0c\u65e5\u671f\u5b57\u6bb5\u9ed8\u8ba4\u53ef\u80fd\u4ee5\u65f6\u95f4\u6233\uff08\u5982 <code>1672531200000</code>\uff09\u7684\u5f62\u5f0f\u8f93\u51fa\uff0c\u6216\u8005\u683c\u5f0f\u4e0d\u7edf\u4e00\uff08\u5982 <code>\"2023-01-01T00:00:00\"</code>\uff09\uff0c\u524d\u7aef\u96be\u4ee5\u76f4\u63a5\u5c55\u793a\u3002\u540c\u6837\uff0c\u524d\u7aef\u4f20\u6765\u7684\u65e5\u671f\u5b57\u7b26\u4e32\u4e5f\u53ef\u80fd\u56e0\u4e3a\u683c\u5f0f\u4e0d\u5339\u914d\u5bfc\u81f4\u89e3\u6790\u5931\u8d25\u3002</p> <p>\u200b   <code>@JsonFormat</code> \u5c31\u662f\u7528\u6765\u6307\u5b9a\u67d0\u4e2a\u5b57\u6bb5\u5728\u8f6c\u6210 JSON \u6216\u4ece JSON \u89e3\u6790\u65f6\u6240\u4f7f\u7528\u7684\u65e5\u671f\u683c\u5f0f\uff0c\u786e\u4fdd\u524d\u540e\u7aef\u5bf9\u65e5\u671f\u7684\u7406\u89e3\u4e00\u81f4\u3002</p>"},{"location":"java/ssm/#2_8","title":"2. \u57fa\u672c\u7528\u6cd5","text":"<pre><code>import com.fasterxml.jackson.annotation.JsonFormat;\nimport java.util.Date;\n\npublic class User {\n\n    private String name;\n\n    @JsonFormat(pattern = \"yyyy-MM-dd HH:mm:ss\", timezone = \"GMT+8\")\n    private Date createTime;\n\n    // getter \u548c setter\n}\n</code></pre>"},{"location":"java/ssm/#3_6","title":"3. \u5168\u5c40\u914d\u7f6e","text":"<p>\u200b   \u5982\u679c\u4e0d\u4f7f\u7528\u5168\u5c40\u914d\u7f6e\uff0c\u90a3\u4e48\u6bcf\u4e00\u4e2a\u65e5\u671f\u5b57\u6bb5\u90fd\u9700\u8981\u53bb\u5199 @JsonFormat\uff0c\u592a\u9ebb\u70e6\u4e86\uff0c\u5c24\u5176\u662f\u91c7\u7528 JavaBean \u5206\u5c42\u67b6\u6784\u3002\u6b64\u65f6\uff0c\u5c31\u53ef\u4ee5\u7528\u914d\u7f6e\u6587\u4ef6\u6765\u5b9e\u73b0\u5168\u5c40\u914d\u7f6e\u3002</p> <pre><code># \u65e5\u671f\u5904\u7406\u914d\u7f6e\nspring.jackson.date-format=yyyy-MM-dd HH:mm:ss\nspring.jackson.time-zone=GMT+8\n</code></pre>"},{"location":"java/ssm/#7","title":"7. \u63a5\u53e3\u6587\u6863","text":""},{"location":"java/ssm/#8-dispathcerservlet","title":"8. DispathcerServlet","text":"<p>\u200b    <code>DispatcherServlet</code> \u662f Spring MVC \u6846\u67b6\u7684\u6838\u5fc3\u7ec4\u4ef6\uff0c\u53ef\u4ee5\u628a\u5b83\u7406\u89e3\u4e3a\u6574\u4e2a Web \u8bf7\u6c42\u5904\u7406\u6d41\u7a0b\u7684\u201c\u603b\u6307\u6325\u201d\u6216\u201c\u524d\u7aef\u63a7\u5236\u5668\u201d\u3002\u5f53\u4f60\u7684\u6d4f\u89c8\u5668\u53d1\u8d77\u4e00\u4e2a HTTP \u8bf7\u6c42\uff08\u6bd4\u5982\u8bbf\u95ee <code>/user/list</code>\uff09\uff0c\u8fd9\u4e2a\u8bf7\u6c42\u9996\u5148\u5230\u8fbe\u7684\u5c31\u662f <code>DispatcherServlet</code>\u3002</p>"},{"location":"java/ssm/#1_5","title":"1. \u4e5d\u5927\u7ec4\u4ef6","text":"<pre><code> @Nullable\n    private MultipartResolver multipartResolver;\n    @Nullable\n    private LocaleResolver localeResolver;\n    /** @deprecated */\n    @Deprecated\n    @Nullable\n    private ThemeResolver themeResolver;\n    @Nullable\n    private List&lt;HandlerMapping&gt; handlerMappings; // \u5b58\u653e\u8bf7\u6c42\u8def\u5f84\u548c\u5904\u7406\u5668\u7684\u6620\u5c04\u5173\u7cfb\n    @Nullable\n    private List&lt;HandlerAdapter&gt; handlerAdapters;  // \u5904\u7406\u5668\u7684\u4e00\u4e9b\u53cd\u5c04\u589e\u5f3a\n    @Nullable\n    private List&lt;HandlerExceptionResolver&gt; handlerExceptionResolvers;  // \u5f02\u5e38\u5904\u7406\u89e3\u6790\u5668\n    @Nullable\n    private RequestToViewNameTranslator viewNameTranslator;\n    @Nullable\n    private FlashMapManager flashMapManager;\n    @Nullable\n    private List&lt;ViewResolver&gt; viewResolvers;\n</code></pre>"},{"location":"java/ssm/#2_9","title":"2. \u8fd0\u884c\u6d41\u7a0b","text":"<ol> <li>\u5ba2\u6237\u7aef\uff08\u6d4f\u89c8\u5668\uff09\u53d1\u9001\u8bf7\u6c42 <code>DispatcherServlet</code>\u62e6\u622a\u8bf7\u6c42. </li> <li><code>DispatcherServlet</code> \u6839\u636e\u8bf7\u6c42\u6d88\u606f\u8c03\u7528 <code>HandlerMapping</code>  \u4f1a\u6839\u636e\u672c\u6b21\u8bf7\u6c42\u7684 <code>url</code> \u627e\u5230\u5bf9\u5e94\u7684 <code>handler</code>\uff0c\u5e76\u4f1a\u5c06\u8bf7\u6c42\u6d89\u53ca\u5230\u7684\u62e6\u622a\u5668\u548c <code>Handler</code> \u4e00\u8d77\u5c01\u88c5\u8fd4\u56de\u3002</li> <li><code>DispatcherServlet</code> \u8c03\u7528 <code>HandlerAdapter</code>\u9002\u914d\u5668\u6267\u884c <code>Handler</code> \u3002</li> <li><code>Handler</code> \u5b8c\u6210\u5bf9\u7528\u6237\u8bf7\u6c42\u7684\u5904\u7406\u540e\uff0c\u4f1a\u8fd4\u56de\u4e00\u4e2a <code>ModelAndView</code> \u5bf9\u8c61\u7ed9<code>DispatcherServlet</code>\uff0c<code>ModelAndView</code> \u987e\u540d\u601d\u4e49\uff0c\u5305\u542b\u4e86\u6570\u636e\u6a21\u578b\u4ee5\u53ca\u76f8\u5e94\u7684\u89c6\u56fe\u7684\u4fe1\u606f\u3002<code>Model</code> \u662f\u8fd4\u56de\u7684\u6570\u636e\u5bf9\u8c61\uff0c<code>View</code> \u662f\u4e2a\u903b\u8f91\u4e0a\u7684 <code>View</code></li> <li><code>DispatcherServlet</code>\u5c06<code>ModelAndView</code>\u4f20\u7ed9<code>ViewReslover</code>\u89c6\u56fe\u89e3\u6790\u5668</li> <li><code>ViewReslover</code>\u89e3\u6790\u540e\u8fd4\u56de\u5177\u4f53<code>View</code></li> <li><code>DispaterServlet</code> \u628a\u8fd4\u56de\u7684 <code>Model</code> \u4f20\u7ed9 <code>View</code>\uff08\u89c6\u56fe\u6e32\u67d3\uff09</li> <li><code>DispaterServlet</code> \u4f1a\u5c06\u89c6\u56fe\u54cd\u5e94\u7ed9\u5ba2\u6237\u7aef</li> </ol>"},{"location":"java/ssm/#mybatis","title":"\u516d\u3001Mybatis\u2b50","text":"<p>\u200b   \u6301\u4e45\u5c42\u6846\u67b6 \u662f\u7528\u4e8e\u7b80\u5316\u6570\u636e\u5e93\u64cd\u4f5c\u3001\u7ba1\u7406\u6570\u636e\u6301\u4e45\u5316\u7684\u8f6f\u4ef6\u6846\u67b6\u3002\u5b83\u7684\u6838\u5fc3\u4f5c\u7528\u662f \u8ba9 Java \u5bf9\u8c61\u4e0e\u6570\u636e\u5e93\u4e2d\u7684\u8bb0\u5f55\u4e4b\u95f4\u8fdb\u884c\u65b9\u4fbf\u3001\u9ad8\u6548\u3001\u5b89\u5168\u7684\u8f6c\u6362\u548c\u64cd\u4f5c\uff0c\u800c\u4e0d\u9700\u8981\u5f00\u53d1\u8005\u624b\u52a8\u7f16\u5199\u5927\u91cf\u91cd\u590d\u7684 JDBC \u4ee3\u7801\u3002</p>"},{"location":"java/ssm/#1-mybatis","title":"1. mybatis\u7684\u4f7f\u7528\u65b9\u6cd5","text":"<p>\u200b   1\uff09\u5bfc\u5165mybatis\u4f9d\u8d56</p> <p>\u200b   2\uff09\u914d\u7f6e\u6570\u636e\u6e90\u4fe1\u606f</p> <p>\u200b   3\uff09\u5199\u4e00\u4e2a javaBean\uff0c\u4e5f\u5c31\u662f PO\uff08 Persist Object\uff09</p> <p>\u200b   4\uff09\u5199\u6301\u4e45\u5c42\u63a5\u53e3\uff0c\u4e5f\u5c31\u662fMapper\u5c42\uff08\u6ce8\u610f\u6807 @Mapper\uff09</p> <p>\u200b   5\uff09\u53bb\u5199 Mapper \u5c42\u65b9\u6cd5\u5bf9\u5e94\u7684 xml \u914d\u7f6e\u6587\u4ef6\uff0c\u53bb\u6620\u5c04\u8fd9\u4e9b\u63a5\u53e3\u600e\u4e48\u6267\u884c\uff0c\u6267\u884c\u90a3\u4e9bsql\u3002</p> <p>\u200b   6\uff09\u6ce8\u610f\u6570\u636e\u5e93\u5b57\u6bb5\u540d\u4e0b\u5212\u7ebf\u4e00\u822c\u5728 Po \u79cd\u8981\u5199\u6210\u9a7c\u5cf0\u5f0f\u3002</p> <p>\u200b   7\uff09\u6700\u540e\uff0c\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u544a\u8bc9 Mybatis xml \u6587\u4ef6\u7684\u4f4d\u7f6e\u3002</p>"},{"location":"java/ssm/#2_10","title":"2. \u53c2\u6570\u5904\u7406","text":""},{"location":"java/ssm/#1_6","title":"1. #{} \u4e0e ${} \u7684\u533a\u522b","text":"<p>\u200b   \u5728 MyBatis \u4e2d\uff0c<code>#{}</code> \u548c <code>${}</code> \u90fd\u53ef\u4ee5\u7528\u4e8e\u4f20\u9012\u53c2\u6570\uff0c\u4f46\u5b83\u4eec\u7684\u5e95\u5c42\u673a\u5236\u548c\u4f7f\u7528\u573a\u666f\u6709\u7740\u672c\u8d28\u533a\u522b\u3002</p> <p>\u200b   1\uff09\u9996\u5148\uff0c<code>#{}</code> \u662f MyBatis \u4e2d\u7684\u9884\u7f16\u8bd1\u5360\u4f4d\u7b26\uff0c\u76f8\u5f53\u4e8e JDBC \u4e2d\u7684 <code>?</code>\u3002\u5728\u6267\u884c SQL \u8bed\u53e5\u65f6\uff0cMyBatis \u4f1a\u5148\u5c06 <code>#{}</code> \u66ff\u6362\u4e3a\u4e00\u4e2a\u95ee\u53f7\u5360\u4f4d\u7b26\uff0c\u7136\u540e\u901a\u8fc7 <code>PreparedStatement</code> \u9010\u4e2a\u8bbe\u7f6e\u53c2\u6570\u503c\u3002\u8fd9\u79cd\u65b9\u5f0f\u80fd\u591f\u6709\u6548\u9632\u6b62 SQL \u6ce8\u5165\uff0c\u56e0\u4e3a\u53c2\u6570\u503c\u4e0d\u4f1a\u76f4\u63a5\u62fc\u63a5\u5230 SQL \u5b57\u7b26\u4e32\u4e2d\uff0c\u800c\u662f\u7531\u6570\u636e\u5e93\u5728\u6267\u884c\u9636\u6bb5\u5b89\u5168\u5730\u7ed1\u5b9a\u3002\u6b64\u5916\uff0c<code>#{}</code> \u8fd8\u80fd\u81ea\u52a8\u6839\u636e\u53c2\u6570\u7c7b\u578b\u6dfb\u52a0\u5408\u9002\u7684\u5f15\u53f7\uff0c\u4f8b\u5982\u5f53\u4f20\u5165\u5b57\u7b26\u4e32\u65f6\u4f1a\u81ea\u52a8\u52a0\u4e0a\u5355\u5f15\u53f7\uff0c\u975e\u5e38\u9002\u5408\u7528\u4e8e\u63d2\u5165\u3001\u66f4\u65b0\u6216\u67e5\u8be2\u65f6\u7684\u6761\u4ef6\u53c2\u6570\u8d4b\u503c\u3002</p> <p>\u200b   2\uff09\u4e0e\u4e4b\u76f8\u5bf9\uff0c<code>${}</code> \u5219\u662f MyBatis \u7684\u5b57\u7b26\u4e32\u62fc\u63a5\u65b9\u5f0f\uff0c\u5b83\u5728 SQL \u8bed\u53e5\u89e3\u6790\u9636\u6bb5\u5c31\u4f1a\u88ab\u76f4\u63a5\u66ff\u6362\u4e3a\u5b9e\u9645\u7684\u53c2\u6570\u5185\u5bb9\uff0c\u76f8\u5f53\u4e8e\u76f4\u63a5\u5c06\u53d8\u91cf\u503c\u63d2\u5165\u5230 SQL \u5b57\u7b26\u4e32\u4e2d\u3002\u8fd9\u610f\u5473\u7740\u5982\u679c\u53c2\u6570\u503c\u6765\u81ea\u7528\u6237\u8f93\u5165\uff0c\u53ef\u80fd\u4f1a\u9020\u6210 SQL \u6ce8\u5165\u98ce\u9669\u3002\u56e0\u6b64\uff0c<code>${}</code> \u4e00\u822c\u4e0d\u7528\u4e8e\u503c\u7684\u4f20\u9012\uff0c\u800c\u662f\u7528\u4e8e\u90a3\u4e9b\u4e0d\u80fd\u4f7f\u7528 <code>#{}</code> \u7684\u573a\u666f\uff0c\u6bd4\u5982\u52a8\u6001\u6307\u5b9a\u8868\u540d\u3001\u5217\u540d\u3001\u6392\u5e8f\u5b57\u6bb5\u6216\u5173\u952e\u5b57\u7b49\u4f4d\u7f6e\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c<code>${}</code> \u4e0d\u4f1a\u81ea\u52a8\u52a0\u5f15\u53f7\uff0c\u82e5\u62fc\u63a5\u7684\u662f\u5b57\u7b26\u4e32\u7c7b\u578b\u53c2\u6570\uff0c\u5fc5\u987b\u624b\u52a8\u6dfb\u52a0\u5355\u5f15\u53f7\uff0c\u5426\u5219\u4f1a\u5bfc\u81f4 SQL \u8bed\u6cd5\u9519\u8bef\u3002</p> <p>\u200b   </p>"},{"location":"java/ssm/#2_11","title":"2. \u53c2\u6570\u53d6\u503c\u65b9\u6cd5","text":"<p>\u200b   \u6700\u4f73\u5b9e\u8df5\uff1a\u5373\u4f7f\u53ea\u6709\u4e00\u4e2a\u53c2\u6570\uff0c\u4e5f\u7528 Param \u76f4\u63a5\u53c2\u6570\u540d</p> <p></p>"},{"location":"java/ssm/#3_7","title":"3. \u8fd4\u56de\u503c","text":"<p>\u200b   \u5728 MyBatis \u4e2d\uff0c\u6bcf\u4e00\u4e2a Mapper \u63a5\u53e3\u7684\u65b9\u6cd5\u90fd\u9700\u8981\u5728\u5bf9\u5e94\u7684 XML \u6620\u5c04\u6587\u4ef6\u4e2d\u660e\u786e\u6307\u5b9a\u67e5\u8be2\u7ed3\u679c\u7684\u5c01\u88c5\u7c7b\u578b\uff0c\u5373\u901a\u8fc7 <code>resultType</code> \u6216 <code>resultMap</code> \u5c5e\u6027\u6765\u5b9a\u4e49\u8fd4\u56de\u503c\u7c7b\u578b\u3002\u867d\u7136 MyBatis \u5185\u7f6e\u4e86\u4e00\u4e9b\u5e38\u7528\u7c7b\u578b\u7684\u522b\u540d\uff08\u5982 <code>int</code>\u3001<code>string</code>\u3001<code>map</code>\u3001<code>list</code> \u7b49\uff09\uff0c\u4f46\u5728\u5b9e\u9645\u5f00\u53d1\u4e2d\u4ecd\u5efa\u8bae\u4f7f\u7528\u5b8c\u6574\u9650\u5b9a\u7c7b\u540d\uff08\u5373\u5168\u7c7b\u540d\uff09\uff0c\u8fd9\u6837\u80fd\u907f\u514d\u547d\u540d\u51b2\u7a81\uff0c\u4e5f\u8ba9 XML \u6587\u4ef6\u66f4\u76f4\u89c2\u3001\u53ef\u7ef4\u62a4\u3002</p> <p>1\uff09\u6307\u5b9a\u8fd4\u56de\u7c7b\u578b</p> <p>\u200b   \u6bcf\u4e00\u4e2a Mapper \u5c42\u63a5\u53e3\u5bf9\u5e94\u7684 XML \u8bed\u53e5\u5757\u4e2d\uff0c\u90fd\u5fc5\u987b\u6307\u660e\u67e5\u8be2\u7ed3\u679c\u8981\u5c01\u88c5\u6210\u7684 Java \u7c7b\u578b\u3002\u901a\u5e38\u4f7f\u7528 <code>resultType</code> \u5c5e\u6027\u6307\u5b9a\u7c7b\u578b\u540d\u79f0\uff0c\u4f8b\u5982\uff1a</p> <pre><code>&lt;select id=\"findUserById\" resultType=\"com.example.pojo.User\"&gt;\n    SELECT * FROM user WHERE id = #{id}\n&lt;/select&gt;\n</code></pre> <p>2\uff09\u96c6\u5408\u7c7b\u578b\u7684\u8fd4\u56de\u503c</p> <p>\u200b   \u5f53\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u662f\u96c6\u5408\u7c7b\u578b\uff08\u4f8b\u5982 <code>List</code> \u6216 <code>Set</code>\u6216<code>Map</code>\uff09\uff0c\u5728 MyBatis \u7684\u914d\u7f6e\u4e2d\u53ea\u9700\u6307\u5b9a\u96c6\u5408\u4e2d\u5143\u7d20\u7684\u7c7b\u578b\u5373\u53ef\u3002MyBatis \u4f1a\u81ea\u52a8\u5c06\u67e5\u8be2\u7ed3\u679c\u7684\u591a\u884c\u8bb0\u5f55\u5c01\u88c5\u4e3a\u96c6\u5408\u3002\u4f8b\u5982\uff1a</p> <pre><code> // \u5c06\u7ed3\u679c\u5c01\u88c5\u4e3a Map (\u96c6\u5408\uff0cset,list\u540c\u7406)\n    @MapKey(\"id\")\n    Map&lt;Integer, Emp&gt; getMap();\n\n&lt;select id=\"getMap\" resultType=\"person.liutianba.mybatis.bean.Emp\"&gt;\n        select * from t_emp\n&lt;/select&gt;\n</code></pre> <p>3\uff09\u590d\u6742\u8fd4\u56de\u7ed3\u679c\u7684\u6620\u5c04</p> <p>\u200b   \u5982\u679c\u67e5\u8be2\u7ed3\u679c\u4e2d\u5b57\u6bb5\u540d\u4e0e\u5b9e\u4f53\u7c7b\u5c5e\u6027\u540d\u4e0d\u5b8c\u5168\u5bf9\u5e94\uff0c\u6216\u9700\u8981\u591a\u8868\u8054\u5408\u67e5\u8be2\u65f6\uff0c\u5219\u53ef\u4f7f\u7528 <code>resultMap</code> \u8fdb\u884c\u66f4\u7075\u6d3b\u7684\u6620\u5c04\u914d\u7f6e\uff0c\u901a\u8fc7 <code>&lt;result&gt;</code> \u548c <code>&lt;association&gt;</code> \u7b49\u6807\u7b7e\u81ea\u5b9a\u4e49\u5b57\u6bb5\u4e0e\u5c5e\u6027\u4e4b\u95f4\u7684\u5bf9\u5e94\u5173\u7cfb\u3002</p> <pre><code>&lt;resultMap id=\"rme\" type=\"person.liutianba.mybatis.bean.Emp\"&gt;\n        &lt;!--\u4e3b\u952e\u6620\u5c04\u7528id--&gt;\n        &lt;id column=\"id\" property=\"id\"&gt;&lt;/id&gt;\n        &lt;!--\u666e\u901a\u5c5e\u6027\u6620\u5c04\u7528 result--&gt;\n        &lt;result column=\"age\" property=\"age\"&gt;&lt;/result&gt;\n        &lt;result column=\"emp_name\" property=\"empName\"&gt;&lt;/result&gt;\n        &lt;result column=\"emp_salary\" property=\"empSalary\"&gt;&lt;/result&gt;\n    &lt;/resultMap&gt;\n\n    &lt;select id=\"getEmpById\" resultMap=\"rme\"&gt;\n        select * from t_emp where id = #{id}\n    &lt;/select&gt;\n</code></pre> <p>\u200b   \u4e0b\u9762\u662f\u591a\u8868\u67e5\u8be2\u7684\u4e00\u4e9b\u8bed\u6cd5</p> <p></p> <p>\u200b   \u4e00\u5bf9\u4e00\u5173\u7cfb\u5c01\u88c5\uff1a</p> <pre><code>&lt;resultMap id=\"orderWithCustomer\" type=\"person.liutianba.mybatis.bean.Order\"&gt;\n        &lt;id property=\"id\" column=\"id\"/&gt;\n        &lt;result property=\"address\" column=\"address\"/&gt;\n        &lt;result property=\"amount\" column=\"amount\"/&gt;\n        &lt;result property=\"customerId\" column=\"customer_id\"/&gt;\n        &lt;association property=\"customer\" javaType=\"person.liutianba.mybatis.bean.Customer\"&gt;\n            &lt;id property=\"id\" column=\"c_id\"/&gt; \n            &lt;result property=\"customerName\" column=\"customer_name\"/&gt;\n            &lt;result property=\"phone\" column=\"phone\"/&gt;\n        &lt;/association&gt;\n    &lt;/resultMap&gt;\n</code></pre> <p></p> <p>\u200b   \u4e00\u5bf9\u591a\u5173\u7cfb\u5c01\u88c5\uff1a\uff08collection\uff09</p> <pre><code> &lt;!--\u6f14\u793acollection--&gt;\n    &lt;resultMap id=\"CustomerWithOrdersRM\" type=\"person.liutianba.mybatis.bean.Customer\"&gt;\n        &lt;id column=\"c_id\" property=\"id\"&gt;&lt;/id&gt;\n        &lt;result column=\"customer_name\" property=\"customerName\"&gt;&lt;/result&gt;\n        &lt;result column=\"phone\" property=\"phone\"&gt;&lt;/result&gt;\n        &lt;collection property=\"orders\" ofType=\"person.liutianba.mybatis.bean.Order\"&gt;\n            &lt;id column=\"id\" property=\"id\"&gt;&lt;/id&gt;\n            &lt;result column=\"address\" property=\"address\"&gt;&lt;/result&gt;\n            &lt;result column=\"amount\" property=\"amount\"&gt;&lt;/result&gt;\n            &lt;result column=\"c_id\" property=\"customerId\"&gt;&lt;/result&gt;\n        &lt;/collection&gt;\n    &lt;/resultMap&gt;\n</code></pre>"},{"location":"java/ssm/#3_8","title":"3. \u5206\u6b65\u67e5\u8be2","text":"<p>\u200b   \u5728\u9700\u8981\u94fe\u8868\u67e5\u8be2\u7684\u573a\u666f\u4e0b\uff0c\u4e0d\u4ec5\u53ef\u4ee5\u6309\u5e38\u89c4\u5199\u6cd5\uff0c\u4e5f\u53ef\u4ee5\u5199\u5206\u5e03\u67e5\u8be2\uff0c\u5982\u4e0b\u9762\u7684\u573a\u666f\uff1a\u67e5\u8be2\u5177\u4f53\u8ba2\u5355\u4ee5\u53ca\u5b83\u5bf9\u5e94\u7684\u5ba2\u6237\u7684\u4fe1\u606f\uff1a</p> <p>\u200b   1\uff09\u67e5\u8be2\u8ba2\u5355</p> <p>\u200b   2\uff09\u6839\u636e\u5ba2\u6237id\u67e5\u8be2id</p> <pre><code>&lt;resultMap id=\"CustomerWithOrdersStepRM\" type=\"person.liutianba.mybatis.bean.Customer\"&gt;\n        &lt;id column=\"id\" property=\"id\"&gt;&lt;/id&gt;\n        &lt;result column=\"customer_name\" property=\"customerName\"&gt;&lt;/result&gt;\n        &lt;result column=\"phone\" property=\"phone\"&gt;&lt;/result&gt;\n        &lt;collection property=\"orders\" select=\"getOrdersByCustomerId\" column=\"id\"&gt;&lt;/collection&gt;\n    &lt;/resultMap&gt;\n\n\n    &lt;select id=\"getOrdersByCustomerId\" resultType=\"person.liutianba.mybatis.bean.Order\"&gt;\n        select * from t_orders\n        where customer_id=#{id}\n    &lt;/select&gt;\n\n    &lt;select id=\"getCustomerByIdWithOrders\" resultMap=\"CustomerWithOrdersStepRM\"&gt;\n        SELECT *\n        FROM t_customer\n        WHERE id=#{id}\n    &lt;/select&gt;\n</code></pre> <p>\u200b   \u5728\u5206\u9875\u67e5\u8be2\u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u5f00\u542f\u5ef6\u671f\u52a0\u8f7d\uff0c\u4e5f\u5c31\u662f\u5982\u679c\u6ca1\u7528\u5230\u9700\u8981\u8c03\u7528\u5176\u4ed6\u67e5\u8be2\u65b9\u6cd5\u624d\u80fd\u67e5\u5230\u7684\u6570\u636e\uff0c\u5c31\u4e0d\u53d1\u8fd9\u4e2a\u67e5\u8be2\u3002</p> <pre><code>mybatis.configuration.lazy-loading-enabled=true\nmybatis.configuration.aggressive-lazy-loading=false\n</code></pre>"},{"location":"java/ssm/#4-sql","title":"4. \u52a8\u6001sql","text":""},{"location":"java/ssm/#41-if","title":"4.1 if \u6807\u7b7e","text":"<p>\u7528\u4e8e\u5224\u65ad\u67d0\u4e2a\u6761\u4ef6\u662f\u5426\u6210\u7acb\uff0c\u51b3\u5b9a\u662f\u5426\u62fc\u63a5\u67d0\u6bb5 SQL\u3002</p> <pre><code>&lt;if test=\"\u6761\u4ef6\u8868\u8fbe\u5f0f\"&gt;\n    SQL \u7247\u6bb5\n&lt;/if&gt;\n</code></pre>"},{"location":"java/ssm/#42-where","title":"4.2 <code>&lt;where&gt;</code> \u6807\u7b7e","text":"<p>\u81ea\u52a8\u5904\u7406 <code>WHERE</code> \u5173\u952e\u5b57\uff0c\u5e76\u667a\u80fd\u53bb\u9664\u591a\u4f59\u7684 <code>AND</code> \u6216 <code>OR</code>\u3002</p> <pre><code>&lt;select id=\"findEmp\" parameterType=\"EmpPO\" resultType=\"EmpPO\"&gt;\n    SELECT * FROM t_emp\n    &lt;where&gt;\n        &lt;if test=\"id != null\"&gt;\n            AND id = #{id}\n        &lt;/if&gt;\n        &lt;if test=\"empName != null and empName != ''\"&gt;\n            AND emp_name = #{empName}\n        &lt;/if&gt;\n        &lt;if test=\"age != null\"&gt;\n            AND age &gt;= #{age}\n        &lt;/if&gt;\n    &lt;/where&gt;\n&lt;/select&gt;\n</code></pre>"},{"location":"java/ssm/#43-set","title":"4.3 <code>&lt;set&gt;</code>\u6807\u7b7e","text":"<p>\u7528\u4e8e UPDATE \u8bed\u53e5\u4e2d\uff0c\u81ea\u52a8\u5904\u7406 SET \u5173\u952e\u5b57\uff0c\u5e76\u53bb\u9664\u6700\u540e\u4e00\u4e2a\u591a\u4f59\u7684\u9017\u53f7\u3002</p> <pre><code>&lt;update id=\"updateEmp\" parameterType=\"EmpPO\"&gt;\n    UPDATE t_emp\n    &lt;set&gt;\n        &lt;if test=\"empName != null and empName != ''\"&gt;\n            emp_name = #{empName},\n        &lt;/if&gt;\n        &lt;if test=\"age != null\"&gt;\n            age = #{age},\n        &lt;/if&gt;\n        &lt;if test=\"empSalary != null\"&gt;\n            emp_salary = #{empSalary}\n        &lt;/if&gt;\n    &lt;/set&gt;\n    WHERE id = #{id}\n&lt;/update&gt;\n</code></pre>"},{"location":"java/ssm/#44-trim-where","title":"4.4 <code>&lt;trim&gt;</code> \u5b9e\u73b0 <code>&lt;where&gt;</code> \u7684\u529f\u80fd","text":"<p><code>&lt;trim&gt;</code> \u662f\u66f4\u7075\u6d3b\u7684\u6807\u7b7e\uff0c\u53ef\u4ee5\u81ea\u5b9a\u4e49\u524d\u540e\u7f00\u5904\u7406\u3002\u5f53\u6807\u7b7e\u4e0d\u4e3a\u7a7a\uff0c\u5c31\u4f1a\u5728\u8fd9\u4e2asql\u7247\u6bb5\u524d\u6dfb\u52a0\u4e00\u4e2a\u524d\u7f00 prefix \u4ee5\u53ca\u540e\u7f00 suffix, \u540c\u65f6\u5982\u679c\u8fd9\u4e2asql\u7247\u6bb5\u4ee5\u6307\u5b9a\u7684\u524d\u7f00\u5f00\u59cb\uff0c\u5c31\u8986\u76d6\u4e3a\u7a7a\u4e32\u3002 <pre><code>&lt;trim prefix=\"\u524d\u7f00\" prefixOverrides=\"\u8981\u53bb\u9664\u7684\u524d\u7f00\u5b57\u7b26\u4e32\"\n      suffix=\"\u540e\u7f00\" suffixOverrides=\"\u8981\u53bb\u9664\u7684\u540e\u7f00\u5b57\u7b26\u4e32\"&gt;\n    SQL \u7247\u6bb5\n&lt;/trim&gt;\n\n\n&lt;select id=\"findEmp\" parameterType=\"EmpPO\" resultType=\"EmpPO\"&gt;\n    SELECT * FROM t_emp\n    &lt;trim prefix=\"WHERE\" prefixOverrides=\"AND |OR \"&gt;\n        &lt;if test=\"id != null\"&gt;\n            AND id = #{id}\n        &lt;/if&gt;\n        &lt;if test=\"empName != null and empName != ''\"&gt;\n            AND emp_name = #{empName}\n        &lt;/if&gt;\n        &lt;if test=\"age != null\"&gt;\n            AND age &gt;= #{age}\n        &lt;/if&gt;\n    &lt;/trim&gt;\n&lt;/select&gt;\n</code></pre> <ul> <li><code>prefix=\"WHERE\"</code>\uff1a\u5982\u679c\u6709\u5185\u5bb9\uff0c\u52a0 <code>WHERE</code> \u524d\u7f00</li> <li><code>prefixOverrides=\"AND |OR \"</code>\uff1a\u53bb\u9664\u7b2c\u4e00\u4e2a\u591a\u4f59\u7684 <code>AND</code> \u6216 <code>OR</code></li> <li>\u6548\u679c\u548c <code>&lt;where&gt;</code> \u5b8c\u5168\u4e00\u6837\uff0c\u4f46\u66f4\u7075\u6d3b</li> </ul>"},{"location":"java/ssm/#45-trim-set","title":"4.5 <code>&lt;trim&gt;</code> \u5b9e\u73b0 <code>&lt;set&gt;</code> \u7684\u529f\u80fd","text":"<pre><code>&lt;update id=\"updateEmp\" parameterType=\"EmpPO\"&gt;\n    UPDATE t_emp\n    &lt;trim prefix=\"SET\" suffixOverrides=\",\"&gt;\n        &lt;if test=\"empName != null and empName != ''\"&gt;\n            emp_name = #{empName},\n        &lt;/if&gt;\n        &lt;if test=\"age != null\"&gt;\n            age = #{age},\n        &lt;/if&gt;\n        &lt;if test=\"empSalary != null\"&gt;\n            emp_salary = #{empSalary},\n        &lt;/if&gt;\n    &lt;/trim&gt;\n    WHERE id = #{id}\n&lt;/update&gt;\n</code></pre>"},{"location":"java/ssm/#46-choose-when-otherwise","title":"4.6 <code>&lt;choose&gt;</code> <code>&lt;when&gt;</code> <code>&lt;otherwise&gt;</code>","text":"<p>\u200b   \u5f53\u9700\u8981\u4ece\u591a\u4e2a\u6761\u4ef6\u4e2d\u9009\u62e9\u4e00\u4e2a\u6765\u62fc\u63a5 SQL \u65f6\u4f7f\u7528\u3002\u5b83\u4fdd\u8bc1\u53ea\u6267\u884c\u7b2c\u4e00\u4e2a\u5339\u914d\u7684\u6761\u4ef6\uff0c\u5176\u4f59\u5ffd\u7565\uff0c\u5e38\u7528\u4e8e\u201c\u641c\u7d22\u4f18\u5148\u7ea7\u201d\u6216\u201c\u5355\u9009\u6761\u4ef6\u201d\u3002</p> <pre><code>&lt;choose&gt;\n    &lt;when test=\"\u6761\u4ef61\"&gt;\n        SQL \u7247\u6bb51\n    &lt;/when&gt;\n    &lt;when test=\"\u6761\u4ef62\"&gt;\n        SQL \u7247\u6bb52\n    &lt;/when&gt;\n    &lt;otherwise&gt;\n        \u9ed8\u8ba4 SQL \u7247\u6bb5\uff08\u53ef\u9009\uff09\n    &lt;/otherwise&gt;\n&lt;/choose&gt;\n</code></pre>"},{"location":"java/ssm/#5-foreach","title":"5. foreach \u6807\u7b7e","text":""},{"location":"java/ssm/#1-foreach","title":"1. foreach\u5b9e\u73b0\u6279\u91cf\u67e5\u8be2","text":"<p>\u200b   \u539f\u751f\u8bed\u6cd5\uff1awhere xxx in()</p> <pre><code> &lt;select id=\"getEmpByIds\" resultType=\"person.liutianba.mybatis.bean.Emp\"&gt;\n        select * from t_emp where id in\n           &lt;if test=\"ids != null\"&gt;\n               &lt;foreach collection=\"ids\" item=\"id\" open=\"(\" close=\")\" separator=\",\"&gt;\n                   #{id}\n               &lt;/foreach&gt;\n           &lt;/if&gt;\n    &lt;/select&gt;\n</code></pre>"},{"location":"java/ssm/#2foreach","title":"2.\uff09foreach\u5b9e\u73b0\u6279\u91cf\u63d2\u5165","text":"<p>\u200b   \u539f\u751f\u8bed\u6cd5\uff1avalues (), (), </p> <pre><code>&lt;insert id=\"addEmps\"&gt;\n        insert into t_emp (emp_name, age, emp_salary)\n        values \n        &lt;foreach collection=\"list\" item=\"emp\" separator=\",\"&gt;\n            (#{emp.empName}, #{emp.age}, #{emp.empSalary})\n        &lt;/foreach&gt;\n    &lt;/insert&gt;\n</code></pre>"},{"location":"java/ssm/#3-foreach","title":"3. foreach\u5b9e\u73b0\u6279\u91cf\u4fee\u6539","text":"<p>\u200b   \u6ca1\u6709\u539f\u751f\u8bed\u6cd5\uff0c\u6240\u4ee5\u9700\u8981\u5728\u4e00\u4e2asql\u8bf7\u6c42\u53d1\u9001\u591a\u4e2asql\uff0c\u6ce8\uff1a\u9700\u8981\u5728\u6570\u636e\u5e93\u8fde\u63a5\u65f6\u5f00\u59cb\u6279\u5904\u7406\u3002</p> <pre><code>spring.datasource.url=jdbc:mysql://localhost:3306/mybatis-example?allowMultiQueries=true\n</code></pre>"},{"location":"java/ssm/#6-sql","title":"6. sql \u6807\u7b7e","text":"<p>\u200b   \u8d1f\u8d23\u628a\u5e38\u7528\u7684sql\u7247\u6bb5\u5207\u51fa\u6765\uff0c\u7136\u540e\u505a\u4e00\u4e2a\u590d\u7528\u3002\u9700\u8981\u914d\u5408 include \u6807\u7b7e\u6765\u4f7f\u7528\u3002</p>"},{"location":"java/ssm/#5_1","title":"5. \u7279\u6b8a\u5b57\u7b26\u7684\u8f6c\u4e49","text":""},{"location":"java/ssm/#6-mybatis","title":"6. Mybatis \u7684\u7f13\u5b58\u673a\u5236","text":"<p>\u200b   MyBatis \u63d0\u4f9b\u4e86\u4e24\u7ea7\u7f13\u5b58\u673a\u5236\uff1a\u4e00\u7ea7\u7f13\u5b58 \u548c \u4e8c\u7ea7\u7f13\u5b58\uff0c\u7528\u4e8e\u63d0\u5347\u6570\u636e\u5e93\u67e5\u8be2\u6027\u80fd\uff0c\u907f\u514d\u91cd\u590d\u6267\u884c\u76f8\u540c\u7684 SQL\u3002</p>"},{"location":"java/ssm/#1_7","title":"1. \u4e00\u7ea7\u7f13\u5b58\u673a\u5236 \uff08\u540c\u4e00\u4e8b\u52a1\u5171\u4eab\uff09","text":"<p>\u200b   1\uff09\u7b2c\u4e00\u6b21\u6267\u884c <code>select</code> \u65f6\uff0c\u67e5\u8be2\u6570\u636e\u5e93\uff0c\u7ed3\u679c\u653e\u5165\u4e00\u7ea7\u7f13\u5b58</p> <p>\u200b   2\uff09\u540e\u7eed\u6267\u884c\u76f8\u540c SQL \u548c\u53c2\u6570\u65f6\uff0c\u76f4\u63a5\u4ece\u7f13\u5b58\u4e2d\u53d6\u6570\u636e\uff0c\u4e0d\u518d\u67e5\u8be2\u6570\u636e\u5e93</p> <p>\u200b   3\uff09\u5982\u679c\u6267\u884c\u4e86 <code>insert</code>\u3001<code>update</code>\u3001<code>delete</code> \u6216 <code>sqlSession.clearCache()</code>\uff0c\u7f13\u5b58\u4f1a\u88ab\u6e05\u7a7a</p>"},{"location":"java/ssm/#2_12","title":"2. \u4e8c\u7ea7\u7f13\u5b58\u673a\u5236 \uff08\u6240\u6709\u4e8b\u52a1\u5171\u4eab\uff09","text":"<p>\u200b   1\uff09\u4f5c\u7528\u8303\u56f4\uff1a<code>Mapper</code> \u7ea7\u522b\uff08\u547d\u540d\u7a7a\u95f4\u7ea7\u522b\uff09</p> <p>\u200b   2\uff09\u751f\u547d\u5468\u671f\uff1a\u8de8 <code>SqlSession</code>\uff0c\u751a\u81f3\u8de8\u4e8b\u52a1\u5171\u4eab</p> <p>\u200b   3\uff09\u9ed8\u8ba4\u5173\u95ed\uff1a\u5fc5\u987b\u624b\u52a8\u914d\u7f6e\u624d\u80fd\u542f\u7528</p> <ol> <li>\u7b2c\u4e00\u4e2a <code>SqlSession</code> \u67e5\u8be2\u6570\u636e\u540e\uff0c\u7ed3\u679c\u4e0d\u4ec5\u5b58\u5165\u4e00\u7ea7\u7f13\u5b58\uff0c\u8fd8\u5199\u5165\u4e8c\u7ea7\u7f13\u5b58</li> <li>\u7b2c\u4e8c\u4e2a <code>SqlSession</code> \u6267\u884c\u76f8\u540c\u67e5\u8be2\u65f6\uff0c\u5148\u67e5\u4e8c\u7ea7\u7f13\u5b58\uff0c\u547d\u4e2d\u5219\u76f4\u63a5\u8fd4\u56de</li> <li>\u5f53\u4efb\u610f <code>SqlSession</code> \u6267\u884c <code>commit()</code> \u65f6\uff0c\u4e8c\u7ea7\u7f13\u5b58\u624d\u4f1a\u66f4\u65b0\uff08\u672a\u63d0\u4ea4\u4e0d\u66f4\u65b0\uff09</li> </ol> <pre><code>// \u7b2c\u4e00\u4e2a\u4f1a\u8bdd\nSqlSession session1 = sqlSessionFactory.openSession();\nUserMapper mapper1 = session1.getMapper(UserMapper.class);\nUser user1 = mapper1.findById(1);  // \u67e5\u6570\u636e\u5e93 \u2192 \u5b58\u5165\u4e00\u7ea7 + \u4e8c\u7ea7\u7f13\u5b58\nsession1.close(); // \u4e8c\u7ea7\u7f13\u5b58\u6b64\u65f6\u5df2\u66f4\u65b0\uff08\u56e0\u4e3a commit\uff09\n\n// \u7b2c\u4e8c\u4e2a\u4f1a\u8bdd\nSqlSession session2 = sqlSessionFactory.openSession();\nUserMapper mapper2 = session2.getMapper(UserMapper.class);\nUser user2 = mapper2.findById(1);  // \u76f4\u63a5\u4ece\u4e8c\u7ea7\u7f13\u5b58\u8bfb\u53d6\uff01\u4e0d\u67e5\u6570\u636e\u5e93\nsession2.close();\n</code></pre>"},{"location":"java/ssm/#7-mybatis","title":"7. Mybatis\u7684\u56db\u5927\u5bf9\u8c61\u4ee5\u53ca\u62e6\u622a\u5668\uff08\u5148\u4e86\u89e3\uff09","text":""},{"location":"java/ssm/#8","title":"8. \u5206\u9875\u63d2\u4ef6","text":"<p>\u4f7f\u7528\u6b65\u9aa4\uff1a</p> <p>\u200b   1\uff09\u5f15\u5165\u4f9d\u8d56\uff1aPageHelper</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;com.github.pagehelper&lt;/groupId&gt;\n    &lt;artifactId&gt;pagehelper-spring-boot-starter&lt;/artifactId&gt;\n    &lt;version&gt;\u6700\u65b0\u7248\u672c&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u200b   2\uff09\u6ce8\u518c PageHelper \u63d2\u4ef6\uff0c\u53ef\u4ee5\u5728\u6ce8\u518c\u8fc7\u7a0b\u4e2d\u914d\u7f6e\u4e00\u4e9b\u5c5e\u6027</p> <pre><code>@Configuration\npublic class PageHelperConfig {\n    /*\n     * \u914d\u7f6e\u5206\u9875\u63d2\u4ef6\n     */\n\n    @Bean\n    public PageInterceptor pageHelper() {\n        // 1. \u521b\u5efa\u63d2\u4ef6\u5bf9\u8c61\n        PageInterceptor pageHelper = new PageInterceptor();\n\n        // 2. \u914d\u7f6e\u63d2\u4ef6\u5bf9\u8c61\n\n        return pageHelper;\n    }\n}\n</code></pre> <p>\u200b   3\uff09\u5728\u9700\u8981\u5206\u9875\u7684\u65b9\u6cd5\u4e4b\u524d\u5f00\u59cb\u5206\u9875</p> <pre><code>// \u5f00\u542f\u5206\u9875\nPageHelper.startPage(pageNum, pageSize);\n</code></pre> <p>\u200b   4\uff09\u7528 PageInfo \u53bb\u5305\u88c5\u5206\u9875\u67e5\u8be2\u7ed3\u679c\uff0c\u91cc\u9762\u6709\u524d\u7aef\u8981\u7528\u5230\u7684\u5f88\u591a\u6570\u636e\uff0c\u6bd4\u5982\u9875\u9762\u5927\u5c0f\uff0c\u662f\u5426\u662f\u6700\u540e\u4e00\u9875\u7b49\u7b49\u3002</p> <pre><code>// \u5305\u88c5\u7ed3\u679c\nPageInfo&lt;Emp&gt; pageInfo = new PageInfo&lt;&gt;(list);\n</code></pre>"},{"location":"java/ssm/#mybatis-plus","title":"\u4e03\u3001Mybatis plus\u2b50\u2b50","text":"<p>\u200b   MyBatis-Plus \u662f\u4e00\u4e2a MyBatis \u7684\u589e\u5f3a\u5de5\u5177\uff0c\u5728 MyBatis \u7684\u57fa\u7840\u4e0a\u53ea\u505a\u589e\u5f3a\u4e0d\u505a\u6539\u53d8\uff0c\u4e3a\u7b80\u5316\u5f00\u53d1\u3001\u63d0\u9ad8\u6548\u7387\u800c\u751f\u3002</p>"},{"location":"java/ssm/#71","title":"7.1 \u6846\u67b6\u6982\u8ff0","text":"<p>MyBatis-Plus\uff08\u7b80\u79f0 MP\uff09\u662f\u4e00\u4e2aMyBatis \u7684\u589e\u5f3a\u5de5\u5177\uff0c\u5728 MyBatis \u7684\u57fa\u7840\u4e0a\u53ea\u505a\u589e\u5f3a\u4e0d\u505a\u6539\u53d8\uff0c\u4e3a\u7b80\u5316\u5f00\u53d1\u3001\u63d0\u9ad8\u6548\u7387\u800c\u751f\u3002\u5176\u7a81\u51fa\u7684\u7279\u6027\u5982\u4e0b\uff1a</p> <ul> <li>\u65e0\u4fb5\u5165\uff1a\u53ea\u505a\u589e\u5f3a\u4e0d\u505a\u6539\u53d8\uff0c\u5f15\u5165\u5b83\u4e0d\u4f1a\u5bf9\u73b0\u6709\u5de5\u7a0b\u4ea7\u751f\u5f71\u54cd\uff0c\u5982\u4e1d\u822c\u987a\u6ed1</li> <li>\u5f3a\u5927\u7684 CRUD \u64cd\u4f5c\uff1a\u5185\u7f6e\u901a\u7528 Mapper\u3001\u901a\u7528 Service\uff0c\u63d0\u4f9b\u4e86\u5927\u91cf\u7684\u901a\u7528\u7684CRUD\u65b9\u6cd5\uff0c\u56e0\u6b64\u53ef\u4ee5\u7701\u53bb\u5927\u91cf\u624b\u5199sql\u7684\u8bed\u53e5\u7684\u5de5\u4f5c\u3002</li> <li>\u6761\u4ef6\u6784\u9020\u5668\uff1a\u63d0\u4f9b\u4e86\u5f3a\u5927\u7684\u6761\u4ef6\u6784\u9020\u5668\uff0c\u53ef\u4ee5\u6784\u9020\u5404\u79cd\u590d\u6742\u7684\u67e5\u8be2\u6761\u4ef6\uff0c\u4ee5\u5e94\u5bf9\u5404\u79cd\u590d\u6742\u67e5\u8be2\u3002</li> <li>\u5185\u7f6e\u5206\u9875\u63d2\u4ef6\uff1a\u914d\u7f6e\u597d\u63d2\u4ef6\u4e4b\u540e\uff0c\u5199\u5206\u9875\u7b49\u540c\u4e8e\u666e\u901a List \u67e5\u8be2\uff0c\u65e0\u9700\u5173\u6ce8\u5206\u9875\u903b\u8f91\u3002</li> </ul> <p>\u4e0b\u9762\u901a\u8fc7\u4e00\u4e2a\u7b80\u5355\u6848\u4f8b\u5feb\u901f\u719f\u6089MyBatis Plus\u7684\u57fa\u672c\u4f7f\u7528</p>"},{"location":"java/ssm/#72","title":"7.2 \u6570\u636e\u5e93\u51c6\u5907","text":"<p>\u9996\u5148\u5728\u6570\u636e\u5e93\u4e2d\u51c6\u5907\u4e00\u5f20\u8868\uff0c\u4e3a\u540e\u5e8f\u7684\u5b66\u4e60\u505a\u51c6\u5907\u3002</p> <ol> <li>\u521b\u5efa\u6570\u636e\u5e93</li> </ol> <p>\u5728MySQL\u4e2d\u521b\u5efa\u4e00\u4e2a\u6570\u636e\u5e93<code>hello_mp</code></p> <pre><code>CREATE DATABASE hello_mp CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;\n</code></pre> <ol> <li>\u521b\u5efa\u8868</li> </ol> <p>\u5728<code>hello-mp</code>\u5e93\u4e2d\u521b\u5efa\u4e00\u4e2a\u8868<code>user</code></p> <pre><code>DROP TABLE IF EXISTS user;\nCREATE TABLE user\n(\n    id BIGINT(20) NOT NULL AUTO_INCREMENT COMMENT '\u4e3b\u952eID',\n    name VARCHAR(30) NULL DEFAULT NULL COMMENT '\u59d3\u540d',\n    age INT(11) NULL DEFAULT NULL COMMENT '\u5e74\u9f84',\n    email VARCHAR(50) NULL DEFAULT NULL COMMENT '\u90ae\u7bb1',\n    PRIMARY KEY (id)\n);\n</code></pre> <ol> <li>\u63d2\u5165\u6570\u636e</li> </ol> <pre><code>INSERT INTO user (id, name, age, email) VALUES\n(1, 'Jone', 18, 'test1@baomidou.com'),\n(2, 'Jack', 20, 'test2@baomidou.com'),\n(3, 'Tom', 28, 'test3@baomidou.com'),\n(4, 'Sandy', 21, 'test4@baomidou.com'),\n(5, 'Billie', 24, 'test5@baomidou.com');\n</code></pre>"},{"location":"java/ssm/#73-springboot","title":"7.3 \u4e0eSpringBoot\u96c6\u6210","text":"<p>Mybatis Plus\u4e0eSpringBoot\u7684\u96c6\u6210\u5341\u5206\u7b80\u5355\uff0c\u5177\u4f53\u64cd\u4f5c\u5982\u4e0b</p> <ol> <li>\u5f15\u5165Maven \u4f9d\u8d56</li> </ol> <p>\u63d0\u524d\u521b\u5efa\u597d\u4e00\u4e2aSpringBoot\u9879\u76ee\uff0c\u7136\u540e\u5728\u9879\u76ee\u4e2d\u5f15\u5165MyBatis Plus\u4f9d\u8d56</p> <pre><code> &lt;dependency&gt;\n            &lt;groupId&gt;com.baomidou&lt;/groupId&gt;\n            &lt;artifactId&gt;mybatis-plus-spring-boot3-starter&lt;/artifactId&gt;\n            &lt;version&gt;3.5.6&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u672c\u6848\u4f8b\u5b8c\u6574\u7684<code>pom.xml</code>\u6587\u4ef6\u5982\u4e0b</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\n    &lt;groupId&gt;person.liutianba&lt;/groupId&gt;\n    &lt;artifactId&gt;springboot_03_mybatis-plus&lt;/artifactId&gt;\n    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\n\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;3.5.7&lt;/version&gt;\n    &lt;/parent&gt;\n\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.baomidou&lt;/groupId&gt;\n            &lt;artifactId&gt;mybatis-plus-spring-boot3-starter&lt;/artifactId&gt;\n            &lt;version&gt;3.5.6&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.mysql&lt;/groupId&gt;\n            &lt;artifactId&gt;mysql-connector-j&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\n            &lt;artifactId&gt;lombok&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n    &lt;/dependencies&gt;\n\n    &lt;properties&gt;\n        &lt;maven.compiler.source&gt;17&lt;/maven.compiler.source&gt;\n        &lt;maven.compiler.target&gt;17&lt;/maven.compiler.target&gt;\n        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n    &lt;/properties&gt;\n\n&lt;/project&gt;\n</code></pre> <ol> <li>\u914d\u7f6e<code>application.yml</code>\u6587\u4ef6</li> </ol> <p>\u914d\u7f6e\u6570\u636e\u5e93\u76f8\u5173\u5185\u5bb9\u5982\u4e0b</p> <pre><code>spring:\n  datasource:\n    driver-class-name: com.mysql.cj.jdbc.Driver\n    username: root\n    password: liuqiang\n    url: jdbc:mysql://192.168.10.101:3306/hello_mp?useUnicode=true&amp;characterEncoding=utf-8&amp;serverTimezone=GMT%2b8\n</code></pre>"},{"location":"java/ssm/#74","title":"7.4 \u521b\u5efa\u5b9e\u4f53\u7c7b","text":"<p>\u521b\u5efa\u4e0e<code>user</code>\u8868\u76f8\u5bf9\u5e94\u7684\u5b9e\u4f53\u7c7b\uff0c\u5982\u4e0b</p> <pre><code>@Data\n@TableName(\"user\")\npublic class User {\n\n    @TableId(value = \"id\", type = IdType.AUTO)\n    private Long id;\n\n    @TableField(\"name\")\n    private String name;\n\n    @TableField(\"age\")\n    private Integer age;\n\n    @TableField(\"email\")\n    private String email;\n}\n</code></pre> <p>\u77e5\u8bc6\u70b9\uff1a</p> <p>\u5b9e\u4f53\u7c7b\u4e2d\u7684\u4e09\u4e2a\u6ce8\u89e3\u7684\u542b\u4e49\u5982\u4e0b</p> <ul> <li><code>@TableName</code>\uff1a\u8868\u540d\u6ce8\u89e3\uff0c\u7528\u4e8e\u6807\u8bc6\u5b9e\u4f53\u7c7b\u6240\u5bf9\u5e94\u7684\u8868</li> <li> <p><code>value</code>\uff1a\u7528\u4e8e\u58f0\u660e\u8868\u540d</p> </li> <li> <p><code>@TableId</code>\uff1a\u4e3b\u952e\u6ce8\u89e3\uff0c\u7528\u4e8e\u6807\u8bc6\u4e3b\u952e\u5b57\u6bb5</p> </li> <li><code>value</code>\uff1a\u7528\u4e8e\u58f0\u660e\u4e3b\u952e\u7684\u5b57\u6bb5\u540d</li> <li> <p><code>type</code>\uff1a\u7528\u4e8e\u58f0\u660e\u4e3b\u952e\u7684\u751f\u6210\u7b56\u7565\uff0c\u5e38\u7528\u7684\u7b56\u7565\u6709<code>AUTO</code>\u3001<code>ASSIGN_UUID</code>\u3001<code>INPUT</code>\u7b49\u7b49</p> </li> <li> <p><code>@TableField</code>\uff1a\u666e\u901a\u5b57\u6bb5\u6ce8\u89e3\uff0c\u7528\u4e8e\u6807\u8bc6\u5c5e\u6027\u6240\u5bf9\u5e94\u7684\u8868\u5b57\u6bb5</p> </li> <li><code>value</code>\uff1a\u7528\u4e8e\u58f0\u660e\u666e\u901a\u5b57\u6bb5\u7684\u5b57\u6bb5\u540d</li> </ul>"},{"location":"java/ssm/#75-mapper","title":"7.5 \u901a\u7528Mapper","text":"<p>\u901a\u7528Mapper\u63d0\u4f9b\u4e86\u901a\u7528\u7684CRUD\u65b9\u6cd5\uff0c\u4f7f\u7528\u5b83\u53ef\u4ee5\u7701\u53bb\u5927\u91cf\u7f16\u5199\u7b80\u5355\u91cd\u590d\u7684SQL\u8bed\u53e5\u7684\u5de5\u4f5c\uff0c\u5177\u4f53\u7528\u6cd5\u5982\u4e0b</p> <ol> <li>\u521b\u5efaMapper\u63a5\u53e3</li> </ol> <p>\u521b\u5efa<code>UserMapper</code>\u63a5\u53e3\uff0c\u5e76\u7ee7\u627f\u7531Mybatis Plus\u63d0\u4f9b\u7684<code>BaseMapper&lt;T&gt;</code>\u63a5\u53e3\uff0c\u5982\u4e0b</p> <pre><code>public interface UserMapper extends BaseMapper&lt;User&gt; {\n}\n</code></pre> <p>\u77e5\u8bc6\u70b9\uff1a</p> <p>\u82e5Mapper\u63a5\u53e3\u8fc7\u591a\uff0c\u53ef\u4e0d\u7528\u9010\u4e00\u914d\u7f6e<code>@Mapper</code>\u6ce8\u89e3\uff0c\u800c\u4f7f\u7528<code>@MapperScan</code>\u6ce8\u89e3\u6307\u5b9a\u5305\u626b\u63cf\u8def\u5f84\u8fdb\u884c\u7edf\u4e00\u7ba1\u7406\uff0c\u4f8b\u5982</p> <pre><code>@SpringBootApplication\n@MapperScan(\"com.atguigu.hellomp.mapper\")\npublic class HelloMpApplication {\n\n    public static void main(String[] args) {\n        SpringApplication.run(HelloMpApplication.class, args);\n    }\n}\n</code></pre> <ol> <li>\u6d4b\u8bd5\u901a\u7528Mapper</li> </ol> <p>\u521b\u5efa<code>userMapperTest</code>\u6d4b\u8bd5\u7c7b\u578b\uff0c\u5185\u5bb9\u5982\u4e0b</p> <pre><code>@SpringBootTest\nclass UserMapperTest {\n\n    @Autowired\n    private UserMapper userMapper;\n\n    @Test\n    public void testSelectList() {\n        List&lt;User&gt; users = userMapper.selectList(null);\n        users.forEach(System.out::println);\n    }\n\n    @Test\n    public void testSelectById() {\n        User user = userMapper.selectById(1);\n        System.out.println(user);\n    }\n\n    @Test\n    public void testInsert() {\n        User user = new User();\n        user.setName(\"zhangsan\");\n        user.setAge(11);\n        user.setEmail(\"test@test.com\");\n        userMapper.insert(user);\n    }\n\n    @Test\n    public void testUpdateById() {\n        User user = userMapper.selectById(1);\n        user.setName(\"xiaoming\");\n        userMapper.updateById(user);\n    }\n\n    @Test\n    public void testDeleteById() {\n        userMapper.deleteById(1);\n    }\n}\n</code></pre>"},{"location":"java/ssm/#76-service","title":"7.6 \u901a\u7528Service","text":"<p>\u901a\u7528Service\u8fdb\u4e00\u6b65\u5c01\u88c5\u4e86\u901a\u7528Mapper\u7684CRUD\u65b9\u6cd5\uff0c\u5e76\u63d0\u4f9b\u4e86\u4f8b\u5982<code>saveOrUpdate</code>\u3001<code>saveBatch</code>\u7b49\u9ad8\u7ea7\u65b9\u6cd5\u3002</p> <ol> <li>\u521b\u5efaService\u63a5\u53e3</li> </ol> <p>\u521b\u5efa<code>UserService</code>\uff0c\u5185\u5bb9\u5982\u4e0b</p> <pre><code>public interface UserService extends IService&lt;User&gt; {\n}\n</code></pre> <ol> <li>\u521b\u5efaService\u5b9e\u73b0\u7c7b</li> </ol> <p>\u521b\u5efa<code>UserServiceImpl</code>\uff0c\u5185\u5bb9\u5982\u4e0b</p> <pre><code>@Service\npublic class UserServiceImpl extends ServiceImpl&lt;UserMapper, User&gt; implements UserService {\n}\n</code></pre> <ol> <li>\u6d4b\u8bd5\u901a\u7528Service</li> </ol> <p>\u521b\u5efa<code>UserServiceImplTest</code>\u6d4b\u8bd5\u7c7b\uff0c\u5185\u5bb9\u5982\u4e0b</p> <pre><code>@SpringBootTest\nclass UserServiceImplTest {\n\n\n    @Autowired\n    private UserService userService;\n\n    @Test\n    public void testSaveOrUpdate() {\n        User user1 = userService.getById(2);\n        user1.setName(\"xiaohu\");\n\n        User user2 = new User();\n        user2.setName(\"lisi\");\n        user2.setAge(27);\n        user2.setEmail(\"lisi@email.com\");\n        userService.saveOrUpdate(user1);\n        userService.saveOrUpdate(user2);\n    }\n\n\n    @Test\n    public void testSaveBatch() {\n        User user1 = new User();\n        user1.setName(\"dongdong\");\n        user1.setAge(49);\n        user1.setEmail(\"dongdong@email.com\");\n\n        User user2 = new User();\n        user2.setName(\"nannan\");\n        user2.setAge(29);\n        user2.setEmail(\"nannan@email.com\");\n\n        List&lt;User&gt; users = List.of(user1, user2);\n        userService.saveBatch(users);\n    }\n}\n</code></pre>"},{"location":"java/ssm/#77","title":"7.7 \u6761\u4ef6\u6784\u9020\u5668","text":"<p>MyBatis-Plus \u63d0\u4f9b\u4e86\u4e00\u5957\u5f3a\u5927\u7684\u6761\u4ef6\u6784\u9020\u5668\uff08Wrapper\uff09\uff0c\u7528\u4e8e\u6784\u5efa\u590d\u6742\u7684\u6570\u636e\u5e93\u67e5\u8be2\u6761\u4ef6\u3002Wrapper \u7c7b\u5141\u8bb8\u5f00\u53d1\u8005\u4ee5\u94fe\u5f0f\u8c03\u7528\u7684\u65b9\u5f0f\u6784\u9020\u67e5\u8be2\u6761\u4ef6\uff0c\u65e0\u9700\u7f16\u5199\u7e41\u7410\u7684 SQL \u8bed\u53e5\uff0c\u4ece\u800c\u63d0\u9ad8\u5f00\u53d1\u6548\u7387\u5e76\u51cf\u5c11 SQL \u6ce8\u5165\u7684\u98ce\u9669\u3002</p> <p>\u5728 MyBatis-Plus \u4e2d\uff0cWrapper \u7c7b\u662f\u6784\u5efa\u67e5\u8be2\u548c\u66f4\u65b0\u6761\u4ef6\u7684\u6838\u5fc3\u5de5\u5177\u3002\u4ee5\u4e0b\u662f\u4e3b\u8981\u7684 Wrapper \u7c7b\u53ca\u5176\u529f\u80fd\uff1a</p> <ul> <li>AbstractWrapper\uff1a\u8fd9\u662f\u4e00\u4e2a\u62bd\u8c61\u57fa\u7c7b\uff0c\u63d0\u4f9b\u4e86\u6240\u6709 Wrapper \u7c7b\u5171\u6709\u7684\u65b9\u6cd5\u548c\u5c5e\u6027\u3002\u5b83\u5b9a\u4e49\u4e86\u6761\u4ef6\u6784\u9020\u7684\u57fa\u672c\u903b\u8f91\uff0c\u5305\u62ec\u5b57\u6bb5\uff08column\uff09\u3001\u503c\uff08value\uff09\u3001\u64cd\u4f5c\u7b26\uff08condition\uff09\u7b49\u3002\u6240\u6709\u7684 QueryWrapper\u3001UpdateWrapper\u3001LambdaQueryWrapper \u548c LambdaUpdateWrapper \u90fd\u7ee7\u627f\u81ea AbstractWrapper\u3002</li> <li>QueryWrapper\uff1a\u4e13\u95e8\u7528\u4e8e\u6784\u9020\u67e5\u8be2\u6761\u4ef6\uff0c\u652f\u6301\u57fa\u672c\u7684\u7b49\u4e8e\u3001\u4e0d\u7b49\u4e8e\u3001\u5927\u4e8e\u3001\u5c0f\u4e8e\u7b49\u5404\u79cd\u5e38\u89c1\u64cd\u4f5c\u3002\u5b83\u5141\u8bb8\u4f60\u4ee5\u94fe\u5f0f\u8c03\u7528\u7684\u65b9\u5f0f\u6dfb\u52a0\u591a\u4e2a\u67e5\u8be2\u6761\u4ef6\uff0c\u5e76\u4e14\u53ef\u4ee5\u7ec4\u5408\u4f7f\u7528 <code>and</code> \u548c <code>or</code> \u903b\u8f91\u3002</li> <li>UpdateWrapper\uff1a\u7528\u4e8e\u6784\u9020\u66f4\u65b0\u6761\u4ef6\uff0c\u53ef\u4ee5\u5728\u66f4\u65b0\u6570\u636e\u65f6\u6307\u5b9a\u6761\u4ef6\u3002\u4e0e QueryWrapper \u7c7b\u4f3c\uff0c\u5b83\u4e5f\u652f\u6301\u94fe\u5f0f\u8c03\u7528\u548c\u903b\u8f91\u7ec4\u5408\u3002\u4f7f\u7528 UpdateWrapper \u53ef\u4ee5\u5728\u4e0d\u521b\u5efa\u5b9e\u4f53\u5bf9\u8c61\u7684\u60c5\u51b5\u4e0b\uff0c\u76f4\u63a5\u8bbe\u7f6e\u66f4\u65b0\u5b57\u6bb5\u548c\u6761\u4ef6\u3002</li> <li>LambdaQueryWrapper\uff1a\u8fd9\u662f\u4e00\u4e2a\u57fa\u4e8e Lambda \u8868\u8fbe\u5f0f\u7684\u67e5\u8be2\u6761\u4ef6\u6784\u9020\u5668\uff0c\u5b83\u901a\u8fc7 Lambda \u8868\u8fbe\u5f0f\u6765\u5f15\u7528\u5b9e\u4f53\u7c7b\u7684\u5c5e\u6027\uff0c\u4ece\u800c\u907f\u514d\u4e86\u786c\u7f16\u7801\u5b57\u6bb5\u540d\u3002\u8fd9\u79cd\u65b9\u5f0f\u63d0\u9ad8\u4e86\u4ee3\u7801\u7684\u53ef\u8bfb\u6027\u548c\u53ef\u7ef4\u62a4\u6027\uff0c\u5c24\u5176\u662f\u5728\u5b57\u6bb5\u540d\u53ef\u80fd\u53d1\u751f\u53d8\u5316\u7684\u60c5\u51b5\u4e0b\u3002</li> <li> <p>LambdaUpdateWrapper\uff1a\u7c7b\u4f3c\u4e8e LambdaQueryWrapper\uff0cLambdaUpdateWrapper \u662f\u57fa\u4e8e Lambda \u8868\u8fbe\u5f0f\u7684\u66f4\u65b0\u6761\u4ef6\u6784\u9020\u5668\u3002\u5b83\u5141\u8bb8\u4f60\u4f7f\u7528 Lambda \u8868\u8fbe\u5f0f\u6765\u6307\u5b9a\u66f4\u65b0\u5b57\u6bb5\u548c\u6761\u4ef6\uff0c\u540c\u6837\u907f\u514d\u4e86\u786c\u7f16\u7801\u5b57\u6bb5\u540d\u7684\u95ee\u9898\u3002</p> </li> <li> <p>\u521b\u5efa<code>WrapperTest</code>\u6d4b\u8bd5\u7c7b\uff0c\u5185\u5bb9\u5982\u4e0b</p> </li> </ul> <pre><code>@SpringBootTest\npublic class WrapperTest {\n\n    @Autowired\n    private UserService userService;\n\n    @Test\n    public void testQueryWrapper() {\n\n        //\u67e5\u8be2name=Tom\u7684\u6240\u6709\u7528\u6237\n        QueryWrapper&lt;User&gt; queryWrapper1 = new QueryWrapper&lt;&gt;();\n        queryWrapper1.eq(\"name\", \"Tom\");\n\n        //\u67e5\u8be2\u90ae\u7bb1\u57df\u540d\u4e3abaomidou.com\u7684\u6240\u6709\u7528\u6237\n        QueryWrapper&lt;User&gt; queryWrapper2 = new QueryWrapper&lt;&gt;();\n        queryWrapper2.like(\"email\", \"baomidou.com\");\n\n        //\u67e5\u8be2\u6240\u6709\u7528\u6237\u4fe1\u606f\u5e76\u6309\u7167age\u5b57\u6bb5\u964d\u5e8f\u6392\u5e8f\n        QueryWrapper&lt;User&gt; queryWrapper3 = new QueryWrapper&lt;&gt;();\n        queryWrapper3.orderByDesc(\"age\");\n\n        //\u67e5\u8be2age\u4ecb\u4e8e[20,30]\u7684\u6240\u6709\u7528\u6237\n        QueryWrapper&lt;User&gt; queryWrapper4 = new QueryWrapper&lt;&gt;();\n        queryWrapper4.between(\"age\", 20, 30);\n\n        //\u67e5\u8be2age\u5c0f\u4e8e20\u6216\u5927\u4e8e30\u7684\u7528\u6237\n        QueryWrapper&lt;User&gt; queryWrapper5 = new QueryWrapper&lt;&gt;();\n        queryWrapper5.lt(\"age\", 20).or().gt(\"age\", 30);\n\n        //\u90ae\u7bb1\u57df\u540d\u4e3abaomidou.com\u4e14\u5e74\u9f84\u5c0f\u4e8e30\u6216\u5927\u4e8e40\u4e14\u7684\u7528\u6237\n        QueryWrapper&lt;User&gt; queryWrapper6 = new QueryWrapper&lt;&gt;();\n        queryWrapper6.like(\"email\", \"baomidou.com\").and(wrapper -&gt; wrapper.lt(\"age\", 30).or().gt(\"age\", 40));\n\n        List&lt;User&gt; list = userService.list(queryWrapper6);\n        list.forEach(System.out::println);\n    }\n\n    @Test\n    public void testUpdateWrapper() {\n\n        //\u5c06name=Tom\u7684\u7528\u6237\u7684email\u6539\u4e3aTom@baobidou.com\n        UpdateWrapper&lt;User&gt; updateWrapper = new UpdateWrapper&lt;&gt;();\n        updateWrapper.eq(\"name\", \"Tom\");\n        updateWrapper.set(\"email\", \"Tom@baobidou.com\");\n\n        userService.update(updateWrapper);\n    }\n}\n</code></pre> <ol> <li>\u521b\u5efa<code>LambdaWrapperTest</code>\u6d4b\u8bd5\u7c7b\uff0c\u5185\u5bb9\u5982\u4e0b</li> </ol> <p>\u4e0a\u8ff0\u7684<code>QueryWrapper</code>\u548c<code>UpdateWrapper</code>\u5747\u6709\u4e00\u4e2a<code>Lambda</code>\u7248\u672c\uff0c\u4e5f\u5c31\u662f<code>LambdaQueryWrapper</code>\u548c<code>LambdaUpdateWrapper</code>\uff0c<code>Lambda</code>\u7248\u672c\u7684\u4f18\u52bf\u5728\u4e8e\uff0c\u53ef\u4ee5\u7701\u53bb\u5b57\u6bb5\u540d\u7684\u786c\u7f16\u7801\uff0c\u5177\u4f53\u6848\u4f8b\u5982\u4e0b\uff1a</p> <pre><code>@SpringBootTest\npublic class LambdaWrapperTest {\n\n    @Autowired\n    private UserService userService;\n\n    @Test\n    public void testLambdaQueryWrapper() {\n        //\u67e5\u8be2name=Tom\u7684\u6240\u6709\u7528\u6237\n        LambdaQueryWrapper&lt;User&gt; lambdaQueryWrapper = new LambdaQueryWrapper&lt;&gt;();\n        lambdaQueryWrapper.eq(User::getName, \"Tom\");\n\n        List&lt;User&gt; list = userService.list(lambdaQueryWrapper);\n        list.forEach(System.out::println);\n\n    }\n\n    @Test\n    public void testLambdaUpdateWrapper() {\n        //\u5c06name=Tom\u7684\u7528\u6237\u7684\u90ae\u7bb1\u6539\u4e3aTom@tom.com\n        LambdaUpdateWrapper&lt;User&gt; lambdaUpdateWrapper = new LambdaUpdateWrapper&lt;&gt;();\n        lambdaUpdateWrapper.eq(User::getName, \"Tom\");\n        lambdaUpdateWrapper.set(User::getEmail, \"Tom@Tom.com\");\n\n        userService.update(lambdaUpdateWrapper);\n    }\n}\n</code></pre>"},{"location":"java/ssm/#78","title":"7.8 \u903b\u8f91\u5220\u9664","text":"<p>\u903b\u8f91\u5220\u9664\uff0c\u53ef\u4ee5\u65b9\u4fbf\u5730\u5b9e\u73b0\u5bf9\u6570\u636e\u5e93\u8bb0\u5f55\u7684\u903b\u8f91\u5220\u9664\u800c\u4e0d\u662f\u7269\u7406\u5220\u9664\u3002\u903b\u8f91\u5220\u9664\u662f\u6307\u901a\u8fc7\u66f4\u6539\u8bb0\u5f55\u7684\u72b6\u6001\u6216\u6dfb\u52a0\u6807\u8bb0\u5b57\u6bb5\u6765\u6a21\u62df\u5220\u9664\u64cd\u4f5c\uff0c\u4ece\u800c\u4fdd\u7559\u4e86\u5220\u9664\u524d\u7684\u6570\u636e\uff0c\u4fbf\u4e8e\u540e\u7eed\u7684\u6570\u636e\u5206\u6790\u548c\u6062\u590d\u3002</p> <ul> <li>\u7269\u7406\u5220\u9664\uff1a\u771f\u5b9e\u5220\u9664\uff0c\u5c06\u5bf9\u5e94\u6570\u636e\u4ece\u6570\u636e\u5e93\u4e2d\u5220\u9664\uff0c\u4e4b\u540e\u67e5\u8be2\u4e0d\u5230\u6b64\u6761\u88ab\u5220\u9664\u7684\u6570\u636e</li> <li> <p>\u903b\u8f91\u5220\u9664\uff1a\u5047\u5220\u9664\uff0c\u5c06\u5bf9\u5e94\u6570\u636e\u4e2d\u4ee3\u8868\u662f\u5426\u88ab\u5220\u9664\u5b57\u6bb5\u7684\u72b6\u6001\u4fee\u6539\u4e3a\u201c\u88ab\u5220\u9664\u72b6\u6001\u201d\uff0c\u4e4b\u540e\u5728\u6570\u636e\u5e93\u4e2d\u4ecd\u65e7\u80fd\u770b\u5230\u6b64\u6761\u6570\u636e\u8bb0\u5f55</p> </li> <li> <p>\u6570\u636e\u5e93\u548c\u5b9e\u4f53\u7c7b\u6dfb\u52a0\u903b\u8f91\u5220\u9664\u5b57\u6bb5 </p> </li> <li> <p>\u8868\u6dfb\u52a0\u903b\u8f91\u5220\u9664\u5b57\u6bb5</p> <p>\u53ef\u4ee5\u662f\u4e00\u4e2a\u5e03\u5c14\u7c7b\u578b\u3001\u6574\u6570\u7c7b\u578b\u6216\u679a\u4e3e\u7c7b\u578b\u3002</p> <pre><code>ALTER TABLE USER ADD deleted INT DEFAULT 0 ;  # int \u7c7b\u578b 1 \u903b\u8f91\u5220\u9664 0 \u672a\u903b\u8f91\u5220\u9664\n</code></pre> </li> <li> <p>\u5b9e\u4f53\u7c7b\u6dfb\u52a0\u5c5e\u6027</p> <pre><code>@Data\npublic class User {\n\n   // @TableId\n    private Integer id;\n    private String name;\n    private Integer age;\n    private String email;\n\n    @TableLogic\n    //\u903b\u8f91\u5220\u9664\u5b57\u6bb5 int mybatis-plus\u4e0b,\u9ed8\u8ba4 \u903b\u8f91\u5220\u9664\u503c\u4e3a1 \u672a\u903b\u8f91\u5220\u9664 0 \n    private Integer deleted;\n}\n</code></pre> </li> </ul> <p>2.\u6307\u5b9a\u903b\u8f91\u5220\u9664\u5b57\u6bb5\u548c\u5c5e\u6027\u503c </p> <ol> <li>\u5355\u4e00\u6307\u5b9a</li> </ol> <pre><code>@Data\npublic class User {\n\n   // @TableId\n    private Integer id;\n    private String name;\n    private Integer age;\n    private String email;\n     @TableLogic\n    //\u903b\u8f91\u5220\u9664\u5b57\u6bb5 int mybatis-plus\u4e0b,\u9ed8\u8ba4 \u903b\u8f91\u5220\u9664\u503c\u4e3a1 \u672a\u903b\u8f91\u5220\u9664 0\n    private Integer deleted;\n}\n</code></pre> <ol> <li>\u5168\u5c40\u914d\u7f6e</li> </ol> <pre><code>mybatis-plus:\n  global-config:\n    db-config:\n      logic-delete-field: deleted #\u5217\u540d\n      logic-delete-value: 1 # \u903b\u8f91\u5df2\u5220\u9664\u503c(\u9ed8\u8ba4\u4e3a 1)\n      logic-not-delete-value: 0 # \u903b\u8f91\u672a\u5220\u9664\u503c(\u9ed8\u8ba4\u4e3a 0)\n</code></pre> <p>3.\u6f14\u793a\u903b\u8f91\u5220\u9664\u64cd\u4f5c</p> <p>\u5220\u9664\u4ee3\u7801:</p> <pre><code>//\u903b\u8f91\u5220\u9664\n@Test\npublic void testQuick5(){\n    //\u903b\u8f91\u5220\u9664\n    userMapper.deleteById(5);\n}\n</code></pre> <p>\u6267\u884c\u6548\u679c:</p> <p>JDBC Connection [com.alibaba.druid.proxy.jdbc.ConnectionProxyImpl@5871a482] will not be managed by Spring</p> <p>==&gt; Preparing: UPDATE user SET deleted=1 WHERE id=? AND deleted=0 ==&gt; Parameters: 5(Integer) &lt;==    Updates: 1 4. \u6d4b\u8bd5\u67e5\u8be2\u6570\u636e</p> <pre><code>@Test\npublic void testQuick6(){\n    //\u6b63\u5e38\u67e5\u8be2.\u9ed8\u8ba4\u67e5\u8be2\u975e\u903b\u8f91\u5220\u9664\u6570\u636e\n    userMapper.selectList(null);\n}\n\n//SELECT id,name,age,email,deleted FROM user WHERE deleted=0\n</code></pre>"},{"location":"java/ssm/#79","title":"7.9 \u5206\u9875\u63d2\u4ef6","text":"<p>\u5206\u9875\u67e5\u8be2\u662f\u4e00\u4e2a\u5f88\u5e38\u89c1\u7684\u9700\u6c42\uff0c\u6545Mybatis-Plus\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5206\u9875\u63d2\u4ef6\uff0c\u4f7f\u7528\u5b83\u53ef\u4ee5\u5341\u5206\u65b9\u4fbf\u7684\u5b8c\u6210\u5206\u9875\u67e5\u8be2\u3002\u4e0b\u9762\u4ecb\u7ecdMybatis-Plus\u5206\u9875\u63d2\u4ef6\u7684\u7528\u6cd5\uff0c\u8be6\u7ec6\u4fe1\u606f\u53ef\u53c2\u8003\u5b98\u65b9\u6587\u6863\u3002</p> <ul> <li>\u914d\u7f6e\u5206\u9875\u63d2\u4ef6</li> </ul> <p>\u521b\u5efa<code>com.atguigu.hellomp.config.MPConfiguration</code>\u914d\u7f6e\u7c7b\uff0c\u589e\u52a0\u5982\u4e0b\u5185\u5bb9</p> <pre><code>@Configuration\npublic class MPConfiguration {\n\n    @Bean\n    public MybatisPlusInterceptor mybatisPlusInterceptor() {\n        MybatisPlusInterceptor interceptor = new MybatisPlusInterceptor();\n        interceptor.addInnerInterceptor(new PaginationInnerInterceptor(DbType.MYSQL));\n        return interceptor;\n    }\n}\n</code></pre> <ul> <li>\u5206\u9875\u63d2\u4ef6\u4f7f\u7528\u8bf4\u660e</li> </ul> <p>\u6784\u9020\u5206\u9875\u5bf9\u8c61, \u5206\u9875\u5bf9\u8c61\u5305\u542b\u4e86\u5206\u9875\u7684\u5404\u9879\u4fe1\u606f\uff0c\u5176\u6838\u5fc3\u5c5e\u6027\u5982\u4e0b\uff1a</p> <pre><code>| \u5c5e\u6027\u540d  | \u7c7b\u578b | \u9ed8\u8ba4\u503c    | \u63cf\u8ff0                   |\n| ------- | ---- | --------- | ---------------------- |\n| records | List | emptyList | \u67e5\u8be2\u6570\u636e\u5217\u8868           |\n| total   | Long | 0         | \u67e5\u8be2\u5217\u8868\u603b\u8bb0\u5f55\u6570       |\n| size    | Long | 10        | \u6bcf\u9875\u663e\u793a\u6761\u6570\uff0c\u9ed8\u8ba4`10` |\n| current | Long | 1         | \u5f53\u524d\u9875                 |\n\n\u5206\u9875\u5bf9\u8c61\u65e2\u4f5c\u4e3a\u5206\u9875\u67e5\u8be2\u7684\u53c2\u6570\uff0c\u4e5f\u4f5c\u4e3a\u5206\u9875\u67e5\u8be2\u7684\u8fd4\u56de\u7ed3\u679c\uff0c\u5f53\u4f5c\u4e3a\u67e5\u8be2\u53c2\u6570\u65f6\uff0c\u901a\u5e38\u53ea\u9700\u63d0\u4f9b`current`\u548c`size`\u5c5e\u6027\uff0c\u5982\u4e0b\n\n```java\nIPage&lt;T&gt; page = new Page&lt;&gt;(current, size);\n```\n\n\u6ce8\uff1a`IPage`\u4e3a\u5206\u9875\u63a5\u53e3\uff0c`Page`\u4e3a`IPage`\u63a5\u53e3\u7684\u4e00\u4e2a\u5b9e\u73b0\u7c7b\u3002\n</code></pre> <ul> <li> <p>\u5206\u9875\u67e5\u8be2</p> <p>Mybatis Plus\u7684<code>BaseMapper</code>\u548c<code>ServiceImpl</code>\u5747\u63d0\u4f9b\u4e86\u5e38\u7528\u7684\u5206\u9875\u67e5\u8be2\u7684\u65b9\u6cd5\uff0c\u4f8b\u5982\uff1a</p> <ul> <li><code>BaseMapper</code>\u7684\u5206\u9875\u67e5\u8be2\uff1a</li> </ul> <pre><code>IPage&lt;T&gt; selectPage(IPage&lt;T&gt; page,Wrapper&lt;T&gt; queryWrapper);\n</code></pre> <ul> <li><code>ServiceImpl</code>\u7684\u5206\u9875\u67e5\u8be2\uff1a</li> </ul> <pre><code>// \u65e0\u6761\u4ef6\u5206\u9875\u67e5\u8be2\nIPage&lt;T&gt; page(IPage&lt;T&gt; page);\n// \u6761\u4ef6\u5206\u9875\u67e5\u8be2\nIPage&lt;T&gt; page(IPage&lt;T&gt; page, Wrapper&lt;T&gt; queryWrapper);\n</code></pre> <ul> <li>\u81ea\u5b9a\u4e49Mapper</li> </ul> <p>\u5bf9\u4e8e\u81ea\u5b9a\u4e49SQL\uff0c\u4e5f\u53ef\u4ee5\u5341\u5206\u65b9\u4fbf\u7684\u5b8c\u6210\u5206\u9875\u67e5\u8be2\uff0c\u5982\u4e0b</p> <p><code>Mapper</code>\u63a5\u53e3\uff1a</p> <pre><code>IPage&lt;UserVo&gt; selectPageVo(IPage&lt;?&gt; page, Integer state);\n</code></pre> <p><code>Mapper.xml</code>\uff1a</p> <pre><code>&lt;select id=\"selectPageVo\" resultType=\"xxx.xxx.xxx.UserVo\"&gt;\n    SELECT id,name FROM user WHERE state=#{state}\n&lt;/select&gt;\n</code></pre> <p>\u6ce8\u610f\uff1a<code>Mapper.xml</code>\u4e2d\u7684SQL\u53ea\u9700\u5b9e\u73b0\u67e5\u8be2<code>list</code>\u7684\u903b\u8f91\u5373\u53ef\uff0c\u65e0\u9700\u5173\u6ce8\u5206\u9875\u7684\u903b\u8f91\u3002</p> </li> <li> <p>\u6848\u4f8b\u5b9e\u64cd</p> </li> </ul> <p>\u5206\u9875\u67e5\u8be2\u6848\u4f8b\u5982\u4e0b\uff1a</p> <p>\u521b\u5efa<code>PageTest</code>\u6d4b\u8bd5\u7c7b\uff0c\u5185\u5bb9\u5982\u4e0b</p> <pre><code>@SpringBootTest\npublic class PageTest {\n\n    @Autowired\n    private UserService userService;\n\n    @Autowired\n    private UserMapper userMapper;\n\n    //\u901a\u7528Service\u5206\u9875\u67e5\u8be2\n    @Test\n    public void testPageService() {\n        Page&lt;User&gt; page = new Page&lt;&gt;(2, 3);\n        Page&lt;User&gt; userPage = userService.page(page);\n        userPage.getRecords().forEach(System.out::println);\n    }\n\n    //\u901a\u7528Mapper\u5206\u9875\u67e5\u8be2\n    @Test\n    public void testPageMapper() {\n        IPage&lt;User&gt; page = new Page&lt;&gt;(2, 3);\n        IPage&lt;User&gt; userPage = userMapper.selectPage(page, null);\n        userPage.getRecords().forEach(System.out::println);\n    }\n\n    //\u81ea\u5b9a\u4e49SQL\u5206\u9875\u67e5\u8be2\n    @Test\n    public void testCustomMapper() {\n        IPage&lt;User&gt; page = new Page&lt;&gt;(2, 3);\n        IPage&lt;User&gt; userPage = userMapper.selectUserPage(page);\n        userPage.getRecords().forEach(System.out::println);\n    }\n}\n</code></pre> <p>\u5728UserMapper\u4e2d\u58f0\u660e\u5206\u9875\u67e5\u8be2\u65b9\u6cd5\u5982\u4e0b</p> <pre><code>IPage&lt;User&gt; selectUserPage(IPage&lt;User&gt; page);\n</code></pre> <p>\u521b\u5efa<code>resources/mapper/UserMapper.xml</code>\u6587\u4ef6\uff0c\u5185\u5bb9\u5982\u4e0b</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE mapper\n        PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\"\n        \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\"&gt;\n&lt;mapper namespace=\"com.atguigu.hellomp.mapper.UserMapper\"&gt;\n    &lt;select id=\"selectUserPage\" resultType=\"com.atguigu.hellomp.entity.User\"&gt;\n        select *\n        from user\n    &lt;/select&gt;\n&lt;/mapper&gt;\n</code></pre> <p>\u6ce8\u610f\uff1a</p> <p>Mybatis-Plus\u4e2d<code>Mapper.xml</code>\u6587\u4ef6\u8def\u5f84\u9ed8\u8ba4\u4e3a\uff1a<code>classpath*:/mapper/**/*.xml</code>\uff0c\u53ef\u5728<code>application.yml</code>\u4e2d\u914d\u7f6e\u4ee5\u4e0b\u53c2\u6570\u8fdb\u884c\u4fee\u6539</p> <pre><code> ```yml\n</code></pre> <p>mybatis-plus:     mapper-locations: classpath:/mapper//.xml      ```</p>"},{"location":"java/ssm/#710-mybatisx","title":"7.10 MyBatisX\u63d2\u4ef6","text":"<p>MyBatis Plus\u63d0\u4f9b\u4e86\u4e00\u4e2aIDEA\u63d2\u4ef6\u2014\u2014<code>MybatisX</code>,\u4f7f\u7528\u5b83\u53ef\u6839\u636e\u6570\u636e\u5e93\u5feb\u901f\u751f\u6210<code>Entity</code>\u3001<code>Mapper</code>\u3001<code>Mapper.xml</code>\u3001<code>Service</code>\u3001<code>ServiceImpl</code>\u7b49\u4ee3\u7801\uff0c\u4f7f\u7528\u6237\u66f4\u4e13\u6ce8\u4e8e\u4e1a\u52a1</p>"},{"location":"middleware/minio/","title":"minio","text":""},{"location":"middleware/minio/#_1","title":"\u57fa\u7840\u6982\u5ff5","text":"<ul> <li>\u5bf9\u8c61\uff08Object\uff09 </li> </ul> <p>\u5bf9\u8c61\u662f\u5b9e\u9645\u7684\u6570\u636e\u5355\u5143\uff0c\u4f8b\u5982\u6211\u4eec\u4e0a\u4f20\u7684\u4e00\u4e2a\u56fe\u7247\u3002</p> <ul> <li>\u5b58\u50a8\u6876\uff08Bucket\uff09</li> </ul> <p>\u5b58\u50a8\u6876\u662f\u7528\u4e8e\u7ec4\u7ec7\u5bf9\u8c61\u7684\u547d\u540d\u7a7a\u95f4\uff0c\u7c7b\u4f3c\u4e8e\u6587\u4ef6\u5939\u3002\u6bcf\u4e2a\u5b58\u50a8\u6876\u53ef\u4ee5\u5305\u542b\u591a\u4e2a\u5bf9\u8c61\u3002</p> <ul> <li>\u7aef\u70b9\uff08Endpoint\uff09 </li> </ul> <p>\u7aef\u70b9\u662fMinIO\u670d\u52a1\u5668\u7684\u7f51\u7edc\u5730\u5740\uff0c\u7528\u4e8e\u8bbf\u95ee\u5b58\u50a8\u6876\u548c\u5bf9\u8c61\uff0c\u4f8b\u5982<code>http://192.168.10.101:9000</code></p> <p>\u6ce8\u610f\uff1a</p> <p><code>9000</code>\u4e3aMinIO\u7684API\u7684\u9ed8\u8ba4\u7aef\u53e3\uff0c\u524d\u8fb9\u914d\u7f6e\u7684<code>9001</code>\u4ee5\u4e3a\u7ba1\u7406\u9875\u9762\u7aef\u53e3\u3002</p> <ul> <li>Access Key \u548c Secret Key</li> </ul> <p>Access Key\u662f\u7528\u4e8e\u6807\u8bc6\u548c\u9a8c\u8bc1\u8bbf\u95ee\u8005\u8eab\u4efd\u7684\u552f\u4e00\u6807\u8bc6\u7b26\uff0c\u76f8\u5f53\u4e8e\u7528\u6237\u540d\u3002</p> <p>Secret Key\u662f\u4e0eAccess Key\u5173\u8054\u7684\u5bc6\u7801\uff0c\u7528\u4e8e\u9a8c\u8bc1\u8bbf\u95ee\u8005\u7684\u8eab\u4efd\u3002</p>"},{"location":"middleware/minio/#minio","title":"MinIO\u7ba1\u7406\u9875\u9762\u64cd\u4f5c","text":"<ol> <li>\u767b\u5f55</li> </ol> <p>\u7ba1\u7406\u9875\u9762\u7684\u5730\u5740\u4e3ahttp://192.168.10.101:9001\uff0c\u767b\u5f55\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\u4e3a\u90e8\u7f72\u65f6\u5728<code>EnvironmentFile</code>\u6587\u4ef6\u4e2d\u914d\u7f6e\u7684\u5982\u4e0b\u53c2\u6570</p> <pre><code>MINIO_ROOT_USER=minioadmin\nMINIO_ROOT_PASSWORD=minioadmin\n</code></pre> <ol> <li>\u521b\u5efa\u5b58\u50a8\u6876</li> </ol> <p></p> <ol> <li> <p>\u4e0a\u4f20\u56fe\u7247</p> </li> <li> <p>\u627e\u5230\u76ee\u6807\u6876</p> <p></p> </li> <li> <p>\u4e0a\u4f20\u56fe\u7247</p> <p></p> </li> <li> <p>\u8bbf\u95ee\u56fe\u7247</p> </li> <li> <p>\u56fe\u7247URL</p> <p>\u7531\u4e8eMinIO\u63d0\u4f9b\u4e86HTTP\u8bbf\u95ee\u529f\u80fd\uff0c\u6240\u4ee5\u53ef\u4ee5\u901a\u8fc7\u6d4f\u89c8\u5668\u76f4\u63a5\u8bbf\u95ee\u5bf9\u8c61\u3002\u5bf9\u8c61URL\u4e3aMinIO\u7684<code>Endpoint</code>+<code>\u5bf9\u8c61\u7684\u5b58\u50a8\u8def\u5f84</code>\uff0c\u4f8b\u5982\u4e0b\u56fe\u4e2d\u7684\u56fe\u7247\u5bf9\u8c61\u7684URL\u4e3a :</p> <p>http:192.168.10.101:9000/test/\u516c\u5bd3-\u5916\u89c2.jpg\u3002</p> <p></p> </li> <li> <p>\u8bbf\u95ee\u6743\u9650</p> <p>\u4e0d\u51fa\u610f\u5916\u7684\u8bdd\uff0c\u4f7f\u7528\u6d4f\u89c8\u5668\u8bbf\u95ee\u4e0a\u8ff0URL\uff0c\u4f1a\u5f97\u5230\u5982\u4e0b\u54cd\u5e94\uff0c\u5f88\u663e\u7136\u662f\u6ca1\u6709\u8bbf\u95ee\u6743\u9650\u3002</p> <pre><code>&lt;Error&gt;\n    &lt;Code&gt;AccessDenied&lt;/Code&gt;\n    &lt;Message&gt;Access Denied.&lt;/Message&gt;\n    &lt;Key&gt;\u516c\u5bd3-\u5916\u89c2.jpg&lt;/Key&gt;\n    &lt;BucketName&gt;test&lt;/BucketName&gt;\n    &lt;Resource&gt;/test/\u516c\u5bd3-\u5916\u89c2.jpg&lt;/Resource&gt;\n    &lt;RequestId&gt;177BC92022FC5684&lt;/RequestId&gt;\n    &lt;HostId&gt;dd9025bab4ad464b049177c95eb6ebf374d3b3fd1af9251148b658df7ac2e3e8&lt;/HostId&gt;\n&lt;/Error&gt;\n</code></pre> <p>\u82e5\u60f3\u7ee7\u7eed\u8bbf\u95ee\u56fe\u7247\uff0c\u9700\u8981\u4fee\u6539\u56fe\u7247\u6240\u5728\u6876\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u5982\u4e0b\u56fe\u6240\u793a</p> <p></p> <p>\u5982\u4e0a\u56fe\u6240\u793a\uff0c\u53ef\u9009\u7684\u8bbf\u95ee\u6743\u9650\u5171\u6709\u4e09\u4e2a\u9009\u9879\uff0c\u5206\u522b\u662f<code>Private</code>\u3001<code>Public</code>\u548c<code>Custom</code>\uff0c\u5177\u4f53\u8bf4\u660e\u5982\u4e0b</p> <ul> <li><code>Private</code></li> </ul> <p>\u53ea\u5141\u8bb8\u6876\u7684\u6240\u6709\u8005\u5bf9\u8be5\u6876\u8fdb\u884c\u8bfb\u5199\u3002</p> <ul> <li><code>Public</code></li> </ul> <p>\u5141\u8bb8\u6240\u6709\u4eba\u5bf9\u8be5\u6876\u8fdb\u884c\u8bfb\u5199\u3002</p> <ul> <li><code>Custom</code></li> </ul> <p>\u81ea\u5b9a\u4e49\u8bbf\u95ee\u6743\u9650\u3002</p> <p>\u82e5\u60f3\u5c06\u6743\u9650\u8bbe\u7f6e\u4e3a\u53ea\u5141\u8bb8\u6240\u6709\u8005\u5199\uff0c\u4f46\u5141\u8bb8\u6240\u6709\u4eba\u8bfb\uff0c\u5c31\u9700\u8981\u81ea\u5b9a\u4e49\u8bbf\u95ee\u6743\u9650\u3002\u81ea\u5b9a\u4e49\u8bbf\u95ee\u6743\u9650\uff0c\u9700\u8981\u4f7f\u7528\u4e00\u4e2a\u89c4\u5b9a\u683c\u5f0f\u7684JSON\u5b57\u7b26\u4e32\u8fdb\u884c\u63cf\u8ff0\uff0c\u5177\u4f53\u683c\u5f0f\u53ef\u53c2\u8003\u5b98\u65b9\u6587\u6863\u3002</p> <p>\u4f8b\u5982\u4ee5\u4e0bJSON\u5b57\u7b26\u4e32\u8868\u8fbe\u7684\u542b\u4e49\u662f\uff1a\u5141\u8bb8(<code>Allow</code>)\u6240\u6709\u4eba(<code>*</code>)\u8bfb\u53d6(<code>s3:GetObject</code>)\u6307\u5b9a\u6876(<code>test</code>)\u7684\u6240\u6709\u5185\u5bb9\u3002</p> <pre><code>{\n  \"Statement\" : [ {\n    \"Action\" : \"s3:GetObject\",\n    \"Effect\" : \"Allow\",\n    \"Principal\" : \"*\",\n    \"Resource\" : \"arn:aws:s3:::test/*\"\n  } ],\n  \"Version\" : \"2012-10-17\"\n}\n</code></pre> <p>\u5c06<code>test</code>\u6876\u8bbf\u95ee\u6743\u9650\u8bbe\u7f6e\u4e3a<code>Custom</code>\uff0c\u5e76\u6dfb\u52a0\u4e0a\u8ff0\u5185\u5bb9,\u6539\u6210\u81ea\u5df1\u7684\u6876\u540d\uff01</p> <p>\u91cd\u65b0\u8bbf\u95eehttp:192.168.10.101:9000/test/\u516c\u5bd3-\u5916\u89c2.jpg\uff0c\u89c2\u5bdf\u662f\u5426\u6b63\u5e38\u3002</p> </li> </ol>"},{"location":"middleware/minio/#minio-java-sdk","title":"MinIO Java SDK","text":"<p>MinIO\u63d0\u4f9b\u4e86\u591a\u79cd\u8bed\u8a00\u7684SDK\u4f9b\u5f00\u53d1\u8005\u4f7f\u7528\uff0c\u672c\u9879\u76ee\u9700\u8981\u7528\u5230Java SDK\uff0c\u4e0b\u9762\u901a\u8fc7\u4e00\u4e2a\u7b80\u5355\u6848\u4f8b\u719f\u6089\u4e00\u4e0b\u5176\u57fa\u672c\u7528\u6cd5\uff0c\u5177\u4f53\u5185\u5bb9\u53ef\u53c2\u8003\u5b98\u65b9\u6587\u6863\u3002</p> <ol> <li> <p>\u521b\u5efa\u4e00\u4e2aMaven\u9879\u76ee</p> </li> <li> <p>\u5f15\u5165\u5982\u4e0b\u4f9d\u8d56</p> </li> </ol> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;io.minio&lt;/groupId&gt;\n    &lt;artifactId&gt;minio&lt;/artifactId&gt;\n    &lt;version&gt;8.5.3&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <ol> <li>\u7f16\u5199\u5982\u4e0b\u5185\u5bb9</li> </ol> <pre><code>package person.ltb;\n\n\nimport io.minio.*;\nimport io.minio.errors.*;\n\nimport java.io.IOException;\nimport java.security.InvalidKeyException;\nimport java.security.NoSuchAlgorithmException;\n\npublic class Minio {\n    public static void main(String[] args) throws ServerException, InsufficientDataException, ErrorResponseException, IOException, NoSuchAlgorithmException, InvalidKeyException, InvalidResponseException, XmlParserException, InternalException {\n        // \u8fde\u63a5\u53c2\u6570\n        String endpoint = \"http://43.143.165.110:9000\";\n        String accessKey = \"minioadmin\";\n        String accessSecret = \"minioadmin\";\n\n\n        // \u521b\u5efaMinioClient\u5bf9\u8c61\n        MinioClient minioClient = MinioClient.builder()\n                .endpoint(endpoint)\n                .credentials(accessKey, accessSecret)\n                .build();\n\n        // \u5982\u679c\u6876\u4e0d\u5b58\u5728\uff0c\u5c31\u53bb\u521b\u5efa\u4e00\u4e2a\u65b0\u6876\n        String bucketName = \"lease\";\n        boolean found = minioClient.bucketExists(BucketExistsArgs.builder().bucket(bucketName).build());\n\n        if (!found) {\n            // \u521b\u5efa\u6876\n            minioClient.makeBucket(MakeBucketArgs.builder().bucket(bucketName).build());\n            String policy = \"\"\"\n                     {\n                          \"Statement\" : [ {\n                            \"Action\" : \"s3:GetObject\",\n                            \"Effect\" : \"Allow\",\n                            \"Principal\" : \"*\",\n                            \"Resource\" : \"arn:aws:s3:::hello-minio/*\"\n                          } ],\n                          \"Version\" : \"2012-10-17\"\n                    }\n                    \"\"\";\n\n            minioClient.setBucketPolicy(SetBucketPolicyArgs.builder().bucket(bucketName).config(policy).build());\n        } else {\n            System.out.println(\"Bucket already exists.\");\n        }\n\n        // \u4e0a\u4f20\u4e00\u5f20\u56fe\u7247\n        minioClient.uploadObject(\n                UploadObjectArgs.builder()\n                        .bucket(bucketName)\n                        .object(\"test.png\")\n                        .filename(\"C:\\\\Users\\\\xx\\\\Pictures\\\\sy\\\\1.png\")\n                        .build()\n        );\n\n        // \u62fc\u63a5\u8bbf\u95ee\u5730\u5740\n        String url = endpoint + \"/\" + bucketName + \"/\" + \"test.png\";\n\n        System.out.println(url);\n    }\n}\n</code></pre> <ol> <li>\u8fd0\u884c\u6d4b\u8bd5</li> </ol> <p>\u8fd0\u884c\u4e0a\u8ff0\u4ee3\u7801\uff0c\u7136\u540e\u67e5\u770bMinIO\u7ba1\u7406\u9875\u9762\uff0c\u89c2\u5bdf\u662f\u5426\u4e0a\u4f20\u6210\u529f\u3002</p>"}]}