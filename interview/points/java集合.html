
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://liutianba7.github.io/interview/points/java%E9%9B%86%E5%90%88.html">
      
      
        <link rel="prev" href="java%E5%9F%BA%E7%A1%80.html">
      
      
        <link rel="next" href="ssm.html">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>java集合 - LiuTianBa7 's Blog</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#java" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../index.html" title="LiuTianBa7 &#39;s Blog" class="md-header__button md-logo" aria-label="LiuTianBa7 's Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12 8-1.33.09C9.81 7.07 7.4 4.5 5 4.5c0 0-1.97 2.96-.04 6.91-.55.83-.89 1.26-.96 2.25l-1.93.29.21.98 1.76-.26.14.71-1.57.94.47.89 1.45-.89C5.68 18.76 8.59 20 12 20s6.32-1.24 7.47-3.68l1.45.89.47-.89-1.57-.94.14-.71 1.76.26.21-.98-1.93-.29c-.07-.99-.41-1.42-.96-2.25C20.97 7.46 19 4.5 19 4.5c-2.4 0-4.81 2.57-5.67 3.59zm-3 3a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1m6 0a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1m-4 3h2l-.7 1.39c.2.64.76 1.11 1.45 1.11a1.5 1.5 0 0 0 1.5-1.5h.5a2 2 0 0 1-2 2c-.75 0-1.4-.41-1.75-1-.35.59-1 1-1.75 1a2 2 0 0 1-2-2h.5a1.5 1.5 0 0 0 1.5 1.5c.69 0 1.25-.47 1.45-1.11z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LiuTianBa7 's Blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              java集合
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="切换至深色模式"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="切换至深色模式" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="切换至浅色模式"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="切换至浅色模式" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/liutianba7/liutianba7.github.io" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    blog
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../index.html" class="md-tabs__link">
        
  
  
    
  
  Welcome

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../java/ssm.html" class="md-tabs__link">
          
  
  
  Java

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../python/Ai/langchain.html" class="md-tabs__link">
          
  
  
  Python

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../frontend/js.html" class="md-tabs__link">
          
  
  
  Frontend

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../index.html" class="md-tabs__link">
          
  
  
  Bagu

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../journal/2026-02.html" class="md-tabs__link">
          
  
  
  Journal

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../tools/git.html" class="md-tabs__link">
          
  
  
  Tools

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../middleware/mysql%E5%9F%BA%E7%A1%80.html" class="md-tabs__link">
          
  
  
  Middleware

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../linux/basic.html" class="md-tabs__link">
          
  
  
  Linux

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="LiuTianBa7 &#39;s Blog" class="md-nav__button md-logo" aria-label="LiuTianBa7 's Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12 8-1.33.09C9.81 7.07 7.4 4.5 5 4.5c0 0-1.97 2.96-.04 6.91-.55.83-.89 1.26-.96 2.25l-1.93.29.21.98 1.76-.26.14.71-1.57.94.47.89 1.45-.89C5.68 18.76 8.59 20 12 20s6.32-1.24 7.47-3.68l1.45.89.47-.89-1.57-.94.14-.71 1.76.26.21-.98-1.93-.29c-.07-.99-.41-1.42-.96-2.25C20.97 7.46 19 4.5 19 4.5c-2.4 0-4.81 2.57-5.67 3.59zm-3 3a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1m6 0a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1m-4 3h2l-.7 1.39c.2.64.76 1.11 1.45 1.11a1.5 1.5 0 0 0 1.5-1.5h.5a2 2 0 0 1-2 2c-.75 0-1.4-.41-1.75-1-.35.59-1 1-1.75 1a2 2 0 0 1-2-2h.5a1.5 1.5 0 0 0 1.5 1.5c.69 0 1.25-.47 1.45-1.11z"/></svg>

    </a>
    LiuTianBa7 's Blog
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/liutianba7/liutianba7.github.io" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    blog
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Welcome
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Java
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Java
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/ssm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ssm
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/springboot.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    springboot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Python
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Python
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/Ai/langchain.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    langchain
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/Ai/pytorch.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    pytorch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/Web/fastapi.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    fastapi
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Frontend
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Frontend
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frontend/js.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    js
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frontend/vue3.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    vue3
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Bagu
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Bagu
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    八股复习路线
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="java%E5%9F%BA%E7%A1%80.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    java基础
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    java集合
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="java%E9%9B%86%E5%90%88.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    java集合
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        一、集合概述
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="一、集合概述">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. 集合概述
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-listsetqueuemap" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. List，Set，Queue，Map四者的区别
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. 集合框架底层数据结构总结
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. 集合框架底层数据结构总结">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-list" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1 List
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-set" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2 Set
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-queue" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.3 Queue
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-map" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.4 Map
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. 如何选择集合
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. 为什么要使用集合
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#list" class="md-nav__link">
    <span class="md-ellipsis">
      
        二、List
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="二、List">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-array-arraylist" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Array 和 ArrayList
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-arraylist-vector" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. ArrayList 和 Vector 的区别
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-arraylist-null" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. ArrayList 可以添加 null 值吗？
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-arraylist" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. ArrayList 的插入和删除元素的时间复杂度
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-linkedlist" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. LinkedList 插入和删除元素的时间复杂度
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-linkedlist-randomaccess" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. LinkedList 为什么不能实现 RandomAccess 接口？
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-arraylist-linkedlist" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. ArrayList 和 LinkedList 的区别
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-randomaccess" class="md-nav__link">
    <span class="md-ellipsis">
      
        8. RandomAccess 接口⭐️
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-iterator" class="md-nav__link">
    <span class="md-ellipsis">
      
        9. Iterator 本质
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-arraylist" class="md-nav__link">
    <span class="md-ellipsis">
      
        10. ArrayList 的扩容机制⭐⭐⭐
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11-fail-fast-fail-safe" class="md-nav__link">
    <span class="md-ellipsis">
      
        11. 集合中的 fail-fast 和 fail-safe 是什么？
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="11. 集合中的 fail-fast 和 fail-safe 是什么？">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-fail-fast" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. fail-fast
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-fail-safe" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. fail-safe
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set" class="md-nav__link">
    <span class="md-ellipsis">
      
        三、Set
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="三、Set">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-comparable-comparator" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Comparable 和 Comparator 的区别
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. 无序性和不可重复性的含义是什么
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-hashsetlinkedhashset-treeset" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. 比较 HashSet、LinkedHashSet 和 TreeSet 三者的异同
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qqeue" class="md-nav__link">
    <span class="md-ellipsis">
      
        四、Qqeue
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="四、Qqeue">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-queue-deque" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Queue 和 Deque 的区别
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-arraydeque-linkedlist" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. ArrayDeque 和 LinkedList 的区别
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-priorityqueue" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. PriorityQueue
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-blockingqueue" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. BlockingQueue
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-blockingqueue" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. BlockingQueue 有哪些实现类
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-blockingqueue" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. BlockingQueue 有什么作用
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. BlockingQueue 有什么作用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a" class="md-nav__link">
    <span class="md-ellipsis">
      
        A. 线程池（最经典的应用）
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-decoupling" class="md-nav__link">
    <span class="md-ellipsis">
      
        B. 解耦（Decoupling）
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c" class="md-nav__link">
    <span class="md-ellipsis">
      
        C. 流量削峰
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-array" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Array
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#map" class="md-nav__link">
    <span class="md-ellipsis">
      
        五、Map
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="五、Map">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-hashmap-hashtable" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. HashMap 和 HashTable 的区别
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-haspmap-2n" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. 为什么 haspMap 底层数据必须是 \(2^n\) 呢⭐️⭐️⭐️
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#18-hash" class="md-nav__link">
    <span class="md-ellipsis">
      
        补充：为什么1.8 扩容时不需要重新计算 Hash？⭐️
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-hashmap-hashset" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. HashMap 和 HashSet 的区别
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-hashmap-treemap" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. HashMap 和 TreeMap 的区别
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-treemap" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. TreeMap 的优势⭐️⭐️⭐️
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-hashset" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. HashSet 如何检查重复
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-hashset" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. HashSet 如果元素存在，会覆盖吗？
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-hashmap" class="md-nav__link">
    <span class="md-ellipsis">
      
        8. HashMap 的底层实现⭐️
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="8. HashMap 的底层实现⭐️">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#81-put" class="md-nav__link">
    <span class="md-ellipsis">
      
        8.1 put 方法的底层原理⭐️
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#82-hash" class="md-nav__link">
    <span class="md-ellipsis">
      
        8.2 hash 源码⭐️
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#83" class="md-nav__link">
    <span class="md-ellipsis">
      
        8.3 底层数据结构
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#84" class="md-nav__link">
    <span class="md-ellipsis">
      
        8.4 扩容⭐️
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-hashmap" class="md-nav__link">
    <span class="md-ellipsis">
      
        9. 为什么 HashMap 优先扩容而非直接转为红黑树
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-8-64" class="md-nav__link">
    <span class="md-ellipsis">
      
        10. 为什么选择阈值 8 和 64
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11-hashmap" class="md-nav__link">
    <span class="md-ellipsis">
      
        11. HashMap 多线程操作导致死循环问题
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-hashmap" class="md-nav__link">
    <span class="md-ellipsis">
      
        12 HashMap 为什么线程不安全⭐️
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-hashmap" class="md-nav__link">
    <span class="md-ellipsis">
      
        13. HashMap 的常见遍历方式⭐️
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-coucurrenthashmap" class="md-nav__link">
    <span class="md-ellipsis">
      
        14. CoucurrentHashMap
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-jdk-17-jdk-18-concurrenthashmap" class="md-nav__link">
    <span class="md-ellipsis">
      
        15. JDK 1.7 和 JDK 1.8 的 ConcurrentHashMap 实现有什么不同？
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-node-cas-synchronized" class="md-nav__link">
    <span class="md-ellipsis">
      
        16. node + cas + synchronized
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#17-concurrenthashmap-key-value-null" class="md-nav__link">
    <span class="md-ellipsis">
      
        17. ConcurrentHashMap 为什么 key 和 value 不能为 null？
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#18-colletions" class="md-nav__link">
    <span class="md-ellipsis">
      
        18. Colletions 工具类
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ssm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ssm
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="springboot%2BCloud.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    spring[boot|cloud]
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="mysql.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    mysql
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="redis.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    redis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="es.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    elasticsearch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="rmq.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    rmq
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="seata.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    seata
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    设计模式
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Journal
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Journal
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../journal/2026-02.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    202602
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tools
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tools
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/git.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    git
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/docker.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    docker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Middleware
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Middleware
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../middleware/mysql%E5%9F%BA%E7%A1%80.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    mysql 基础
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../middleware/mysql%E9%AB%98%E7%BA%A7.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    mysql 高级
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../middleware/redis.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    redis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../middleware/minio.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    minio
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Linux
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Linux
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/basic.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    basic
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        一、集合概述
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="一、集合概述">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. 集合概述
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-listsetqueuemap" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. List，Set，Queue，Map四者的区别
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. 集合框架底层数据结构总结
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. 集合框架底层数据结构总结">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-list" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1 List
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-set" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2 Set
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-queue" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.3 Queue
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-map" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.4 Map
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. 如何选择集合
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. 为什么要使用集合
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#list" class="md-nav__link">
    <span class="md-ellipsis">
      
        二、List
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="二、List">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-array-arraylist" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Array 和 ArrayList
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-arraylist-vector" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. ArrayList 和 Vector 的区别
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-arraylist-null" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. ArrayList 可以添加 null 值吗？
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-arraylist" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. ArrayList 的插入和删除元素的时间复杂度
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-linkedlist" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. LinkedList 插入和删除元素的时间复杂度
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-linkedlist-randomaccess" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. LinkedList 为什么不能实现 RandomAccess 接口？
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-arraylist-linkedlist" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. ArrayList 和 LinkedList 的区别
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-randomaccess" class="md-nav__link">
    <span class="md-ellipsis">
      
        8. RandomAccess 接口⭐️
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-iterator" class="md-nav__link">
    <span class="md-ellipsis">
      
        9. Iterator 本质
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-arraylist" class="md-nav__link">
    <span class="md-ellipsis">
      
        10. ArrayList 的扩容机制⭐⭐⭐
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11-fail-fast-fail-safe" class="md-nav__link">
    <span class="md-ellipsis">
      
        11. 集合中的 fail-fast 和 fail-safe 是什么？
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="11. 集合中的 fail-fast 和 fail-safe 是什么？">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-fail-fast" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. fail-fast
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-fail-safe" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. fail-safe
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set" class="md-nav__link">
    <span class="md-ellipsis">
      
        三、Set
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="三、Set">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-comparable-comparator" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Comparable 和 Comparator 的区别
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. 无序性和不可重复性的含义是什么
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-hashsetlinkedhashset-treeset" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. 比较 HashSet、LinkedHashSet 和 TreeSet 三者的异同
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qqeue" class="md-nav__link">
    <span class="md-ellipsis">
      
        四、Qqeue
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="四、Qqeue">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-queue-deque" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Queue 和 Deque 的区别
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-arraydeque-linkedlist" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. ArrayDeque 和 LinkedList 的区别
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-priorityqueue" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. PriorityQueue
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-blockingqueue" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. BlockingQueue
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-blockingqueue" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. BlockingQueue 有哪些实现类
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-blockingqueue" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. BlockingQueue 有什么作用
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. BlockingQueue 有什么作用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a" class="md-nav__link">
    <span class="md-ellipsis">
      
        A. 线程池（最经典的应用）
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-decoupling" class="md-nav__link">
    <span class="md-ellipsis">
      
        B. 解耦（Decoupling）
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c" class="md-nav__link">
    <span class="md-ellipsis">
      
        C. 流量削峰
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-array" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Array
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#map" class="md-nav__link">
    <span class="md-ellipsis">
      
        五、Map
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="五、Map">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-hashmap-hashtable" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. HashMap 和 HashTable 的区别
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-haspmap-2n" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. 为什么 haspMap 底层数据必须是 \(2^n\) 呢⭐️⭐️⭐️
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#18-hash" class="md-nav__link">
    <span class="md-ellipsis">
      
        补充：为什么1.8 扩容时不需要重新计算 Hash？⭐️
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-hashmap-hashset" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. HashMap 和 HashSet 的区别
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-hashmap-treemap" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. HashMap 和 TreeMap 的区别
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-treemap" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. TreeMap 的优势⭐️⭐️⭐️
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-hashset" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. HashSet 如何检查重复
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-hashset" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. HashSet 如果元素存在，会覆盖吗？
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-hashmap" class="md-nav__link">
    <span class="md-ellipsis">
      
        8. HashMap 的底层实现⭐️
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="8. HashMap 的底层实现⭐️">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#81-put" class="md-nav__link">
    <span class="md-ellipsis">
      
        8.1 put 方法的底层原理⭐️
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#82-hash" class="md-nav__link">
    <span class="md-ellipsis">
      
        8.2 hash 源码⭐️
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#83" class="md-nav__link">
    <span class="md-ellipsis">
      
        8.3 底层数据结构
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#84" class="md-nav__link">
    <span class="md-ellipsis">
      
        8.4 扩容⭐️
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-hashmap" class="md-nav__link">
    <span class="md-ellipsis">
      
        9. 为什么 HashMap 优先扩容而非直接转为红黑树
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-8-64" class="md-nav__link">
    <span class="md-ellipsis">
      
        10. 为什么选择阈值 8 和 64
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11-hashmap" class="md-nav__link">
    <span class="md-ellipsis">
      
        11. HashMap 多线程操作导致死循环问题
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-hashmap" class="md-nav__link">
    <span class="md-ellipsis">
      
        12 HashMap 为什么线程不安全⭐️
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-hashmap" class="md-nav__link">
    <span class="md-ellipsis">
      
        13. HashMap 的常见遍历方式⭐️
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-coucurrenthashmap" class="md-nav__link">
    <span class="md-ellipsis">
      
        14. CoucurrentHashMap
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-jdk-17-jdk-18-concurrenthashmap" class="md-nav__link">
    <span class="md-ellipsis">
      
        15. JDK 1.7 和 JDK 1.8 的 ConcurrentHashMap 实现有什么不同？
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-node-cas-synchronized" class="md-nav__link">
    <span class="md-ellipsis">
      
        16. node + cas + synchronized
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#17-concurrenthashmap-key-value-null" class="md-nav__link">
    <span class="md-ellipsis">
      
        17. ConcurrentHashMap 为什么 key 和 value 不能为 null？
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#18-colletions" class="md-nav__link">
    <span class="md-ellipsis">
      
        18. Colletions 工具类
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="java">Java 集合</h1>
<h2 id="_1">一、集合概述</h2>
<h4 id="1">1. 集合概述</h4>
<p>Java 集合，也叫作容器，主要是由两大接口派生而来：一个是 <code>Collection</code>接口，主要用于存放单一元素；另一个是 <code>Map</code> 接口，主要用于存放键值对。对于<code>Collection</code> 接口，下面又有三个主要的子接口：<code>List</code>、<code>Set</code> 、 <code>Queue</code>。</p>
<p align='center'>
    <img src="../../assets/imgs/interview/java/java集合/java集合01.png" alt="java集合01" style="zoom:80%;" />
</p>

<h4 id="2-listsetqueuemap">2. List，Set，Queue，Map四者的区别</h4>
<ul>
<li>List：存储的元素是有序的，可重复的，其子类ArrrayList实际上本质就是一个在内存连续的数组，我们可以通过下标在O(1)的时间获取元素，而LinkedList本质就是一个链表，它在需要频繁的增删操作有很大优势。</li>
<li>Set：存储的元素是不可重复的</li>
<li>Queue：按特定的排队规则来确定先后顺序，存储的元素是有序的、可重复的。</li>
<li>Map：存储键值对数据，Key 是不可重复的，而 Value 则无所谓，在查询时主要通过 Key 去直接查到 Value。</li>
</ul>
<h4 id="3">3. 集合框架底层数据结构总结</h4>
<h5 id="31-list">3.1 List</h5>
<ul>
<li><code>ArrayList</code>：<code>Object[]</code> 数组。详细可以查看：<a href="/java/collection/arraylist-source-code.html">ArrayList 源码分析</a>。</li>
<li><code>Vector</code>：<code>Object[]</code> 数组。</li>
<li><code>LinkedList</code>：双向链表(JDK1.6 之前为循环链表，JDK1.7 取消了循环)。详细可以查看：<a href="/java/collection/linkedlist-source-code.html">LinkedList 源码分析</a>。</li>
</ul>
<h5 id="32-set">3.2 Set</h5>
<ul>
<li><code>HashSet</code>(无序，唯一): 基于 <code>HashMap</code> 实现的，底层采用 <code>HashMap</code> 来保存元素。</li>
<li><code>LinkedHashSet</code>: <code>LinkedHashSet</code> 是 <code>HashSet</code> 的子类，并且其内部是通过 <code>LinkedHashMap</code> 来实现的。</li>
<li><code>TreeSet</code>(有序，唯一): 红黑树(自平衡的排序二叉树)。</li>
</ul>
<h5 id="33-queue">3.3 Queue</h5>
<ul>
<li><code>PriorityQueue</code>: <code>Object[]</code> 数组来实现小顶堆。详细可以查看：<a href="/java/collection/priorityqueue-source-code.html">PriorityQueue 源码分析</a>。</li>
<li><code>DelayQueue</code>:<code>PriorityQueue</code>。详细可以查看：<a href="/java/collection/delayqueue-source-code.html">DelayQueue 源码分析</a>。</li>
<li><code>ArrayDeque</code>: 可扩容动态双向数组。</li>
</ul>
<h4 id="34-map">3.4 Map</h4>
<ul>
<li><code>HashMap</code>：JDK1.8 之前 <code>HashMap</code> 由数组+链表组成的，数组是 <code>HashMap</code> 的主体，链表则是主要为了解决哈希冲突而存在的（“拉链法”解决冲突）。JDK1.8 以后在解决哈希冲突时有了较大的变化，当链表长度大于阈值（默认为 8）（将链表转换成红黑树前会判断，如果当前数组的长度小于 64，那么会选择先进行数组扩容（默认0.75），而不是转换为红黑树）时，将链表转化为红黑树，以减少搜索时间。详细可以查看：<a href="/java/collection/hashmap-source-code.html">HashMap 源码分析</a>。</li>
<li><code>LinkedHashMap</code>：<code>LinkedHashMap</code> 通过在普通的 <code>HashMap</code> 基础上，额外维护了一条<strong>双向链表</strong>来实现有序。它继承了 <code>HashMap</code> 的位桶数组+链表/红黑树，但每个节点（Entry）都增加了 <code>before</code> 和 <code>after</code> 两个指针。默认维持的是插入顺序，还支持访问顺序，也就是每当一个元素被get（）或者put（）的时候，它就会被放到双向链表的尾部。</li>
<li><code>Hashtable</code>：数组+链表组成的，数组是 <code>Hashtable</code> 的主体，链表则是主要为了解决哈希冲突而存在的。</li>
<li><code>TreeMap</code>：红黑树（自平衡的排序二叉树）。</li>
</ul>
<h4 id="4">4. 如何选择集合</h4>
<p>选择集合，要更具存储的元素以及需求来权衡，如果不是键值对，就在 collection 下选择，如果查询、修改频繁，我们就去选择 ArrayList，但如果增加、删除频繁，我们就选择 LinkedList，如果不需要排序且元素没有重复存储的需求，我们就去选择HashSet，但如果需要排序，且综合性能要求高，我们就用TreeSet。对于 Map 系列同理，如果我们不需要排序，则考虑 HashMap，需要排序则使用TreeMap，如果只需要维持插入顺序则选择 LinkedHashMap。</p>
<h4 id="5">5. 为什么要使用集合</h4>
<ol>
<li><strong>长度可变（动态扩容）</strong>： 数组在创建时必须指定长度，且不可改变；集合（如 <code>ArrayList</code>）支持<strong>动态扩容</strong>，能根据数据量自动调整空间，避免了空间浪费或溢出。</li>
<li><strong>数据结构多样化</strong>： 集合框架直接封装了<strong>链表、栈、队列、哈希表、红黑树</strong>等复杂算法，开发者无需手写这些逻辑，做到了开箱即用。</li>
<li><strong>功能丰富（高效率）</strong>： 提供了内置的排序、搜索、洗牌（shuffle）等工具类（如 <code>Collections</code>），极大提高了开发效率。</li>
<li><strong>强类型安全</strong>： 配合<strong>泛型</strong>使用，可以在编译期检查数据类型，避免了频繁的类型强制转换带来的 <code>ClassCastException</code>。</li>
</ol>
<h2 id="list">二、List</h2>
<h4 id="1-array-arraylist">1. Array 和 ArrayList</h4>
<p>ArrayList 是动态数组，比起 Array更加灵活
- <code>ArrayList</code>会根据实际存储的元素动态地扩容或缩容，而 <code>Array</code> 被创建之后就不能改变它的长度了。
- <code>ArrayList</code> 允许你使用泛型来确保类型安全，<code>Array</code> 则不可以。
- <code>ArrayList</code> 中只能存储对象。对于基本类型数据，需要使用其对应的包装类（如 Integer、Double 等）。<code>Array</code> 可以直接存储基本类型数据，也可以存储对象。
- <code>ArrayList</code> 支持插入、删除、遍历等常见操作，并且提供了丰富的 API 操作方法，比如 <code>add()</code>、<code>remove()</code>等。<code>Array</code> 只是一个固定长度的数组，只能按照下标访问其中的元素，不具备动态添加、删除元素的能力。
- <code>ArrayList</code>创建时不需要指定大小，而<code>Array</code>创建时必须指定大小。</p>
<h4 id="2-arraylist-vector">2. ArrayList 和 Vector 的区别</h4>
<ul>
<li><code>ArrayList</code> 是 <code>List</code> 的主要实现类，底层使用 <code>Object[]</code>存储，适用于频繁的查找工作，线程不安全 。</li>
<li><code>Vector</code> 是 <code>List</code> 的古老实现类，底层使用<code>Object[]</code> 存储，线程安全。</li>
</ul>
<h4 id="3-arraylist-null">3. ArrayList 可以添加 null 值吗？</h4>
<p><code>ArrayList</code> 中可以存储任何类型的对象，包括 <code>null</code> 值。不过，不建议向<code>ArrayList</code> 中添加 <code>null</code> 值， <code>null</code> 值无意义，会让代码难以维护比如忘记做判空处理就会导致空指针异常。</p>
<h4 id="4-arraylist">4. ArrayList 的插入和删除元素的时间复杂度</h4>
<p>插入：O(n)
最坏情况：头插，需要移动 n 个元素，O(n)
最好情况，在尾部插入，不需要移动任何元素，O(1)
插入指定位置：需要把在该位置之后的所有元素都向后移动一个位置，由于可能在任何位置，所以加权计算后平均移动 n / 2 个元素。</p>
<p>删除同理：O(n)</p>
<p>查询：如果是根据下标查询，那就是O(1)</p>
<p>修改：和查询同理</p>
<h4 id="5-linkedlist">5. LinkedList 插入和删除元素的时间复杂度</h4>
<p>插入 | 删除：O(n)
如果是头插 | 尾插：直接进行指针的操作即可，O（1）
指定位置：需要找到指定位置，平时找 n / 2 次，所以是 O(n)</p>
<p>但由于LinkedList不需要移动元素，所以即使时间复杂度一样，但插入和删除的效率 LinkedList 还是高于 ArrayList 的。</p>
<h4 id="6-linkedlist-randomaccess">6. LinkedList 为什么不能实现 RandomAccess 接口？</h4>
<p><code>RandomAccess</code> 是一个标记接口，用来表明实现该接口的类支持随机访问（即可以通过索引快速访问元素）。由于 <code>LinkedList</code> 底层数据结构是链表，内存地址不连续，只能通过指针来定位，不支持随机快速访问，所以不能实现 <code>RandomAccess</code> 接口。</p>
<h4 id="7-arraylist-linkedlist">7. ArrayList 和 LinkedList 的区别</h4>
<ul>
<li>底层数据结构不同：一个是数组，一个是双向链表</li>
<li>一个支持随机访问，一个不支持随机访问</li>
<li>数据在内存中是连续的，而链表不是连续的。</li>
</ul>
<h4 id="8-randomaccess">8. RandomAccess 接口⭐️</h4>
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">RandomAccess</span><span class="w"> </span><span class="p">{</span><span class="w">  </span>

<span class="p">}</span>
</code></pre></div>
<p>查看源码我们发现实际上 <code>RandomAccess</code> 接口中什么都没有定义。所以，在我看来 <code>RandomAccess</code> 接口不过是一个标识罢了。标识什么？ 标识实现这个接口的类具有随机访问功能。</p>
<p>允许通用算法根据列表是“随机访问”还是“顺序访问”来调整行为，从而提供最佳性能。
在 <code>binarySearch()</code> 方法中，它要判断传入的 list 是否 <code>RandomAccess</code> 的实例，如果是，调用<code>indexedBinarySearch()</code>方法，如果不是，那么调用<code>iteratorBinarySearch()</code>方法</p>
<ul>
<li>在 <strong>ArrayList</strong> 中，<strong>下标访问更快</strong>，因为它省去了迭代器对象的创建和方法调用开销，直接利用数组的内存偏移量寻址。</li>
<li>在 <strong>LinkedList</strong> 中，<strong>迭代器更快</strong>，因为它避免了每次查询都从头开始寻找节点的重复劳动。</li>
</ul>
<h4 id="9-iterator">9. Iterator 本质</h4>
<p>迭代器的本质是<strong>对集合遍历逻辑的封装</strong>。它通过一种“黑盒”方式，让你无需关心底层是数组还是链表。</p>
<ul>
<li><strong>内部状态</strong>：迭代器内部维护了一个<strong>游标（cursor）</strong>。</li>
<li><strong>执行逻辑</strong>：每次调用 <code>next()</code>，它都会根据底层结构的逻辑（数组则是下标自增，链表则是通过 <code>next</code> 指针寻找后继节点）来获取下一个元素。</li>
<li><strong>设计模式</strong>：它是设计模式中“迭代器模式”的典型实现，目的是<strong>解耦</strong>容器的实现与遍历行为。</li>
</ul>
<h4 id="10-arraylist">10. ArrayList 的扩容机制⭐⭐⭐</h4>
<p>详见笔主的这篇文章: <a href="https://javaguide.cn/java/collection/arraylist-source-code.html#arraylist-%E6%89%A9%E5%AE%B9%E6%9C%BA%E5%88%B6%E5%88%86%E6%9E%90">ArrayList 扩容机制分析</a>。</p>
<p>首先是三种初始化方法
 1. 默认构造方式：容量为10，实际上是一个空数组
 2. 指定容量：本质就是创建了一个大小为 initCapacity 的 Object[]
 3. 直接传一个 Collection 实现类，事实就是把这个集合转为 Object[] 数组</p>
<p>扩容实际就是当 size == elementData.length，就会调用 grow方法，grow底层调重载的 grow(int mincacity) 方法，如下：</p>
<p>可以分析：如果是默认初始化方式且是第一次添加原则，则本质就是将elementData扩容为一个长度为10的 Object 数组。如果不是第一次，则会调用 ArraysSupport.newLength 去获取新的数组大小，然后再去产生一个该大小的数组。</p>
<div class="highlight"><pre><span></span><code><span class="kd">private</span><span class="w"> </span><span class="n">Object</span><span class="o">[]</span><span class="w"> </span><span class="nf">grow</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">minCapacity</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  </span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">oldCapacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">elementData</span><span class="p">.</span><span class="na">length</span><span class="p">;</span><span class="w">  </span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">oldCapacity</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">elementData</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">DEFAULTCAPACITY_EMPTY_ELEMENTDATA</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  </span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">newCapacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ArraysSupport</span><span class="p">.</span><span class="na">newLength</span><span class="p">(</span><span class="n">oldCapacity</span><span class="p">,</span><span class="w">  </span>
<span class="w">                </span><span class="n">minCapacity</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">oldCapacity</span><span class="p">,</span><span class="w"> </span><span class="cm">/* minimum growth */</span><span class="w">  </span>
<span class="w">                </span><span class="n">oldCapacity</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w">           </span><span class="cm">/* preferred growth */</span><span class="p">);</span><span class="w">  </span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">elementData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">copyOf</span><span class="p">(</span><span class="n">elementData</span><span class="p">,</span><span class="w"> </span><span class="n">newCapacity</span><span class="p">);</span><span class="w">  </span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">  </span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">elementData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Object</span><span class="o">[</span><span class="n">Math</span><span class="p">.</span><span class="na">max</span><span class="p">(</span><span class="n">DEFAULT_CAPACITY</span><span class="p">,</span><span class="w"> </span><span class="n">minCapacity</span><span class="p">)</span><span class="o">]</span><span class="p">;</span><span class="w">  </span>
<span class="w">    </span><span class="p">}</span><span class="w">  </span>
<span class="p">}</span>
</code></pre></div>
<p><strong>下面是获取新长度的方法源码：</strong></p>
<p>首先，扩容大小是在：0.5倍的旧容量大小和 minGrowth 里选大的那个，一般都会是0.5倍的旧容量大小，也就是扩容1.5倍。</p>
<p>确定了扩容后的大小后，还得判断，如果当前大小已经大于了容器的最大容量，则调用hugeLength，否则直接返回扩容后的大小即可。</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">newLength</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">oldLength</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">minGrowth</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">prefGrowth</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  </span>
<span class="w">    </span><span class="c1">// preconditions not checked because of inlining  </span>
<span class="w">    </span><span class="c1">// assert oldLength &gt;= 0    // assert minGrowth &gt; 0  </span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">prefLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">oldLength</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Math</span><span class="p">.</span><span class="na">max</span><span class="p">(</span><span class="n">minGrowth</span><span class="p">,</span><span class="w"> </span><span class="n">prefGrowth</span><span class="p">);</span><span class="w"> </span><span class="c1">// might overflow  </span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">prefLength</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">prefLength</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">SOFT_MAX_ARRAY_LENGTH</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  </span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">prefLength</span><span class="p">;</span><span class="w">  </span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">  </span>
<span class="w">        </span><span class="c1">// put code cold in a separate method  </span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">hugeLength</span><span class="p">(</span><span class="n">oldLength</span><span class="p">,</span><span class="w"> </span><span class="n">minGrowth</span><span class="p">);</span><span class="w">  </span>
<span class="w">    </span><span class="p">}</span><span class="w">  </span>
<span class="p">}</span>
</code></pre></div>
<p>而 hugeLength 方法则很简单，也就是如果 oldCapacity + minGrowth &gt; 最大容量大小了，则直接抛异常，因为已经存不下了，否则直接返回最大容量。</p>
<p><strong>总结：</strong>
扩容时机：如果是add方法，那么就是在 size == elementData.length 的时候扩容。而如果是 addAll 方法，则在当前元素个数 + 添加的集合的元素个数 &gt; 当前容量的时候扩容 numNew &gt; (elementData = this.elementData).length - (s = size)</p>
<p>扩容方法：grow(int minCapacity)，每次扩容后的大小是：
$$
newCapacity = oldCapacity + max(0.5 * oldCapacity, minGrowth)
$$
如果 <span class="arithmatex">\(newCapacity &lt; 最大容量\)</span> ，则直接返回，否则调用 hugeLength（）方法。</p>
<p>hugeLength（）: oldCapacity + minGrowth
如果 oldCapacity + minGrowth &lt; 最大容量，则直接返回，否则说明此时已经存不下了，抛出异常。</p>
<h4 id="11-fail-fast-fail-safe">11. 集合中的 fail-fast 和 fail-safe 是什么？</h4>
<p><code>fail-fast</code>（快速失败）和 <code>fail-safe</code>（安全失败）是Java集合框架在处理并发修改问题时，两种截然不同的设计哲学和容错策略。</p>
<h5 id="1-fail-fast">1. fail-fast</h5>
<pre><code>fail-fast 的思想即针对可能发生的异常进行提前表明故障并停止运行，通过尽早的发现和停止错误，降低故障系统级联的风险。fail-fast 机制通过维护一个变量 modCount，从而能够在遍历过程中提前的发现非法修改并立刻抛出异常，防止程序在错误的状态下继续运行。

原理：每次迭代之前，都会把当前的 modCount 赋给 expectedModCount，在迭代过程中，每次调用 `next()` 或 `remove()`，迭代器都会检查：`if (modCount != expectedModCount)`。如果不相同，就说明在迭代过程中有其他线程修改了当前集合，直接抛出异常：ConcurrentModificationException
</code></pre>
<h5 id="2-fail-safe">2. fail-safe</h5>
<p><strong>核心思想</strong>：迭代时不是直接在原集合上遍历，而是基于原集合的<strong>快照（Snapshot）</strong>，因此不受并发修改的影响。</p>
<p><strong>实现原理</strong>：以 <code>CopyOnWriteArrayList</code> 为例，当发生写操作时，它会复制出一个新数组进行修改，修改完成后再将引用指向新数组。迭代器读取的是旧数组的快照。</p>
<p><strong>代表容器</strong>：<code>CopyOnWriteArrayList</code>、<code>ConcurrentHashMap</code>（1.8后采用弱一致性迭代器）。</p>
<table>
<thead>
<tr>
<th><strong>特性</strong></th>
<th><strong>Fail-Fast</strong></th>
<th><strong>Fail-Safe</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>异常抛出</strong></td>
<td>抛出 <code>ConcurrentModificationException</code></td>
<td>不抛出异常</td>
</tr>
<tr>
<td><strong>原理</strong></td>
<td>检测 <code>modCount</code> 计数器</td>
<td>复制快照 (Copy-on-Write)</td>
</tr>
<tr>
<td><strong>性能</strong></td>
<td>高（无需复制）</td>
<td>较低（复制数组耗时耗空间）</td>
</tr>
<tr>
<td><strong>数据一致性</strong></td>
<td>强一致性（虽抛异常但数据没乱）</td>
<td><strong>弱一致性</strong>（可能读到旧数据）</td>
</tr>
</tbody>
</table>
<h2 id="set">三、Set</h2>
<h4 id="1-comparable-comparator">1. Comparable 和 Comparator 的区别</h4>
<p><code>Comparable</code> 接口和 <code>Comparator</code> 接口都是 Java 中用于排序的接口，
- <code>Comparable</code> 接口实际上是出自<code>java.lang</code>包 它有一个 <code>compareTo(Object obj)</code>方法用来排序
- <code>Comparator</code>接口实际上是出自 <code>java.util</code> 包它有一个<code>compare(Object obj1, Object obj2)</code>方法用来排序</p>
<p>Comparable 是“内部定义”，由类自身实现 <code>compareTo</code> 方法，确定默认的排序规则；而 Comparator 是“外部策略”，通过创建一个独立的比较器传入排序方法，无需修改原类代码即可实现多种灵活的排序需求。</p>
<h4 id="2">2. 无序性和不可重复性的含义是什么</h4>
<ul>
<li><strong>无序性</strong> 指<strong>存储顺序不等于添加顺序</strong>。 数据在底层并不是按照你 <code>add()</code> 的先后顺序依次排列的。以 <code>HashSet</code> 为例，它根据元素的 <strong>Hash 值</strong>计算存储位置，所以你遍历出的顺序通常与你存入的顺序不一致。</li>
<li><strong>不可重复性</strong> 指<strong>同一个集合中不能包含两个“相等”的元素</strong>。 这种相等是通过 <code>equals()</code> 方法和 <code>hashCode()</code> 方法共同判定的。当你尝试存入重复元素时，新元素会覆盖旧元素或直接被拒绝存入，从而保证集合内元素的<strong>唯一性</strong>。</li>
</ul>
<h4 id="3-hashsetlinkedhashset-treeset">3. 比较 HashSet、LinkedHashSet 和 TreeSet 三者的异同</h4>
<p><strong>相同点</strong>： 三者均实现 <code>Set</code> 接口，具备<strong>元素唯一性</strong>，且都是<strong>线程不安全</strong>的。</p>
<p><strong>不同点（核心差异点）</strong>：</p>
<ol>
<li><strong>HashSet (最常用)</strong>：底层是 <strong>HashMap</strong>。它不保证任何顺序，性能最高，适用于只需要去重、不关心顺序的场景。</li>
<li><strong>LinkedHashSet (有序去重)</strong>：它是 <code>HashSet</code> 的子类，底层是 <strong>HashMap + 双向链表</strong>。它通过链表维护了<strong>插入顺序</strong>，适用于需要去重但又希望按插入先后顺序遍历的场景。</li>
<li>
<p><strong>TreeSet (排序去重)</strong>：底层是 <strong>红黑树 (TreeMap)</strong>。它能确保元素处于<strong>排序状态</strong>（自然排序或自定义 <code>Comparator</code>），适用于需要按大小、字母等特定规则排序的场景。</p>
</li>
<li>
<p><strong>性能对比</strong>：<code>HashSet</code> 性能 &gt; <code>LinkedHashSet</code> &gt; <code>TreeSet</code>（因为树的维护成本高）。</p>
</li>
<li><strong>Null 值</strong>：<code>HashSet</code> 和 <code>LinkedHashSet</code> 允许一个 <code>null</code>；而 <code>TreeSet</code> 如果使用自然排序，<strong>不允许存入 <code>null</code></strong>（会抛出 <code>NullPointerException</code>，因为要进行比较）。</li>
</ol>
<h2 id="qqeue">四、Qqeue</h2>
<h4 id="1-queue-deque">1. Queue 和 Deque 的区别</h4>
<p>queue：单端队列，对头出，队尾入，遵守 FIFO 原则，
deque：双端队列，队首队尾都允许插入元素以及出队。</p>
<h4 id="2-arraydeque-linkedlist">2. ArrayDeque 和 LinkedList 的区别</h4>
<p><code>ArrayDeque</code> 和 <code>LinkedList</code> 都实现了 <code>Deque</code> 接口，两者都具有队列的功能，但两者有什么区别呢？</p>
<ul>
<li><code>ArrayDeque</code> 是基于可变长的数组和双指针来实现，而 <code>LinkedList</code> 则通过链表来实现。</li>
<li><code>ArrayDeque</code> 不支持存储 <code>NULL</code> 数据，但 <code>LinkedList</code> 支持。</li>
<li><code>ArrayDeque</code> 是在 JDK1.6 才被引入的，而<code>LinkedList</code> 早在 JDK1.2 时就已经存在。</li>
<li><code>ArrayDeque</code> 插入时可能存在扩容过程, 不过均摊后的插入操作依然为 O(1)。虽然 <code>LinkedList</code> 不需要扩容，但是每次插入数据时均需要申请新的堆空间，均摊性能相比更慢。</li>
</ul>
<p>从性能的角度上，选用 <code>ArrayDeque</code> 来实现队列要比 <code>LinkedList</code> 更好。此外，<code>ArrayDeque</code> 也可以用于实现栈。</p>
<h4 id="3-priorityqueue">3. PriorityQueue</h4>
<p><code>PriorityQueue</code> 是在 JDK1.5 中被引入的, 其与 <code>Queue</code> 的区别在于元素出队顺序是与优先级相关的，即总是优先级最高的元素先出队。</p>
<p>这里列举其相关的一些要点：</p>
<ul>
<li><code>PriorityQueue</code> 利用了二叉堆的数据结构来实现的，底层使用可变长的数组来存储数据</li>
<li><code>PriorityQueue</code> 通过堆元素的上浮和下沉，实现了在 O(logn) 的时间复杂度内插入元素和删除堆顶元素。</li>
<li><code>PriorityQueue</code> 是非线程安全的，且不支持存储 <code>NULL</code> 和 <code>non-comparable</code> 的对象。</li>
<li><code>PriorityQueue</code> 默认是小顶堆，但可以接收一个 <code>Comparator</code> 作为构造参数，从而来自定义元素优先级的先后。</li>
</ul>
<h4 id="4-blockingqueue">4. BlockingQueue</h4>
<p><code>BlockingQueue</code> （阻塞队列）是一个接口，继承自 <code>Queue</code>。<code>BlockingQueue</code>阻塞的原因是其支持当队列没有元素时一直阻塞，直到有元素；还支持如果队列已满，一直等到队列可以放入新元素时再放入。</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">BlockingQueue</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Queue</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span><span class="w"> </span>
<span class="p">{</span><span class="w"> </span>
<span class="w">    </span><span class="c1">// ... </span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li><strong>抛出异常</strong>：<code>add(e)</code>, <code>remove()</code>（队列满/空时报错）</li>
<li><strong>返回特殊值</strong>：<code>offer(e)</code>, <code>poll()</code>（队列满/空时返回 false/null）</li>
<li><strong>一直阻塞</strong>：<strong><code>put(e)</code></strong>, <strong><code>take()</code></strong>（<strong>这是最常用的阻塞核心方法</strong>）</li>
<li><strong>超时退出</strong>：<code>offer(e, time, unit)</code>, <code>poll(time, unit)</code>（等一会儿，不等了就走）</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">InterruptedException</span><span class="w"> </span><span class="p">{</span><span class="w">  </span>
<span class="w">    </span><span class="n">ArrayBlockingQueue</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="n">arrayBlockingQueue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayBlockingQueue</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span><span class="w">  </span>
<span class="w">    </span><span class="c1">// 消费者线程  </span>
<span class="w">    </span><span class="n">Thread</span><span class="w"> </span><span class="n">consumer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">  </span>
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="kc">true</span><span class="p">){</span><span class="w">  </span>
<span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">  </span>
<span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">arrayBlockingQueue</span><span class="p">.</span><span class="na">take</span><span class="p">());</span><span class="w">  </span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  </span>
<span class="w">                </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">  </span>
<span class="w">            </span><span class="p">}</span><span class="w">  </span>
<span class="w">        </span><span class="p">}</span><span class="w">  </span>
<span class="w">    </span><span class="p">});</span><span class="w">  </span>

<span class="w">    </span><span class="n">consumer</span><span class="p">.</span><span class="na">start</span><span class="p">();</span><span class="w">  </span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="w">  </span>
<span class="w">        </span><span class="n">arrayBlockingQueue</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w">  </span>
<span class="w">    </span><span class="p">}</span><span class="w">  </span>
<span class="w">    </span><span class="n">arrayBlockingQueue</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="mi">11</span><span class="p">);</span><span class="w">  </span>
<span class="p">}</span>
</code></pre></div>
<h4 id="5-blockingqueue">5. BlockingQueue 有哪些实现类</h4>
<p align='center'>
    <img src="../../assets/imgs/interview/java/java集合/java集合02.png" alt="java集合02" style="zoom:80%;" />
</p>

<ul>
<li><code>ArrayBlockingQueue</code>：使用数组实现的有界阻塞队列。在创建时需要指定容量大小，并支持公平和非公平两种方式的锁访问机制。</li>
<li><code>LinkedBlockingQueue</code>：使用单向链表实现的可选有界阻塞队列。在创建时可以指定容量大小，如果不指定则默认为<code>Integer.MAX_VALUE</code>。和<code>ArrayBlockingQueue</code>不同的是， 它仅支持非公平的锁访问机制。</li>
<li><code>PriorityBlockingQueue</code>：支持优先级排序的无界阻塞队列。元素必须实现<code>Comparable</code>接口或者在构造函数中传入<code>Comparator</code>对象，并且不能插入 null 元素。</li>
<li><code>SynchronousQueue</code>：同步队列，是一种不存储元素的阻塞队列。每个插入操作都必须等待对应的删除操作，反之删除操作也必须等待插入操作。因此，<code>SynchronousQueue</code>通常用于线程之间的直接传递数据。</li>
<li><code>DelayQueue</code>：延迟队列，其中的元素只有到了其指定的延迟时间，才能够从队列中出队。</li>
</ul>
<table>
<thead>
<tr>
<th><strong>实现类</strong></th>
<th><strong>内部结构</strong></th>
<th><strong>是否有界</strong></th>
<th><strong>线程安全策略</strong></th>
<th><strong>特色场景</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ArrayBlockingQueue</strong></td>
<td>数组</td>
<td><strong>强制有界</strong></td>
<td>单锁（生产消费竞争同一把锁）</td>
<td>内存占用低，适用于负载稳定的场景</td>
</tr>
<tr>
<td><strong>LinkedBlockingQueue</strong></td>
<td>链表</td>
<td>可选有界</td>
<td><strong>双锁</strong>（生产消费分离，并发度更高）</td>
<td>吞吐量高于 Array，ExecutorService 默认常用</td>
</tr>
<tr>
<td><strong>PriorityBlockingQueue</strong></td>
<td>二叉堆</td>
<td>无界</td>
<td>单锁</td>
<td>需要按优先级处理任务（如 VIP 优先）</td>
</tr>
<tr>
<td><strong>DelayQueue</strong></td>
<td>堆</td>
<td>无界</td>
<td>单锁</td>
<td>缓存失效、定时任务调度</td>
</tr>
<tr>
<td><strong>SynchronousQueue</strong></td>
<td>无</td>
<td><strong>零容量</strong></td>
<td>CAS / 信号量</td>
<td>线程池 <code>CachedThreadPool</code> 的核心实现</td>
</tr>
<tr>
<td><strong>LinkedTransferQueue</strong></td>
<td>链表</td>
<td>无界</td>
<td>CAS</td>
<td>高性能数据交换</td>
</tr>
</tbody>
</table>
<h4 id="6-blockingqueue">6. BlockingQueue 有什么作用</h4>
<p>简单来说，<code>BlockingQueue</code> 是为了解决生产者与消费者之间步调不一致**的问题。</p>
<p>如果没有 <code>BlockingQueue</code>，生产者可能会把内存撑爆，或者消费者在没东西处理时一直循环消耗 CPU。<code>BlockingQueue</code> 通过阻塞自动平衡了这两者的速度：</p>
<ul>
<li><strong>队列满了</strong>：生产者尝试放入元素时会被<strong>挂起（休息）</strong>，直到消费者取走一个。</li>
<li><strong>队列空了</strong>：消费者尝试取元素时会被<strong>挂起（休息）</strong>，直到生产者放入一个。</li>
</ul>
<h5 id="a">A. 线程池（最经典的应用）</h5>
<p>Java 的 <code>ThreadPoolExecutor</code> 核心就是 <code>BlockingQueue</code>。</p>
<ul>
<li>当你提交的任务超过了核心线程数，任务就会被放入阻塞队列。</li>
<li>工作线程执行完任务后，会去队列里 <code>take()</code> 任务。如果队列空了，工作线程就地阻塞，等待新任务到来，而不是白白消耗 CPU。</li>
</ul>
<h5 id="b-decoupling">B. 解耦（Decoupling）</h5>
<p>生产者不需要知道消费者的存在。生产者只管往队列里扔东西，消费者只管从队列里拿。哪怕消费者宕机了，数据也会先存在队列里（如果是持久化或足够大的话）。</p>
<h5 id="c">C. 流量削峰</h5>
<p>当瞬间涌入大量请求时，队列可以起到缓冲池的作用。请求先排队，系统按照自己的节奏慢慢处理，防止后端服务被瞬间的高并发冲垮。</p>
<h4 id="7-array">7. Array</h4>
<p><code>ArrayBlockingQueue</code> 和 <code>LinkedBlockingQueue</code> 是 Java 并发包中常用的两种阻塞队列实现，它们都是线程安全的。不过，不过它们之间也存在下面这些区别：</p>
<ul>
<li>底层实现：<code>ArrayBlockingQueue</code> 基于数组实现，而 <code>LinkedBlockingQueue</code> 基于链表实现。</li>
<li>是否有界：<code>ArrayBlockingQueue</code> 是有界队列，必须在创建时指定容量大小。<code>LinkedBlockingQueue</code> 创建时可以不指定容量大小，默认是<code>Integer.MAX_VALUE</code>，也就是无界的。但也可以指定队列大小，从而成为有界的。</li>
<li>锁是否分离： <code>ArrayBlockingQueue</code>中的锁是没有分离的，即生产和消费用的是同一个锁；<code>LinkedBlockingQueue</code>中的锁是分离的，即生产用的是<code>putLock</code>，消费是<code>takeLock</code>，这样可以防止生产者和消费者线程之间的锁争夺。</li>
<li>内存占用：<code>ArrayBlockingQueue</code> 需要提前分配数组内存，而 <code>LinkedBlockingQueue</code> 则是动态分配链表节点内存。这意味着，<code>ArrayBlockingQueue</code> 在创建时就会占用一定的内存空间，且往往申请的内存比实际所用的内存更大，而<code>LinkedBlockingQueue</code> 则是根据元素的增加而逐渐占用内存空间。</li>
</ul>
<h2 id="map">五、Map</h2>
<h4 id="1-hashmap-hashtable">1. HashMap 和 HashTable 的区别</h4>
<ul>
<li>Hashmap 线程不安全，而 HashTable 线程安全</li>
<li>Hashmap 支持 null 作为键，而 HashTable 不支持 null 作为键，也不支持 null 作为值</li>
<li>初始容量个每次扩容的大小不同：① 创建时如果不指定容量初始值，<code>Hashtable</code> 默认的初始大小为 11，之后每次扩充，容量变为原来的 2n+1。<code>HashMap</code> 默认的初始化大小为 16。之后每次扩充，容量变为原来的 2 倍。② 创建时如果给定了容量初始值，那么 <code>Hashtable</code> 会直接使用你给定的大小，而 <code>HashMap</code> 会将其扩充为 2 的幂次方大小（<code>HashMap</code> 中的<code>tableSizeFor()</code>方法保证，下面给出了源代码）。也就是说 <code>HashMap</code> 总是使用 2 的幂作为哈希表的大小,后面会介绍到为什么是 2 的幂次方。</li>
<li>底层数据有区别：数据 + 链表 + 红黑树</li>
<li>哈希函数的实现：<code>HashMap</code> 对哈希值进行了高位和低位的混合扰动处理以减少冲突，而 <code>Hashtable</code> 直接使用键的 <code>hashCode()</code> 值。</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">HashMap</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">initialCapacity</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">loadFactor</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">initialCapacity</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;Illegal initial capacity: &quot;</span><span class="w"> </span><span class="o">+</span>
<span class="w">                                               </span><span class="n">initialCapacity</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">initialCapacity</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">MAXIMUM_CAPACITY</span><span class="p">)</span>
<span class="w">            </span><span class="n">initialCapacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MAXIMUM_CAPACITY</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">loadFactor</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">Float</span><span class="p">.</span><span class="na">isNaN</span><span class="p">(</span><span class="n">loadFactor</span><span class="p">))</span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;Illegal load factor: &quot;</span><span class="w"> </span><span class="o">+</span>
<span class="w">                                               </span><span class="n">loadFactor</span><span class="p">);</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">loadFactor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loadFactor</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tableSizeFor</span><span class="p">(</span><span class="n">initialCapacity</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">     </span><span class="kd">public</span><span class="w"> </span><span class="nf">HashMap</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">initialCapacity</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">(</span><span class="n">initialCapacity</span><span class="p">,</span><span class="w"> </span><span class="n">DEFAULT_LOAD_FACTOR</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>
<p>这段代码是 <code>HashMap</code> 源码中非常经典的一个位运算算法。它的核心作用是：<strong>给定任意一个正整数 <code>cap</code>，寻找大于或等于 <code>cap</code> 的最小的 2 的幂次（Power of Two）。</strong></p>
<div class="highlight"><pre><span></span><code>/**
 * Returns a power of two size for the given target capacity.
 */
static final int tableSizeFor(int cap) {
    // 1. 减1：处理 cap 已经是 2 的幂的情况
    int n = cap - 1;

    // 2. 下面这些操作是将最高位 1 之后的低位全部涂黑（变成 1）
    n |= n &gt;&gt;&gt; 1;  // 保证有 2 个连续的 1
    n |= n &gt;&gt;&gt; 2;  // 保证有 4 个连续的 1
    n |= n &gt;&gt;&gt; 4;  // 保证有 8 个连续的 1
    n |= n &gt;&gt;&gt; 8;  // 保证有 16 个连续的 1
    n |= n &gt;&gt;&gt; 16; // 保证有 32 个连续的 1

    // 3. 最后 n 变成了一个形如 00...0111...1 的数
    // 4. 返回时加 1，它就变成了 100...000，即最小的 2 的幂
    return (n &lt; 0) ? 1 : (n &gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + 1;
}
</code></pre></div>
<h4 id="2-haspmap-2n">2. 为什么 haspMap 底层数据必须是 <span class="arithmatex">\(2^n\)</span> 呢⭐️⭐️⭐️</h4>
<p><code>HashMap</code> 的底层数组长度必须是 <span class="arithmatex">\(2^n\)</span>。这样在计算下标时，可以使用位运算 <code>(n - 1) &amp; hash</code> 来代替取模运算 <code>%</code>，从而极大地提高性能。</p>
<p>在计算机底层，<strong>取模运算（%）</strong> 是一个非常昂贵的操作，它涉及到除法。而<strong>按位与运算（&amp;）</strong> 只需要直接操作二进制位，速度比取模快了好几倍。</p>
<p>当你用一个 <code>hash</code> 值去 <code>&amp; (n - 1)</code> 时，由于 <code>n-1</code> 的高位全是 0，低位全是 1，这个操作的效果就是：<strong>只保留 <code>hash</code> 值的低位，抹掉高位。</strong> 这和取模的结果在数学上是完全一致的。
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  </span>
<span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="mi">90</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">16</span><span class="p">);</span><span class="w">  </span>
<span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="mi">90</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="mi">16</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span><span class="w">  </span>
<span class="p">}</span>
</code></pre></div></p>
<ul>
<li>位运算效率更高：位运算(&amp;)比取余运算(%)更高效。当长度为 2 的幂次方时，<code>hash % length</code> 等价于 <code>hash &amp; (length - 1)</code>。</li>
<li>可以更好地保证哈希值的均匀分布：扩容之后，在旧数组元素 hash 值比较均匀的情况下，新数组元素也会被分配的比较均匀，最好的情况是会有一半在新数组的前半部分，一半在新数组后半部分。</li>
<li>扩容机制变得简单和高效：扩容后只需检查哈希值高位的变化来决定元素的新位置，要么位置不变（高位为 0），要么就是移动到新位置（高位为 1，原索引位置+原容量）。</li>
</ul>
<h4 id="18-hash">补充：为什么<strong>1.8 扩容时不需要重新计算 Hash？</strong>⭐️</h4>
<p>因为 hashmap 的扩容实际就是容量加倍，而又因为容量是 <span class="arithmatex">\(2^n\)</span>， 因此新的桶下表只看原来的hash值在新增的那一个高位是不是1，不是1，则位置不变，是1，则新下表为原来的位置 + 扩容前的数组长度）</p>
<div class="highlight"><pre><span></span><code><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="n">扩容后</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">32</span>
<span class="n">那么</span><span class="err">，</span><span class="n">新下标就是看hash值的第五位是1还是0</span><span class="err">，</span><span class="n">是1</span><span class="err">，</span><span class="n">则新下标就是</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">旧下表</span><span class="err">，</span><span class="n">是0</span><span class="err">，</span><span class="n">则下标不变</span><span class="err">。</span>
</code></pre></div>
<h4 id="3-hashmap-hashset">3. HashMap 和 HashSet 的区别</h4>
<p>如果你看过 <code>HashSet</code> 源码的话就应该知道：<code>HashSet</code> 底层就是基于 <code>HashMap</code> 实现的。（<code>HashSet</code> 的源码非常非常少，因为除了 <code>clone()</code>、<code>writeObject()</code>、<code>readObject()</code>是 <code>HashSet</code> 自己不得不实现之外，其他方法都是直接调用 <code>HashMap</code> 中的方法。</p>
<h4 id="4-hashmap-treemap">4. HashMap 和 TreeMap 的区别</h4>
<p><code>TreeMap</code> 和<code>HashMap</code> 都继承自<code>AbstractMap</code> ，但是需要注意的是<code>TreeMap</code>它还实现了<code>NavigableMap</code>接口和<code>SortedMap</code> 接口。</p>
<p align='center'>
    <img src="../../assets/imgs/interview/java/java集合/java集合03.png" alt="java集合03" style="zoom:80%;" />
</p>

<table>
<thead>
<tr>
<th><strong>特性</strong></th>
<th><strong>HashMap</strong></th>
<th><strong>TreeMap</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>底层数据结构</strong></td>
<td><strong>哈希表</strong>（数组 + 链表 + 红黑树）</td>
<td><strong>红黑树</strong>（自平衡二叉搜索树）</td>
</tr>
<tr>
<td><strong>元素顺序</strong></td>
<td><strong>无序</strong>（插入顺序和遍历顺序不一致）</td>
<td><strong>有序</strong>（默认按 Key 的升序排列）</td>
</tr>
<tr>
<td><strong>性能 (平均时间复杂度)</strong></td>
<td>插入、查询、删除均为 <strong><span class="arithmatex">\(O(1)\)</span></strong></td>
<td>插入、查询、删除均为 <strong><span class="arithmatex">\(O(\log n)\)</span></strong></td>
</tr>
<tr>
<td><strong>接口实现</strong></td>
<td>继承 <code>AbstractMap</code></td>
<td>继承 <code>AbstractMap</code>，多实现了 <code>NavigableMap</code> 和 <code>SortedMap</code></td>
</tr>
<tr>
<td><strong>Null 值支持</strong></td>
<td>允许 <strong>1 个 null 键</strong>，多个 null 值</td>
<td><strong>不允许 null 键</strong>（因为要比较大小），允许 null 值</td>
</tr>
</tbody>
</table>
<p>“HashMap 底层基于哈希表实现，主打高性能，其插入和查询的平均复杂度为 <span class="arithmatex">\(O(1)\)</span>，但它是无序的；而 TreeMap 底层基于红黑树实现，虽然 <span class="arithmatex">\(O(\log n)\)</span> 的性能略逊一筹，但它实现了 <code>NavigableMap</code> 接口，能够根据键（Key）的自然顺序或自定义比较器进行排序，并支持高效的范围查找和边界搜索。”</p>
<h4 id="5-treemap">5. TreeMap 的优势⭐️⭐️⭐️</h4>
<ul>
<li><strong>定向搜索</strong>: <code>ceilingEntry()</code>, <code>floorEntry()</code>, <code>higherEntry()</code>和 <code>lowerEntry()</code> 等方法可以用于定位大于等于、小于等于、严格大于、严格小于给定键的最接近的键值对。</li>
<li><strong>子集操作</strong>: <code>subMap()</code>, <code>headMap()</code>和 <code>tailMap()</code> 方法可以高效地创建原集合的子集视图，而无需复制整个集合。</li>
<li><strong>逆序视图</strong>:<code>descendingMap()</code> 方法返回一个逆序的 <code>NavigableMap</code> 视图，使得可以反向迭代整个 <code>TreeMap</code>。</li>
<li><strong>边界操作</strong>: <code>firstEntry()</code>, <code>lastEntry()</code>, <code>pollFirstEntry()</code>和 <code>pollLastEntry()</code> 等方法可以方便地访问和移除元素。</li>
</ul>
<h4 id="6-hashset">6.  HashSet 如何检查重复</h4>
<p>“HashSet 通过计算对象的 <code>hashCode</code> 定位数组下标。如果位置冲突，先比对 <code>hashCode</code> 是否一致，若一致再调用 <code>equals()</code> 做最终确认。这种双重检查机制极大地提高了查找效率，将检查重复的时间复杂度从 <span class="arithmatex">\(O(n)\)</span> 降到了平均 <span class="arithmatex">\(O(1)\)</span>。”</p>
<h4 id="7-hashset">7. HashSet 如果元素存在，会覆盖吗？</h4>
<p>“对于 <code>HashSet</code> 来说，如果添加重复元素，<code>add</code> 方法会返回 <code>false</code>，且<strong>底层的 Key（即对象本身）不会被覆盖</strong>，依然保留第一次添加时的那个对象；虽然底层 <code>HashMap</code> 会覆盖对应的 Value，但由于 <code>HashSet</code> 的所有 Value 都是同一个静态常量 <code>PRESENT</code>，所以覆盖了也没有实质影响。”</p>
<h4 id="8-hashmap">8. HashMap 的底层实现⭐️</h4>
<p>JDK1.8 之前 <code>HashMap</code> 底层是 <strong>数组和链表</strong> 结合在一起使用也就是 <strong>链表散列</strong>。HashMap 通过 key 的 <code>hashcode</code> 经过扰动函数处理过后得到 hash 值，然后通过 <code>(n - 1) &amp; hash</code> 判断当前元素存放的位置（这里的 n 指的是数组的长度），如果当前位置存在元素的话，就判断该元素与要存入的元素的 hash 值以及 key 是否相同，如果相同的话，直接覆盖，不相同就通过拉链法解决冲突。</p>
<h5 id="81-put">8.1 put 方法的底层原理⭐️</h5>
<ul>
<li><strong>算 Hash</strong> 找下标。</li>
<li><strong>没冲突</strong> 直接塞。</li>
<li><strong>有冲突</strong> 看 Key。</li>
<li><strong>是树</strong> 走树逻辑，<strong>是链表</strong> 遍历找位置。</li>
<li><strong>链表过长</strong> 转红黑树。</li>
<li><strong>Key 重复</strong> 换 Value。</li>
<li><strong>塞完</strong> 检查要不要扩容。</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">final</span><span class="w"> </span><span class="n">V</span><span class="w"> </span><span class="nf">putVal</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">hash</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">onlyIfAbsent</span><span class="p">,</span><span class="w">  </span>
<span class="w">               </span><span class="kt">boolean</span><span class="w"> </span><span class="n">evict</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  </span>
<span class="w">    </span><span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="n">V</span><span class="o">&gt;[]</span><span class="w"> </span><span class="n">tab</span><span class="p">;</span><span class="w"> </span><span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="n">V</span><span class="o">&gt;</span><span class="w"> </span><span class="n">p</span><span class="p">;</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w">  </span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">tab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">table</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tab</span><span class="p">.</span><span class="na">length</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">  </span>
<span class="w">        </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">tab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resize</span><span class="p">()).</span><span class="na">length</span><span class="p">;</span><span class="w">  </span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tab</span><span class="o">[</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">hash</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w">  </span>
<span class="w">        </span><span class="n">tab</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newNode</span><span class="p">(</span><span class="n">hash</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span><span class="w">  </span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">  </span>
<span class="w">        </span><span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="n">V</span><span class="o">&gt;</span><span class="w"> </span><span class="n">e</span><span class="p">;</span><span class="w"> </span><span class="n">K</span><span class="w"> </span><span class="n">k</span><span class="p">;</span><span class="w">  </span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="na">hash</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">hash</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">  </span>
<span class="w">            </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="na">key</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">key</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">k</span><span class="p">))))</span><span class="w">  </span>
<span class="w">            </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">;</span><span class="w">  </span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">TreeNode</span><span class="p">)</span><span class="w">  </span>
<span class="w">            </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">TreeNode</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="n">V</span><span class="o">&gt;</span><span class="p">)</span><span class="n">p</span><span class="p">).</span><span class="na">putTreeVal</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">tab</span><span class="p">,</span><span class="w"> </span><span class="n">hash</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">);</span><span class="w">  </span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">  </span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">binCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">binCount</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  </span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="na">next</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  </span>
<span class="w">                    </span><span class="n">p</span><span class="p">.</span><span class="na">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newNode</span><span class="p">(</span><span class="n">hash</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span><span class="w">  </span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">binCount</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">TREEIFY_THRESHOLD</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="c1">// -1 for 1st  </span>
<span class="w">                        </span><span class="n">treeifyBin</span><span class="p">(</span><span class="n">tab</span><span class="p">,</span><span class="w"> </span><span class="n">hash</span><span class="p">);</span><span class="w">  </span>
<span class="w">                    </span><span class="k">break</span><span class="p">;</span><span class="w">  </span>
<span class="w">                </span><span class="p">}</span><span class="w">  </span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="na">hash</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">hash</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">  </span>
<span class="w">                    </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">key</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">key</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">k</span><span class="p">))))</span><span class="w">  </span>
<span class="w">                    </span><span class="k">break</span><span class="p">;</span><span class="w">  </span>
<span class="w">                </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">;</span><span class="w">  </span>
<span class="w">            </span><span class="p">}</span><span class="w">  </span>
<span class="w">        </span><span class="p">}</span><span class="w">  </span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// existing mapping for key  </span>
<span class="w">            </span><span class="n">V</span><span class="w"> </span><span class="n">oldValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">value</span><span class="p">;</span><span class="w">  </span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">onlyIfAbsent</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">oldValue</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w">  </span>
<span class="w">                </span><span class="n">e</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">;</span><span class="w">  </span>
<span class="w">            </span><span class="n">afterNodeAccess</span><span class="p">(</span><span class="n">e</span><span class="p">);</span><span class="w">  </span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">oldValue</span><span class="p">;</span><span class="w">  </span>
<span class="w">        </span><span class="p">}</span><span class="w">  </span>
<span class="w">    </span><span class="p">}</span><span class="w">  </span>
<span class="w">    </span><span class="o">++</span><span class="n">modCount</span><span class="p">;</span><span class="w">  </span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">++</span><span class="n">size</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">threshold</span><span class="p">)</span><span class="w">  </span>
<span class="w">        </span><span class="n">resize</span><span class="p">();</span><span class="w">  </span>
<span class="w">    </span><span class="n">afterNodeInsertion</span><span class="p">(</span><span class="n">evict</span><span class="p">);</span><span class="w">  </span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w">  </span>
<span class="p">}</span>
</code></pre></div>
<h5 id="82-hash">8.2  hash 源码⭐️</h5>
<p>jkd 1.8 之后 的 hash方法：“扰动函数”的作用就是：把高 16 位的特征，“混合”到低 16 位中。因为：<code>HashMap</code> 的初始容量通常很小（比如 16），那么 <code>n - 1</code> 就是 15（二进制：<code>0000...1111</code>）。当进行 <code>&amp;</code> 运算时，<strong>只有哈希值的最后 4 位参与了运算</strong>。<strong>问题来了</strong>：如果有很多 Key 的 <code>hashCode</code> 虽然不同，但如果它们<strong>仅仅是高位不同，低位全部相同</strong>，那么它们计算出的数组下标就会完全一样，导致严重的哈希冲突。</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">hash</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kt">int</span><span class="w"> </span><span class="n">h</span><span class="p">;</span>
<span class="w">      </span><span class="c1">// key.hashCode()：返回散列值也就是hashcode</span>
<span class="w">      </span><span class="c1">// ^：按位异或</span>
<span class="w">      </span><span class="c1">// &gt;&gt;&gt;:无符号右移，忽略符号位，空位都以0补齐</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">key</span><span class="p">.</span><span class="na">hashCode</span><span class="p">())</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">h</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">16</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
</code></pre></div>
<p>“JDK 1.8 的 <code>hash</code> 方法通过 <code>(h ^ h &gt;&gt;&gt; 16)</code> 将哈希值的高 16 位与低 16 位进行异或运算。这样做是为了在数组长度较小时，让高位信息也能参与到下标寻址的运算中。这大大降低了哈希碰撞的概率，使得数据在散列表中分布得更加均匀，从而维持了 <code>HashMap</code> 接近 <span class="arithmatex">\(O(1)\)</span> 的查找性能。”</p>
<h5 id="83">8.3 底层数据结构</h5>
<p>JDK 1.8 之前：就是一个简单的 数组+ 链表的结构。但是，如果哈希冲突严重，链表可能会比较长，极端情况下查询效率会退化为 O(n)</p>
<p>JDK 1.8 之后，为了解决这个问题，底层数据结构变为了数组 + 链表 + 红黑树的结构。相比于之前的版本， JDK1.8 之后在解决哈希冲突时有了较大的变化，当链表长度大于阈值（默认为 8）（将链表转换成红黑树前会判断，如果当前数组的长度小于 64，那么会选择先进行数组扩容，而不是转换为红黑树）时，将链表转化为红黑树。</p>
<p>这样做的目的是减少搜索时间：链表的查询效率为 O(n)（n 是链表的长度），红黑树是一种自平衡二叉搜索树，其查询效率为 O(log n)。当链表较短时，O(n) 和 O(log n) 的性能差异不明显。但当链表变长时，查询性能会显著下降。</p>
<h5 id="84">8.4 扩容⭐️</h5>
<p>达到 capacity * 0.75 factor 进行扩容，每次两倍。</p>
<h4 id="9-hashmap">9. 为什么 HashMap 优先扩容而非直接转为红黑树</h4>
<p>因为数组扩容才是更加根本的减少哈希冲突的方法，因此，当数组容量不算大时，会优先选择扩容，在java中，只有长度 &gt; 64，才会将链表转为红黑树。</p>
<p>另一方面，过早引入红黑树反而会降低哈希表的效率，因为红黑树的结构比较复杂，常数比较大。</p>
<h4 id="10-8-64">10. 为什么选择阈值 8 和 64</h4>
<ul>
<li>泊松分布表明，链表长度达到 8 的概率极低（小于千万分之一）。在绝大多数情况下，链表长度都不会超过 8。阈值设置为 8，可以保证性能和空间效率的平衡。</li>
<li>数组长度阈值 64 同样是经过实践验证的经验值。在小数组中扩容成本低，优先扩容可以避免过早引入红黑树。数组大小达到 64 时，冲突概率较高，此时红黑树的性能优势开始显现。</li>
</ul>
<p>用极小的概率换取极高的搜索性能。：
<strong>空间成本</strong>：红黑树的节点（<code>TreeNode</code>）占用的空间大约是普通链表节点（<code>Node</code>）的 <strong>2 倍</strong>。如果一上来就用树，会浪费大量内存。
时间成本：当 <span class="arithmatex">\(n=8\)</span> 时，<span class="arithmatex">\(\log_2(8) = 3\)</span>。虽然 3 比 8 小，但考虑到红黑树旋转保持平衡的开销，在 <span class="arithmatex">\(n\)</span> 比较小时，两者的查找速度差异并不大。</p>
<p><strong>泊松分布（Poisson Distribution）</strong>： 根据源码注释中的计算，在哈希值分布均匀的情况下，桶中元素达到 8 个的概率只有 <strong>0.00000006</strong>。</p>
<h4 id="11-hashmap">11. HashMap 多线程操作导致死循环问题</h4>
<p>JDK1.7 及之前版本的 <code>HashMap</code> 在多线程环境下扩容操作可能存在死循环问题，这是由于当一个桶位中有多个元素需要进行扩容时，多个线程同时对链表进行操作，头插法可能会导致链表中的节点指向错误的位置，从而形成一个环形链表，进而使得查询元素的操作陷入死循环无法结束。</p>
<p align='center'>
    <img src="../../assets/imgs/interview/java/java集合/java集合04.png" alt="java集合04" style="zoom:60%;" />
</p>

<p>为了解决这个问题，JDK1.8 版本的 HashMap 采用了尾插法而不是头插法来避免链表倒置，使得插入的节点永远都是放在链表的末尾，避免了链表中的环形结构。但是还是不建议在多线程下使用 <code>HashMap</code>，因为多线程下使用 <code>HashMap</code> 还是会存在数据覆盖的问题。并发环境下，推荐使用 <code>ConcurrentHashMap</code> 。</p>
<ul>
<li><strong>保持顺序</strong>：扩容搬迁时，原链表里的 <code>A -&gt; B</code>，搬到新数组后依然保持 <code>A -&gt; B</code> 的相对顺序。</li>
<li><strong>物理隔离</strong>：它不是一个一个挪，而是先在原位置分好“高位链表”和“低位链表”，然后整体挂载到新的桶位上。既然顺序没乱，也就失去了形成“环”的基础条件。</li>
</ul>
<p>总结：</p>
<p>“JDK 1.7 的死循环根源在于<strong>多线程竞争下的头插法</strong>，导致链表节点在搬迁时产生了环。1.8 虽然通过<strong>尾插法</strong>和<strong>高低位迁移</strong>解决了环的问题，但由于 <code>put</code> 等操作没有任何同步锁保护，依然存在<strong>多线程并发修改导致的数据覆盖</strong>风险。因此，在并发环境下，我们必须使用 <code>ConcurrentHashMap</code> 或者 <code>Collections.synchronizedMap()</code>。”</p>
<h4 id="12-hashmap">12 HashMap 为什么线程不安全⭐️</h4>
<ol>
<li>在 jdk 1.7 之前，由于是头插法，所以在并发扩容是可能会导致链表成环</li>
<li>并发新增元素会导致数据丢失。</li>
</ol>
<h4 id="13-hashmap">13. HashMap 的常见遍历方式⭐️</h4>
<ol>
<li>
<p>迭代器（Iterator）方式遍历
<div class="highlight"><pre><span></span><code><span class="c1">// 1. 迭代器遍历：entry set  </span>
<span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Map</span><span class="p">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">iterator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">map</span><span class="p">.</span><span class="na">entrySet</span><span class="p">().</span><span class="na">iterator</span><span class="p">();</span><span class="w">  </span>
<span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">iterator</span><span class="p">.</span><span class="na">hasNext</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">  </span>
<span class="w">    </span><span class="n">Map</span><span class="p">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iterator</span><span class="p">.</span><span class="na">next</span><span class="p">();</span><span class="w">  </span>
<span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">entry</span><span class="p">.</span><span class="na">getKey</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;:&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">entry</span><span class="p">.</span><span class="na">getValue</span><span class="p">());</span><span class="w">  </span>
<span class="p">}</span>


<span class="c1">// 2. 迭代器遍历：key set  </span>
<span class="n">Iterator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">iterator1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">map</span><span class="p">.</span><span class="na">keySet</span><span class="p">().</span><span class="na">iterator</span><span class="p">();</span><span class="w">  </span>
<span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">iterator1</span><span class="p">.</span><span class="na">hasNext</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">  </span>
<span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iterator1</span><span class="p">.</span><span class="na">next</span><span class="p">();</span><span class="w">  </span>
<span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;:&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">map</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">key</span><span class="p">));</span><span class="w">  </span>
<span class="p">}</span>
</code></pre></div></p>
</li>
<li>
<p>For Each 方式遍历  <br />
<div class="highlight"><pre><span></span><code><span class="c1">// 1. entry</span>
<span class="k">for</span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">map</span><span class="p">.</span><span class="na">entrySet</span><span class="p">()){</span><span class="w">  </span>
<span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">entry</span><span class="p">.</span><span class="na">getKey</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;:&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">entry</span><span class="p">.</span><span class="na">getValue</span><span class="p">());</span><span class="w">  </span>
<span class="p">}</span>
<span class="c1">// 2. key</span>
<span class="k">for</span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">map</span><span class="p">.</span><span class="na">keySet</span><span class="p">()){</span><span class="w">  </span>
<span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;:&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">map</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">key</span><span class="p">));</span><span class="w">  </span>
<span class="p">}</span>
</code></pre></div></p>
</li>
<li>
<p>Lambda 表达式遍历（JDK 1.8+）
<div class="highlight"><pre><span></span><code><span class="n">map</span><span class="p">.</span><span class="na">forEach</span><span class="p">((</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;:&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v</span><span class="p">));</span>
</code></pre></div></p>
</li>
<li>
<p>Streams API 遍历（JDK 1.8+）
<div class="highlight"><pre><span></span><code><span class="c1">// 串行流</span>
<span class="n">map</span><span class="p">.</span><span class="na">entrySet</span><span class="p">().</span><span class="na">stream</span><span class="p">().</span><span class="na">forEach</span><span class="p">(</span><span class="n">entry</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">  </span>
<span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">entry</span><span class="p">.</span><span class="na">getKey</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">entry</span><span class="p">.</span><span class="na">getValue</span><span class="p">());</span><span class="w">  </span>
<span class="p">});</span>

<span class="c1">// 并行流</span>
<span class="n">map</span><span class="p">.</span><span class="na">entrySet</span><span class="p">().</span><span class="na">parallelStream</span><span class="p">().</span><span class="na">forEach</span><span class="p">(</span><span class="n">entry</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">  </span>
<span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">entry</span><span class="p">.</span><span class="na">getKey</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">entry</span><span class="p">.</span><span class="na">getValue</span><span class="p">());</span><span class="w">  </span>
<span class="p">});</span>
</code></pre></div></p>
</li>
</ol>
<p align='center'>
    <img src="../../assets/imgs/interview/java/java集合/java集合05.png" alt="java集合05" style="zoom:80%;" />
</p>

<p>其中 Units 为 ns/op 意思是执行完成时间（单位为纳秒），而 Score 列为平均执行时间， <code>±</code> 符号表示误差。从以上结果可以看出，两个 <code>entrySet</code> 的性能相近，并且执行速度最快，接下来是 <code>stream</code> ，然后是两个 <code>keySet</code>，性能最差的是 <code>KeySet</code> 。</p>
<h4 id="14-coucurrenthashmap">14. CoucurrentHashMap</h4>
<table>
<thead>
<tr>
<th><strong>特性</strong></th>
<th><strong>JDK 1.7</strong></th>
<th><strong>JDK 1.8</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>锁的实现</strong></td>
<td><code>Segment</code> (继承 <code>ReentrantLock</code>)</td>
<td>node + <strong>CAS</strong> + <strong><code>synchronized</code></strong></td>
</tr>
<tr>
<td><strong>锁的粒度</strong></td>
<td>分段锁（默认 16 个 Segment）</td>
<td><strong>节点锁</strong>（锁住每个桶的头节点）</td>
</tr>
<tr>
<td><strong>数据结构</strong></td>
<td>数组 + 链表</td>
<td>数组 + 链表 + <strong>红黑树</strong></td>
</tr>
<tr>
<td><strong>查询性能</strong></td>
<td>链表 <span class="arithmatex">\(O(n)\)</span></td>
<td>红黑树 <span class="arithmatex">\(O(\log n)\)</span></td>
</tr>
</tbody>
</table>
<p>“<code>ConcurrentHashMap</code> 在 1.7 采用 <strong>Segment 分段锁</strong>来实现并发，并发度受限于分段数；而在 1.8 则抛弃了分段锁，改用 <strong>CAS + 数组头节点上的 synchronized</strong>，配合红黑树，实现了更细粒度的锁定和更高的并发性能，同时支持多线程协助扩容，是目前 Java 并发环境下最高效的散列表实现。”</p>
<p>分段锁： 将数据分成一段一段的（Segment），每一段都配一把锁。当一个线程占用其中一把锁时，这一段内的数据都被锁住，但其他段的数据依然可以被其他线程访问。</p>
<p>节点锁：抛弃段的概念，直接给数组里的<strong>每一个桶（Bucket）的头节点</strong>加锁。</p>
<h4 id="15-jdk-17-jdk-18-concurrenthashmap">15. JDK 1.7 和 JDK 1.8 的 ConcurrentHashMap 实现有什么不同？</h4>
<ul>
<li><strong>线程安全实现方式</strong>：JDK 1.7 采用 <code>Segment</code> 分段锁来保证安全， <code>Segment</code> 是继承自 <code>ReentrantLock</code>。JDK1.8 放弃了 <code>Segment</code> 分段锁的设计，采用 <code>Node + CAS + synchronized</code> 保证线程安全，锁粒度更细，<code>synchronized</code> 只锁定当前链表或红黑二叉树的首节点。</li>
<li><strong>Hash 碰撞解决方法</strong> : JDK 1.7 采用拉链法，JDK1.8 采用拉链法结合红黑树（链表长度超过一定阈值时，将链表转换为红黑树）。</li>
<li><strong>并发度</strong>：JDK 1.7 最大并发度是 Segment 的个数，默认是 16。JDK 1.8 最大并发度是 Node 数组的大小，并发度更大。</li>
</ul>
<h4 id="16-node-cas-synchronized">16. node + cas + synchronized</h4>
<p>“在 JDK 1.8 中，<code>ConcurrentHashMap</code> 结合了这三者的优势：<strong>Node</strong> 的 <code>volatile</code> 字段保证了多线程间的内存可见性，使读取操作无需加锁；<strong>CAS</strong> 实现了在特定位置为空时的无锁原子化插入，极大地提升了并发性能；而 <strong>synchronized</strong> 则提供了细粒度的互斥保护，仅在发生哈希冲突时锁定单个桶的头节点</p>
<h4 id="17-concurrenthashmap-key-value-null">17. ConcurrentHashMap 为什么 key 和 value 不能为 null？</h4>
<p>“<code>ConcurrentHashMap</code> 不允许 Key 和 Value 为 <code>null</code>，主要是为了<strong>消除在并发环境下的二义性</strong>。如果允许 <code>null</code> 值，当 <code>get(key)</code> 返回 <code>null</code> 时，我们无法在不加锁的情况下通过 <code>containsKey</code> 确认这个 <code>null</code> 的真实含义，因为在两次操作之间，其他线程可能已经修改了 Map。</p>
<h4 id="18-colletions">18. Colletions 工具类</h4>
<p>排序：
<div class="highlight"><pre><span></span><code><span class="c1">// 排序</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">reverse</span><span class="p">(</span><span class="n">List</span><span class="w"> </span><span class="n">list</span><span class="p">)</span><span class="c1">//反转</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">shuffle</span><span class="p">(</span><span class="n">List</span><span class="w"> </span><span class="n">list</span><span class="p">)</span><span class="c1">//随机排序</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">sort</span><span class="p">(</span><span class="n">List</span><span class="w"> </span><span class="n">list</span><span class="p">)</span><span class="c1">//按自然排序的升序排序</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">sort</span><span class="p">(</span><span class="n">List</span><span class="w"> </span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="n">Comparator</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="c1">//定制排序，由Comparator控制排序逻辑</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">swap</span><span class="p">(</span><span class="n">List</span><span class="w"> </span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="c1">//交换两个索引位置的元素</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">rotate</span><span class="p">(</span><span class="n">List</span><span class="w"> </span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">distance</span><span class="p">)</span><span class="c1">//旋转。当distance为正数时，将list后distance个元素整体移到前面。当distance为负数时，将 list的前distance个元素整体移到后面</span>
</code></pre></div></p>
<p>查找 | 替换
<div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">binarySearch</span><span class="p">(</span><span class="n">List</span><span class="w"> </span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="c1">//对List进行二分查找，返回索引，注意List必须是有序的</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">Collection</span><span class="w"> </span><span class="n">coll</span><span class="p">)</span><span class="c1">//根据元素的自然顺序，返回最大的元素。 类比int min(Collection coll)</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">Collection</span><span class="w"> </span><span class="n">coll</span><span class="p">,</span><span class="w"> </span><span class="n">Comparator</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="c1">//根据定制排序，返回最大元素，排序规则由Comparatator类控制。类比int min(Collection coll, Comparator c)</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">fill</span><span class="p">(</span><span class="n">List</span><span class="w"> </span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">obj</span><span class="p">)</span><span class="c1">//用指定的元素代替指定list中的所有元素</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">frequency</span><span class="p">(</span><span class="n">Collection</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="c1">//统计元素出现次数</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">indexOfSubList</span><span class="p">(</span><span class="n">List</span><span class="w"> </span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="n">List</span><span class="w"> </span><span class="n">target</span><span class="p">)</span><span class="c1">//统计target在list中第一次出现的索引，找不到则返回-1，类比int lastIndexOfSubList(List source, list target)</span>
<span class="kt">boolean</span><span class="w"> </span><span class="nf">replaceAll</span><span class="p">(</span><span class="n">List</span><span class="w"> </span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">oldVal</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">newVal</span><span class="p">)</span><span class="c1">//用新元素替换旧元素</span>
</code></pre></div></p>
<p><a href="https://javaguide.cn/java/collection/java-collection-precautions-for-use.html">集合使用注意事项</a></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2026 LiuTianBa7 

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.tracking", "navigation.top", "search.suggest", "search.highlight", "content.code.copy"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>